!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.THREE=e.THREE||{})}(this,function(e){"use strict";function t(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}),Object.assign(t.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners[e];if(void 0!==i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var i=t.slice(0),n=0,r=i.length;n<r;n++)i[n].call(this,e)}}}});var i,n,r,o,a,s,l="86",c=0,u=1,h=2,d=0,p=1,f=2,m=0,g=1,v=2,y=1,b=2,x=0,_=1,w=2,E=0,T=1,M=2,S=3,C=4,R=5,A=100,P=101,L=102,O=103,I=104,k=200,D=201,N=202,H=203,B=204,F=205,U=206,$=207,j=208,z=209,V=210,G=0,W=1,q=2,X=3,Z=4,Y=5,J=6,K=7,Q=0,ee=1,te=2,ie=0,ne=1,re=2,oe=3,ae=4,se=301,le=302,ce=303,ue=304,he=305,de=306,pe=307,fe=1e3,me=1001,ge=1002,ve=1003,ye=1004,be=1005,xe=1006,_e=1007,we=1008,Ee=1009,Te=1010,Me=1011,Se=1012,Ce=1013,Re=1014,Ae=1015,Pe=1016,Le=1017,Oe=1018,Ie=1019,ke=1020,De=1021,Ne=1022,He=1023,Be=1024,Fe=1025,Ue=He,$e=1026,je=1027,ze=2001,Ve=2002,Ge=2003,We=2004,qe=2100,Xe=2101,Ze=2102,Ye=2103,Je=2151,Ke=2201,Qe=2400,et=0,tt=1,it=2,nt=3e3,rt=3001,ot=3007,at=3002,st=3004,lt=3005,ct=3006,ut=3200,ht=3201,dt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:(n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=new Array(36),o=0,function(){for(var e=0;e<36;e++)8===e||13===e||18===e||23===e?r[e]="-":14===e?r[e]="4":(o<=2&&(o=33554432+16777216*Math.random()|0),i=15&o,o>>=4,r[e]=n[19===e?3&i|8:i]);return r.join("")}),clamp:function(e,t,i){return Math.max(t,Math.min(i,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},lerp:function(e,t,i){return(1-i)*e+i*t},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*dt.DEG2RAD},radToDeg:function(e){return e*dt.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},nearestPowerOfTwo:function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}};function pt(e,t){this.x=e||0,this.y=t||0}Object.defineProperties(pt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(pt.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:(a=new pt,s=new pt,function(e,t){return a.set(e,e),s.set(t,t),this.clamp(a,s)}),clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},distanceToManhattan:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*i-o*n+e.x,this.y=r*n+o*i+e.y,this}});var ft,mt,gt,vt,yt,bt,xt=0;function _t(e,t,i,n,r,o,a,s,l,c){Object.defineProperty(this,"id",{value:xt++}),this.uuid=dt.generateUUID(),this.name="",this.image=void 0!==e?e:_t.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:_t.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:me,this.wrapT=void 0!==n?n:me,this.magFilter=void 0!==r?r:xe,this.minFilter=void 0!==o?o:we,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:He,this.type=void 0!==s?s:Ee,this.offset=new pt(0,0),this.repeat=new pt(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:nt,this.version=0,this.onUpdate=null}function wt(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==n?n:1}function Et(e,t,i){this.uuid=dt.generateUUID(),this.width=e,this.height=t,this.scissor=new wt(0,0,e,t),this.scissorTest=!1,this.viewport=new wt(0,0,e,t),void 0===(i=i||{}).minFilter&&(i.minFilter=xe),this.texture=new _t(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function Tt(e,t,i){Et.call(this,e,t,i),this.activeCubeFace=0,this.activeMipMapLevel=0}function Mt(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._w=void 0!==n?n:1}function St(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0}function Ct(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Rt(e,t,i,n,r,o,a,s,l,c,u,h){_t.call(this,null,o,a,s,l,c,n,r,u,h),this.image={data:e,width:t,height:i},this.magFilter=void 0!==l?l:ve,this.minFilter=void 0!==c?c:ve,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function At(e,t,i,n,r,o,a,s,l,c){e=void 0!==e?e:[],t=void 0!==t?t:se,_t.call(this,e,t,i,n,r,o,a,s,l,c),this.flipY=!1}_t.DEFAULT_IMAGE=void 0,_t.DEFAULT_MAPPING=300,Object.defineProperty(_t.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(_t.prototype,t.prototype,{constructor:_t,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){if(void 0!==e.textures[this.uuid])return e.textures[this.uuid];var t={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var i=this.image;void 0===i.uuid&&(i.uuid=dt.generateUUID()),void 0===e.images[i.uuid]&&(e.images[i.uuid]={uuid:i.uuid,url:function(e){var t;return void 0!==e.toDataURL?t=e:((t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height)),t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}(i)}),t.image=i.uuid}return e.textures[this.uuid]=t,t},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300===this.mapping){if(e.multiply(this.repeat),e.add(this.offset),e.x<0||e.x>1)switch(this.wrapS){case fe:e.x=e.x-Math.floor(e.x);break;case me:e.x=e.x<0?0:1;break;case ge:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case fe:e.y=e.y-Math.floor(e.y);break;case me:e.y=e.y<0?0:1;break;case ge:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.assign(wt.prototype,{isVector4:!0,set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*n+o[12]*r,this.y=o[1]*t+o[5]*i+o[9]*n+o[13]*r,this.z=o[2]*t+o[6]*i+o[10]*n+o[14]*r,this.w=o[3]*t+o[7]*i+o[11]*n+o[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,n,r,o=e.elements,a=o[0],s=o[4],l=o[8],c=o[1],u=o[5],h=o[9],d=o[2],p=o[6],f=o[10];if(Math.abs(s-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(a+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,g=(u+1)/2,v=(f+1)/2,y=(s+c)/4,b=(l+d)/4,x=(h+p)/4;return m>g&&m>v?m<.01?(i=0,n=.707106781,r=.707106781):(n=y/(i=Math.sqrt(m)),r=b/i):g>v?g<.01?(i=.707106781,n=0,r=.707106781):(i=y/(n=Math.sqrt(g)),r=x/n):v<.01?(i=.707106781,n=.707106781,r=0):(i=b/(r=Math.sqrt(v)),n=x/r),this.set(i,n,r,t),this}var _=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(c-s)*(c-s));return Math.abs(_)<.001&&(_=1),this.x=(p-h)/_,this.y=(l-d)/_,this.z=(c-s)/_,this.w=Math.acos((a+u+f-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(i,n){return void 0===e&&(e=new wt,t=new wt),e.set(i,i,i,i),t.set(n,n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Object.assign(Et.prototype,t.prototype,{isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Tt.prototype=Object.create(Et.prototype),Tt.prototype.constructor=Tt,Tt.prototype.isWebGLRenderTargetCube=!0,Object.assign(Mt,{slerp:function(e,t,i,n){return i.copy(e).slerp(t,n)},slerpFlat:function(e,t,i,n,r,o,a){var s=i[n+0],l=i[n+1],c=i[n+2],u=i[n+3],h=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(u!==f||s!==h||l!==d||c!==p){var m=1-a,g=s*h+l*d+c*p+u*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,g*v);m=Math.sin(m*x)/b,a=Math.sin(a*x)/b}var _=a*v;if(s=s*m+h*_,l=l*m+d*_,c=c*m+p*_,u=u*m+f*_,m===1-a){var w=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=w,l*=w,c*=w,u*=w}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}}),Object.defineProperties(Mt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Mt.prototype,{set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=e._x,n=e._y,r=e._z,o=e.order,a=Math.cos,s=Math.sin,l=a(i/2),c=a(n/2),u=a(r/2),h=s(i/2),d=s(n/2),p=s(r/2);return"XYZ"===o?(this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p):"YXZ"===o?(this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p):"ZXY"===o?(this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p):"ZYX"===o?(this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p):"YZX"===o?(this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p):"XZY"===o&&(this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,i=e.elements,n=i[0],r=i[4],o=i[8],a=i[1],s=i[5],l=i[9],c=i[2],u=i[6],h=i[10],d=n+s+h;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(u-l)*t,this._y=(o-c)*t,this._z=(a-r)*t):n>s&&n>h?(t=2*Math.sqrt(1+n-s-h),this._w=(u-l)/t,this._x=.25*t,this._y=(r+a)/t,this._z=(o+c)/t):s>h?(t=2*Math.sqrt(1+s-n-h),this._w=(o-c)/t,this._x=(r+a)/t,this._y=.25*t,this._z=(l+u)/t):(t=2*Math.sqrt(1+h-n-s),this._w=(a-r)/t,this._x=(o+c)/t,this._y=(l+u)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t=new St;return function(i,n){return void 0===t&&(t=new St),(e=i.dot(n)+1)<1e-6?(e=0,Math.abs(i.x)>Math.abs(i.z)?t.set(-i.y,i.x,0):t.set(0,-i.z,i.y)):t.crossVectors(i,n),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var i=e._x,n=e._y,r=e._z,o=e._w,a=t._x,s=t._y,l=t._z,c=t._w;return this._x=i*c+o*a+n*l-r*s,this._y=n*c+o*s+r*a-i*l,this._z=r*c+o*l+i*s-n*a,this._w=o*c-i*a-n*s-r*l,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var i=this._x,n=this._y,r=this._z,o=this._w,a=o*e._w+i*e._x+n*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=n,this._z=r,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var l=Math.atan2(s,a),c=Math.sin((1-t)*l)/s,u=Math.sin(t*l)/s;return this._w=o*c+this._w*u,this._x=i*c+this._x*u,this._y=n*c+this._y*u,this._z=r*c+this._z*u,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(St.prototype,{isVector3:!0,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(gt=new Mt,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(gt.setFromEuler(e))}),applyAxisAngle:function(){var e=new Mt;return function(t,i){return this.applyQuaternion(e.setFromAxisAngle(t,i))}}(),applyMatrix3:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements,o=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*o,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*o,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*o,this},applyQuaternion:function(e){var t=this.x,i=this.y,n=this.z,r=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*n-a*i,c=s*i+a*t-r*n,u=s*n+r*i-o*t,h=-r*t-o*i-a*n;return this.x=l*s+h*-r+c*-a-u*-o,this.y=c*s+h*-o+u*-r-l*-a,this.z=u*s+h*-a+l*-o-c*-r,this},project:(mt=new Ct,function(e){return mt.multiplyMatrices(e.projectionMatrix,mt.getInverse(e.matrixWorld)),this.applyMatrix4(mt)}),unproject:function(){var e=new Ct;return function(t){return e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyMatrix4(e)}}(),transformDirection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new St,t=new St;return function(i,n){return e.set(i,i,i),t.set(n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var i=this.x,n=this.y,r=this.z;return this.x=n*e.z-r*e.y,this.y=r*e.x-i*e.z,this.z=i*e.y-n*e.x,this},crossVectors:function(e,t){var i=e.x,n=e.y,r=e.z,o=t.x,a=t.y,s=t.z;return this.x=n*s-r*a,this.y=r*o-i*s,this.z=i*a-n*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(ft=new St,function(e){return ft.copy(this).projectOnVector(e),this.sub(ft)}),reflect:function(){var e=new St;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(dt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n},distanceToManhattan:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(Ct.prototype,{isMatrix4:!0,set:function(e,t,i,n,r,o,a,s,l,c,u,h,d,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=n,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ct).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractBasis:function(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this},extractRotation:function(){var e=new St;return function(t){var i=this.elements,n=t.elements,r=1/e.setFromMatrixColumn(t,0).length(),o=1/e.setFromMatrixColumn(t,1).length(),a=1/e.setFromMatrixColumn(t,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[4]=n[4]*o,i[5]=n[5]*o,i[6]=n[6]*o,i[8]=n[8]*a,i[9]=n[9]*a,i[10]=n[10]*a,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,i=e.x,n=e.y,r=e.z,o=Math.cos(i),a=Math.sin(i),s=Math.cos(n),l=Math.sin(n),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){var h=o*c,d=o*u,p=a*c,f=a*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=d+p*l,t[5]=h-f*l,t[9]=-a*s,t[2]=f-h*l,t[6]=p+d*l,t[10]=o*s}else if("YXZ"===e.order){var m=s*c,g=s*u,v=l*c,y=l*u;t[0]=m+y*a,t[4]=v*a-g,t[8]=o*l,t[1]=o*u,t[5]=o*c,t[9]=-a,t[2]=g*a-v,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*c,g=s*u,v=l*c,y=l*u;t[0]=m-y*a,t[4]=-o*u,t[8]=v+g*a,t[1]=g+v*a,t[5]=o*c,t[9]=y-m*a,t[2]=-o*l,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){h=o*c,d=o*u,p=a*c,f=a*u;t[0]=s*c,t[4]=p*l-d,t[8]=h*l+f,t[1]=s*u,t[5]=f*l+h,t[9]=d*l-p,t[2]=-l,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var b=o*s,x=o*l,_=a*s,w=a*l;t[0]=s*c,t[4]=w-b*u,t[8]=_*u+x,t[1]=u,t[5]=o*c,t[9]=-a*c,t[2]=-l*c,t[6]=x*u+_,t[10]=b-w*u}else if("XZY"===e.order){b=o*s,x=o*l,_=a*s,w=a*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=b*u+w,t[5]=o*c,t[9]=x*u-_,t[2]=_*u-x,t[6]=a*c,t[10]=w*u+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,i=e._x,n=e._y,r=e._z,o=e._w,a=i+i,s=n+n,l=r+r,c=i*a,u=i*s,h=i*l,d=n*s,p=n*l,f=r*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+f),t[4]=u-v,t[8]=h+g,t[1]=u+v,t[5]=1-(c+f),t[9]=p-m,t[2]=h-g,t[6]=p+m,t[10]=1-(c+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:(vt=new St,yt=new St,bt=new St,function(e,t,i){var n=this.elements;return bt.subVectors(e,t),0===bt.lengthSq()&&(bt.z=1),bt.normalize(),vt.crossVectors(i,bt),0===vt.lengthSq()&&(1===Math.abs(i.z)?bt.x+=1e-4:bt.z+=1e-4,bt.normalize(),vt.crossVectors(i,bt)),vt.normalize(),yt.crossVectors(bt,vt),n[0]=vt.x,n[4]=yt.x,n[8]=bt.x,n[1]=vt.y,n[5]=yt.y,n[9]=bt.y,n[2]=vt.z,n[6]=yt.z,n[10]=bt.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,o=i[0],a=i[4],s=i[8],l=i[12],c=i[1],u=i[5],h=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],b=i[11],x=i[15],_=n[0],w=n[4],E=n[8],T=n[12],M=n[1],S=n[5],C=n[9],R=n[13],A=n[2],P=n[6],L=n[10],O=n[14],I=n[3],k=n[7],D=n[11],N=n[15];return r[0]=o*_+a*M+s*A+l*I,r[4]=o*w+a*S+s*P+l*k,r[8]=o*E+a*C+s*L+l*D,r[12]=o*T+a*R+s*O+l*N,r[1]=c*_+u*M+h*A+d*I,r[5]=c*w+u*S+h*P+d*k,r[9]=c*E+u*C+h*L+d*D,r[13]=c*T+u*R+h*O+d*N,r[2]=p*_+f*M+m*A+g*I,r[6]=p*w+f*S+m*P+g*k,r[10]=p*E+f*C+m*L+g*D,r[14]=p*T+f*R+m*O+g*N,r[3]=v*_+y*M+b*A+x*I,r[7]=v*w+y*S+b*P+x*k,r[11]=v*E+y*C+b*L+x*D,r[15]=v*T+y*R+b*O+x*N,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new St;return function(t){for(var i=0,n=t.count;i<n;i++)e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.applyMatrix4(this),t.setXYZ(i,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],o=e[1],a=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*s*u-n*l*u-r*a*h+i*l*h+n*a*d-i*s*d)+e[7]*(+t*s*d-t*l*h+r*o*h-n*o*d+n*l*c-r*s*c)+e[11]*(+t*l*u-t*a*d-r*o*u+i*o*d+r*a*c-i*l*c)+e[15]*(-n*a*c-t*s*u+t*a*h+n*o*u-i*o*h+i*s*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var i=this.elements,n=e.elements,r=n[0],o=n[1],a=n[2],s=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],b=n[15],x=p*y*h-v*f*h+v*u*m-c*y*m-p*u*b+c*f*b,_=g*f*h-d*y*h-g*u*m+l*y*m+d*u*b-l*f*b,w=d*v*h-g*p*h+g*c*m-l*v*m-d*c*b+l*p*b,E=g*p*u-d*v*u-g*c*f+l*v*f+d*c*y-l*p*y,T=r*x+o*_+a*w+s*E;if(0===T){var M="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(!0===t)throw new Error(M);return console.warn(M),this.identity()}var S=1/T;return i[0]=x*S,i[1]=(v*f*s-p*y*s-v*a*m+o*y*m+p*a*b-o*f*b)*S,i[2]=(c*y*s-v*u*s+v*a*h-o*y*h-c*a*b+o*u*b)*S,i[3]=(p*u*s-c*f*s-p*a*h+o*f*h+c*a*m-o*u*m)*S,i[4]=_*S,i[5]=(d*y*s-g*f*s+g*a*m-r*y*m-d*a*b+r*f*b)*S,i[6]=(g*u*s-l*y*s-g*a*h+r*y*h+l*a*b-r*u*b)*S,i[7]=(l*f*s-d*u*s+d*a*h-r*f*h-l*a*m+r*u*m)*S,i[8]=w*S,i[9]=(g*p*s-d*v*s-g*o*m+r*v*m+d*o*b-r*p*b)*S,i[10]=(l*v*s-g*c*s+g*o*h-r*v*h-l*o*b+r*c*b)*S,i[11]=(d*c*s-l*p*s-d*o*h+r*p*h+l*o*m-r*c*m)*S,i[12]=E*S,i[13]=(d*v*a-g*p*a+g*o*f-r*v*f-d*o*y+r*p*y)*S,i[14]=(g*c*a-l*v*a-g*o*u+r*v*u+l*o*y-r*c*y)*S,i[15]=(l*p*a-d*c*a+d*o*u-r*p*u-l*o*f+r*c*f)*S,this},scale:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=1-i,o=e.x,a=e.y,s=e.z,l=r*o,c=r*a;return this.set(l*o+i,l*a-n*s,l*s+n*a,0,l*a+n*s,c*a+i,c*s-n*o,0,l*s-n*a,c*s+n*o,r*s*s+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(e,t,i){return this.set(1,t,i,0,e,1,i,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,i){return this.makeRotationFromQuaternion(t),this.scale(i),this.setPosition(e),this},decompose:function(){var e=new St,t=new Ct;return function(i,n,r){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),l=e.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),i.x=o[12],i.y=o[13],i.z=o[14],t.copy(this);var c=1/a,u=1/s,h=1/l;return t.elements[0]*=c,t.elements[1]*=c,t.elements[2]*=c,t.elements[4]*=u,t.elements[5]*=u,t.elements[6]*=u,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,n.setFromRotationMatrix(t),r.x=a,r.y=s,r.z=l,this}}(),makePerspective:function(e,t,i,n,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*r/(t-e),l=2*r/(i-n),c=(t+e)/(t-e),u=(i+n)/(i-n),h=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,i,n,r,o){var a=this.elements,s=1/(t-e),l=1/(i-n),c=1/(o-r),u=(t+e)*s,h=(i+n)*l,d=(o+r)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;i<16;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}),Rt.prototype=Object.create(_t.prototype),Rt.prototype.constructor=Rt,Rt.prototype.isDataTexture=!0,At.prototype=Object.create(_t.prototype),At.prototype.constructor=At,At.prototype.isCubeTexture=!0,Object.defineProperty(At.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var Pt=new _t,Lt=new At;function Ot(){this.seq=[],this.map={}}var It=[],kt=[],Dt=new Float32Array(16),Nt=new Float32Array(9);function Ht(e,t,i){var n=e[0];if(n<=0||n>0)return e;var r=t*i,o=It[r];if(void 0===o&&(o=new Float32Array(r),It[r]=o),0!==t){n.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=i,e[a].toArray(o,s)}return o}function Bt(e,t){var i=kt[t];void 0===i&&(i=new Int32Array(t),kt[t]=i);for(var n=0;n!==t;++n)i[n]=e.allocTextureUnit();return i}function Ft(e,t){e.uniform1f(this.addr,t)}function Ut(e,t){e.uniform1i(this.addr,t)}function $t(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function jt(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function zt(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function Vt(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function Gt(e,t){void 0===t.elements?e.uniformMatrix3fv(this.addr,!1,t):(Nt.set(t.elements),e.uniformMatrix3fv(this.addr,!1,Nt))}function Wt(e,t){void 0===t.elements?e.uniformMatrix4fv(this.addr,!1,t):(Dt.set(t.elements),e.uniformMatrix4fv(this.addr,!1,Dt))}function qt(e,t,i){var n=i.allocTextureUnit();e.uniform1i(this.addr,n),i.setTexture2D(t||Pt,n)}function Xt(e,t,i){var n=i.allocTextureUnit();e.uniform1i(this.addr,n),i.setTextureCube(t||Lt,n)}function Zt(e,t){e.uniform2iv(this.addr,t)}function Yt(e,t){e.uniform3iv(this.addr,t)}function Jt(e,t){e.uniform4iv(this.addr,t)}function Kt(e,t){e.uniform1fv(this.addr,t)}function Qt(e,t){e.uniform1iv(this.addr,t)}function ei(e,t){e.uniform2fv(this.addr,Ht(t,this.size,2))}function ti(e,t){e.uniform3fv(this.addr,Ht(t,this.size,3))}function ii(e,t){e.uniform4fv(this.addr,Ht(t,this.size,4))}function ni(e,t){e.uniformMatrix2fv(this.addr,!1,Ht(t,this.size,4))}function ri(e,t){e.uniformMatrix3fv(this.addr,!1,Ht(t,this.size,9))}function oi(e,t){e.uniformMatrix4fv(this.addr,!1,Ht(t,this.size,16))}function ai(e,t,i){var n=t.length,r=Bt(i,n);e.uniform1iv(this.addr,r);for(var o=0;o!==n;++o)i.setTexture2D(t[o]||Pt,r[o])}function si(e,t,i){var n=t.length,r=Bt(i,n);e.uniform1iv(this.addr,r);for(var o=0;o!==n;++o)i.setTextureCube(t[o]||Lt,r[o])}function li(e,t,i){this.id=e,this.addr=i,this.setValue=function(e){switch(e){case 5126:return Ft;case 35664:return $t;case 35665:return jt;case 35666:return zt;case 35674:return Vt;case 35675:return Gt;case 35676:return Wt;case 35678:case 36198:return qt;case 35680:return Xt;case 5124:case 35670:return Ut;case 35667:case 35671:return Zt;case 35668:case 35672:return Yt;case 35669:case 35673:return Jt}}(t.type)}function ci(e,t,i){this.id=e,this.addr=i,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Kt;case 35664:return ei;case 35665:return ti;case 35666:return ii;case 35674:return ni;case 35675:return ri;case 35676:return oi;case 35678:return ai;case 35680:return si;case 5124:case 35670:return Qt;case 35667:case 35671:return Zt;case 35668:case 35672:return Yt;case 35669:case 35673:return Jt}}(t.type)}function ui(e){this.id=e,Ot.call(this)}ui.prototype.setValue=function(e,t){for(var i=this.seq,n=0,r=i.length;n!==r;++n){var o=i[n];o.setValue(e,t[o.id])}};var hi=/([\w\d_]+)(\])?(\[|\.)?/g;function di(e,t){e.seq.push(t),e.map[t.id]=t}function pi(e,t,i){var n=e.name,r=n.length;for(hi.lastIndex=0;;){var o=hi.exec(n),a=hi.lastIndex,s=o[1],l="]"===o[2],c=o[3];if(l&&(s|=0),void 0===c||"["===c&&a+2===r){di(i,void 0===c?new li(s,e,t):new ci(s,e,t));break}var u=i.map[s];void 0===u&&di(i,u=new ui(s)),i=u}}function fi(e,t,i){Ot.call(this),this.renderer=i;for(var n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<n;++r){var o=e.getActiveUniform(t,r),a=o.name;pi(o,e.getUniformLocation(t,a),this)}}fi.prototype.setValue=function(e,t,i){var n=this.map[t];void 0!==n&&n.setValue(e,i,this.renderer)},fi.prototype.setOptional=function(e,t,i){var n=t[i];void 0!==n&&this.setValue(e,i,n)},fi.upload=function(e,t,i,n){for(var r=0,o=t.length;r!==o;++r){var a=t[r],s=i[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,n)}},fi.seqWithValue=function(e,t){for(var i=[],n=0,r=e.length;n!==r;++n){var o=e[n];o.id in t&&i.push(o)}return i};var mi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function gi(e,t,i){return void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)}Object.assign(gi.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,i){return this.r=e,this.g=t,this.b=i,this},setHSL:function(){function e(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+6*(t-e)*(2/3-i):e}return function(t,i,n){if(t=dt.euclideanModulo(t,1),i=dt.clamp(i,0,1),n=dt.clamp(n,0,1),0===i)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+i):n+i-n*i,o=2*n-r;this.r=e(o,r,t+1/3),this.g=e(o,r,t),this.b=e(o,r,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,r=i[1],o=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(a,s,l)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c,u=(c=i[1]).length;if(3===u)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}e&&e.length>0&&(void 0!==(c=mi[e])?this.setHex(c):console.warn("THREE.Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var i=t>0?1/t:1;return this.r=Math.pow(e.r,i),this.g=Math.pow(e.g,i),this.b=Math.pow(e.b,i),this},convertGammaToLinear:function(){var e=this.r,t=this.g,i=this.b;return this.r=e*e,this.g=t*t,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,i,n=e||{h:0,s:0,l:0},r=this.r,o=this.g,a=this.b,s=Math.max(r,o,a),l=Math.min(r,o,a),c=(l+s)/2;if(l===s)t=0,i=0;else{var u=s-l;switch(i=c<=.5?u/(s+l):u/(2-s-l),s){case r:t=(o-a)/u+(o<a?6:0);break;case o:t=(a-r)/u+2;break;case a:t=(r-o)/u+4}t/=6}return n.h=t,n.s=i,n.l=c,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,i){var n=this.getHSL();return n.h+=e,n.s+=t,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var vi={common:{diffuse:{value:new gi(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new wt(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new pt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new gi(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new gi(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new wt(0,0,1,1)}}},yi={merge:function(e){for(var t={},i=0;i<e.length;i++){var n=this.clone(e[i]);for(var r in n)t[r]=n[r]}return t},clone:function(e){var t={};for(var i in e)for(var n in t[i]={},e[i]){var r=e[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}return t}},bi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transpose( const in mat3 v ) {\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\treturn tmp;\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = asin( flipNormal * reflectVec.y ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_flip:"#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",distanceRGBA_vert:"varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0 - getShadowMask() ) );\n}\n",shadow_vert:"#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n"},xi={basic:{uniforms:yi.merge([vi.common,vi.aomap,vi.lightmap,vi.fog]),vertexShader:bi.meshbasic_vert,fragmentShader:bi.meshbasic_frag},lambert:{uniforms:yi.merge([vi.common,vi.aomap,vi.lightmap,vi.emissivemap,vi.fog,vi.lights,{emissive:{value:new gi(0)}}]),vertexShader:bi.meshlambert_vert,fragmentShader:bi.meshlambert_frag},phong:{uniforms:yi.merge([vi.common,vi.aomap,vi.lightmap,vi.emissivemap,vi.bumpmap,vi.normalmap,vi.displacementmap,vi.gradientmap,vi.fog,vi.lights,{emissive:{value:new gi(0)},specular:{value:new gi(1118481)},shininess:{value:30}}]),vertexShader:bi.meshphong_vert,fragmentShader:bi.meshphong_frag},standard:{uniforms:yi.merge([vi.common,vi.aomap,vi.lightmap,vi.emissivemap,vi.bumpmap,vi.normalmap,vi.displacementmap,vi.roughnessmap,vi.metalnessmap,vi.fog,vi.lights,{emissive:{value:new gi(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:bi.meshphysical_vert,fragmentShader:bi.meshphysical_frag},points:{uniforms:yi.merge([vi.points,vi.fog]),vertexShader:bi.points_vert,fragmentShader:bi.points_frag},dashed:{uniforms:yi.merge([vi.common,vi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:bi.linedashed_vert,fragmentShader:bi.linedashed_frag},depth:{uniforms:yi.merge([vi.common,vi.displacementmap]),vertexShader:bi.depth_vert,fragmentShader:bi.depth_frag},normal:{uniforms:yi.merge([vi.common,vi.bumpmap,vi.normalmap,vi.displacementmap,{opacity:{value:1}}]),vertexShader:bi.normal_vert,fragmentShader:bi.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:bi.cube_vert,fragmentShader:bi.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:bi.equirect_vert,fragmentShader:bi.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new St}},vertexShader:bi.distanceRGBA_vert,fragmentShader:bi.distanceRGBA_frag}};function _i(e,t){this.min=void 0!==e?e:new pt(1/0,1/0),this.max=void 0!==t?t:new pt(-1/0,-1/0)}function wi(e,t){var i,n,r,o,a,s,l,c,u=e.context,h=e.state;function d(){var t=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),d=new Uint16Array([0,1,2,0,2,3]);i=u.createBuffer(),n=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,i),u.bufferData(u.ARRAY_BUFFER,t,u.STATIC_DRAW),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),u.bufferData(u.ELEMENT_ARRAY_BUFFER,d,u.STATIC_DRAW),l=u.createTexture(),c=u.createTexture(),h.bindTexture(u.TEXTURE_2D,l),u.texImage2D(u.TEXTURE_2D,0,u.RGB,16,16,0,u.RGB,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),h.bindTexture(u.TEXTURE_2D,c),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,16,16,0,u.RGBA,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),r={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},o=function(t){var i=u.createProgram(),n=u.createShader(u.FRAGMENT_SHADER),r=u.createShader(u.VERTEX_SHADER),o="precision "+e.getPrecision()+" float;\n";return u.shaderSource(n,o+t.fragmentShader),u.shaderSource(r,o+t.vertexShader),u.compileShader(n),u.compileShader(r),u.attachShader(i,n),u.attachShader(i,r),u.linkProgram(i),i}(r),a={vertex:u.getAttribLocation(o,"position"),uv:u.getAttribLocation(o,"uv")},s={renderType:u.getUniformLocation(o,"renderType"),map:u.getUniformLocation(o,"map"),occlusionMap:u.getUniformLocation(o,"occlusionMap"),opacity:u.getUniformLocation(o,"opacity"),color:u.getUniformLocation(o,"color"),scale:u.getUniformLocation(o,"scale"),rotation:u.getUniformLocation(o,"rotation"),screenPosition:u.getUniformLocation(o,"screenPosition")}}this.render=function(r,p,f){if(0!==t.length){var m=new St,g=f.w/f.z,v=.5*f.z,y=.5*f.w,b=16/f.w,x=new pt(b*g,b),_=new St(1,1,0),w=new pt(1,1),E=new _i;E.min.set(f.x,f.y),E.max.set(f.x+(f.z-16),f.y+(f.w-16)),void 0===o&&d(),u.useProgram(o),h.initAttributes(),h.enableAttribute(a.vertex),h.enableAttribute(a.uv),h.disableUnusedAttributes(),u.uniform1i(s.occlusionMap,0),u.uniform1i(s.map,1),u.bindBuffer(u.ARRAY_BUFFER,i),u.vertexAttribPointer(a.vertex,2,u.FLOAT,!1,16,0),u.vertexAttribPointer(a.uv,2,u.FLOAT,!1,16,8),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),h.disable(u.CULL_FACE),h.buffers.depth.setMask(!1);for(var T=0,M=t.length;T<M;T++){b=16/f.w,x.set(b*g,b);var S=t[T];if(m.set(S.matrixWorld.elements[12],S.matrixWorld.elements[13],S.matrixWorld.elements[14]),m.applyMatrix4(p.matrixWorldInverse),m.applyMatrix4(p.projectionMatrix),_.copy(m),w.x=f.x+_.x*v+v-8,w.y=f.y+_.y*y+y-8,!0===E.containsPoint(w)){h.activeTexture(u.TEXTURE0),h.bindTexture(u.TEXTURE_2D,null),h.activeTexture(u.TEXTURE1),h.bindTexture(u.TEXTURE_2D,l),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGB,w.x,w.y,16,16,0),u.uniform1i(s.renderType,0),u.uniform2f(s.scale,x.x,x.y),u.uniform3f(s.screenPosition,_.x,_.y,_.z),h.disable(u.BLEND),h.enable(u.DEPTH_TEST),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),h.activeTexture(u.TEXTURE0),h.bindTexture(u.TEXTURE_2D,c),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,w.x,w.y,16,16,0),u.uniform1i(s.renderType,1),h.disable(u.DEPTH_TEST),h.activeTexture(u.TEXTURE1),h.bindTexture(u.TEXTURE_2D,l),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),S.positionScreen.copy(_),S.customUpdateCallback?S.customUpdateCallback(S):S.updateLensFlares(),u.uniform1i(s.renderType,2),h.enable(u.BLEND);for(var C=0,R=S.lensFlares.length;C<R;C++){var A=S.lensFlares[C];A.opacity>.001&&A.scale>.001&&(_.x=A.x,_.y=A.y,_.z=A.z,b=A.size*A.scale/f.w,x.x=b*g,x.y=b,u.uniform3f(s.screenPosition,_.x,_.y,_.z),u.uniform2f(s.scale,x.x,x.y),u.uniform1f(s.rotation,A.rotation),u.uniform1f(s.opacity,A.opacity),u.uniform3f(s.color,A.color.r,A.color.g,A.color.b),h.setBlending(A.blending,A.blendEquation,A.blendSrc,A.blendDst),e.setTexture2D(A.texture,1),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0))}}}h.enable(u.CULL_FACE),h.enable(u.DEPTH_TEST),h.buffers.depth.setMask(!0),e.resetGLState()}}}function Ei(e,t){var i,n,r,o,a,s,l=e.context,c=e.state,u=new St,h=new Mt,d=new St;function p(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),c=new Uint16Array([0,1,2,0,2,3]);i=l.createBuffer(),n=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,i),l.bufferData(l.ARRAY_BUFFER,t,l.STATIC_DRAW),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),l.bufferData(l.ELEMENT_ARRAY_BUFFER,c,l.STATIC_DRAW),r=function(){var t=l.createProgram(),i=l.createShader(l.VERTEX_SHADER),n=l.createShader(l.FRAGMENT_SHADER);return l.shaderSource(i,["precision "+e.getPrecision()+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),l.shaderSource(n,["precision "+e.getPrecision()+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),l.compileShader(i),l.compileShader(n),l.attachShader(t,i),l.attachShader(t,n),l.linkProgram(t),t}(),o={position:l.getAttribLocation(r,"position"),uv:l.getAttribLocation(r,"uv")},a={uvOffset:l.getUniformLocation(r,"uvOffset"),uvScale:l.getUniformLocation(r,"uvScale"),rotation:l.getUniformLocation(r,"rotation"),scale:l.getUniformLocation(r,"scale"),color:l.getUniformLocation(r,"color"),map:l.getUniformLocation(r,"map"),opacity:l.getUniformLocation(r,"opacity"),modelViewMatrix:l.getUniformLocation(r,"modelViewMatrix"),projectionMatrix:l.getUniformLocation(r,"projectionMatrix"),fogType:l.getUniformLocation(r,"fogType"),fogDensity:l.getUniformLocation(r,"fogDensity"),fogNear:l.getUniformLocation(r,"fogNear"),fogFar:l.getUniformLocation(r,"fogFar"),fogColor:l.getUniformLocation(r,"fogColor"),alphaTest:l.getUniformLocation(r,"alphaTest")};var u=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");u.width=8,u.height=8;var h=u.getContext("2d");h.fillStyle="white",h.fillRect(0,0,8,8),(s=new _t(u)).needsUpdate=!0}function f(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(m,g){if(0!==t.length){void 0===r&&p(),l.useProgram(r),c.initAttributes(),c.enableAttribute(o.position),c.enableAttribute(o.uv),c.disableUnusedAttributes(),c.disable(l.CULL_FACE),c.enable(l.BLEND),l.bindBuffer(l.ARRAY_BUFFER,i),l.vertexAttribPointer(o.position,2,l.FLOAT,!1,16,0),l.vertexAttribPointer(o.uv,2,l.FLOAT,!1,16,8),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),l.uniformMatrix4fv(a.projectionMatrix,!1,g.projectionMatrix.elements),c.activeTexture(l.TEXTURE0),l.uniform1i(a.map,0);var v=0,y=0,b=m.fog;b?(l.uniform3f(a.fogColor,b.color.r,b.color.g,b.color.b),b.isFog?(l.uniform1f(a.fogNear,b.near),l.uniform1f(a.fogFar,b.far),l.uniform1i(a.fogType,1),v=1,y=1):b.isFogExp2&&(l.uniform1f(a.fogDensity,b.density),l.uniform1i(a.fogType,2),v=2,y=2)):(l.uniform1i(a.fogType,0),v=0,y=0);for(var x=0,_=t.length;x<_;x++){(E=t[x]).modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,E.matrixWorld),E.z=-E.modelViewMatrix.elements[14]}t.sort(f);var w=[];for(x=0,_=t.length;x<_;x++){var E,T=(E=t[x]).material;if(!1!==T.visible){E.onBeforeRender(e,m,g,void 0,T,void 0),l.uniform1f(a.alphaTest,T.alphaTest),l.uniformMatrix4fv(a.modelViewMatrix,!1,E.modelViewMatrix.elements),E.matrixWorld.decompose(u,h,d),w[0]=d.x,w[1]=d.y;var M=0;m.fog&&T.fog&&(M=y),v!==M&&(l.uniform1i(a.fogType,M),v=M),null!==T.map?(l.uniform2f(a.uvOffset,T.map.offset.x,T.map.offset.y),l.uniform2f(a.uvScale,T.map.repeat.x,T.map.repeat.y)):(l.uniform2f(a.uvOffset,0,0),l.uniform2f(a.uvScale,1,1)),l.uniform1f(a.opacity,T.opacity),l.uniform3f(a.color,T.color.r,T.color.g,T.color.b),l.uniform1f(a.rotation,T.rotation),l.uniform2fv(a.scale,w),c.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst,T.blendEquationAlpha,T.blendSrcAlpha,T.blendDstAlpha,T.premultipliedAlpha),c.buffers.depth.setTest(T.depthTest),c.buffers.depth.setMask(T.depthWrite),T.map?e.setTexture2D(T.map,0):e.setTexture2D(s,0),l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0),E.onAfterRender(e,m,g,void 0,T,void 0)}}c.enable(l.CULL_FACE),e.resetGLState()}}}xi.physical={uniforms:yi.merge([xi.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:bi.meshphysical_vert,fragmentShader:bi.meshphysical_frag},Object.assign(_i.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new pt;return function(t,i){var n=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){var t=e||new pt;return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new pt;return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return(t||new pt).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return(t||new pt).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new pt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Ti,Mi,Si,Ci,Ri,Ai,Pi,Li=0;function Oi(){Object.defineProperty(this,"id",{value:Li++}),this.uuid=dt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=T,this.side=m,this.shading=b,this.vertexColors=x,this.opacity=1,this.transparent=!1,this.blendSrc=B,this.blendDst=F,this.blendEquation=A,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=X,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.needsUpdate=!0}function Ii(e){Oi.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function ki(e){Oi.call(this),this.type="MeshDepthMaterial",this.depthPacking=ut,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function Di(e,t){this.min=void 0!==e?e:new St(1/0,1/0,1/0),this.max=void 0!==t?t:new St(-1/0,-1/0,-1/0)}function Ni(e,t){this.center=void 0!==e?e:new St,this.radius=void 0!==t?t:0}function Hi(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function Bi(e,t){this.normal=void 0!==e?e:new St(1,0,0),this.constant=void 0!==t?t:0}function Fi(e,t,i,n,r,o){this.planes=[void 0!==e?e:new Bi,void 0!==t?t:new Bi,void 0!==i?i:new Bi,void 0!==n?n:new Bi,void 0!==r?r:new Bi,void 0!==o?o:new Bi]}function Ui(e,t,i,n){var r=e.context,o=e.state,a=new Fi,s=new Ct,l=t.shadows,c=new pt,u=new pt(n.maxTextureSize,n.maxTextureSize),h=new St,d=new St,f=1,y=2,b=1+(f|y),x=new Array(b),_=new Array(b),w={},E=[new St(1,0,0),new St(-1,0,0),new St(0,0,1),new St(0,0,-1),new St(0,1,0),new St(0,-1,0)],T=[new St(0,1,0),new St(0,1,0),new St(0,1,0),new St(0,1,0),new St(0,0,1),new St(0,0,-1)],M=[new wt,new wt,new wt,new wt,new wt,new wt],S=new ki;S.depthPacking=ht,S.clipping=!0;for(var C=xi.distanceRGBA,R=yi.clone(C.uniforms),A=0;A!==b;++A){var P=0!=(A&f),L=0!=(A&y),O=S.clone();O.morphTargets=P,O.skinning=L,x[A]=O;var I=new Ii({defines:{USE_SHADOWMAP:""},uniforms:R,vertexShader:C.vertexShader,fragmentShader:C.fragmentShader,morphTargets:P,skinning:L,clipping:!0});_[A]=I}var k=this;function D(t,i,n,r){var o=t.geometry,a=null,s=x,l=t.customDepthMaterial;if(n&&(s=_,l=t.customDistanceMaterial),l)a=l;else{var c=!1;i.morphTargets&&(o&&o.isBufferGeometry?c=o.morphAttributes&&o.morphAttributes.position&&o.morphAttributes.position.length>0:o&&o.isGeometry&&(c=o.morphTargets&&o.morphTargets.length>0)),t.isSkinnedMesh&&!1===i.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var u=t.isSkinnedMesh&&i.skinning,h=0;c&&(h|=f),u&&(h|=y),a=s[h]}if(e.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){var d=a.uuid,p=i.uuid,b=w[d];void 0===b&&(b={},w[d]=b);var E=b[p];void 0===E&&(E=a.clone(),b[p]=E),a=E}a.visible=i.visible,a.wireframe=i.wireframe;var T=i.side;return k.renderSingleSided&&T==v&&(T=m),k.renderReverseSided&&(T===m?T=g:T===g&&(T=m)),a.side=T,a.clipShadows=i.clipShadows,a.clippingPlanes=i.clippingPlanes,a.wireframeLinewidth=i.wireframeLinewidth,a.linewidth=i.linewidth,n&&void 0!==a.uniforms.lightPos&&a.uniforms.lightPos.value.copy(r),a}function N(t,n,r,o){if(!1!==t.visible){if(t.layers.test(n.layers)&&(t.isMesh||t.isLine||t.isPoints)&&t.castShadow&&(!t.frustumCulled||a.intersectsObject(t))){t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld);var s=i.update(t),l=t.material;if(Array.isArray(l))for(var c=s.groups,u=0,h=c.length;u<h;u++){var p=c[u],f=l[p.materialIndex];if(f&&f.visible){var m=D(t,f,o,d);e.renderBufferDirect(r,null,s,m,t,p)}}else if(l.visible){m=D(t,l,o,d);e.renderBufferDirect(r,null,s,m,t,null)}}for(var g=t.children,v=0,y=g.length;v<y;v++)N(g[v],n,r,o)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=p,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(t,i){if(!1!==k.enabled&&(!1!==k.autoUpdate||!1!==k.needsUpdate)&&0!==l.length){var n;o.disable(r.BLEND),o.buffers.color.setClear(1,1,1,1),o.buffers.depth.setTest(!0),o.setScissorTest(!1);for(var p=0,f=l.length;p<f;p++){var m=l[p],g=m.shadow,v=m&&m.isPointLight;if(void 0!==g){var y=g.camera;if(c.copy(g.mapSize),c.min(u),v){var b=c.x,x=c.y;M[0].set(2*b,x,b,x),M[1].set(0,x,b,x),M[2].set(3*b,x,b,x),M[3].set(b,x,b,x),M[4].set(3*b,0,b,x),M[5].set(b,0,b,x),c.x*=4,c.y*=2}if(null===g.map){var _={minFilter:ve,magFilter:ve,format:He};g.map=new Et(c.x,c.y,_),g.map.texture.name=m.name+".shadowMap",y.updateProjectionMatrix()}g.isSpotLightShadow&&g.update(m);var w=g.map,S=g.matrix;d.setFromMatrixPosition(m.matrixWorld),y.position.copy(d),v?(n=6,S.makeTranslation(-d.x,-d.y,-d.z)):(n=1,h.setFromMatrixPosition(m.target.matrixWorld),y.lookAt(h),y.updateMatrixWorld(),S.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),S.multiply(y.projectionMatrix),S.multiply(y.matrixWorldInverse)),e.setRenderTarget(w),e.clear();for(var C=0;C<n;C++){if(v){h.copy(y.position),h.add(E[C]),y.up.copy(T[C]),y.lookAt(h),y.updateMatrixWorld();var R=M[C];o.viewport(R)}s.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),a.setFromMatrix(s),N(t,i,y,v)}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}var A=e.getClearColor(),P=e.getClearAlpha();e.setClearColor(A,P),k.needsUpdate=!1}}}function $i(e){var t={};return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t[e.uuid]},remove:function(i){i.isInterleavedBufferAttribute&&(i=i.data);var n=t[i.uuid];n&&(e.deleteBuffer(n.buffer),delete t[i.uuid])},update:function(i,n){i.isInterleavedBufferAttribute&&(i=i.data);var r=t[i.uuid];void 0===r?t[i.uuid]=function(t,i){var n=t.array,r=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,o=e.createBuffer();e.bindBuffer(i,o),e.bufferData(i,n,r),t.onUploadCallback();var a=e.FLOAT;return n instanceof Float32Array?a=e.FLOAT:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?a=e.UNSIGNED_SHORT:n instanceof Int16Array?a=e.SHORT:n instanceof Uint32Array?a=e.UNSIGNED_INT:n instanceof Int32Array?a=e.INT:n instanceof Int8Array?a=e.BYTE:n instanceof Uint8Array&&(a=e.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}(i,n):r.version<i.version&&(function(t,i,n){var r=i.array,o=i.updateRange;e.bindBuffer(n,t),!1===i.dynamic?e.bufferData(n,r,e.STATIC_DRAW):-1===o.count?e.bufferSubData(n,0,r):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(n,o.offset*r.BYTES_PER_ELEMENT,r.subarray(o.offset,o.offset+o.count)),o.count=-1)}(r.buffer,i,n),r.version=i.version)}}}function ji(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._order=n||ji.DefaultOrder}function zi(){this.mask=1}Object.assign(Oi.prototype,t.prototype,{isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var i=e[t];if(void 0!==i){var n=this[t];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]="overdraw"===t?Number(i):i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e;t&&(e={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearCoat&&(i.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(i.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,i.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==T&&(i.blending=this.blending),this.shading!==b&&(i.shading=this.shading),this.side!==m&&(i.side=this.side),this.vertexColors!==x&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),i.skinning=this.skinning,i.morphTargets=this.morphTargets,i.dithering=this.dithering,t){var r=n(e.textures),o=n(e.images);r.length>0&&(i.textures=r),o.length>0&&(i.images=o)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.shading=e.shading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,i=null;if(null!==t){var n=t.length;i=new Array(n);for(var r=0;r!==n;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ii.prototype=Object.create(Oi.prototype),Ii.prototype.constructor=Ii,Ii.prototype.isShaderMaterial=!0,Ii.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=yi.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Ii.prototype.toJSON=function(e){var t=Oi.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},ki.prototype=Object.create(Oi.prototype),ki.prototype.constructor=ki,ki.prototype.isMeshDepthMaterial=!0,ki.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Object.assign(Di.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=e.length;s<l;s+=3){var c=e[s],u=e[s+1],h=e[s+2];c<t&&(t=c),u<i&&(i=u),h<n&&(n=h),c>r&&(r=c),u>o&&(o=u),h>a&&(a=h)}return this.min.set(t,i,n),this.max.set(r,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,l=e.count;s<l;s++){var c=e.getX(s),u=e.getY(s),h=e.getZ(s);c<t&&(t=c),u<i&&(i=u),h<n&&(n=h),c>r&&(r=c),u>o&&(o=u),h>a&&(a=h)}return this.min.set(t,i,n),this.max.set(r,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new St;return function(t,i){var n=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){var t=e||new St;return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new St;return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e=new St;return function(t){var i=this;return t.updateMatrixWorld(!0),t.traverse(function(t){var n,r,o=t.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(n=0,r=a.length;n<r;n++)e.copy(a[n]),e.applyMatrix4(t.matrixWorld),i.expandByPoint(e)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(n=0,r=s.count;n<r;n++)e.fromBufferAttribute(s,n).applyMatrix4(t.matrixWorld),i.expandByPoint(e)}}),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new St).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:(Mi=new St,function(e){return this.clampPoint(e.center,Mi),Mi.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=e.constant&&i>=e.constant},clampPoint:function(e,t){return(t||new St).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new St;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new St;return function(t){var i=t||new Ni;return this.getCenter(i.center),i.radius=.5*this.getSize(e).length(),i}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(Ti=[new St,new St,new St,new St,new St,new St,new St,new St],function(e){return this.isEmpty()?this:(Ti[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ti[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ti[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ti[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ti[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ti[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ti[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ti[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ti),this)}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Ni.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(Si=new Di,function(e,t){var i=this.center;void 0!==t?i.copy(t):Si.setFromPoints(e).getCenter(i);for(var n=0,r=0,o=e.length;r<o;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(this.center.dot(e.normal)-e.constant)<=this.radius},clampPoint:function(e,t){var i=this.center.distanceToSquared(e),n=t||new St;return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){var t=e||new Di;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(Hi.prototype,{isMatrix3:!0,set:function(e,t,i,n,r,o,a,s,l){var c=this.elements;return c[0]=e,c[1]=n,c[2]=a,c[3]=t,c[4]=r,c[5]=s,c[6]=i,c[7]=o,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new St;return function(t){for(var i=0,n=t.count;i<n;i++)e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.applyMatrix3(this),t.setXYZ(i,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,o=i[0],a=i[3],s=i[6],l=i[1],c=i[4],u=i[7],h=i[2],d=i[5],p=i[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],b=n[7],x=n[2],_=n[5],w=n[8];return r[0]=o*f+a*v+s*x,r[3]=o*m+a*y+s*_,r[6]=o*g+a*b+s*w,r[1]=l*f+c*v+u*x,r[4]=l*m+c*y+u*_,r[7]=l*g+c*b+u*w,r[2]=h*f+d*v+p*x,r[5]=h*m+d*y+p*_,r[8]=h*g+d*b+p*w,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8];return t*o*c-t*a*l-i*r*c+i*a*s+n*r*l-n*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var i=e.elements,n=this.elements,r=i[0],o=i[1],a=i[2],s=i[3],l=i[4],c=i[5],u=i[6],h=i[7],d=i[8],p=d*l-c*h,f=c*u-d*s,m=h*s-l*u,g=r*p+o*f+a*m;if(0===g){var v="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=p*y,n[1]=(a*h-d*o)*y,n[2]=(c*o-a*l)*y,n[3]=f*y,n[4]=(d*r-a*u)*y,n[5]=(a*s-c*r)*y,n[6]=m*y,n[7]=(o*u-h*r)*y,n[8]=(l*r-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;i<9;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}}),Object.assign(Bi.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new St,t=new St;return function(i,n,r){var o=e.subVectors(r,n).cross(t.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var i=this.distanceToPoint(e);return(t||new St).copy(this.normal).multiplyScalar(i)},intersectLine:function(){var e=new St;return function(t,i){var n=i||new St,r=t.delta(e),o=this.normal.dot(r);if(0===o)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/o;return a<0||a>1?void 0:n.copy(r).multiplyScalar(a).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return(e||new St).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new St,t=new Hi;return function(i,n){var r=this.coplanarPoint(e).applyMatrix4(i),o=n||t.getNormalMatrix(i),a=this.normal.applyMatrix3(o).normalize();return this.constant=-r.dot(a),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Fi.prototype,{set:function(e,t,i,n,r,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,i=0;i<6;i++)t[i].copy(e.planes[i]);return this},setFromMatrix:function(e){var t=this.planes,i=e.elements,n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],l=i[5],c=i[6],u=i[7],h=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return t[0].setComponents(a-n,u-s,f-h,y-m).normalize(),t[1].setComponents(a+n,u+s,f+h,y+m).normalize(),t[2].setComponents(a+r,u+l,f+d,y+g).normalize(),t[3].setComponents(a-r,u-l,f-d,y-g).normalize(),t[4].setComponents(a-o,u-c,f-p,y-v).normalize(),t[5].setComponents(a+o,u+c,f+p,y+v).normalize(),this},intersectsObject:(Ai=new Ni,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Ai.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ai)}),intersectsSprite:function(){var e=new Ni;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,i=e.center,n=-e.radius,r=0;r<6;r++){if(t[r].distanceToPoint(i)<n)return!1}return!0},intersectsBox:(Ci=new St,Ri=new St,function(e){for(var t=this.planes,i=0;i<6;i++){var n=t[i];Ci.x=n.normal.x>0?e.min.x:e.max.x,Ri.x=n.normal.x>0?e.max.x:e.min.x,Ci.y=n.normal.y>0?e.min.y:e.max.y,Ri.y=n.normal.y>0?e.max.y:e.min.y,Ci.z=n.normal.z>0?e.min.z:e.max.z,Ri.z=n.normal.z>0?e.max.z:e.min.z;var r=n.distanceToPoint(Ci),o=n.distanceToPoint(Ri);if(r<0&&o<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}}),ji.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ji.DefaultOrder="XYZ",Object.defineProperties(ji.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(ji.prototype,{isEuler:!0,set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,i){var n=dt.clamp,r=e.elements,o=r[0],a=r[4],s=r[8],l=r[1],c=r[5],u=r[9],h=r[2],d=r[6],p=r[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===t?(this._y=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===t?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===t?(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-u,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new Ct;return function(t,i,n){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,i,n)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(Pi=new Mt,function(e){return Pi.setFromEuler(this),this.setFromQuaternion(Pi,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new St(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(zi.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Vi,Gi,Wi,qi,Xi=0;function Zi(){Object.defineProperty(this,"id",{value:Xi++}),this.uuid=dt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zi.DefaultUp.clone();var e=new St,t=new ji,i=new Mt,n=new St(1,1,1);t.onChange(function(){i.setFromEuler(t,!1)}),i.onChange(function(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new Ct},normalMatrix:{value:new Hi}}),this.matrix=new Ct,this.matrixWorld=new Ct,this.matrixAutoUpdate=Zi.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new zi,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Yi(){Zi.call(this),this.type="Camera",this.matrixWorldInverse=new Ct,this.projectionMatrix=new Ct}function Ji(e,t,i,n,r,o){Yi.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Ki(e,t,i,n){Yi.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Qi(e,t,i,n,r,o){this.a=e,this.b=t,this.c=i,this.normal=n&&n.isVector3?n:new St,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new gi,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}Zi.DefaultUp=new St(0,1,0),Zi.DefaultMatrixAutoUpdate=!0,Object.assign(Zi.prototype,t.prototype,{isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(qi=new Mt,function(e,t){return qi.setFromAxisAngle(e,t),this.quaternion.multiply(qi),this}),rotateX:function(){var e=new St(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new St(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new St(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new St;return function(t,i){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(i)),this}}(),translateX:function(){var e=new St(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new St(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new St(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(Wi=new Ct,function(e){return e.applyMatrix4(Wi.getInverse(this.matrixWorld))}),lookAt:function(){var e=new Ct;return function(t){this.isCamera?e.lookAt(this.position,t,this.up):e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var i=this.children.indexOf(e);return-1!==i&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(i,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i].getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){var t=e||new St;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Vi=new St,Gi=new St,function(e){var t=e||new Mt;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Vi,t,Gi),t}),getWorldRotation:function(){var e=new Mt;return function(t){var i=t||new ji;return this.getWorldQuaternion(e),i.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new St,t=new Mt;return function(i){var n=i||new St;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(){var e=new Mt;return function(t){var i=t||new St;return this.getWorldQuaternion(e),i.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].updateMatrixWorld(e)},toJSON:function(e){var t=void 0===e||""===e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function r(t,i){return void 0===t[i.uuid]&&(t[i.uuid]=i.toJSON(e)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),n.matrix=this.matrix.toArray(),void 0!==this.geometry&&(n.geometry=r(e.geometries,this.geometry)),void 0!==this.material)if(Array.isArray(this.material)){for(var o=[],a=0,s=this.material.length;a<s;a++)o.push(r(e.materials,this.material[a]));n.material=o}else n.material=r(e.materials,this.material);if(this.children.length>0){n.children=[];for(a=0;a<this.children.length;a++)n.children.push(this.children[a].toJSON(e).object)}if(t){var l=d(e.geometries),c=d(e.materials),u=d(e.textures),h=d(e.images);l.length>0&&(i.geometries=l),c.length>0&&(i.materials=c),u.length>0&&(i.textures=u),h.length>0&&(i.images=h)}return i.object=n,i;function d(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var i=0;i<e.children.length;i++){var n=e.children[i];this.add(n.clone())}return this}}),Yi.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Yi,isCamera:!0,copy:function(e,t){return Zi.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:function(){var e=new Mt;return function(t){var i=t||new St;return this.getWorldQuaternion(e),i.set(0,0,-1).applyQuaternion(e)}}(),updateMatrixWorld:function(e){Zi.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Ji.prototype=Object.assign(Object.create(Yi.prototype),{constructor:Ji,isOrthographicCamera:!0,copy:function(e,t){return Yi.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,i,n,r,o){this.view={fullWidth:e,fullHeight:t,offsetX:i,offsetY:n,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-e,o=i+e,a=n+t,s=n-t;if(null!==this.view){var l=this.zoom/(this.view.width/this.view.fullWidth),c=this.zoom/(this.view.height/this.view.fullHeight),u=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(r+=u*(this.view.offsetX/l))+u*(this.view.width/l),s=(a-=h*(this.view.offsetY/c))-h*(this.view.height/c)}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far)},toJSON:function(e){var t=Zi.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Ki.prototype=Object.assign(Object.create(Yi.prototype),{constructor:Ki,isPerspectiveCamera:!0,copy:function(e,t){return Yi.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*dt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*dt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*dt.RAD2DEG*Math.atan(Math.tan(.5*dt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,i,n,r,o){this.aspect=e/t,this.view={fullWidth:e,fullHeight:t,offsetX:i,offsetY:n,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*dt.DEG2RAD*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n,o=this.view;if(null!==o){var a=o.fullWidth,s=o.fullHeight;r+=o.offsetX*n/a,t-=o.offsetY*i/s,n*=o.width/a,i*=o.height/s}var l=this.filmOffset;0!==l&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-i,e,this.far)},toJSON:function(e){var t=Zi.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Object.assign(Qi.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var en,tn,nn,rn,on,an,sn,ln,cn=0;function un(){return cn++}function hn(){Object.defineProperty(this,"id",{value:un()}),this.uuid=dt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function dn(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=dt.generateUUID(),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function pn(e,t){dn.call(this,new Int8Array(e),t)}function fn(e,t){dn.call(this,new Uint8Array(e),t)}function mn(e,t){dn.call(this,new Uint8ClampedArray(e),t)}function gn(e,t){dn.call(this,new Int16Array(e),t)}function vn(e,t){dn.call(this,new Uint16Array(e),t)}function yn(e,t){dn.call(this,new Int32Array(e),t)}function bn(e,t){dn.call(this,new Uint32Array(e),t)}function xn(e,t){dn.call(this,new Float32Array(e),t)}function _n(e,t){dn.call(this,new Float64Array(e),t)}function wn(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function En(e){if(0===e.length)return-1/0;for(var t=e[0],i=1,n=e.length;i<n;++i)e[i]>t&&(t=e[i]);return t}function Tn(){Object.defineProperty(this,"id",{value:un()}),this.uuid=dt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function Mn(e,t,i,n,r,o){hn.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new Sn(e,t,i,n,r,o)),this.mergeVertices()}function Sn(e,t,i,n,r,o){Tn.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:o};var a=this;n=Math.floor(n)||1,r=Math.floor(r)||1;var s=[],l=[],c=[],u=[],h=0,d=0;function p(e,t,i,n,r,o,p,f,m,g,v){var y,b,x=o/m,_=p/g,w=o/2,E=p/2,T=f/2,M=m+1,S=g+1,C=0,R=0,A=new St;for(b=0;b<S;b++){var P=b*_-E;for(y=0;y<M;y++){var L=y*x-w;A[e]=L*n,A[t]=P*r,A[i]=T,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[i]=f>0?1:-1,c.push(A.x,A.y,A.z),u.push(y/m),u.push(1-b/g),C+=1}}for(b=0;b<g;b++)for(y=0;y<m;y++){var O=h+y+M*b,I=h+y+M*(b+1),k=h+(y+1)+M*(b+1),D=h+(y+1)+M*b;s.push(O,I,D),s.push(I,k,D),R+=6}a.addGroup(d,R,v),d+=R,h+=C}p("z","y","x",-1,-1,i,t,e,o=Math.floor(o)||1,r,0),p("z","y","x",1,-1,i,t,-e,o,r,1),p("x","z","y",1,1,e,i,t,n,o,2),p("x","z","y",1,-1,e,i,-t,n,o,3),p("x","y","z",1,-1,e,t,i,n,r,4),p("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(s),this.addAttribute("position",new xn(l,3)),this.addAttribute("normal",new xn(c,3)),this.addAttribute("uv",new xn(u,2))}function Cn(e,t,i,n){hn.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new Rn(e,t,i,n)),this.mergeVertices()}function Rn(e,t,i,n){Tn.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};var r,o,a=e/2,s=t/2,l=Math.floor(i)||1,c=Math.floor(n)||1,u=l+1,h=c+1,d=e/l,p=t/c,f=[],m=[],g=[],v=[];for(o=0;o<h;o++){var y=o*p-s;for(r=0;r<u;r++){var b=r*d-a;m.push(b,-y,0),g.push(0,0,1),v.push(r/l),v.push(1-o/c)}}for(o=0;o<c;o++)for(r=0;r<l;r++){var x=r+u*o,_=r+u*(o+1),w=r+1+u*(o+1),E=r+1+u*o;f.push(x,_,E),f.push(_,w,E)}this.setIndex(f),this.addAttribute("position",new xn(m,3)),this.addAttribute("normal",new xn(g,3)),this.addAttribute("uv",new xn(v,2))}function An(e){Oi.call(this),this.type="MeshBasicMaterial",this.color=new gi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Pn(e,t){this.origin=void 0!==e?e:new St,this.direction=void 0!==t?t:new St}function Ln(e,t){this.start=void 0!==e?e:new St,this.end=void 0!==t?t:new St}function On(e,t,i){this.a=void 0!==e?e:new St,this.b=void 0!==t?t:new St,this.c=void 0!==i?i:new St}function In(e,t){Zi.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Tn,this.material=void 0!==t?t:new An({color:16777215*Math.random()}),this.drawMode=et,this.updateMorphTargets()}function kn(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Dn(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Nn(){var e={};return{get:function(t,i){var n=t.id+","+i.id,r=e[n];return void 0===r&&(r=new function(){var e=[],t=-1,i=[],n=-1;return{opaque:e,transparent:i,init:function(){t=-1,n=-1},push:function(r,o,a,s,l){var c,u;a.transparent?(c=i,u=++n):(c=e,u=++t);var h=c[u];h?(h.id=r.id,h.object=r,h.geometry=o,h.material=a,h.program=a.program,h.renderOrder=r.renderOrder,h.z=s,h.group=l):(h={id:r.id,object:r,geometry:o,material:a,program:a.program,renderOrder:r.renderOrder,z:s,group:l},c.push(h))},finish:function(){e.length=t+1,i.length=n+1},sort:function(){e.sort(kn),i.sort(Dn)}}},e[n]=r),r},dispose:function(){e={}}}}function Hn(e,t,i){var n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),!1===e.getShaderParameter(n,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(n),function(e){for(var t=e.split("\n"),i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join("\n")}(i)),n}Object.assign(hn.prototype,t.prototype,{isGeometry:!0,applyMatrix:function(e){for(var t=(new Hi).getNormalMatrix(e),i=0,n=this.vertices.length;i<n;i++){this.vertices[i].applyMatrix4(e)}for(i=0,n=this.faces.length;i<n;i++){var r=this.faces[i];r.normal.applyMatrix3(t).normalize();for(var o=0,a=r.vertexNormals.length;o<a;o++)r.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new Ct;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Ct;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Ct;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Ct;return function(t,i,n){return e.makeTranslation(t,i,n),this.applyMatrix(e),this}}(),scale:function(){var e=new Ct;return function(t,i,n){return e.makeScale(t,i,n),this.applyMatrix(e),this}}(),lookAt:(en=new Zi,function(e){en.lookAt(e),en.updateMatrix(),this.applyMatrix(en.matrix)}),fromBufferGeometry:function(e){var t=this,i=null!==e.index?e.index.array:void 0,n=e.attributes,r=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,l=void 0!==n.uv2?n.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var c=[],u=[],h=[],d=0,p=0;d<r.length;d+=3,p+=2)t.vertices.push(new St(r[d],r[d+1],r[d+2])),void 0!==o&&c.push(new St(o[d],o[d+1],o[d+2])),void 0!==a&&t.colors.push(new gi(a[d],a[d+1],a[d+2])),void 0!==s&&u.push(new pt(s[p],s[p+1])),void 0!==l&&h.push(new pt(l[p],l[p+1]));function f(e,i,n,r){var d=new Qi(e,i,n,void 0!==o?[c[e].clone(),c[i].clone(),c[n].clone()]:[],void 0!==a?[t.colors[e].clone(),t.colors[i].clone(),t.colors[n].clone()]:[],r);t.faces.push(d),void 0!==s&&t.faceVertexUvs[0].push([u[e].clone(),u[i].clone(),u[n].clone()]),void 0!==l&&t.faceVertexUvs[1].push([h[e].clone(),h[i].clone(),h[n].clone()])}var m=e.groups;if(m.length>0)for(d=0;d<m.length;d++)for(var g=m[d],v=g.start,y=(p=v,v+g.count);p<y;p+=3)void 0!==i?f(i[p],i[p+1],i[p+2],g.materialIndex):f(p,p+1,p+2,g.materialIndex);else if(void 0!==i)for(d=0;d<i.length;d+=3)f(i[d],i[d+1],i[d+2]);else for(d=0;d<r.length/3;d+=3)f(d,d+1,d+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,i=0===t?1:1/t,n=new Ct;return n.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new St,t=new St,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,i,n,r,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,i=this.vertices.length;t<i;t++)a[t]=new St;if(e){var s,l,c,u=new St,h=new St;for(n=0,r=this.faces.length;n<r;n++)o=this.faces[n],s=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c],u.subVectors(c,l),h.subVectors(s,l),u.cross(h),a[o.a].add(u),a[o.b].add(u),a[o.c].add(u)}else for(this.computeFaceNormals(),n=0,r=this.faces.length;n<r;n++)a[(o=this.faces[n]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,i=this.vertices.length;t<i;t++)a[t].normalize();for(n=0,r=this.faces.length;n<r;n++){var d=(o=this.faces[n]).vertexNormals;3===d.length?(d[0].copy(a[o.a]),d[1].copy(a[o.b]),d[2].copy(a[o.c])):(d[0]=a[o.a].clone(),d[1]=a[o.b].clone(),d[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,i;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n=(i=this.faces[e]).vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,i,n,r;for(i=0,n=this.faces.length;i<n;i++)for((r=this.faces[i]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var o=new hn;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)l=new St,c={a:new St,b:new St,c:new St},a.push(l),s.push(c)}var l,c,u=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),i=0,n=this.faces.length;i<n;i++)r=this.faces[i],l=u.faceNormals[i],c=u.vertexNormals[i],l.copy(r.normal),c.a.copy(r.vertexNormals[0]),c.b.copy(r.vertexNormals[1]),c.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)(r=this.faces[i]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeLineDistances:function(){for(var e=0,t=this.vertices,i=0,n=t.length;i<n;i++)i>0&&(e+=t[i].distanceTo(t[i-1])),this.lineDistances[i]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Di),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ni),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,i){if(e&&e.isGeometry){var n,r=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,l=e.faces,c=this.faceVertexUvs[0],u=e.faceVertexUvs[0],h=this.colors,d=e.colors;void 0===i&&(i=0),void 0!==t&&(n=(new Hi).getNormalMatrix(t));for(var p=0,f=a.length;p<f;p++){var m=a[p].clone();void 0!==t&&m.applyMatrix4(t),o.push(m)}for(p=0,f=d.length;p<f;p++)h.push(d[p].clone());for(p=0,f=l.length;p<f;p++){var g,v,y,b=l[p],x=b.vertexNormals,_=b.vertexColors;(g=new Qi(b.a+r,b.b+r,b.c+r)).normal.copy(b.normal),void 0!==n&&g.normal.applyMatrix3(n).normalize();for(var w=0,E=x.length;w<E;w++)v=x[w].clone(),void 0!==n&&v.applyMatrix3(n).normalize(),g.vertexNormals.push(v);g.color.copy(b.color);for(w=0,E=_.length;w<E;w++)y=_[w],g.vertexColors.push(y.clone());g.materialIndex=b.materialIndex+i,s.push(g)}for(p=0,f=u.length;p<f;p++){var T=u[p],M=[];if(void 0!==T){for(w=0,E=T.length;w<E;w++)M.push(T[w].clone());c.push(M)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,i,n,r,o,a,s,l={},c=[],u=[],h=Math.pow(10,4);for(i=0,n=this.vertices.length;i<n;i++)e=this.vertices[i],void 0===l[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(l[t]=i,c.push(this.vertices[i]),u[i]=c.length-1):u[i]=u[l[t]];var d=[];for(i=0,n=this.faces.length;i<n;i++){(r=this.faces[i]).a=u[r.a],r.b=u[r.b],r.c=u[r.c],o=[r.a,r.b,r.c];for(var p=0;p<3;p++)if(o[p]===o[(p+1)%3]){d.push(i);break}}for(i=d.length-1;i>=0;i--){var f=d[i];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,i=0;i<t;i++)e[i]._id=i;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var n,r,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(n=[]),a&&a.length===t&&(r=[]);for(i=0;i<t;i++){var s=e[i]._id;n&&n.push(o[s]),r&&r.push(a[s])}n&&(this.faceVertexUvs[0]=n),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}for(var n=[],r=0;r<this.vertices.length;r++){var o=this.vertices[r];n.push(o.x,o.y,o.z)}var a=[],s=[],l={},c=[],u={},h=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=void 0!==this.faceVertexUvs[0][r],m=p.normal.length()>0,g=p.vertexNormals.length>0,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=p.vertexColors.length>0,b=0;if(b=E(b=E(b=E(b=E(b=E(b=E(b=E(b=E(b,0,0),1,!0),2,!1),3,f),4,m),5,g),6,v),7,y),a.push(b),a.push(p.a,p.b,p.c),a.push(p.materialIndex),f){var x=this.faceVertexUvs[0][r];a.push(S(x[0]),S(x[1]),S(x[2]))}if(m&&a.push(T(p.normal)),g){var _=p.vertexNormals;a.push(T(_[0]),T(_[1]),T(_[2]))}if(v&&a.push(M(p.color)),y){var w=p.vertexColors;a.push(M(w[0]),M(w[1]),M(w[2]))}}function E(e,t,i){return i?e|1<<t:e&~(1<<t)}function T(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]?l[t]:(l[t]=s.length/3,s.push(e.x,e.y,e.z),l[t])}function M(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==u[t]?u[t]:(u[t]=c.length,c.push(e.getHex()),u[t])}function S(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]?d[t]:(d[t]=h.length/2,h.push(e.x,e.y),d[t])}return e.data={},e.data.vertices=n,e.data.normals=s,c.length>0&&(e.data.colors=c),h.length>0&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){return(new hn).copy(this)},copy:function(e){var t,i,n,r,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,i=s.length;t<i;t++)this.vertices.push(s[t].clone());var l=e.colors;for(t=0,i=l.length;t<i;t++)this.colors.push(l[t].clone());var c=e.faces;for(t=0,i=c.length;t<i;t++)this.faces.push(c[t].clone());for(t=0,i=e.faceVertexUvs.length;t<i;t++){var u=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,r=u.length;n<r;n++){var h=u[n],d=[];for(o=0,a=h.length;o<a;o++){var p=h[o];d.push(p.clone())}this.faceVertexUvs[t].push(d)}}var f=e.morphTargets;for(t=0,i=f.length;t<i;t++){var m={};if(m.name=f[t].name,void 0!==f[t].vertices)for(m.vertices=[],n=0,r=f[t].vertices.length;n<r;n++)m.vertices.push(f[t].vertices[n].clone());if(void 0!==f[t].normals)for(m.normals=[],n=0,r=f[t].normals.length;n<r;n++)m.normals.push(f[t].normals[n].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,i=g.length;t<i;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],n=0,r=g[t].vertexNormals.length;n<r;n++){var y=g[t].vertexNormals[n],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],n=0,r=g[t].faceNormals.length;n<r;n++)v.faceNormals.push(g[t].faceNormals[n].clone());this.morphNormals.push(v)}var x=e.skinWeights;for(t=0,i=x.length;t<i;t++)this.skinWeights.push(x[t].clone());var _=e.skinIndices;for(t=0,i=_.length;t<i;t++)this.skinIndices.push(_[t].clone());var w=e.lineDistances;for(t=0,i=w.length;t<i;t++)this.lineDistances.push(w[t]);var E=e.boundingBox;null!==E&&(this.boundingBox=E.clone());var T=e.boundingSphere;return null!==T&&(this.boundingSphere=T.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(dn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(dn.prototype,{isBufferAttribute:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.itemSize:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,i){e*=this.itemSize,i*=t.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new gi),t[i++]=o.r,t[i++]=o.g,t[i++]=o.b}return this},copyIndicesArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];t[i++]=o.a,t[i++]=o.b,t[i++]=o.c}return this},copyVector2sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new pt),t[i++]=o.x,t[i++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new St),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new wt),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z,t[i++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),pn.prototype=Object.create(dn.prototype),pn.prototype.constructor=pn,fn.prototype=Object.create(dn.prototype),fn.prototype.constructor=fn,mn.prototype=Object.create(dn.prototype),mn.prototype.constructor=mn,gn.prototype=Object.create(dn.prototype),gn.prototype.constructor=gn,vn.prototype=Object.create(dn.prototype),vn.prototype.constructor=vn,yn.prototype=Object.create(dn.prototype),yn.prototype.constructor=yn,bn.prototype=Object.create(dn.prototype),bn.prototype.constructor=bn,xn.prototype=Object.create(dn.prototype),xn.prototype.constructor=xn,_n.prototype=Object.create(dn.prototype),_n.prototype.constructor=_n,Object.assign(wn.prototype,{computeGroups:function(e){for(var t,i=[],n=void 0,r=e.faces,o=0;o<r.length;o++){var a=r[o];a.materialIndex!==n&&(n=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,i.push(t)),t={start:3*o,materialIndex:n})}void 0!==t&&(t.count=3*o-t.start,i.push(t)),this.groups=i},fromGeometry:function(e){var t,i=e.faces,n=e.vertices,r=e.faceVertexUvs,o=r[0]&&r[0].length>0,a=r[1]&&r[1].length>0,s=e.morphTargets,l=s.length;if(l>0){t=[];for(var c=0;c<l;c++)t[c]=[];this.morphTargets.position=t}var u,h=e.morphNormals,d=h.length;if(d>0){u=[];for(c=0;c<d;c++)u[c]=[];this.morphTargets.normal=u}var p=e.skinIndices,f=e.skinWeights,m=p.length===n.length,g=f.length===n.length;for(c=0;c<i.length;c++){var v=i[c];this.vertices.push(n[v.a],n[v.b],n[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var x,_=v.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===o)void 0!==(x=r[0][c])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new pt,new pt,new pt));if(!0===a)void 0!==(x=r[1][c])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new pt,new pt,new pt));for(var E=0;E<l;E++){var T=s[E].vertices;t[E].push(T[v.a],T[v.b],T[v.c])}for(E=0;E<d;E++){var M=h[E].vertexNormals[c];u[E].push(M.a,M.b,M.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}}),Tn.MaxIndex=65535,Object.assign(Tn.prototype,t.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(En(e)>65535?bn:vn)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(t)):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(e,new dn(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,i){this.groups.push({start:e,count:t,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var i=this.attributes.normal;void 0!==i&&((new Hi).getNormalMatrix(e).applyToBufferAttribute(i),i.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new Ct;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Ct;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Ct;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Ct;return function(t,i,n){return e.makeTranslation(t,i,n),this.applyMatrix(e),this}}(),scale:function(){var e=new Ct;return function(t,i,n){return e.makeScale(t,i,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new Zi;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var i=new xn(3*t.vertices.length,3),n=new xn(3*t.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var r=new xn(t.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},updateFromObject:function(e){var t,i=e.geometry;if(e.isMesh){var n=i.__directGeometry;if(!0===i.elementsNeedUpdate&&(n=void 0,i.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}return!0===i.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(i.vertices),t.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(i.normals),t.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(i.colors),t.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(i.uvs),t.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(i.lineDistances),t.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(e.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new wn).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new dn(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var i=new Float32Array(3*e.normals.length);this.addAttribute("normal",new dn(i,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new dn(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var r=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new dn(r,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new dn(o,2).copyVector2sArray(e.uvs2))}if(e.indices.length>0){var a=new(En(e.indices)>65535?Uint32Array:Uint16Array)(3*e.indices.length);this.setIndex(new dn(a,1).copyIndicesArray(e.indices))}for(var s in this.groups=e.groups,e.morphTargets){for(var l=[],c=e.morphTargets[s],u=0,h=c.length;u<h;u++){var d=c[u],p=new xn(3*d.length,3);l.push(p.copyVector3sArray(d))}this.morphAttributes[s]=l}if(e.skinIndices.length>0){var f=new xn(4*e.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var m=new xn(4*e.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Di);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new Di,t=new St;return function(){null===this.boundingSphere&&(this.boundingSphere=new Ni);var i=this.attributes.position;if(i){var n=this.boundingSphere.center;e.setFromBufferAttribute(i),e.getCenter(n);for(var r=0,o=0,a=i.count;o<a;o++)t.x=i.getX(o),t.y=i.getY(o),t.z=i.getZ(o),r=Math.max(r,n.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,i=this.groups;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new dn(new Float32Array(n.length),3));else for(var r=t.normal.array,o=0,a=r.length;o<a;o++)r[o]=0;var s,l,c,u=t.normal.array,h=new St,d=new St,p=new St,f=new St,m=new St;if(e){var g=e.array;0===i.length&&this.addGroup(0,g.length);for(var v=0,y=i.length;v<y;++v){var b=i[v],x=b.start;for(o=x,a=x+b.count;o<a;o+=3)s=3*g[o+0],l=3*g[o+1],c=3*g[o+2],h.fromArray(n,s),d.fromArray(n,l),p.fromArray(n,c),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),u[s]+=f.x,u[s+1]+=f.y,u[s+2]+=f.z,u[l]+=f.x,u[l+1]+=f.y,u[l+2]+=f.z,u[c]+=f.x,u[c+1]+=f.y,u[c+2]+=f.z}}else for(o=0,a=n.length;o<a;o+=9)h.fromArray(n,o),d.fromArray(n,o+3),p.fromArray(n,o+6),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),u[o]=f.x,u[o+1]=f.y,u[o+2]=f.z,u[o+3]=f.x,u[o+4]=f.y,u[o+5]=f.z,u[o+6]=f.x,u[o+7]=f.y,u[o+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0);var i=this.attributes;for(var n in i)if(void 0!==e.attributes[n])for(var r=i[n].array,o=e.attributes[n],a=o.array,s=0,l=o.itemSize*t;s<a.length;s++,l++)r[l]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e,t,i,n,r=this.attributes.normal,o=0,a=r.count;o<a;o++)e=r.getX(o),t=r.getY(o),i=r.getZ(o),n=1/Math.sqrt(e*e+t*t+i*i),r.setXYZ(o,e*n,t*n,i*n)},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Tn,t=this.index.array,i=this.attributes;for(var n in i){for(var r=i[n],o=r.array,a=r.itemSize,s=new o.constructor(t.length*a),l=0,c=0,u=0,h=t.length;u<h;u++){l=t[u]*a;for(var d=0;d<a;d++)s[c++]=o[l++]}e.addAttribute(n,new dn(s,a))}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}e.data={attributes:{}};var n=this.index;if(null!==n){var r=Array.prototype.slice.call(n.array);e.data.index={type:n.array.constructor.name,array:r}}var o=this.attributes;for(var i in o){var a=o[i];r=Array.prototype.slice.call(a.array);e.data.attributes[i]={itemSize:a.itemSize,type:a.array.constructor.name,array:r,normalized:a.normalized}}var s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));var l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e},clone:function(){return(new Tn).copy(this)},copy:function(e){var t,i,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var r=e.index;null!==r&&this.setIndex(r.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var l=[],c=s[t];for(i=0,n=c.length;i<n;i++)l.push(c[i].clone());this.morphAttributes[t]=l}var u=e.groups;for(i=0,n=u.length;i<n;i++){var h=u[i];this.addGroup(h.start,h.count,h.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Mn.prototype=Object.create(hn.prototype),Mn.prototype.constructor=Mn,Sn.prototype=Object.create(Tn.prototype),Sn.prototype.constructor=Sn,Cn.prototype=Object.create(hn.prototype),Cn.prototype.constructor=Cn,Rn.prototype=Object.create(Tn.prototype),Rn.prototype.constructor=Rn,An.prototype=Object.create(Oi.prototype),An.prototype.constructor=An,An.prototype.isMeshBasicMaterial=!0,An.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Object.assign(Pn.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new St).copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new St;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var i=t||new St;i.subVectors(e,this.origin);var n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new St;return function(t){var i=e.subVectors(t,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(i).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:(nn=new St,rn=new St,on=new St,function(e,t,i,n){nn.copy(e).add(t).multiplyScalar(.5),rn.copy(t).sub(e).normalize(),on.copy(this.origin).sub(nn);var r,o,a,s,l=.5*e.distanceTo(t),c=-this.direction.dot(rn),u=on.dot(this.direction),h=-on.dot(rn),d=on.lengthSq(),p=Math.abs(1-c*c);if(p>0)if(o=c*u-h,s=l*p,(r=c*h-u)>=0)if(o>=-s)if(o<=s){var f=1/p;a=(r*=f)*(r+c*(o*=f)+2*u)+o*(c*r+o+2*h)+d}else o=l,a=-(r=Math.max(0,-(c*o+u)))*r+o*(o+2*h)+d;else o=-l,a=-(r=Math.max(0,-(c*o+u)))*r+o*(o+2*h)+d;else o<=-s?a=-(r=Math.max(0,-(-c*l+u)))*r+(o=r>0?-l:Math.min(Math.max(-l,-h),l))*(o+2*h)+d:o<=s?(r=0,a=(o=Math.min(Math.max(-l,-h),l))*(o+2*h)+d):a=-(r=Math.max(0,-(c*l+u)))*r+(o=r>0?l:Math.min(Math.max(-l,-h),l))*(o+2*h)+d;else o=c>0?-l:l,a=-(r=Math.max(0,-(c*o+u)))*r+o*(o+2*h)+d;return i&&i.copy(this.direction).multiplyScalar(r).add(this.origin),n&&n.copy(rn).multiplyScalar(o).add(nn),a}),intersectSphere:function(){var e=new St;return function(t,i){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),r=e.dot(e)-n*n,o=t.radius*t.radius;if(r>o)return null;var a=Math.sqrt(o-r),s=n-a,l=n+a;return s<0&&l<0?null:s<0?this.at(l,i):this.at(s,i)}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null},intersectPlane:function(e,t){var i=this.distanceToPlane(e);return null===i?null:this.at(i,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var i,n,r,o,a,s,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(i=(e.min.x-h.x)*l,n=(e.max.x-h.x)*l):(i=(e.max.x-h.x)*l,n=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,o=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,o=(e.min.y-h.y)*c),i>o||r>n?null:((r>i||i!=i)&&(i=r),(o<n||n!=n)&&(n=o),u>=0?(a=(e.min.z-h.z)*u,s=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,s=(e.min.z-h.z)*u),i>s||a>n?null:((a>i||i!=i)&&(i=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(i>=0?i:n,t)))},intersectsBox:(tn=new St,function(e){return null!==this.intersectBox(e,tn)}),intersectTriangle:function(){var e=new St,t=new St,i=new St,n=new St;return function(r,o,a,s,l){t.subVectors(o,r),i.subVectors(a,r),n.crossVectors(t,i);var c,u=this.direction.dot(n);if(u>0){if(s)return null;c=1}else{if(!(u<0))return null;c=-1,u=-u}e.subVectors(this.origin,r);var h=c*this.direction.dot(i.crossVectors(e,i));if(h<0)return null;var d=c*this.direction.dot(t.cross(e));if(d<0)return null;if(h+d>u)return null;var p=-c*e.dot(n);return p<0?null:this.at(p/u,l)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Ln.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return(e||new St).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new St).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var i=t||new St;return this.delta(i).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(an=new St,sn=new St,function(e,t){an.subVectors(e,this.start),sn.subVectors(this.end,this.start);var i=sn.dot(sn),n=sn.dot(an)/i;return t&&(n=dt.clamp(n,0,1)),n}),closestPointToPoint:function(e,t,i){var n=this.closestPointToPointParameter(e,t),r=i||new St;return this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(On,{normal:(ln=new St,function(e,t,i,n){var r=n||new St;r.subVectors(i,t),ln.subVectors(e,t),r.cross(ln);var o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}),barycoordFromPoint:function(){var e=new St,t=new St,i=new St;return function(n,r,o,a,s){e.subVectors(a,r),t.subVectors(o,r),i.subVectors(n,r);var l=e.dot(e),c=e.dot(t),u=e.dot(i),h=t.dot(t),d=t.dot(i),p=l*h-c*c,f=s||new St;if(0===p)return f.set(-2,-1,-1);var m=1/p,g=(h*u-c*d)*m,v=(l*d-c*u)*m;return f.set(1-g-v,v,g)}}(),containsPoint:function(){var e=new St;return function(t,i,n,r){var o=On.barycoordFromPoint(t,i,n,r,e);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}()}),Object.assign(On.prototype,{set:function(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this},setFromPointsAndIndices:function(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new St,t=new St;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){return(e||new St).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return On.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new Bi).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return On.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return On.containsPoint(e,this.a,this.b,this.c)},closestPointToPoint:function(){var e=new Bi,t=[new Ln,new Ln,new Ln],i=new St,n=new St;return function(r,o){var a=o||new St,s=1/0;if(e.setFromCoplanarPoints(this.a,this.b,this.c),e.projectPoint(r,i),!0===this.containsPoint(i))a.copy(i);else{t[0].set(this.a,this.b),t[1].set(this.b,this.c),t[2].set(this.c,this.a);for(var l=0;l<t.length;l++){t[l].closestPointToPoint(i,!0,n);var c=i.distanceToSquared(n);c<s&&(s=c,a.copy(n))}}return a}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),In.prototype=Object.assign(Object.create(Zi.prototype),{constructor:In,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return Zi.prototype.copy.call(this,e),this.drawMode=e.drawMode,this},updateMorphTargets:function(){var e,t,i,n=this.geometry;if(n.isBufferGeometry){var r=n.morphAttributes,o=Object.keys(r);if(o.length>0){var a=r[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)i=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}else{var s=n.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)i=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}},raycast:function(){var e=new Ct,t=new Pn,i=new Ni,n=new St,r=new St,o=new St,a=new St,s=new St,l=new St,c=new pt,u=new pt,h=new pt,d=new St,p=new St,f=new St;function m(e,t,i,n,r,o,a){return On.barycoordFromPoint(e,t,i,n,d),r.multiplyScalar(d.x),o.multiplyScalar(d.y),a.multiplyScalar(d.z),r.add(o).add(a),r.clone()}function y(e,t,i,n,r,o,a){var s=e.material;if(null===(s.side===g?i.intersectTriangle(o,r,n,!0,a):i.intersectTriangle(n,r,o,s.side!==v,a)))return null;f.copy(a),f.applyMatrix4(e.matrixWorld);var l=t.ray.origin.distanceTo(f);return l<t.near||l>t.far?null:{distance:l,point:f.clone(),object:e}}function b(e,t,i,a,s,l,d,f){n.fromBufferAttribute(a,l),r.fromBufferAttribute(a,d),o.fromBufferAttribute(a,f);var g=y(e,t,i,n,r,o,p);return g&&(s&&(c.fromBufferAttribute(s,l),u.fromBufferAttribute(s,d),h.fromBufferAttribute(s,f),g.uv=m(p,n,r,o,c,u,h)),g.face=new Qi(l,d,f,On.normal(n,r,o)),g.faceIndex=l),g}return function(d,f){var g,v=this.geometry,x=this.material,_=this.matrixWorld;if(void 0!==x&&(null===v.boundingSphere&&v.computeBoundingSphere(),i.copy(v.boundingSphere),i.applyMatrix4(_),!1!==d.ray.intersectsSphere(i)&&(e.getInverse(_),t.copy(d.ray).applyMatrix4(e),null===v.boundingBox||!1!==t.intersectsBox(v.boundingBox))))if(v.isBufferGeometry){var w,E,T,M,S,C=v.index,R=v.attributes.position,A=v.attributes.uv;if(null!==C)for(M=0,S=C.count;M<S;M+=3)w=C.getX(M),E=C.getX(M+1),T=C.getX(M+2),(g=b(this,d,t,R,A,w,E,T))&&(g.faceIndex=Math.floor(M/3),f.push(g));else for(M=0,S=R.count;M<S;M+=3)(g=b(this,d,t,R,A,w=M,E=M+1,T=M+2))&&(g.index=w,f.push(g))}else if(v.isGeometry){var P,L,O,I,k=Array.isArray(x),D=v.vertices,N=v.faces,H=v.faceVertexUvs[0];H.length>0&&(I=H);for(var B=0,F=N.length;B<F;B++){var U=N[B],$=k?x[U.materialIndex]:x;if(void 0!==$){if(P=D[U.a],L=D[U.b],O=D[U.c],!0===$.morphTargets){var j=v.morphTargets,z=this.morphTargetInfluences;n.set(0,0,0),r.set(0,0,0),o.set(0,0,0);for(var V=0,G=j.length;V<G;V++){var W=z[V];if(0!==W){var q=j[V].vertices;n.addScaledVector(a.subVectors(q[U.a],P),W),r.addScaledVector(s.subVectors(q[U.b],L),W),o.addScaledVector(l.subVectors(q[U.c],O),W)}}n.add(P),r.add(L),o.add(O),P=n,L=r,O=o}if(g=y(this,d,t,P,L,O,p)){if(I&&I[B]){var X=I[B];c.copy(X[0]),u.copy(X[1]),h.copy(X[2]),g.uv=m(p,P,L,O,c,u,h)}g.face=U,g.faceIndex=B,f.push(g)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Bn,Fn,Un,$n,jn,zn,Vn=0;function Gn(e){switch(e){case nt:return["Linear","( value )"];case rt:return["sRGB","( value )"];case at:return["RGBE","( value )"];case st:return["RGBM","( value, 7.0 )"];case lt:return["RGBM","( value, 16.0 )"];case ct:return["RGBD","( value, 256.0 )"];case ot:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Wn(e,t){var i=Gn(t);return"vec4 "+e+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function qn(e){return""!==e}function Xn(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function Zn(e){return e.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(e,t){var i=bi[t];if(void 0===i)throw new Error("Can not resolve #include <"+t+">");return Zn(i)})}function Yn(e){return e.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,i,n){for(var r="",o=parseInt(t);o<parseInt(i);o++)r+=n.replace(/\[ i \]/g,"[ "+o+" ]");return r})}function Jn(e,t,i,n,r){var o=e.context,a=i.extensions,s=i.defines,l=n.vertexShader,c=n.fragmentShader,u="SHADOWMAP_TYPE_BASIC";r.shadowMapType===p?u="SHADOWMAP_TYPE_PCF":r.shadowMapType===f&&(u="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(r.envMap){switch(i.envMap.mapping){case se:case le:h="ENVMAP_TYPE_CUBE";break;case de:case pe:h="ENVMAP_TYPE_CUBE_UV";break;case ce:case ue:h="ENVMAP_TYPE_EQUIREC";break;case he:h="ENVMAP_TYPE_SPHERE"}switch(i.envMap.mapping){case le:case ue:d="ENVMAP_MODE_REFRACTION"}switch(i.combine){case Q:m="ENVMAP_BLENDING_MULTIPLY";break;case ee:m="ENVMAP_BLENDING_MIX";break;case te:m="ENVMAP_BLENDING_ADD"}}var g,v,y,b,x,_=e.gammaFactor>0?e.gammaFactor:1,w=function(e,t,i){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(qn).join("\n")}(a,r,e.extensions),E=function(e){var t=[];for(var i in e){var n=e[i];!1!==n&&t.push("#define "+i+" "+n)}return t.join("\n")}(s),T=o.createProgram();i.isRawShaderMaterial?(g=[E,"\n"].filter(qn).join("\n"),v=[w,E,"\n"].filter(qn).join("\n")):(g=["precision "+r.precision+" float;","precision "+r.precision+" int;","#define SHADER_NAME "+n.name,E,r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+_,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+d:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+r.numClippingPlanes,r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+u:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&e.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(qn).join("\n"),v=[w,"precision "+r.precision+" float;","precision "+r.precision+" int;","#define SHADER_NAME "+n.name,E,r.alphaTest?"#define ALPHATEST "+r.alphaTest:"","#define GAMMA_FACTOR "+_,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+h:"",r.envMap?"#define "+d:"",r.envMap?"#define "+m:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.vertexColors?"#define USE_COLOR":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+r.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(r.numClippingPlanes-r.numClipIntersection),r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+u:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&e.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",r.envMap&&e.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",r.toneMapping!==ie?"#define TONE_MAPPING":"",r.toneMapping!==ie?bi.tonemapping_pars_fragment:"",r.toneMapping!==ie?function(e,t){var i;switch(t){case ne:i="Linear";break;case re:i="Reinhard";break;case oe:i="Uncharted2";break;case ae:i="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.outputEncoding||r.mapEncoding||r.envMapEncoding||r.emissiveMapEncoding?bi.encodings_pars_fragment:"",r.mapEncoding?Wn("mapTexelToLinear",r.mapEncoding):"",r.envMapEncoding?Wn("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMapEncoding?Wn("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.outputEncoding?(y="linearToOutputTexel",b=r.outputEncoding,x=Gn(b),"vec4 "+y+"( vec4 value ) { return LinearTo"+x[0]+x[1]+"; }"):"",r.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(qn).join("\n")),l=Xn(l=Zn(l),r),c=Xn(c=Zn(c),r),i.isShaderMaterial||(l=Yn(l),c=Yn(c));var M=g+l,S=v+c,C=Hn(o,o.VERTEX_SHADER,M),R=Hn(o,o.FRAGMENT_SHADER,S);o.attachShader(T,C),o.attachShader(T,R),void 0!==i.index0AttributeName?o.bindAttribLocation(T,0,i.index0AttributeName):!0===r.morphTargets&&o.bindAttribLocation(T,0,"position"),o.linkProgram(T);var A,P,L=o.getProgramInfoLog(T),O=o.getShaderInfoLog(C),I=o.getShaderInfoLog(R),k=!0,D=!0;return!1===o.getProgramParameter(T,o.LINK_STATUS)?(k=!1,console.error("THREE.WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(T,o.VALIDATE_STATUS),"gl.getProgramInfoLog",L,O,I)):""!==L?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",L):""!==O&&""!==I||(D=!1),D&&(this.diagnostics={runnable:k,material:i,programLog:L,vertexShader:{log:O,prefix:g},fragmentShader:{log:I,prefix:v}}),o.deleteShader(C),o.deleteShader(R),this.getUniforms=function(){return void 0===A&&(A=new fi(o,T,e)),A},this.getAttributes=function(){return void 0===P&&(P=function(e,t,i){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),o=0;o<r;o++){var a=e.getActiveAttrib(t,o).name;n[a]=e.getAttribLocation(t,a)}return n}(o,T)),P},this.destroy=function(){o.deleteProgram(T),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Vn++,this.code=t,this.usedTimes=1,this.program=T,this.vertexShader=C,this.fragmentShader=R,this}function Kn(e,t){var i=[],n={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},r=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function o(e,t){var i;return e?e.isTexture?i=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=e.texture.encoding):i=nt,i===nt&&t&&(i=ot),i}this.getParameters=function(i,r,a,s,l,c){var u=n[i.type],h=c.isSkinnedMesh?function(e){var i=e.skeleton.bones;if(t.floatVertexTextures)return 1024;var n=t.maxVertexUniforms,r=Math.floor((n-20)/4),o=Math.min(r,i.length);return o<i.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+i.length+" bones. This GPU supports "+o+"."),0):o}(c):0,d=e.getPrecision();null!==i.precision&&(d=t.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",d,"instead.");var p=e.getRenderTarget();return{shaderID:u,precision:d,supportsVertexTextures:t.vertexTextures,outputEncoding:o(p?p.texture:null,e.gammaOutput),map:!!i.map,mapEncoding:o(i.map,e.gammaInput),envMap:!!i.envMap,envMapMode:i.envMap&&i.envMap.mapping,envMapEncoding:o(i.envMap,e.gammaInput),envMapCubeUV:!!i.envMap&&(i.envMap.mapping===de||i.envMap.mapping===pe),lightMap:!!i.lightMap,aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:o(i.emissiveMap,e.gammaInput),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,combine:i.combine,vertexColors:i.vertexColors,fog:!!a,useFog:i.fog,fogExp:a&&a.isFogExp2,flatShading:i.shading===y,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:t.logarithmicDepthBuffer,skinning:i.skinning&&h>0,maxBones:h,useVertexTexture:t.floatVertexTextures,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:s,numClipIntersection:l,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.receiveShadow&&r.shadows.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:i.side===v,flipSided:i.side===g,depthPacking:void 0!==i.depthPacking&&i.depthPacking}},this.getProgramCode=function(t,i){var n=[];if(i.shaderID?n.push(i.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var o in t.defines)n.push(o),n.push(t.defines[o]);for(var a=0;a<r.length;a++)n.push(i[r[a]]);return n.push(t.onBeforeCompile.toString()),n.push(e.gammaOutput),n.join()},this.acquireProgram=function(t,n,r,o){for(var a,s=0,l=i.length;s<l;s++){var c=i[s];if(c.code===o){++(a=c).usedTimes;break}}return void 0===a&&(a=new Jn(e,o,t,n,r),i.push(a)),a},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},this.programs=i}function Qn(e,t,i,n,r,o,a){var s="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext;function l(e,t){if(e.width>t||e.height>t){var i=t/Math.max(e.width,e.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(e.width*i),n.height=Math.floor(e.height*i),n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n}return e}function c(e){return dt.isPowerOfTwo(e.width)&&dt.isPowerOfTwo(e.height)}function u(e,t){return e.generateMipmaps&&t&&e.minFilter!==ve&&e.minFilter!==xe}function h(t){return t===ve||t===ye||t===be?e.NEAREST:e.LINEAR}function d(t){var i=t.target;i.removeEventListener("dispose",d),function(t){var i=n.get(t);if(t.image&&i.__image__webglTextureCube)e.deleteTexture(i.__image__webglTextureCube);else{if(void 0===i.__webglInit)return;e.deleteTexture(i.__webglTexture)}n.remove(t)}(i),a.textures--}function p(t){var i=t.target;i.removeEventListener("dispose",p),function(t){var i=n.get(t),r=n.get(t.texture);if(!t)return;void 0!==r.__webglTexture&&e.deleteTexture(r.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(i.__webglFramebuffer[o]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[o]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer);n.remove(t.texture),n.remove(t)}(i),a.textures--}function f(t,h){var p=n.get(t);if(t.version>0&&p.__version!==t.version){var f=t.image;if(void 0===f)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else{if(!1!==f.complete)return void function(t,n,h){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",d),t.__webglTexture=e.createTexture(),a.textures++);i.activeTexture(e.TEXTURE0+h),i.bindTexture(e.TEXTURE_2D,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment);var p=l(n.image,r.maxTextureSize);(function(e){return e.wrapS!==me||e.wrapT!==me||e.minFilter!==ve&&e.minFilter!==xe})(n)&&!1===c(p)&&(p=function(e){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement){var t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return t.width=dt.nearestPowerOfTwo(e.width),t.height=dt.nearestPowerOfTwo(e.height),t.getContext("2d").drawImage(e,0,0,t.width,t.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+t.width+"x"+t.height,e),t}return e}(p));var f=c(p),g=o(n.format),v=o(n.type);m(e.TEXTURE_2D,n,f);var y,b=n.mipmaps;if(n.isDepthTexture){var x=e.DEPTH_COMPONENT;if(n.type===Ae){if(!s)throw new Error("Float Depth Texture only supported in WebGL2.0");x=e.DEPTH_COMPONENT32F}else s&&(x=e.DEPTH_COMPONENT16);n.format===$e&&x===e.DEPTH_COMPONENT&&n.type!==Se&&n.type!==Re&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=Se,v=o(n.type)),n.format===je&&(x=e.DEPTH_STENCIL,n.type!==ke&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=ke,v=o(n.type))),i.texImage2D(e.TEXTURE_2D,0,x,p.width,p.height,0,g,v,null)}else if(n.isDataTexture)if(b.length>0&&f){for(var _=0,w=b.length;_<w;_++)y=b[_],i.texImage2D(e.TEXTURE_2D,_,g,y.width,y.height,0,g,v,y.data);n.generateMipmaps=!1}else i.texImage2D(e.TEXTURE_2D,0,g,p.width,p.height,0,g,v,p.data);else if(n.isCompressedTexture)for(var _=0,w=b.length;_<w;_++)y=b[_],n.format!==He&&n.format!==Ne?i.getCompressedTextureFormats().indexOf(g)>-1?i.compressedTexImage2D(e.TEXTURE_2D,_,g,y.width,y.height,0,y.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(e.TEXTURE_2D,_,g,y.width,y.height,0,g,v,y.data);else if(b.length>0&&f){for(var _=0,w=b.length;_<w;_++)y=b[_],i.texImage2D(e.TEXTURE_2D,_,g,g,v,y);n.generateMipmaps=!1}else i.texImage2D(e.TEXTURE_2D,0,g,g,v,p);u(n,f)&&e.generateMipmap(e.TEXTURE_2D);t.__version=n.version,n.onUpdate&&n.onUpdate(n)}(p,t,h);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t)}}i.activeTexture(e.TEXTURE0+h),i.bindTexture(e.TEXTURE_2D,p.__webglTexture)}function m(i,a,s){var l;if(s?(e.texParameteri(i,e.TEXTURE_WRAP_S,o(a.wrapS)),e.texParameteri(i,e.TEXTURE_WRAP_T,o(a.wrapT)),e.texParameteri(i,e.TEXTURE_MAG_FILTER,o(a.magFilter)),e.texParameteri(i,e.TEXTURE_MIN_FILTER,o(a.minFilter))):(e.texParameteri(i,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(i,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),a.wrapS===me&&a.wrapT===me||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),e.texParameteri(i,e.TEXTURE_MAG_FILTER,h(a.magFilter)),e.texParameteri(i,e.TEXTURE_MIN_FILTER,h(a.minFilter)),a.minFilter!==ve&&a.minFilter!==xe&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),l=t.get("EXT_texture_filter_anisotropic")){if(a.type===Ae&&null===t.get("OES_texture_float_linear"))return;if(a.type===Pe&&null===t.get("OES_texture_half_float_linear"))return;(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(e.texParameterf(i,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function g(t,r,a,s){var l=o(r.texture.format),c=o(r.texture.type);i.texImage2D(s,0,l,r.width,r.height,0,l,c,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,a,s,n.get(r.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function v(t,i){e.bindRenderbuffer(e.RENDERBUFFER,t),i.depthBuffer&&!i.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,i.width,i.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):i.depthBuffer&&i.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,i.width,i.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,i.width,i.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function y(t){var i=n.get(t),r=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported!");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),f(i.depthTexture,0);var r=n.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===$e)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,r,0);else{if(i.depthTexture.format!==je)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,r,0)}}(i.__webglFramebuffer,t)}else if(r){i.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=e.createRenderbuffer(),v(i.__webglDepthbuffer[o],t)}else e.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),v(i.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}this.setTexture2D=f,this.setTextureCube=function(t,s){var h=n.get(t);if(6===t.image.length)if(t.version>0&&h.__version!==t.version){h.__image__webglTextureCube||(t.addEventListener("dispose",d),h.__image__webglTextureCube=e.createTexture(),a.textures++),i.activeTexture(e.TEXTURE0+s),i.bindTexture(e.TEXTURE_CUBE_MAP,h.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var p=t&&t.isCompressedTexture,f=t.image[0]&&t.image[0].isDataTexture,g=[],v=0;v<6;v++)g[v]=p||f?f?t.image[v].image:t.image[v]:l(t.image[v],r.maxCubemapSize);var y=c(g[0]),b=o(t.format),x=o(t.type);for(m(e.TEXTURE_CUBE_MAP,t,y),v=0;v<6;v++)if(p)for(var _,w=g[v].mipmaps,E=0,T=w.length;E<T;E++)_=w[E],t.format!==He&&t.format!==Ne?i.getCompressedTextureFormats().indexOf(b)>-1?i.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,E,b,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,E,b,_.width,_.height,0,b,x,_.data);else f?i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,b,g[v].width,g[v].height,0,b,x,g[v].data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,b,b,x,g[v]);u(t,y)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),h.__version=t.version,t.onUpdate&&t.onUpdate(t)}else i.activeTexture(e.TEXTURE0+s),i.bindTexture(e.TEXTURE_CUBE_MAP,h.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,r){i.activeTexture(e.TEXTURE0+r),i.bindTexture(e.TEXTURE_CUBE_MAP,n.get(t).__webglTexture)},this.setupRenderTarget=function(t){var r=n.get(t),o=n.get(t.texture);t.addEventListener("dispose",p),o.__webglTexture=e.createTexture(),a.textures++;var s=!0===t.isWebGLRenderTargetCube,l=c(t);if(s){r.__webglFramebuffer=[];for(var h=0;h<6;h++)r.__webglFramebuffer[h]=e.createFramebuffer()}else r.__webglFramebuffer=e.createFramebuffer();if(s){for(i.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture),m(e.TEXTURE_CUBE_MAP,t.texture,l),h=0;h<6;h++)g(r.__webglFramebuffer[h],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+h);u(t.texture,l)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),i.bindTexture(e.TEXTURE_CUBE_MAP,null)}else i.bindTexture(e.TEXTURE_2D,o.__webglTexture),m(e.TEXTURE_2D,t.texture,l),g(r.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),u(t.texture,l)&&e.generateMipmap(e.TEXTURE_2D),i.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&y(t)},this.updateRenderTargetMipmap=function(t){var r=t.texture;if(u(r,c(t))){var o=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=n.get(r).__webglTexture;i.bindTexture(o,a),e.generateMipmap(o),i.bindTexture(o,null)}}}function er(e){Ki.call(this),this.cameras=e||[]}function tr(e){console.log("THREE.WebGLRenderer",l);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,r=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,p=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,f=[],m=null,b=new Float32Array(8),_=[],w=[];this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=ne,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Q,ee=this,te=null,ie=null,re=null,oe=-1,ae="",se=null,le=null,ce=new wt,ue=null,he=new wt,de=0,pe=t.width,Ue=t.height,Ke=1,Qe=new wt(0,0,pe,Ue),nt=!1,rt=new wt(0,0,pe,Ue),ot=new Fi,at=new function(){var e=this,t=null,i=0,n=!1,r=!1,o=new Bi,a=new Hi,s={value:null,needsUpdate:!1};function l(){s.value!==t&&(s.value=t,s.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function c(t,i,n,r){var l=null!==t?t.length:0,c=null;if(0!==l){if(c=s.value,!0!==r||null===c){var u=n+4*l,h=i.matrixWorldInverse;a.getNormalMatrix(h),(null===c||c.length<u)&&(c=new Float32Array(u));for(var d=0,p=n;d!==l;++d,p+=4)o.copy(t[d]).applyMatrix4(h,a),o.normal.toArray(c,p),c[p+3]=o.constant}s.value=c,s.needsUpdate=!0}return e.numPlanes=l,c}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,r,o){var a=0!==e.length||r||0!==i||n;return n=r,t=c(e,o,0),i=e.length,a},this.beginShadows=function(){r=!0,c(null)},this.endShadows=function(){r=!1,l()},this.setState=function(e,o,a,u,h,d){if(!n||null===e||0===e.length||r&&!a)r?c(null):l();else{var p=r?0:i,f=4*p,m=h.clippingState||null;s.value=m,m=c(e,u,f,d);for(var g=0;g!==f;++g)m[g]=t[g];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=p}}},st=!1,lt=!1,ct=new Ct,ut=new St,ht=new Ct,ft=new Ct,mt={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},gt={geometries:0,textures:0},vt={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:vt,memory:gt,programs:null};try{var yt={alpha:n,depth:r,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:p};if(null===(Q=i||t.getContext("webgl",yt)||t.getContext("experimental-webgl",yt)))throw null!==t.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===Q.getShaderPrecisionFormat&&(Q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),t.addEventListener("webglcontextlost",Gt,!1)}catch(e){console.error("THREE.WebGLRenderer: "+e)}var bt=new function(e){var t={};return{get:function(i){if(void 0!==t[i])return t[i];var n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=e.getExtension("WEBGL_compressed_texture_etc1");break;default:n=e.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),t[i]=n,n}}}(Q);bt.get("WEBGL_depth_texture"),bt.get("OES_texture_float"),bt.get("OES_texture_float_linear"),bt.get("OES_texture_half_float"),bt.get("OES_texture_half_float_linear"),bt.get("OES_standard_derivatives"),bt.get("ANGLE_instanced_arrays"),bt.get("OES_element_index_uint")&&(Tn.MaxIndex=4294967296);var xt=new function(e,t,i){var n;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o=void 0!==i.precision?i.precision:"highp",a=r(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);var s=!0===i.logarithmicDepthBuffer&&!!t.get("EXT_frag_depth"),l=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),c=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),u=e.getParameter(e.MAX_TEXTURE_SIZE),h=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),d=e.getParameter(e.MAX_VERTEX_ATTRIBS),p=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),f=e.getParameter(e.MAX_VARYING_VECTORS),m=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),g=c>0,v=!!t.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==n)return n;var i=t.get("EXT_texture_filter_anisotropic");return n=null!==i?e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:s,maxTextures:l,maxVertexTextures:c,maxTextureSize:u,maxCubemapSize:h,maxAttributes:d,maxVertexUniforms:p,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v}}(Q,bt,e),_t=new function(e,t,i){var n=new function(){var t=!1,i=new wt,n=null,r=new wt;return{setMask:function(i){n===i||t||(e.colorMask(i,i,i,i),n=i)},setLocked:function(e){t=e},setClear:function(t,n,o,a,s){!0===s&&(t*=a,n*=a,o*=a),i.set(t,n,o,a),!1===r.equals(i)&&(e.clearColor(t,n,o,a),r.copy(i))},reset:function(){t=!1,n=null,r.set(0,0,0,1)}}},r=new function(){var t=!1,i=null,n=null,r=null;return{setTest:function(t){t?ee(e.DEPTH_TEST):te(e.DEPTH_TEST)},setMask:function(n){i===n||t||(e.depthMask(n),i=n)},setFunc:function(t){if(n!==t){if(t)switch(t){case G:e.depthFunc(e.NEVER);break;case W:e.depthFunc(e.ALWAYS);break;case q:e.depthFunc(e.LESS);break;case X:e.depthFunc(e.LEQUAL);break;case Z:e.depthFunc(e.EQUAL);break;case Y:e.depthFunc(e.GEQUAL);break;case J:e.depthFunc(e.GREATER);break;case K:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);n=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,i=null,n=null,r=null}}},o=new function(){var t=!1,i=null,n=null,r=null,o=null,a=null,s=null,l=null,c=null;return{setTest:function(t){t?ee(e.STENCIL_TEST):te(e.STENCIL_TEST)},setMask:function(n){i===n||t||(e.stencilMask(n),i=n)},setFunc:function(t,i,a){n===t&&r===i&&o===a||(e.stencilFunc(t,i,a),n=t,r=i,o=a)},setOp:function(t,i,n){a===t&&s===i&&l===n||(e.stencilOp(t,i,n),a=t,s=i,l=n)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,i=null,n=null,r=null,o=null,a=null,s=null,l=null,c=null}}},a=e.getParameter(e.MAX_VERTEX_ATTRIBS),s=new Uint8Array(a),l=new Uint8Array(a),d=new Uint8Array(a),p={},f=null,m=null,y=null,b=null,x=null,_=null,w=null,A=null,P=!1,L=null,O=null,I=null,k=null,D=null,N=null,H=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),B=parseFloat(/^WebGL\ ([0-9])/.exec(e.getParameter(e.VERSION))[1]),F=parseFloat(B)>=1,U=null,$={},j=new wt,z=new wt;function V(t,i,n){var r=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var a=0;a<n;a++)e.texImage2D(i+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,r);return o}var Q={};function ee(t){!0!==p[t]&&(e.enable(t),p[t]=!0)}function te(t){!1!==p[t]&&(e.disable(t),p[t]=!1)}function ie(t,n,r,o,a,s,l,c){t!==E?ee(e.BLEND):te(e.BLEND),t===R||t===m&&c===P||(t===M?c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)):t===S?c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR)):t===C?c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR)):c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)),m=t,P=c),t===R?(a=a||n,s=s||r,l=l||o,n===y&&a===_||(e.blendEquationSeparate(i(n),i(a)),y=n,_=a),r===b&&o===x&&s===w&&l===A||(e.blendFuncSeparate(i(r),i(o),i(s),i(l)),b=r,x=o,w=s,A=l)):(y=null,b=null,x=null,_=null,w=null,A=null)}function ne(t){L!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),L=t)}function re(t){t!==c?(ee(e.CULL_FACE),t!==O&&(t===u?e.cullFace(e.BACK):t===h?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):te(e.CULL_FACE),O=t}function oe(t,i,n){t?(ee(e.POLYGON_OFFSET_FILL),k===i&&D===n||(e.polygonOffset(i,n),k=i,D=n)):te(e.POLYGON_OFFSET_FILL)}function ae(t){void 0===t&&(t=e.TEXTURE0+H-1),U!==t&&(e.activeTexture(t),U=t)}return Q[e.TEXTURE_2D]=V(e.TEXTURE_2D,e.TEXTURE_2D,1),Q[e.TEXTURE_CUBE_MAP]=V(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:n,depth:r,stencil:o},init:function(){n.setClear(0,0,0,1),r.setClear(1),o.setClear(0),ee(e.DEPTH_TEST),r.setFunc(X),ne(!1),re(u),ee(e.CULL_FACE),ee(e.BLEND),ie(T)},initAttributes:function(){for(var e=0,t=s.length;e<t;e++)s[e]=0},enableAttribute:function(i){s[i]=1,0===l[i]&&(e.enableVertexAttribArray(i),l[i]=1),0!==d[i]&&(t.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i,0),d[i]=0)},enableAttributeAndDivisor:function(i,n){s[i]=1,0===l[i]&&(e.enableVertexAttribArray(i),l[i]=1),d[i]!==n&&(t.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i,n),d[i]=n)},disableUnusedAttributes:function(){for(var t=0,i=l.length;t!==i;++t)l[t]!==s[t]&&(e.disableVertexAttribArray(t),l[t]=0)},enable:ee,disable:te,getCompressedTextureFormats:function(){if(null===f&&(f=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")))for(var i=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<i.length;n++)f.push(i[n]);return f},setBlending:ie,setMaterial:function(t){t.side===v?te(e.CULL_FACE):ee(e.CULL_FACE),ne(t.side===g),!0===t.transparent?ie(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):ie(E),r.setFunc(t.depthFunc),r.setTest(t.depthTest),r.setMask(t.depthWrite),n.setMask(t.colorWrite),oe(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:ne,setCullFace:re,setLineWidth:function(t){t!==I&&(F&&e.lineWidth(t),I=t)},setPolygonOffset:oe,getScissorTest:function(){return N},setScissorTest:function(t){N=t,t?ee(e.SCISSOR_TEST):te(e.SCISSOR_TEST)},activeTexture:ae,bindTexture:function(t,i){null===U&&ae();var n=$[U];void 0===n&&(n={type:void 0,texture:void 0},$[U]=n),n.type===t&&n.texture===i||(e.bindTexture(t,i||Q[t]),n.type=t,n.texture=i)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===j.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),j.copy(t))},viewport:function(t){!1===z.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),z.copy(t))},reset:function(){for(var t=0;t<l.length;t++)1===l[t]&&(e.disableVertexAttribArray(t),l[t]=0);p={},f=null,U=null,$={},m=null,L=null,O=null,n.reset(),r.reset(),o.reset()}}}(Q,bt,ni),Et=new function(){var e={};return{get:function(t){var i=t.uuid,n=e[i];return void 0===n&&(n={},e[i]=n),n},remove:function(t){delete e[t.uuid]},clear:function(){e={}}}},Tt=new Qn(Q,bt,_t,Et,xt,ni,gt),Mt=new $i(Q),At=new function(e,t,i){var n={},r={};function o(e){var a=e.target,s=n[a.id];for(var l in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[l]);a.removeEventListener("dispose",o),delete n[a.id];var c=r[a.id];c&&(t.remove(c),delete r[a.id]),(c=r[s.id])&&(t.remove(c),delete r[s.id]),i.geometries--}return{get:function(e,t){var r=n[t.id];return r||(t.addEventListener("dispose",o),t.isBufferGeometry?r=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Tn).setFromObject(e)),r=t._bufferGeometry),n[t.id]=r,i.geometries++,r)},update:function(i){var n=i.index,r=i.attributes;for(var o in null!==n&&t.update(n,e.ELEMENT_ARRAY_BUFFER),r)t.update(r[o],e.ARRAY_BUFFER);var a=i.morphAttributes;for(var o in a)for(var s=a[o],l=0,c=s.length;l<c;l++)t.update(s[l],e.ARRAY_BUFFER)},getWireframeAttribute:function(i){var n=r[i.id];if(n)return n;var o,a=[],s=i.index,l=i.attributes;if(null!==s)for(var c=0,u=(o=s.array).length;c<u;c+=3){var h=o[c+0],d=o[c+1],p=o[c+2];a.push(h,d,d,p,p,h)}else for(c=0,u=(o=l.position.array).length/3-1;c<u;c+=3)h=c+0,d=c+1,p=c+2,a.push(h,d,d,p,p,h);return n=new(En(a)>65535?bn:vn)(a,1),t.update(n,e.ELEMENT_ARRAY_BUFFER),r[i.id]=n,n}}}(Q,Mt,gt),Pt=new function(e,t,i){var n={};return{update:function(e){var r=i.frame,o=e.geometry,a=t.get(e,o);return n[a.id]!==r&&(o.isGeometry&&a.updateFromObject(e),t.update(a),n[a.id]=r),a},clear:function(){n={}}}}(Q,At,vt),Lt=new Kn(this,xt),Ot=new function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var i;switch(t.type){case"DirectionalLight":i={direction:new St,color:new gi,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new pt};break;case"SpotLight":i={position:new St,direction:new St,color:new gi,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new pt};break;case"PointLight":i={position:new St,color:new gi,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new pt};break;case"HemisphereLight":i={direction:new St,skyColor:new gi,groundColor:new gi};break;case"RectAreaLight":i={color:new gi,position:new St,halfWidth:new St,halfHeight:new St}}return e[t.id]=i,i}}},It=new Nn,kt=new function(e,t,i,n){var r,o,a,s,l=new gi(0),c=0;function u(e,i){t.buffers.color.setClear(e.r,e.g,e.b,i,n)}return{getClearColor:function(){return l},setClearColor:function(e,t){l.set(e),u(l,c=void 0!==t?t:1)},getClearAlpha:function(){return c},setClearAlpha:function(e){u(l,c=e)},render:function(t,n,h){var d=t.background;null===d?u(l,c):d&&d.isColor&&(u(d,1),h=!0),(e.autoClear||h)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),d&&d.isCubeTexture?(void 0===a&&(a=new Ki,s=new In(new Sn(5,5,5),new Ii({uniforms:xi.cube.uniforms,vertexShader:xi.cube.vertexShader,fragmentShader:xi.cube.fragmentShader,side:g,depthTest:!1,depthWrite:!1,fog:!1}))),a.projectionMatrix.copy(n.projectionMatrix),a.matrixWorld.extractRotation(n.matrixWorld),a.matrixWorldInverse.getInverse(a.matrixWorld),s.material.uniforms.tCube.value=d,s.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,s.matrixWorld),i.update(s),e.renderBufferDirect(a,null,s.geometry,s.material,s,null)):d&&d.isTexture&&(void 0===r&&(r=new Ji(-1,1,1,-1,0,1),o=new In(new Rn(2,2),new An({depthTest:!1,depthWrite:!1,fog:!1}))),o.material.map=d,i.update(o),e.renderBufferDirect(r,null,o.geometry,o.material,o,null))}}}(this,_t,Pt,s),Dt=new function(e){var t=this,i=null,n=null;"VRFrameData"in window&&(n=new window.VRFrameData);var r=new Ct,o=new Ct,a=new Ct,s=new Ki;s.bounds=new wt(0,0,.5,1),s.layers.enable(1);var l=new Ki;l.bounds=new wt(.5,0,.5,1),l.layers.enable(2);var c,u,h=new er([s,l]);h.layers.enable(1),h.layers.enable(2),window.addEventListener("vrdisplaypresentchange",function(){if(i.isPresenting){var n=i.getEyeParameters("left"),r=n.renderWidth,o=n.renderHeight;u=e.getPixelRatio(),c=e.getSize(),e.setDrawingBufferSize(2*r,o,1)}else t.enabled&&e.setDrawingBufferSize(c.width,c.height,u)},!1),this.enabled=!1,this.standing=!1,this.getDevice=function(){return i},this.setDevice=function(e){void 0!==e&&(i=e)},this.getCamera=function(e){if(null===i)return e;i.depthNear=e.near,i.depthFar=e.far,i.getFrameData(n);var t=n.pose;null!==t.position?e.position.fromArray(t.position):e.position.set(0,0,0),null!==t.orientation&&e.quaternion.fromArray(t.orientation),e.updateMatrixWorld();var c=i.stageParameters;if(this.standing&&c&&(o.fromArray(c.sittingToStandingTransform),a.getInverse(o),e.matrixWorld.multiply(o),e.matrixWorldInverse.multiply(a)),!1===i.isPresenting)return e;h.matrixWorld.copy(e.matrixWorld),h.matrixWorldInverse.copy(e.matrixWorldInverse),s.matrixWorldInverse.fromArray(n.leftViewMatrix),l.matrixWorldInverse.fromArray(n.rightViewMatrix),this.standing&&c&&(s.matrixWorldInverse.multiply(a),l.matrixWorldInverse.multiply(a));var u=e.parent;null!==u&&(r.getInverse(u.matrixWorld),s.matrixWorldInverse.multiply(r),l.matrixWorldInverse.multiply(r)),s.matrixWorld.getInverse(s.matrixWorldInverse),l.matrixWorld.getInverse(l.matrixWorldInverse),s.projectionMatrix.fromArray(n.leftProjectionMatrix),l.projectionMatrix.fromArray(n.rightProjectionMatrix),h.projectionMatrix.copy(s.projectionMatrix);var d=i.getLayers();if(d.length){var p=d[0];null!==p.leftBounds&&4===p.leftBounds.length&&s.bounds.fromArray(p.leftBounds),null!==p.rightBounds&&4===p.rightBounds.length&&l.bounds.fromArray(p.rightBounds)}return h},this.getStandingMatrix=function(){return o},this.submitFrame=function(){i&&i.isPresenting&&i.submitFrame()}}(this);this.info.programs=Lt.programs;var Nt=new function(e,t,i){var n;this.setMode=function(e){n=e},this.render=function(t,r){e.drawArrays(n,t,r),i.calls++,i.vertices+=r,n===e.TRIANGLES&&(i.faces+=r/3)},this.renderInstances=function(r,o,a){var s=t.get("ANGLE_instanced_arrays");if(null!==s){var l=r.attributes.position;l.isInterleavedBufferAttribute?(a=l.data.count,s.drawArraysInstancedANGLE(n,0,a,r.maxInstancedCount)):s.drawArraysInstancedANGLE(n,o,a,r.maxInstancedCount),i.calls++,i.vertices+=a*r.maxInstancedCount,n===e.TRIANGLES&&(i.faces+=r.maxInstancedCount*a/3)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(Q,bt,vt),Ht=new function(e,t,i){var n,r,o;this.setMode=function(e){n=e},this.setIndex=function(e){r=e.type,o=e.bytesPerElement},this.render=function(t,a){e.drawElements(n,a,r,t*o),i.calls++,i.vertices+=a,n===e.TRIANGLES&&(i.faces+=a/3)},this.renderInstances=function(a,s,l){var c=t.get("ANGLE_instanced_arrays");null!==c?(c.drawElementsInstancedANGLE(n,l,r,s*o,a.maxInstancedCount),i.calls++,i.vertices+=l*a.maxInstancedCount,n===e.TRIANGLES&&(i.faces+=a.maxInstancedCount*l/3)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(Q,bt,vt);function Bt(){return null===ie?Ke:1}function Ft(){_t.init(),_t.scissor(ce.copy(Qe).multiplyScalar(Ke)),_t.viewport(he.copy(rt).multiplyScalar(Ke))}function Ut(){te=null,se=null,ae="",oe=-1,_t.reset()}Ft(),this.context=Q,this.capabilities=xt,this.extensions=bt,this.properties=Et,this.renderLists=It,this.state=_t,this.vr=Dt;var $t=new Ui(this,mt,Pt,xt);this.shadowMap=$t;var jt,zt=new Ei(this,_),Vt=new wi(this,w);function Gt(e){e.preventDefault(),Ut(),Ft(),Et.clear(),Pt.clear()}function Wt(e){var t=e.target;t.removeEventListener("dispose",Wt),function(e){qt(e),Et.remove(e)}(t)}function qt(e){var t=Et.get(e).program;e.program=void 0,void 0!==t&&Lt.releaseProgram(t)}function Xt(e,t){return Math.abs(t[0])-Math.abs(e[0])}function Zt(e,t,i,n){for(var r=0,o=e.length;r<o;r++){var a=e[r],s=a.object,l=a.geometry,c=void 0===n?a.material:n,u=a.group;if(i.isArrayCamera){le=i;for(var h=i.cameras,d=0,p=h.length;d<p;d++){var f=h[d];if(s.layers.test(f.layers)){var m=f.bounds,g=m.x*pe,v=m.y*Ue,y=m.z*pe,b=m.w*Ue;ee.setViewport(g,v,y,b),ee.setScissor(g,v,y,b),ee.setScissorTest(!0),Yt(s,t,f,l,c,u)}}}else le=null,Yt(s,t,i,l,c,u)}}function Yt(e,t,i,n,r,o){if(e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.onBeforeRender(ee,t,i,n,r,o),e.isImmediateRenderObject){_t.setMaterial(r);var a=Kt(i,t.fog,r,e);ae="",function(e,t,i){e.render(function(e){ee.renderBufferImmediate(e,t,i)})}(e,a,r)}else ee.renderBufferDirect(i,t.fog,n,r,e,o);e.onAfterRender(ee,t,i,n,r,o)}function Jt(e,t,i){var n=Et.get(e),r=Lt.getParameters(e,mt,t,at.numPlanes,at.numIntersection,i),o=Lt.getProgramCode(e,r),a=n.program,s=!0;if(void 0===a)e.addEventListener("dispose",Wt);else if(a.code!==o)qt(e);else{if(void 0!==r.shaderID)return;s=!1}if(s){if(r.shaderID){var l=xi[r.shaderID];n.shader={name:e.type,uniforms:yi.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else n.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(n.shader),a=Lt.acquireProgram(e,n.shader,r,o),n.program=a,e.program=a}var c=a.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var u=0;u<ee.maxMorphTargets;u++)c["morphTarget"+u]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(u=0;u<ee.maxMorphNormals;u++)c["morphNormal"+u]>=0&&e.numSupportedMorphNormals++}var h=n.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=at.numPlanes,n.numIntersection=at.numIntersection,h.clippingPlanes=at.uniform),n.fog=t,n.lightsHash=mt.hash,e.lights&&(h.ambientLightColor.value=mt.ambient,h.directionalLights.value=mt.directional,h.spotLights.value=mt.spot,h.rectAreaLights.value=mt.rectArea,h.pointLights.value=mt.point,h.hemisphereLights.value=mt.hemi,h.directionalShadowMap.value=mt.directionalShadowMap,h.directionalShadowMatrix.value=mt.directionalShadowMatrix,h.spotShadowMap.value=mt.spotShadowMap,h.spotShadowMatrix.value=mt.spotShadowMatrix,h.pointShadowMap.value=mt.pointShadowMap,h.pointShadowMatrix.value=mt.pointShadowMatrix);var d=n.program.getUniforms(),p=fi.seqWithValue(d.seq,h);n.uniformsList=p}function Kt(e,t,i,n){de=0;var r=Et.get(i);if(st&&(lt||e!==se)){var o=e===se&&i.id===oe;at.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,e,r,o)}!1===i.needsUpdate&&(void 0===r.program?i.needsUpdate=!0:i.fog&&r.fog!==t?i.needsUpdate=!0:i.lights&&r.lightsHash!==mt.hash?i.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===at.numPlanes&&r.numIntersection===at.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(Jt(i,t,n),i.needsUpdate=!1);var a,s,l=!1,c=!1,u=!1,h=r.program,d=h.getUniforms(),p=r.shader.uniforms;if(h.id!==te&&(Q.useProgram(h.program),te=h.id,l=!0,c=!0,u=!0),i.id!==oe&&(oe=i.id,c=!0),l||e!==se){if(d.setValue(Q,"projectionMatrix",e.projectionMatrix),xt.logarithmicDepthBuffer&&d.setValue(Q,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),se!==(le||e)&&(se=le||e,c=!0,u=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap){var f=d.map.cameraPosition;void 0!==f&&f.setValue(Q,ut.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&d.setValue(Q,"viewMatrix",e.matrixWorldInverse)}if(i.skinning){d.setOptional(Q,n,"bindMatrix"),d.setOptional(Q,n,"bindMatrixInverse");var m=n.skeleton;if(m){var g=m.bones;if(xt.floatVertexTextures){if(void 0===m.boneTexture){var v=Math.sqrt(4*g.length);v=dt.nextPowerOfTwo(Math.ceil(v)),v=Math.max(v,4);var y=new Float32Array(v*v*4);y.set(m.boneMatrices);var b=new Rt(y,v,v,He,Ae);m.boneMatrices=y,m.boneTexture=b,m.boneTextureSize=v}d.setValue(Q,"boneTexture",m.boneTexture),d.setValue(Q,"boneTextureSize",m.boneTextureSize)}else d.setOptional(Q,m,"boneMatrices")}}return c&&(d.setValue(Q,"toneMappingExposure",ee.toneMappingExposure),d.setValue(Q,"toneMappingWhitePoint",ee.toneMappingWhitePoint),i.lights&&(s=u,(a=p).ambientLightColor.needsUpdate=s,a.directionalLights.needsUpdate=s,a.pointLights.needsUpdate=s,a.spotLights.needsUpdate=s,a.rectAreaLights.needsUpdate=s,a.hemisphereLights.needsUpdate=s),t&&i.fog&&function(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(p,t),(i.isMeshBasicMaterial||i.isMeshLambertMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.isMeshNormalMaterial||i.isMeshDepthMaterial)&&function(e,t){e.opacity.value=t.opacity,e.diffuse.value=t.color,t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity);e.map.value=t.map,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity);t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity);var i;t.map?i=t.map:t.specularMap?i=t.specularMap:t.displacementMap?i=t.displacementMap:t.normalMap?i=t.normalMap:t.bumpMap?i=t.bumpMap:t.roughnessMap?i=t.roughnessMap:t.metalnessMap?i=t.metalnessMap:t.alphaMap?i=t.alphaMap:t.emissiveMap&&(i=t.emissiveMap);if(void 0!==i){i.isWebGLRenderTarget&&(i=i.texture);var n=i.offset,r=i.repeat;e.offsetRepeat.value.set(n.x,n.y,r.x,r.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}(p,i),i.isLineBasicMaterial?Qt(p,i):i.isLineDashedMaterial?(Qt(p,i),function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(p,i)):i.isPointsMaterial?function(e,t){if(e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*Ke,e.scale.value=.5*Ue,e.map.value=t.map,null!==t.map){var i=t.map.offset,n=t.map.repeat;e.offsetRepeat.value.set(i.x,i.y,n.x,n.y)}}(p,i):i.isMeshLambertMaterial?function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(p,i):i.isMeshToonMaterial?function(e,t){ei(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(p,i):i.isMeshPhongMaterial?ei(p,i):i.isMeshPhysicalMaterial?function(e,t){e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness,ti(e,t)}(p,i):i.isMeshStandardMaterial?ti(p,i):i.isMeshDepthMaterial?i.displacementMap&&(p.displacementMap.value=i.displacementMap,p.displacementScale.value=i.displacementScale,p.displacementBias.value=i.displacementBias):i.isMeshNormalMaterial&&function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale);t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(p,i),void 0!==p.ltcMat&&(p.ltcMat.value=vi.LTC_MAT_TEXTURE),void 0!==p.ltcMag&&(p.ltcMag.value=vi.LTC_MAG_TEXTURE),fi.upload(Q,r.uniformsList,p,ee)),d.setValue(Q,"modelViewMatrix",n.modelViewMatrix),d.setValue(Q,"normalMatrix",n.normalMatrix),d.setValue(Q,"modelMatrix",n.matrixWorld),h}function Qt(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function ei(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function ti(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}function ii(e,t){var i,n,r,o,a,s,l,c,u=0,h=0,d=0,p=t.matrixWorldInverse,f=0,m=0,g=0,v=0,y=0;for(i=0,n=e.length;i<n;i++)if(a=(r=e[i]).color,s=r.intensity,l=r.distance,c=r.shadow&&r.shadow.map?r.shadow.map.texture:null,r.isAmbientLight)u+=a.r*s,h+=a.g*s,d+=a.b*s;else if(r.isDirectionalLight){(b=Ot.get(r)).color.copy(r.color).multiplyScalar(r.intensity),b.direction.setFromMatrixPosition(r.matrixWorld),ut.setFromMatrixPosition(r.target.matrixWorld),b.direction.sub(ut),b.direction.transformDirection(p),b.shadow=r.castShadow,r.castShadow&&(o=r.shadow,b.shadowBias=o.bias,b.shadowRadius=o.radius,b.shadowMapSize=o.mapSize),mt.directionalShadowMap[f]=c,mt.directionalShadowMatrix[f]=r.shadow.matrix,mt.directional[f]=b,f++}else if(r.isSpotLight){(b=Ot.get(r)).position.setFromMatrixPosition(r.matrixWorld),b.position.applyMatrix4(p),b.color.copy(a).multiplyScalar(s),b.distance=l,b.direction.setFromMatrixPosition(r.matrixWorld),ut.setFromMatrixPosition(r.target.matrixWorld),b.direction.sub(ut),b.direction.transformDirection(p),b.coneCos=Math.cos(r.angle),b.penumbraCos=Math.cos(r.angle*(1-r.penumbra)),b.decay=0===r.distance?0:r.decay,b.shadow=r.castShadow,r.castShadow&&(o=r.shadow,b.shadowBias=o.bias,b.shadowRadius=o.radius,b.shadowMapSize=o.mapSize),mt.spotShadowMap[g]=c,mt.spotShadowMatrix[g]=r.shadow.matrix,mt.spot[g]=b,g++}else if(r.isRectAreaLight){(b=Ot.get(r)).color.copy(a).multiplyScalar(s/(r.width*r.height)),b.position.setFromMatrixPosition(r.matrixWorld),b.position.applyMatrix4(p),ft.identity(),ht.copy(r.matrixWorld),ht.premultiply(p),ft.extractRotation(ht),b.halfWidth.set(.5*r.width,0,0),b.halfHeight.set(0,.5*r.height,0),b.halfWidth.applyMatrix4(ft),b.halfHeight.applyMatrix4(ft),mt.rectArea[v]=b,v++}else if(r.isPointLight){(b=Ot.get(r)).position.setFromMatrixPosition(r.matrixWorld),b.position.applyMatrix4(p),b.color.copy(r.color).multiplyScalar(r.intensity),b.distance=r.distance,b.decay=0===r.distance?0:r.decay,b.shadow=r.castShadow,r.castShadow&&(o=r.shadow,b.shadowBias=o.bias,b.shadowRadius=o.radius,b.shadowMapSize=o.mapSize),mt.pointShadowMap[m]=c,mt.pointShadowMatrix[m]=r.shadow.matrix,mt.point[m]=b,m++}else if(r.isHemisphereLight){var b;(b=Ot.get(r)).direction.setFromMatrixPosition(r.matrixWorld),b.direction.transformDirection(p),b.direction.normalize(),b.skyColor.copy(r.color).multiplyScalar(s),b.groundColor.copy(r.groundColor).multiplyScalar(s),mt.hemi[y]=b,y++}mt.ambient[0]=u,mt.ambient[1]=h,mt.ambient[2]=d,mt.directional.length=f,mt.spot.length=g,mt.rectArea.length=v,mt.point.length=m,mt.hemi.length=y,mt.hash=f+","+m+","+g+","+v+","+y+","+mt.shadows.length}function ni(e){var t;if(e===fe)return Q.REPEAT;if(e===me)return Q.CLAMP_TO_EDGE;if(e===ge)return Q.MIRRORED_REPEAT;if(e===ve)return Q.NEAREST;if(e===ye)return Q.NEAREST_MIPMAP_NEAREST;if(e===be)return Q.NEAREST_MIPMAP_LINEAR;if(e===xe)return Q.LINEAR;if(e===_e)return Q.LINEAR_MIPMAP_NEAREST;if(e===we)return Q.LINEAR_MIPMAP_LINEAR;if(e===Ee)return Q.UNSIGNED_BYTE;if(e===Le)return Q.UNSIGNED_SHORT_4_4_4_4;if(e===Oe)return Q.UNSIGNED_SHORT_5_5_5_1;if(e===Ie)return Q.UNSIGNED_SHORT_5_6_5;if(e===Te)return Q.BYTE;if(e===Me)return Q.SHORT;if(e===Se)return Q.UNSIGNED_SHORT;if(e===Ce)return Q.INT;if(e===Re)return Q.UNSIGNED_INT;if(e===Ae)return Q.FLOAT;if(e===Pe&&null!==(t=bt.get("OES_texture_half_float")))return t.HALF_FLOAT_OES;if(e===De)return Q.ALPHA;if(e===Ne)return Q.RGB;if(e===He)return Q.RGBA;if(e===Be)return Q.LUMINANCE;if(e===Fe)return Q.LUMINANCE_ALPHA;if(e===$e)return Q.DEPTH_COMPONENT;if(e===je)return Q.DEPTH_STENCIL;if(e===A)return Q.FUNC_ADD;if(e===P)return Q.FUNC_SUBTRACT;if(e===L)return Q.FUNC_REVERSE_SUBTRACT;if(e===k)return Q.ZERO;if(e===D)return Q.ONE;if(e===N)return Q.SRC_COLOR;if(e===H)return Q.ONE_MINUS_SRC_COLOR;if(e===B)return Q.SRC_ALPHA;if(e===F)return Q.ONE_MINUS_SRC_ALPHA;if(e===U)return Q.DST_ALPHA;if(e===$)return Q.ONE_MINUS_DST_ALPHA;if(e===j)return Q.DST_COLOR;if(e===z)return Q.ONE_MINUS_DST_COLOR;if(e===V)return Q.SRC_ALPHA_SATURATE;if((e===ze||e===Ve||e===Ge||e===We)&&null!==(t=bt.get("WEBGL_compressed_texture_s3tc"))){if(e===ze)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Ve)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Ge)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===We)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===qe||e===Xe||e===Ze||e===Ye)&&null!==(t=bt.get("WEBGL_compressed_texture_pvrtc"))){if(e===qe)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Xe)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Ze)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Ye)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===Je&&null!==(t=bt.get("WEBGL_compressed_texture_etc1")))return t.COMPRESSED_RGB_ETC1_WEBGL;if((e===O||e===I)&&null!==(t=bt.get("EXT_blend_minmax"))){if(e===O)return t.MIN_EXT;if(e===I)return t.MAX_EXT}return e===ke&&null!==(t=bt.get("WEBGL_depth_texture"))?t.UNSIGNED_INT_24_8_WEBGL:0}this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){var e=bt.get("WEBGL_lose_context");e&&e.loseContext()},this.getMaxAnisotropy=function(){return xt.getMaxAnisotropy()},this.getPrecision=function(){return xt.precision},this.getPixelRatio=function(){return Ke},this.setPixelRatio=function(e){void 0!==e&&(Ke=e,this.setSize(pe,Ue,!1))},this.getSize=function(){return{width:pe,height:Ue}},this.setSize=function(e,i,n){var r=Dt.getDevice();r&&r.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(pe=e,Ue=i,t.width=e*Ke,t.height=i*Ke,!1!==n&&(t.style.width=e+"px",t.style.height=i+"px"),this.setViewport(0,0,e,i))},this.getDrawingBufferSize=function(){return{width:pe*Ke,height:Ue*Ke}},this.setDrawingBufferSize=function(e,i,n){pe=e,Ue=i,Ke=n,t.width=e*n,t.height=i*n,this.setViewport(0,0,e,i)},this.setViewport=function(e,t,i,n){rt.set(e,Ue-t-n,i,n),_t.viewport(he.copy(rt).multiplyScalar(Ke))},this.setScissor=function(e,t,i,n){Qe.set(e,Ue-t-n,i,n),_t.scissor(ce.copy(Qe).multiplyScalar(Ke))},this.setScissorTest=function(e){_t.setScissorTest(nt=e)},this.getClearColor=kt.getClearColor,this.setClearColor=kt.setClearColor,this.getClearAlpha=kt.getClearAlpha,this.setClearAlpha=kt.setClearAlpha,this.clear=function(e,t,i){var n=0;(void 0===e||e)&&(n|=Q.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=Q.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=Q.STENCIL_BUFFER_BIT),Q.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,i,n){this.setRenderTarget(e),this.clear(t,i,n)},this.resetGLState=Ut,this.dispose=function(){t.removeEventListener("webglcontextlost",Gt,!1),It.dispose()},this.renderBufferImmediate=function(e,t,i){_t.initAttributes();var n=Et.get(e);e.hasPositions&&!n.position&&(n.position=Q.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=Q.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=Q.createBuffer()),e.hasColors&&!n.color&&(n.color=Q.createBuffer());var r=t.getAttributes();if(e.hasPositions&&(Q.bindBuffer(Q.ARRAY_BUFFER,n.position),Q.bufferData(Q.ARRAY_BUFFER,e.positionArray,Q.DYNAMIC_DRAW),_t.enableAttribute(r.position),Q.vertexAttribPointer(r.position,3,Q.FLOAT,!1,0,0)),e.hasNormals){if(Q.bindBuffer(Q.ARRAY_BUFFER,n.normal),!i.isMeshPhongMaterial&&!i.isMeshStandardMaterial&&!i.isMeshNormalMaterial&&i.shading===y)for(var o=0,a=3*e.count;o<a;o+=9){var s=e.normalArray,l=(s[o+0]+s[o+3]+s[o+6])/3,c=(s[o+1]+s[o+4]+s[o+7])/3,u=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=l,s[o+1]=c,s[o+2]=u,s[o+3]=l,s[o+4]=c,s[o+5]=u,s[o+6]=l,s[o+7]=c,s[o+8]=u}Q.bufferData(Q.ARRAY_BUFFER,e.normalArray,Q.DYNAMIC_DRAW),_t.enableAttribute(r.normal),Q.vertexAttribPointer(r.normal,3,Q.FLOAT,!1,0,0)}e.hasUvs&&i.map&&(Q.bindBuffer(Q.ARRAY_BUFFER,n.uv),Q.bufferData(Q.ARRAY_BUFFER,e.uvArray,Q.DYNAMIC_DRAW),_t.enableAttribute(r.uv),Q.vertexAttribPointer(Mt.uv,2,Q.FLOAT,!1,0,0)),e.hasColors&&i.vertexColors!==x&&(Q.bindBuffer(Q.ARRAY_BUFFER,n.color),Q.bufferData(Q.ARRAY_BUFFER,e.colorArray,Q.DYNAMIC_DRAW),_t.enableAttribute(r.color),Q.vertexAttribPointer(r.color,3,Q.FLOAT,!1,0,0)),_t.disableUnusedAttributes(),Q.drawArrays(Q.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,i,n,r,o){_t.setMaterial(n);var a=Kt(e,t,n,r),s=i.id+"_"+a.id+"_"+(!0===n.wireframe),l=!1;s!==ae&&(ae=s,l=!0);var c=r.morphTargetInfluences;if(void 0!==c){for(var u=[],h=0,d=c.length;h<d;h++){var p=c[h];u.push([p,h])}u.sort(Xt),u.length>8&&(u.length=8);var f=i.morphAttributes;for(h=0,d=u.length;h<d;h++){p=u[h];if(b[h]=p[0],0!==p[0]){var m=p[1];!0===n.morphTargets&&f.position&&i.addAttribute("morphTarget"+h,f.position[m]),!0===n.morphNormals&&f.normal&&i.addAttribute("morphNormal"+h,f.normal[m])}else!0===n.morphTargets&&i.removeAttribute("morphTarget"+h),!0===n.morphNormals&&i.removeAttribute("morphNormal"+h)}h=u.length;for(var g=b.length;h<g;h++)b[h]=0;a.getUniforms().setValue(Q,"morphTargetInfluences",b),l=!0}m=i.index;var v,y=i.attributes.position,x=1;!0===n.wireframe&&(m=At.getWireframeAttribute(i),x=2);var _=Nt;null!==m&&(v=Mt.get(m),(_=Ht).setIndex(v)),l&&(!function(e,t,i,n){if(i&&i.isInstancedBufferGeometry&&null===bt.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===n&&(n=0);_t.initAttributes();var r=i.attributes,o=t.getAttributes(),a=e.defaultAttributeValues;for(var s in o){var l=o[s];if(l>=0){var c=r[s];if(void 0!==c){var u=c.normalized,h=c.itemSize,d=Mt.get(c),p=d.buffer,f=d.type,m=d.bytesPerElement;if(c.isInterleavedBufferAttribute){var g=c.data,v=g.stride,y=c.offset;g&&g.isInstancedInterleavedBuffer?(_t.enableAttributeAndDivisor(l,g.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=g.meshPerAttribute*g.count)):_t.enableAttribute(l),Q.bindBuffer(Q.ARRAY_BUFFER,p),Q.vertexAttribPointer(l,h,f,u,v*m,(n*v+y)*m)}else c.isInstancedBufferAttribute?(_t.enableAttributeAndDivisor(l,c.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=c.meshPerAttribute*c.count)):_t.enableAttribute(l),Q.bindBuffer(Q.ARRAY_BUFFER,p),Q.vertexAttribPointer(l,h,f,u,0,n*h*m)}else if(void 0!==a){var b=a[s];if(void 0!==b)switch(b.length){case 2:Q.vertexAttrib2fv(l,b);break;case 3:Q.vertexAttrib3fv(l,b);break;case 4:Q.vertexAttrib4fv(l,b);break;default:Q.vertexAttrib1fv(l,b)}}}}_t.disableUnusedAttributes()}(n,a,i),null!==m&&Q.bindBuffer(Q.ELEMENT_ARRAY_BUFFER,v.buffer));var w=0;null!==m?w=m.count:void 0!==y&&(w=y.count);var E=i.drawRange.start*x,T=i.drawRange.count*x,M=null!==o?o.start*x:0,S=null!==o?o.count*x:1/0,C=Math.max(E,M),R=Math.min(w,E+T,M+S)-1,A=Math.max(0,R-C+1);if(0!==A){if(r.isMesh)if(!0===n.wireframe)_t.setLineWidth(n.wireframeLinewidth*Bt()),_.setMode(Q.LINES);else switch(r.drawMode){case et:_.setMode(Q.TRIANGLES);break;case tt:_.setMode(Q.TRIANGLE_STRIP);break;case it:_.setMode(Q.TRIANGLE_FAN)}else if(r.isLine){var P=n.linewidth;void 0===P&&(P=1),_t.setLineWidth(P*Bt()),r.isLineSegments?_.setMode(Q.LINES):r.isLineLoop?_.setMode(Q.LINE_LOOP):_.setMode(Q.LINE_STRIP)}else r.isPoints&&_.setMode(Q.POINTS);i&&i.isInstancedBufferGeometry?i.maxInstancedCount>0&&_.renderInstances(i,C,A):_.render(C,A)}},this.compile=function(e,t){f=[],e.traverse(function(e){e.isLight&&f.push(e)}),ii(f,t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var i=0;i<t.material.length;i++)Jt(t.material[i],e.fog,t);else Jt(t.material,e.fog,t)})},this.animate=function(e){(Dt.getDevice()||window).requestAnimationFrame(function t(){e(),(Dt.getDevice()||window).requestAnimationFrame(t)})},this.render=function(e,t,i,n){if(t&&t.isCamera){ae="",oe=-1,se=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),Dt.enabled&&(t=Dt.getCamera(t)),ct.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ot.setFromMatrix(ct),f.length=0,_.length=0,w.length=0,lt=this.localClippingEnabled,st=at.init(this.clippingPlanes,lt,t),(m=It.get(e,t)).init(),function e(t,i,n){if(!t.visible)return;var r=t.layers.test(i.layers);if(r)if(t.isLight)f.push(t);else if(t.isSprite)t.frustumCulled&&!ot.intersectsSprite(t)||_.push(t);else if(t.isLensFlare)w.push(t);else if(t.isImmediateRenderObject)n&&ut.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ct),m.push(t,null,t.material,ut.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||ot.intersectsObject(t))){n&&ut.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ct);var o=Pt.update(t),a=t.material;if(Array.isArray(a))for(var s=o.groups,l=0,c=s.length;l<c;l++){var u=s[l],h=a[u.materialIndex];h&&h.visible&&m.push(t,o,h,ut.z,u)}else a.visible&&m.push(t,o,a,ut.z,null)}var d=t.children;for(var l=0,c=d.length;l<c;l++)e(d[l],i,n)}(e,t,ee.sortObjects),m.finish(),!0===ee.sortObjects&&m.sort(),st&&at.beginShadows(),function(e){for(var t=0,i=0,n=e.length;i<n;i++){var r=e[i];r.castShadow&&(mt.shadows[t]=r,t++)}mt.shadows.length=t}(f),$t.render(e,t),ii(f,t),st&&at.endShadows(),vt.frame++,vt.calls=0,vt.vertices=0,vt.faces=0,vt.points=0,void 0===i&&(i=null),this.setRenderTarget(i),kt.render(e,t,n);var r=m.opaque,o=m.transparent;if(e.overrideMaterial){var a=e.overrideMaterial;r.length&&Zt(r,e,t,a),o.length&&Zt(o,e,t,a)}else r.length&&Zt(r,e,t),o.length&&Zt(o,e,t);zt.render(e,t),Vt.render(e,t,he),i&&Tt.updateRenderTargetMipmap(i),_t.buffers.depth.setTest(!0),_t.buffers.depth.setMask(!0),_t.buffers.color.setMask(!0),t.isArrayCamera&&ee.setScissorTest(!1),Dt.enabled&&Dt.submitFrame()}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(e,t){_t.setCullFace(e),_t.setFlipSided(t===d)},this.allocTextureUnit=function(){var e=de;return e>=xt.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+xt.maxTextures),de+=1,e},this.setTexture2D=(jt=!1,function(e,t){e&&e.isWebGLRenderTarget&&(jt||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),jt=!0),e=e.texture),Tt.setTexture2D(e,t)}),this.setTexture=function(){var e=!1;return function(t,i){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),Tt.setTexture2D(t,i)}}(),this.setTextureCube=function(){var e=!1;return function(t,i){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?Tt.setTextureCube(t,i):Tt.setTextureCubeDynamic(t,i)}}(),this.getRenderTarget=function(){return ie},this.setRenderTarget=function(e){ie=e,e&&void 0===Et.get(e).__webglFramebuffer&&Tt.setupRenderTarget(e);var t,i=e&&e.isWebGLRenderTargetCube;if(e){var n=Et.get(e);t=i?n.__webglFramebuffer[e.activeCubeFace]:n.__webglFramebuffer,ce.copy(e.scissor),ue=e.scissorTest,he.copy(e.viewport)}else t=null,ce.copy(Qe).multiplyScalar(Ke),ue=nt,he.copy(rt).multiplyScalar(Ke);if(re!==t&&(Q.bindFramebuffer(Q.FRAMEBUFFER,t),re=t),_t.scissor(ce),_t.setScissorTest(ue),_t.viewport(he),i){var r=Et.get(e.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,r.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,i,n,r,o){if(e&&e.isWebGLRenderTarget){var a=Et.get(e).__webglFramebuffer;if(a){var s=!1;a!==re&&(Q.bindFramebuffer(Q.FRAMEBUFFER,a),s=!0);try{var l=e.texture,c=l.format,u=l.type;if(c!==He&&ni(c)!==Q.getParameter(Q.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(u===Ee||ni(u)===Q.getParameter(Q.IMPLEMENTATION_COLOR_READ_TYPE)||u===Ae&&(bt.get("OES_texture_float")||bt.get("WEBGL_color_buffer_float"))||u===Pe&&bt.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Q.checkFramebufferStatus(Q.FRAMEBUFFER)===Q.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-n&&i>=0&&i<=e.height-r&&Q.readPixels(t,i,n,r,ni(c),ni(u),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&Q.bindFramebuffer(Q.FRAMEBUFFER,re)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function ir(e,t){this.name="",this.color=new gi(e),this.density=void 0!==t?t:25e-5}function nr(e,t,i){this.name="",this.color=new gi(e),this.near=void 0!==t?t:1,this.far=void 0!==i?i:1e3}function rr(){Zi.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function or(e,t,i,n,r){Zi.call(this),this.lensFlares=[],this.positionScreen=new St,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,i,n,r)}function ar(e){Oi.call(this),this.type="SpriteMaterial",this.color=new gi(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)}function sr(e){Zi.call(this),this.type="Sprite",this.material=void 0!==e?e:new ar}function lr(){Zi.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function cr(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new Ct)}}function ur(){Zi.call(this),this.type="Bone"}function hr(e,t){In.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ct,this.bindMatrixInverse=new Ct;var i=new cr(this.initBones());this.bind(i,this.matrixWorld),this.normalizeSkinWeights()}function dr(e){Oi.call(this),this.type="LineBasicMaterial",this.color=new gi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function pr(e,t,i){if(1===i)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new fr(e,t);Zi.call(this),this.type="Line",this.geometry=void 0!==e?e:new Tn,this.material=void 0!==t?t:new dr({color:16777215*Math.random()})}function fr(e,t){pr.call(this,e,t),this.type="LineSegments"}function mr(e,t){pr.call(this,e,t),this.type="LineLoop"}function gr(e){Oi.call(this),this.type="PointsMaterial",this.color=new gi(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}function vr(e,t){Zi.call(this),this.type="Points",this.geometry=void 0!==e?e:new Tn,this.material=void 0!==t?t:new gr({color:16777215*Math.random()})}function yr(){Zi.call(this),this.type="Group"}function br(e,t,i,n,r,o,a,s,l){_t.call(this,e,t,i,n,r,o,a,s,l),this.generateMipmaps=!1;var c=this;!function t(){requestAnimationFrame(t),e.readyState>=e.HAVE_CURRENT_DATA&&(c.needsUpdate=!0)}()}function xr(e,t,i,n,r,o,a,s,l,c,u,h){_t.call(this,null,o,a,s,l,c,n,r,u,h),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function _r(e,t,i,n,r,o,a,s,l){_t.call(this,e,t,i,n,r,o,a,s,l),this.needsUpdate=!0}function wr(e,t,i,n,r,o,a,s,l,c){if((c=void 0!==c?c:$e)!==$e&&c!==je)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&c===$e&&(i=Se),void 0===i&&c===je&&(i=ke),_t.call(this,null,n,r,o,a,s,c,i,l),this.image={width:e,height:t},this.magFilter=void 0!==a?a:ve,this.minFilter=void 0!==s?s:ve,this.flipY=!1,this.generateMipmaps=!1}function Er(e){Tn.call(this),this.type="WireframeGeometry";var t,i,n,r,o,a,s,l,c,u,h=[],d=[0,0],p={},f=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,n=m.length;t<n;t++){var g=m[t];for(i=0;i<3;i++)s=g[f[i]],l=g[f[(i+1)%3]],d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===p[c=d[0]+","+d[1]]&&(p[c]={index1:d[0],index2:d[1]})}for(c in p)a=p[c],u=e.vertices[a.index1],h.push(u.x,u.y,u.z),u=e.vertices[a.index2],h.push(u.x,u.y,u.z)}else if(e&&e.isBufferGeometry){var v,y,b,x,_,w,E;if(u=new St,null!==e.index){for(v=e.attributes.position,y=e.index,0===(b=e.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),r=0,o=b.length;r<o;++r)for(t=_=(x=b[r]).start,n=_+x.count;t<n;t+=3)for(i=0;i<3;i++)s=y.getX(t+i),l=y.getX(t+(i+1)%3),d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===p[c=d[0]+","+d[1]]&&(p[c]={index1:d[0],index2:d[1]});for(c in p)a=p[c],u.fromBufferAttribute(v,a.index1),h.push(u.x,u.y,u.z),u.fromBufferAttribute(v,a.index2),h.push(u.x,u.y,u.z)}else for(t=0,n=(v=e.attributes.position).count/3;t<n;t++)for(i=0;i<3;i++)w=3*t+i,u.fromBufferAttribute(v,w),h.push(u.x,u.y,u.z),E=3*t+(i+1)%3,u.fromBufferAttribute(v,E),h.push(u.x,u.y,u.z)}this.addAttribute("position",new xn(h,3))}function Tr(e,t,i){hn.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:i},this.fromBufferGeometry(new Mr(e,t,i)),this.mergeVertices()}function Mr(e,t,i){Tn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:i};var n,r,o=[],a=[],s=[],l=[],c=new St,u=new St,h=new St,d=new St,p=new St,f=t+1;for(n=0;n<=i;n++){var m=n/i;for(r=0;r<=t;r++){var g=r/t;u=e(g,m,u),a.push(u.x,u.y,u.z),g-1e-5>=0?(h=e(g-1e-5,m,h),d.subVectors(u,h)):(h=e(g+1e-5,m,h),d.subVectors(h,u)),m-1e-5>=0?(h=e(g,m-1e-5,h),p.subVectors(u,h)):(h=e(g,m+1e-5,h),p.subVectors(h,u)),c.crossVectors(d,p).normalize(),s.push(c.x,c.y,c.z),l.push(g,m)}}for(n=0;n<i;n++)for(r=0;r<t;r++){var v=n*f+r,y=n*f+r+1,b=(n+1)*f+r+1,x=(n+1)*f+r;o.push(v,y,x),o.push(y,b,x)}this.setIndex(o),this.addAttribute("position",new xn(a,3)),this.addAttribute("normal",new xn(s,3)),this.addAttribute("uv",new xn(l,2))}function Sr(e,t,i,n){hn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n},this.fromBufferGeometry(new Cr(e,t,i,n)),this.mergeVertices()}function Cr(e,t,i,n){Tn.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n},i=i||1;var r=[],o=[];function a(e,t,i,n){var r,o,a=Math.pow(2,n),l=[];for(r=0;r<=a;r++){l[r]=[];var c=e.clone().lerp(i,r/a),u=t.clone().lerp(i,r/a),h=a-r;for(o=0;o<=h;o++)l[r][o]=0===o&&r===a?c:c.clone().lerp(u,o/h)}for(r=0;r<a;r++)for(o=0;o<2*(a-r)-1;o++){var d=Math.floor(o/2);o%2==0?(s(l[r][d+1]),s(l[r+1][d]),s(l[r][d])):(s(l[r][d+1]),s(l[r+1][d+1]),s(l[r+1][d]))}}function s(e){r.push(e.x,e.y,e.z)}function l(t,i){var n=3*t;i.x=e[n+0],i.y=e[n+1],i.z=e[n+2]}function c(e,t,i,n){n<0&&1===e.x&&(o[t]=e.x-1),0===i.x&&0===i.z&&(o[t]=n/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}!function(e){for(var i=new St,n=new St,r=new St,o=0;o<t.length;o+=3)l(t[o+0],i),l(t[o+1],n),l(t[o+2],r),a(i,n,r,e)}(n=n||0),function(e){for(var t=new St,i=0;i<r.length;i+=3)t.x=r[i+0],t.y=r[i+1],t.z=r[i+2],t.normalize().multiplyScalar(e),r[i+0]=t.x,r[i+1]=t.y,r[i+2]=t.z}(i),function(){for(var e=new St,t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];var i=u(e)/2/Math.PI+.5,n=(a=e,Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5);o.push(i,1-n)}var a;(function(){for(var e=new St,t=new St,i=new St,n=new St,a=new pt,s=new pt,l=new pt,h=0,d=0;h<r.length;h+=9,d+=6){e.set(r[h+0],r[h+1],r[h+2]),t.set(r[h+3],r[h+4],r[h+5]),i.set(r[h+6],r[h+7],r[h+8]),a.set(o[d+0],o[d+1]),s.set(o[d+2],o[d+3]),l.set(o[d+4],o[d+5]),n.copy(e).add(t).add(i).divideScalar(3);var p=u(n);c(a,d+0,e,p),c(s,d+2,t,p),c(l,d+4,i,p)}})(),function(){for(var e=0;e<o.length;e+=6){var t=o[e+0],i=o[e+2],n=o[e+4],r=Math.max(t,i,n),a=Math.min(t,i,n);r>.9&&a<.1&&(t<.2&&(o[e+0]+=1),i<.2&&(o[e+2]+=1),n<.2&&(o[e+4]+=1))}}()}(),this.addAttribute("position",new xn(r,3)),this.addAttribute("normal",new xn(r.slice(),3)),this.addAttribute("uv",new xn(o,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function Rr(e,t){hn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ar(e,t)),this.mergeVertices()}function Ar(e,t){Cr.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Pr(e,t){hn.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Lr(e,t)),this.mergeVertices()}function Lr(e,t){Cr.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Or(e,t){hn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ir(e,t)),this.mergeVertices()}function Ir(e,t){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];Cr.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function kr(e,t){hn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Dr(e,t)),this.mergeVertices()}function Dr(e,t){var i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n];Cr.call(this,r,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Nr(e,t,i,n,r,o){hn.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:n,closed:r},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new Hr(e,t,i,n,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Hr(e,t,i,n,r){Tn.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:n,closed:r},t=t||64,i=i||1,n=n||8,r=r||!1;var o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,l=new St,c=new St,u=new pt,h=[],d=[],p=[],f=[];function m(r){var a=e.getPointAt(r/t),u=o.normals[r],p=o.binormals[r];for(s=0;s<=n;s++){var f=s/n*Math.PI*2,m=Math.sin(f),g=-Math.cos(f);c.x=g*u.x+m*p.x,c.y=g*u.y+m*p.y,c.z=g*u.z+m*p.z,c.normalize(),d.push(c.x,c.y,c.z),l.x=a.x+i*c.x,l.y=a.y+i*c.y,l.z=a.z+i*c.z,h.push(l.x,l.y,l.z)}}!function(){for(a=0;a<t;a++)m(a);m(!1===r?t:0),function(){for(a=0;a<=t;a++)for(s=0;s<=n;s++)u.x=a/t,u.y=s/n,p.push(u.x,u.y)}(),function(){for(s=1;s<=t;s++)for(a=1;a<=n;a++){var e=(n+1)*(s-1)+(a-1),i=(n+1)*s+(a-1),r=(n+1)*s+a,o=(n+1)*(s-1)+a;f.push(e,i,o),f.push(i,r,o)}}()}(),this.setIndex(f),this.addAttribute("position",new xn(h,3)),this.addAttribute("normal",new xn(d,3)),this.addAttribute("uv",new xn(p,2))}function Br(e,t,i,n,r,o,a){hn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Fr(e,t,i,n,r,o)),this.mergeVertices()}function Fr(e,t,i,n,r,o){Tn.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:o},e=e||100,t=t||40,i=Math.floor(i)||64,n=Math.floor(n)||8,r=r||2,o=o||3;var a,s,l=[],c=[],u=[],h=[],d=new St,p=new St,f=new St,m=new St,g=new St,v=new St,y=new St;for(a=0;a<=i;++a){var b=a/i*r*Math.PI*2;for(C(b,r,o,e,f),C(b+.01,r,o,e,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=n;++s){var x=s/n*Math.PI*2,_=-t*Math.cos(x),w=t*Math.sin(x);d.x=f.x+(_*y.x+w*g.x),d.y=f.y+(_*y.y+w*g.y),d.z=f.z+(_*y.z+w*g.z),c.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),u.push(p.x,p.y,p.z),h.push(a/i),h.push(s/n)}}for(s=1;s<=i;s++)for(a=1;a<=n;a++){var E=(n+1)*(s-1)+(a-1),T=(n+1)*s+(a-1),M=(n+1)*s+a,S=(n+1)*(s-1)+a;l.push(E,T,S),l.push(T,M,S)}function C(e,t,i,n,r){var o=Math.cos(e),a=Math.sin(e),s=i/t*e,l=Math.cos(s);r.x=n*(2+l)*.5*o,r.y=n*(2+l)*a*.5,r.z=n*Math.sin(s)*.5}this.setIndex(l),this.addAttribute("position",new xn(c,3)),this.addAttribute("normal",new xn(u,3)),this.addAttribute("uv",new xn(h,2))}function Ur(e,t,i,n,r){hn.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new $r(e,t,i,n,r)),this.mergeVertices()}function $r(e,t,i,n,r){Tn.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},e=e||100,t=t||40,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var o,a,s=[],l=[],c=[],u=[],h=new St,d=new St,p=new St;for(o=0;o<=i;o++)for(a=0;a<=n;a++){var f=a/n*r,m=o/i*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(f),d.y=(e+t*Math.cos(m))*Math.sin(f),d.z=t*Math.sin(m),l.push(d.x,d.y,d.z),h.x=e*Math.cos(f),h.y=e*Math.sin(f),p.subVectors(d,h).normalize(),c.push(p.x,p.y,p.z),u.push(a/n),u.push(o/i)}for(o=1;o<=i;o++)for(a=1;a<=n;a++){var g=(n+1)*o+a-1,v=(n+1)*(o-1)+a-1,y=(n+1)*(o-1)+a,b=(n+1)*o+a;s.push(g,v,b),s.push(v,y,b)}this.setIndex(s),this.addAttribute("position",new xn(l,3)),this.addAttribute("normal",new xn(c,3)),this.addAttribute("uv",new xn(u,2))}er.prototype=Object.assign(Object.create(Ki.prototype),{constructor:er,isArrayCamera:!0}),ir.prototype.isFogExp2=!0,ir.prototype.clone=function(){return new ir(this.color.getHex(),this.density)},ir.prototype.toJSON=function(e){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},nr.prototype.isFog=!0,nr.prototype.clone=function(){return new nr(this.color.getHex(),this.near,this.far)},nr.prototype.toJSON=function(e){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},rr.prototype=Object.assign(Object.create(Zi.prototype),{constructor:rr,copy:function(e,t){return Zi.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Zi.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),or.prototype=Object.assign(Object.create(Zi.prototype),{constructor:or,isLensFlare:!0,copy:function(e){Zi.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,i=e.lensFlares.length;t<i;t++)this.lensFlares.push(e.lensFlares[t]);return this},add:function(e,t,i,n,r,o){void 0===t&&(t=-1),void 0===i&&(i=0),void 0===o&&(o=1),void 0===r&&(r=new gi(16777215)),void 0===n&&(n=T),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:e,size:t,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:r,blending:n})},updateLensFlares:function(){var e,t,i=this.lensFlares.length,n=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(e=0;e<i;e++)(t=this.lensFlares[e]).x=this.positionScreen.x+n*t.distance,t.y=this.positionScreen.y+r*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)}}),ar.prototype=Object.create(Oi.prototype),ar.prototype.constructor=ar,ar.prototype.isSpriteMaterial=!0,ar.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},sr.prototype=Object.assign(Object.create(Zi.prototype),{constructor:sr,isSprite:!0,raycast:(Bn=new St,Fn=new St,Un=new St,function(e,t){Fn.setFromMatrixPosition(this.matrixWorld),e.ray.closestPointToPoint(Fn,Bn),Un.setFromMatrixScale(this.matrixWorld);var i=Un.x*Un.y/4;if(!(Fn.distanceToSquared(Bn)>i)){var n=e.ray.origin.distanceTo(Bn);n<e.near||n>e.far||t.push({distance:n,point:Bn.clone(),face:null,object:this})}}),clone:function(){return new this.constructor(this.material).copy(this)}}),lr.prototype=Object.assign(Object.create(Zi.prototype),{constructor:lr,copy:function(e){Zi.prototype.copy.call(this,e,!1);for(var t=e.levels,i=0,n=t.length;i<n;i++){var r=t[i];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var i=this.levels,n=0;n<i.length&&!(t<i[n].distance);n++);i.splice(n,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,i=1,n=t.length;i<n&&!(e<t[i].distance);i++);return t[i-1].object},raycast:($n=new St,function(e,t){$n.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo($n);this.getObjectForDistance(i).raycast(e,t)}),update:function(){var e=new St,t=new St;return function(i){var n=this.levels;if(n.length>1){e.setFromMatrixPosition(i.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var r=e.distanceTo(t);n[0].object.visible=!0;for(var o=1,a=n.length;o<a&&r>=n[o].distance;o++)n[o-1].object.visible=!1,n[o].object.visible=!0;for(;o<a;o++)n[o].object.visible=!1}}}(),toJSON:function(e){var t=Zi.prototype.toJSON.call(this,e);t.object.levels=[];for(var i=this.levels,n=0,r=i.length;n<r;n++){var o=i[n];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Object.assign(cr.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var i=new Ct;this.bones[e]&&i.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(i)}},pose:function(){var e,t,i;for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(jn=new Ct,zn=new Ct,function(){for(var e=this.bones,t=this.boneInverses,i=this.boneMatrices,n=this.boneTexture,r=0,o=e.length;r<o;r++){var a=e[r]?e[r].matrixWorld:zn;jn.multiplyMatrices(a,t[r]),jn.toArray(i,16*r)}void 0!==n&&(n.needsUpdate=!0)}),clone:function(){return new cr(this.bones,this.boneInverses)}}),ur.prototype=Object.assign(Object.create(Zi.prototype),{constructor:ur,isBone:!0}),hr.prototype=Object.assign(Object.create(In.prototype),{constructor:hr,isSkinnedMesh:!0,initBones:function(){var e,t,i,n,r=[];if(this.geometry&&void 0!==this.geometry.bones){for(i=0,n=this.geometry.bones.length;i<n;i++)t=this.geometry.bones[i],e=new ur,r.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(i=0,n=this.geometry.bones.length;i<n;i++)-1!==(t=this.geometry.bones[i]).parent&&null!==t.parent&&void 0!==r[t.parent]?r[t.parent].add(r[i]):this.add(r[i])}return this.updateMatrixWorld(!0),r},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var i=this.geometry.skinWeights[t];(e=1/i.lengthManhattan())!==1/0?i.multiplyScalar(e):i.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new wt,r=this.geometry.attributes.skinWeight;for(t=0;t<r.count;t++)n.x=r.getX(t),n.y=r.getY(t),n.z=r.getZ(t),n.w=r.getW(t),(e=1/n.lengthManhattan())!==1/0?n.multiplyScalar(e):n.set(1,0,0,0),r.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(e){In.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),dr.prototype=Object.create(Oi.prototype),dr.prototype.constructor=dr,dr.prototype.isLineBasicMaterial=!0,dr.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},pr.prototype=Object.assign(Object.create(Zi.prototype),{constructor:pr,isLine:!0,raycast:function(){var e=new Ct,t=new Pn,i=new Ni;return function(n,r){var o=n.linePrecision,a=o*o,s=this.geometry,l=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),i.copy(s.boundingSphere),i.applyMatrix4(l),!1!==n.ray.intersectsSphere(i)){e.getInverse(l),t.copy(n.ray).applyMatrix4(e);var c=new St,u=new St,h=new St,d=new St,p=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var f=s.index,m=s.attributes.position.array;if(null!==f)for(var g=f.array,v=0,y=g.length-1;v<y;v+=p){var b=g[v],x=g[v+1];if(c.fromArray(m,3*b),u.fromArray(m,3*x),!(t.distanceSqToSegment(c,u,d,h)>a))d.applyMatrix4(this.matrixWorld),(E=n.ray.origin.distanceTo(d))<n.near||E>n.far||r.push({distance:E,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}else for(v=0,y=m.length/3-1;v<y;v+=p){if(c.fromArray(m,3*v),u.fromArray(m,3*v+3),!(t.distanceSqToSegment(c,u,d,h)>a))d.applyMatrix4(this.matrixWorld),(E=n.ray.origin.distanceTo(d))<n.near||E>n.far||r.push({distance:E,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else if(s.isGeometry){var _=s.vertices,w=_.length;for(v=0;v<w-1;v+=p){var E;if(!(t.distanceSqToSegment(_[v],_[v+1],d,h)>a))d.applyMatrix4(this.matrixWorld),(E=n.ray.origin.distanceTo(d))<n.near||E>n.far||r.push({distance:E,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),fr.prototype=Object.assign(Object.create(pr.prototype),{constructor:fr,isLineSegments:!0}),mr.prototype=Object.assign(Object.create(pr.prototype),{constructor:mr,isLineLoop:!0}),gr.prototype=Object.create(Oi.prototype),gr.prototype.constructor=gr,gr.prototype.isPointsMaterial=!0,gr.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},vr.prototype=Object.assign(Object.create(Zi.prototype),{constructor:vr,isPoints:!0,raycast:function(){var e=new Ct,t=new Pn,i=new Ni;return function(n,r){var o=this,a=this.geometry,s=this.matrixWorld,l=n.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),i.copy(a.boundingSphere),i.applyMatrix4(s),i.radius+=l,!1!==n.ray.intersectsSphere(i)){e.getInverse(s),t.copy(n.ray).applyMatrix4(e);var c=l/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,h=new St;if(a.isBufferGeometry){var d=a.index,p=a.attributes.position.array;if(null!==d)for(var f=d.array,m=0,g=f.length;m<g;m++){var v=f[m];h.fromArray(p,3*v),x(h,v)}else{m=0;for(var y=p.length/3;m<y;m++)h.fromArray(p,3*m),x(h,m)}}else{var b=a.vertices;for(m=0,y=b.length;m<y;m++)x(b[m],m)}}function x(e,i){var a=t.distanceSqToPoint(e);if(a<u){var l=t.closestPointToPoint(e);l.applyMatrix4(s);var c=n.ray.origin.distanceTo(l);if(c<n.near||c>n.far)return;r.push({distance:c,distanceToRay:Math.sqrt(a),point:l.clone(),index:i,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),yr.prototype=Object.assign(Object.create(Zi.prototype),{constructor:yr}),br.prototype=Object.create(_t.prototype),br.prototype.constructor=br,xr.prototype=Object.create(_t.prototype),xr.prototype.constructor=xr,xr.prototype.isCompressedTexture=!0,_r.prototype=Object.create(_t.prototype),_r.prototype.constructor=_r,wr.prototype=Object.create(_t.prototype),wr.prototype.constructor=wr,wr.prototype.isDepthTexture=!0,Er.prototype=Object.create(Tn.prototype),Er.prototype.constructor=Er,Tr.prototype=Object.create(hn.prototype),Tr.prototype.constructor=Tr,Mr.prototype=Object.create(Tn.prototype),Mr.prototype.constructor=Mr,Sr.prototype=Object.create(hn.prototype),Sr.prototype.constructor=Sr,Cr.prototype=Object.create(Tn.prototype),Cr.prototype.constructor=Cr,Rr.prototype=Object.create(hn.prototype),Rr.prototype.constructor=Rr,Ar.prototype=Object.create(Cr.prototype),Ar.prototype.constructor=Ar,Pr.prototype=Object.create(hn.prototype),Pr.prototype.constructor=Pr,Lr.prototype=Object.create(Cr.prototype),Lr.prototype.constructor=Lr,Or.prototype=Object.create(hn.prototype),Or.prototype.constructor=Or,Ir.prototype=Object.create(Cr.prototype),Ir.prototype.constructor=Ir,kr.prototype=Object.create(hn.prototype),kr.prototype.constructor=kr,Dr.prototype=Object.create(Cr.prototype),Dr.prototype.constructor=Dr,Nr.prototype=Object.create(hn.prototype),Nr.prototype.constructor=Nr,Hr.prototype=Object.create(Tn.prototype),Hr.prototype.constructor=Hr,Br.prototype=Object.create(hn.prototype),Br.prototype.constructor=Br,Fr.prototype=Object.create(Tn.prototype),Fr.prototype.constructor=Fr,Ur.prototype=Object.create(hn.prototype),Ur.prototype.constructor=Ur,$r.prototype=Object.create(Tn.prototype),$r.prototype.constructor=$r;var jr={area:function(e){for(var t=e.length,i=0,n=t-1,r=0;r<t;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return.5*i},triangulate:function(){function e(e,t,i,n,r,o){var a,s,l,c,u,h,d,p,f,m,g,v,y,b,x,_,w;if(s=e[o[t]].x,l=e[o[t]].y,c=e[o[i]].x,u=e[o[i]].y,h=e[o[n]].x,(c-s)*((d=e[o[n]].y)-l)-(u-l)*(h-s)<=0)return!1;for(m=h-c,g=d-u,v=s-h,y=l-d,b=c-s,x=u-l,a=0;a<r;a++)if(p=e[o[a]].x,f=e[o[a]].y,!(p===s&&f===l||p===c&&f===u||p===h&&f===d)&&(_=b*(f-l)-x*(p-s),w=v*(f-d)-y*(p-h),m*(f-u)-g*(p-c)>=-Number.EPSILON&&w>=-Number.EPSILON&&_>=-Number.EPSILON))return!1;return!0}return function(t,i){var n=t.length;if(n<3)return null;var r,o,a,s=[],l=[],c=[];if(jr.area(t)>0)for(o=0;o<n;o++)l[o]=o;else for(o=0;o<n;o++)l[o]=n-1-o;var u=n,h=2*u;for(o=u-1;u>2;){if(h--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),i?c:s;if(u<=(r=o)&&(r=0),u<=(o=r+1)&&(o=0),u<=(a=o+1)&&(a=0),e(t,r,o,a,u,l)){var d,p,f,m,g;for(d=l[r],p=l[o],f=l[a],s.push([t[d],t[p],t[f]]),c.push([l[r],l[o],l[a]]),m=o,g=o+1;g<u;m++,g++)l[m]=l[g];h=2*--u}}return i?c:s}}(),triangulateShape:function(e,t){function i(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function n(e,t,i){return e.x!==t.x?e.x<t.x?e.x<=i.x&&i.x<=t.x:t.x<=i.x&&i.x<=e.x:e.y<t.y?e.y<=i.y&&i.y<=t.y:t.y<=i.y&&i.y<=e.y}function r(e,t,i,r,o){var a=t.x-e.x,s=t.y-e.y,l=r.x-i.x,c=r.y-i.y,u=e.x-i.x,h=e.y-i.y,d=s*l-a*c,p=s*u-a*h;if(Math.abs(d)>Number.EPSILON){var f;if(d>0){if(p<0||p>d)return[];if((f=c*u-l*h)<0||f>d)return[]}else{if(p>0||p<d)return[];if((f=c*u-l*h)>0||f<d)return[]}if(0===f)return!o||0!==p&&p!==d?[e]:[];if(f===d)return!o||0!==p&&p!==d?[t]:[];if(0===p)return[i];if(p===d)return[r];var m=f/d;return[{x:e.x+m*a,y:e.y+m*s}]}if(0!==p||c*u!=l*h)return[];var g,v,y,b,x,_,w,E,T=0===a&&0===s,M=0===l&&0===c;return T&&M?e.x!==i.x||e.y!==i.y?[]:[e]:T?n(i,r,e)?[e]:[]:M?n(e,t,i)?[i]:[]:(0!==a?(e.x<t.x?(g=e,y=e.x,v=t,b=t.x):(g=t,y=t.x,v=e,b=e.x),i.x<r.x?(x=i,w=i.x,_=r,E=r.x):(x=r,w=r.x,_=i,E=i.x)):(e.y<t.y?(g=e,y=e.y,v=t,b=t.y):(g=t,y=t.y,v=e,b=e.y),i.y<r.y?(x=i,w=i.y,_=r,E=r.y):(x=r,w=r.y,_=i,E=i.y)),y<=w?b<w?[]:b===w?o?[]:[x]:b<=E?[x,v]:[x,_]:y>E?[]:y===E?o?[]:[g]:b<=E?[g,v]:[g,_])}function o(e,t,i,n){var r=t.x-e.x,o=t.y-e.y,a=i.x-e.x,s=i.y-e.y,l=n.x-e.x,c=n.y-e.y,u=r*s-o*a,h=r*c-o*l;if(Math.abs(u)>Number.EPSILON){var d=l*s-c*a;return u>0?h>=0&&d>=0:h>=0||d>=0}return h>0}i(e),t.forEach(i);for(var a,s,l,c,u,h,d={},p=e.concat(),f=0,m=t.length;f<m;f++)Array.prototype.push.apply(p,t[f]);for(a=0,s=p.length;a<s;a++)void 0!==d[u=p[a].x+":"+p[a].y]&&console.warn("THREE.ShapeUtils: Duplicate point",u,a),d[u]=a;var g=function(e,t){var i,n=e.concat();function a(e,t){var r=n.length-1,a=e-1;a<0&&(a=r);var s=e+1;s>r&&(s=0);var l=o(n[e],n[a],n[s],i[t]);if(!l)return!1;var c=i.length-1,u=t-1;u<0&&(u=c);var h=t+1;return h>c&&(h=0),!!(l=o(i[t],i[u],i[h],n[e]))}function s(e,t){var i,o;for(i=0;i<n.length;i++)if(o=i+1,o%=n.length,r(e,t,n[i],n[o],!0).length>0)return!0;return!1}var l=[];function c(e,i){var n,o,a,s;for(n=0;n<l.length;n++)for(o=t[l[n]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,r(e,i,o[a],o[s],!0).length>0)return!0;return!1}for(var u,h,d,p,f,m,g,v,y,b,x=[],_=0,w=t.length;_<w;_++)l.push(_);for(var E=0,T=2*l.length;l.length>0;){if(--T<0){console.log("Infinite Loop! Holes left:"+l.length+", Probably Hole outside Shape!");break}for(h=E;h<n.length;h++){for(d=n[h],u=-1,_=0;_<l.length;_++)if(f=l[_],void 0===x[m=d.x+":"+d.y+":"+f]){i=t[f];for(var M=0;M<i.length;M++)if(p=i[M],a(h,M)&&!s(d,p)&&!c(d,p)){u=M,l.splice(_,1),g=n.slice(0,h+1),v=n.slice(h),y=i.slice(u),b=i.slice(0,u+1),n=g.concat(y).concat(b).concat(v),E=h;break}if(u>=0)break;x[m]=!0}if(u>=0)break}}return n}(e,t),v=jr.triangulate(g,!1);for(a=0,s=v.length;a<s;a++)for(c=v[a],l=0;l<3;l++)void 0!==(h=d[u=c[l].x+":"+c[l].y])&&(c[l]=h);return v.concat()},isClockWise:function(e){return jr.area(e)<0}};function zr(e,t){hn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Vr(e,t)),this.mergeVertices()}function Vr(e,t){void 0!==e&&(Tn.call(this),this.type="ExtrudeBufferGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeVertexNormals())}function Gr(e,t){hn.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Wr(e,t)),this.mergeVertices()}function Wr(e,t){var i=(t=t||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new hn;var n=i.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Vr.call(this,n,t),this.type="TextBufferGeometry"}function qr(e,t,i,n,r,o,a){hn.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Xr(e,t,i,n,r,o,a)),this.mergeVertices()}function Xr(e,t,i,n,r,o,a){Tn.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},e=e||50,t=Math.max(3,Math.floor(t)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var s,l,c=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),u=0,h=[],d=new St,p=new St,f=[],m=[],g=[],v=[];for(l=0;l<=i;l++){var y=[],b=l/i;for(s=0;s<=t;s++){var x=s/t;d.x=-e*Math.cos(n+x*r)*Math.sin(o+b*a),d.y=e*Math.cos(o+b*a),d.z=e*Math.sin(n+x*r)*Math.sin(o+b*a),m.push(d.x,d.y,d.z),p.set(d.x,d.y,d.z).normalize(),g.push(p.x,p.y,p.z),v.push(x,1-b),y.push(u++)}h.push(y)}for(l=0;l<i;l++)for(s=0;s<t;s++){var _=h[l][s+1],w=h[l][s],E=h[l+1][s],T=h[l+1][s+1];(0!==l||o>0)&&f.push(_,w,T),(l!==i-1||c<Math.PI)&&f.push(w,E,T)}this.setIndex(f),this.addAttribute("position",new xn(m,3)),this.addAttribute("normal",new xn(g,3)),this.addAttribute("uv",new xn(v,2))}function Zr(e,t,i,n,r,o){hn.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new Yr(e,t,i,n,r,o)),this.mergeVertices()}function Yr(e,t,i,n,r,o){Tn.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:o},e=e||20,t=t||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8;var a,s,l,c=[],u=[],h=[],d=[],p=e,f=(t-e)/(n=void 0!==n?Math.max(1,n):1),m=new St,g=new pt;for(s=0;s<=n;s++){for(l=0;l<=i;l++)a=r+l/i*o,m.x=p*Math.cos(a),m.y=p*Math.sin(a),u.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,d.push(g.x,g.y);p+=f}for(s=0;s<n;s++){var v=s*(i+1);for(l=0;l<i;l++){var y=a=l+v,b=a+i+1,x=a+i+2,_=a+1;c.push(y,b,_),c.push(b,x,_)}}this.setIndex(c),this.addAttribute("position",new xn(u,3)),this.addAttribute("normal",new xn(h,3)),this.addAttribute("uv",new xn(d,2))}function Jr(e,t,i,n){hn.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},this.fromBufferGeometry(new Kr(e,t,i,n)),this.mergeVertices()}function Kr(e,t,i,n){Tn.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},t=Math.floor(t)||12,i=i||0,n=n||2*Math.PI,n=dt.clamp(n,0,2*Math.PI);var r,o,a,s=[],l=[],c=[],u=1/t,h=new St,d=new pt;for(o=0;o<=t;o++){var p=i+o*u*n,f=Math.sin(p),m=Math.cos(p);for(a=0;a<=e.length-1;a++)h.x=e[a].x*f,h.y=e[a].y,h.z=e[a].x*m,l.push(h.x,h.y,h.z),d.x=o/t,d.y=a/(e.length-1),c.push(d.x,d.y)}for(o=0;o<t;o++)for(a=0;a<e.length-1;a++){var g=r=a+o*e.length,v=r+e.length,y=r+e.length+1,b=r+1;s.push(g,v,b),s.push(v,y,b)}if(this.setIndex(s),this.addAttribute("position",new xn(l,3)),this.addAttribute("uv",new xn(c,2)),this.computeVertexNormals(),n===2*Math.PI){var x=this.attributes.normal.array,_=new St,w=new St,E=new St;for(r=t*e.length*3,o=0,a=0;o<e.length;o++,a+=3)_.x=x[a+0],_.y=x[a+1],_.z=x[a+2],w.x=x[r+a+0],w.y=x[r+a+1],w.z=x[r+a+2],E.addVectors(_,w).normalize(),x[a+0]=x[r+a+0]=E.x,x[a+1]=x[r+a+1]=E.y,x[a+2]=x[r+a+2]=E.z}}function Qr(e,t){hn.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new eo(e,t)),this.mergeVertices()}function eo(e,t){Tn.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var i=[],n=[],r=[],o=[],a=0,s=0;if(!1===Array.isArray(e))c(e);else for(var l=0;l<e.length;l++)c(e[l]),this.addGroup(a,s,l),a+=s,s=0;function c(e){var a,l,c,u=n.length/3,h=e.extractPoints(t),d=h.shape,p=h.holes;if(!1===jr.isClockWise(d))for(d=d.reverse(),a=0,l=p.length;a<l;a++)c=p[a],!0===jr.isClockWise(c)&&(p[a]=c.reverse());var f=jr.triangulateShape(d,p);for(a=0,l=p.length;a<l;a++)c=p[a],d=d.concat(c);for(a=0,l=d.length;a<l;a++){var m=d[a];n.push(m.x,m.y,0),r.push(0,0,1),o.push(m.x,m.y)}for(a=0,l=f.length;a<l;a++){var g=f[a],v=g[0]+u,y=g[1]+u,b=g[2]+u;i.push(v,y,b),s+=3}}this.setIndex(i),this.addAttribute("position",new xn(n,3)),this.addAttribute("normal",new xn(r,3)),this.addAttribute("uv",new xn(o,2))}function to(e,t){Tn.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var i,n,r,o,a=[],s=Math.cos(dt.DEG2RAD*t),l=[0,0],c={},u=["a","b","c"];e.isBufferGeometry?(o=new hn).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,d=o.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)i=m[u[g]],n=m[u[(g+1)%3]],l[0]=Math.min(i,n),l[1]=Math.max(i,n),void 0===c[r=l[0]+","+l[1]]?c[r]={index1:l[0],index2:l[1],face1:p,face2:void 0}:c[r].face2=p;for(r in c){var v=c[r];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=h[v.index1];a.push(y.x,y.y,y.z),y=h[v.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new xn(a,3))}function io(e,t,i,n,r,o,a,s){hn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new no(e,t,i,n,r,o,a,s)),this.mergeVertices()}function no(e,t,i,n,r,o,a,s){Tn.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s};var l=this;e=void 0!==e?e:20,t=void 0!==t?t:20,i=void 0!==i?i:100,n=Math.floor(n)||8,r=Math.floor(r)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var c=[],u=[],h=[],d=[],p=0,f=[],m=i/2,g=0;function v(i){var r,o,f,v=new pt,y=new St,b=0,x=!0===i?e:t,_=!0===i?1:-1;for(o=p,r=1;r<=n;r++)u.push(0,m*_,0),h.push(0,_,0),d.push(.5,.5),p++;for(f=p,r=0;r<=n;r++){var w=r/n*s+a,E=Math.cos(w),T=Math.sin(w);y.x=x*T,y.y=m*_,y.z=x*E,u.push(y.x,y.y,y.z),h.push(0,_,0),v.x=.5*E+.5,v.y=.5*T*_+.5,d.push(v.x,v.y),p++}for(r=0;r<n;r++){var M=o+r,S=f+r;!0===i?c.push(S,S+1,M):c.push(S+1,S,M),b+=3}l.addGroup(g,b,!0===i?1:2),g+=b}!function(){var o,v,y=new St,b=new St,x=0,_=(t-e)/i;for(v=0;v<=r;v++){var w=[],E=v/r,T=E*(t-e)+e;for(o=0;o<=n;o++){var M=o/n,S=M*s+a,C=Math.sin(S),R=Math.cos(S);b.x=T*C,b.y=-E*i+m,b.z=T*R,u.push(b.x,b.y,b.z),y.set(C,_,R).normalize(),h.push(y.x,y.y,y.z),d.push(M,1-E),w.push(p++)}f.push(w)}for(o=0;o<n;o++)for(v=0;v<r;v++){var A=f[v][o],P=f[v+1][o],L=f[v+1][o+1],O=f[v][o+1];c.push(A,P,O),c.push(P,L,O),x+=6}l.addGroup(g,x,0),g+=x}(),!1===o&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.addAttribute("position",new xn(u,3)),this.addAttribute("normal",new xn(h,3)),this.addAttribute("uv",new xn(d,2))}function ro(e,t,i,n,r,o,a){io.call(this,0,e,t,i,n,r,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a}}function oo(e,t,i,n,r,o,a){no.call(this,0,e,t,i,n,r,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a}}function ao(e,t,i,n){hn.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new so(e,t,i,n)),this.mergeVertices()}function so(e,t,i,n){Tn.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},e=e||50,t=void 0!==t?Math.max(3,t):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r,o,a=[],s=[],l=[],c=[],u=new St,h=new pt;for(s.push(0,0,0),l.push(0,0,1),c.push(.5,.5),o=0,r=3;o<=t;o++,r+=3){var d=i+o/t*n;u.x=e*Math.cos(d),u.y=e*Math.sin(d),s.push(u.x,u.y,u.z),l.push(0,0,1),h.x=(s[r]/e+1)/2,h.y=(s[r+1]/e+1)/2,c.push(h.x,h.y)}for(r=1;r<=t;r++)a.push(r,r+1,0);this.setIndex(a),this.addAttribute("position",new xn(s,3)),this.addAttribute("normal",new xn(l,3)),this.addAttribute("uv",new xn(c,2))}zr.prototype=Object.create(hn.prototype),zr.prototype.constructor=zr,Vr.prototype=Object.create(Tn.prototype),Vr.prototype.constructor=Vr,Vr.prototype.getArrays=function(){var e=this.getAttribute("position"),t=e?Array.prototype.slice.call(e.array):[],i=this.getAttribute("uv"),n=i?Array.prototype.slice.call(i.array):[],r=this.index;return{position:t,uv:n,index:r?Array.prototype.slice.call(r.array):[]}},Vr.prototype.addShapeList=function(e,t){var i=e.length;t.arrays=this.getArrays();for(var n=0;n<i;n++){var r=e[n];this.addShape(r,t)}this.setIndex(t.arrays.index),this.addAttribute("position",new xn(t.arrays.position,3)),this.addAttribute("uv",new xn(t.arrays.uv,2))},Vr.prototype.addShape=function(e,t){var i,n,r,o,a,s,l,c,u=t.arrays?t.arrays:this.getArrays(),h=u.position,d=u.index,p=u.uv,f=[],m=void 0!==t.amount?t.amount:100,g=void 0!==t.bevelThickness?t.bevelThickness:6,v=void 0!==t.bevelSize?t.bevelSize:g-2,y=void 0!==t.bevelSegments?t.bevelSegments:3,b=void 0===t.bevelEnabled||t.bevelEnabled,x=void 0!==t.curveSegments?t.curveSegments:12,_=void 0!==t.steps?t.steps:1,w=t.extrudePath,E=!1,T=void 0!==t.UVGenerator?t.UVGenerator:zr.WorldUVGenerator;w&&(i=w.getSpacedPoints(_),E=!0,b=!1,n=void 0!==t.frames?t.frames:w.computeFrenetFrames(_,!1),r=new St,o=new St,a=new St),b||(y=0,g=0,v=0);var M=this,S=e.extractPoints(x),C=S.shape,R=S.holes;if(!jr.isClockWise(C))for(C=C.reverse(),l=0,c=R.length;l<c;l++)s=R[l],jr.isClockWise(s)&&(R[l]=s.reverse());var A=jr.triangulateShape(C,R),P=C;for(l=0,c=R.length;l<c;l++)s=R[l],C=C.concat(s);function L(e,t,i){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(i).add(e)}var O,I,k,D,N,H,B=C.length,F=A.length;function U(e,t,i){var n,r,o,a=e.x-t.x,s=e.y-t.y,l=i.x-e.x,c=i.y-e.y,u=a*a+s*s,h=a*c-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(u),p=Math.sqrt(l*l+c*c),f=t.x-s/d,m=t.y+a/d,g=((i.x-c/p-f)*c-(i.y+l/p-m)*l)/(a*c-s*l),v=(n=f+a*g-e.x)*n+(r=m+s*g-e.y)*r;if(v<=2)return new pt(n,r);o=Math.sqrt(v/2)}else{var y=!1;a>Number.EPSILON?l>Number.EPSILON&&(y=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(c)&&(y=!0),y?(n=-s,r=a,o=Math.sqrt(u)):(n=a,r=s,o=Math.sqrt(u/2))}return new pt(n/o,r/o)}for(var $=[],j=0,z=P.length,V=z-1,G=j+1;j<z;j++,V++,G++)V===z&&(V=0),G===z&&(G=0),$[j]=U(P[j],P[V],P[G]);var W,q,X=[],Z=$.concat();for(l=0,c=R.length;l<c;l++){for(s=R[l],W=[],j=0,V=(z=s.length)-1,G=j+1;j<z;j++,V++,G++)V===z&&(V=0),G===z&&(G=0),W[j]=U(s[j],s[V],s[G]);X.push(W),Z=Z.concat(W)}for(O=0;O<y;O++){for(k=O/y,D=g*Math.cos(k*Math.PI/2),I=v*Math.sin(k*Math.PI/2),j=0,z=P.length;j<z;j++)J((N=L(P[j],$[j],I)).x,N.y,-D);for(l=0,c=R.length;l<c;l++)for(s=R[l],W=X[l],j=0,z=s.length;j<z;j++)J((N=L(s[j],W[j],I)).x,N.y,-D)}for(I=v,j=0;j<B;j++)N=b?L(C[j],Z[j],I):C[j],E?(o.copy(n.normals[0]).multiplyScalar(N.x),r.copy(n.binormals[0]).multiplyScalar(N.y),a.copy(i[0]).add(o).add(r),J(a.x,a.y,a.z)):J(N.x,N.y,0);for(q=1;q<=_;q++)for(j=0;j<B;j++)N=b?L(C[j],Z[j],I):C[j],E?(o.copy(n.normals[q]).multiplyScalar(N.x),r.copy(n.binormals[q]).multiplyScalar(N.y),a.copy(i[q]).add(o).add(r),J(a.x,a.y,a.z)):J(N.x,N.y,m/_*q);for(O=y-1;O>=0;O--){for(k=O/y,D=g*Math.cos(k*Math.PI/2),I=v*Math.sin(k*Math.PI/2),j=0,z=P.length;j<z;j++)J((N=L(P[j],$[j],I)).x,N.y,m+D);for(l=0,c=R.length;l<c;l++)for(s=R[l],W=X[l],j=0,z=s.length;j<z;j++)N=L(s[j],W[j],I),E?J(N.x,N.y+i[_-1].y,i[_-1].x+D):J(N.x,N.y,m+D)}function Y(e,t){var i,n;for(j=e.length;--j>=0;){i=j,(n=j-1)<0&&(n=e.length-1);var r=0,o=_+2*y;for(r=0;r<o;r++){var a=B*r,s=B*(r+1);Q(t+i+a,t+n+a,t+n+s,t+i+s,e,r,o,i,n)}}}function J(e,t,i){f.push(e),f.push(t),f.push(i)}function K(e,t,i){ee(e),ee(t),ee(i);var n=h.length/3,r=T.generateTopUV(M,h,n-3,n-2,n-1);te(r[0]),te(r[1]),te(r[2])}function Q(e,t,i,n,r,o,a,s,l){ee(e),ee(t),ee(n),ee(t),ee(i),ee(n);var c=h.length/3,u=T.generateSideWallUV(M,h,c-6,c-3,c-2,c-1);te(u[0]),te(u[1]),te(u[3]),te(u[1]),te(u[2]),te(u[3])}function ee(e){d.push(h.length/3),h.push(f[3*e+0]),h.push(f[3*e+1]),h.push(f[3*e+2])}function te(e){p.push(e.x),p.push(e.y)}!function(){var e=h.length/3;if(b){var i=0,n=B*i;for(j=0;j<F;j++)K((H=A[j])[2]+n,H[1]+n,H[0]+n);for(n=B*(i=_+2*y),j=0;j<F;j++)K((H=A[j])[0]+n,H[1]+n,H[2]+n)}else{for(j=0;j<F;j++)K((H=A[j])[2],H[1],H[0]);for(j=0;j<F;j++)K((H=A[j])[0]+B*_,H[1]+B*_,H[2]+B*_)}M.addGroup(e,h.length/3-e,void 0!==t.material?t.material:0)}(),function(){var e=h.length/3,i=0;for(Y(P,i),i+=P.length,l=0,c=R.length;l<c;l++)Y(s=R[l],i),i+=s.length;M.addGroup(e,h.length/3-e,void 0!==t.extrudeMaterial?t.extrudeMaterial:1)}(),t.arrays||(this.setIndex(d),this.addAttribute("position",new xn(h,3)),this.addAttribute("uv",new xn(t.arrays.uv,2)))},zr.WorldUVGenerator={generateTopUV:function(e,t,i,n,r){var o=t[3*i],a=t[3*i+1],s=t[3*n],l=t[3*n+1],c=t[3*r],u=t[3*r+1];return[new pt(o,a),new pt(s,l),new pt(c,u)]},generateSideWallUV:function(e,t,i,n,r,o){var a=t[3*i],s=t[3*i+1],l=t[3*i+2],c=t[3*n],u=t[3*n+1],h=t[3*n+2],d=t[3*r],p=t[3*r+1],f=t[3*r+2],m=t[3*o],g=t[3*o+1],v=t[3*o+2];return Math.abs(s-u)<.01?[new pt(a,1-l),new pt(c,1-h),new pt(d,1-f),new pt(m,1-v)]:[new pt(s,1-l),new pt(u,1-h),new pt(p,1-f),new pt(g,1-v)]}},Gr.prototype=Object.create(hn.prototype),Gr.prototype.constructor=Gr,Wr.prototype=Object.create(Vr.prototype),Wr.prototype.constructor=Wr,qr.prototype=Object.create(hn.prototype),qr.prototype.constructor=qr,Xr.prototype=Object.create(Tn.prototype),Xr.prototype.constructor=Xr,Zr.prototype=Object.create(hn.prototype),Zr.prototype.constructor=Zr,Yr.prototype=Object.create(Tn.prototype),Yr.prototype.constructor=Yr,Jr.prototype=Object.create(hn.prototype),Jr.prototype.constructor=Jr,Kr.prototype=Object.create(Tn.prototype),Kr.prototype.constructor=Kr,Qr.prototype=Object.create(hn.prototype),Qr.prototype.constructor=Qr,eo.prototype=Object.create(Tn.prototype),eo.prototype.constructor=eo,to.prototype=Object.create(Tn.prototype),to.prototype.constructor=to,io.prototype=Object.create(hn.prototype),io.prototype.constructor=io,no.prototype=Object.create(Tn.prototype),no.prototype.constructor=no,ro.prototype=Object.create(io.prototype),ro.prototype.constructor=ro,oo.prototype=Object.create(no.prototype),oo.prototype.constructor=oo,ao.prototype=Object.create(hn.prototype),ao.prototype.constructor=ao,so.prototype=Object.create(Tn.prototype),so.prototype.constructor=so;var lo=Object.freeze({WireframeGeometry:Er,ParametricGeometry:Tr,ParametricBufferGeometry:Mr,TetrahedronGeometry:Rr,TetrahedronBufferGeometry:Ar,OctahedronGeometry:Pr,OctahedronBufferGeometry:Lr,IcosahedronGeometry:Or,IcosahedronBufferGeometry:Ir,DodecahedronGeometry:kr,DodecahedronBufferGeometry:Dr,PolyhedronGeometry:Sr,PolyhedronBufferGeometry:Cr,TubeGeometry:Nr,TubeBufferGeometry:Hr,TorusKnotGeometry:Br,TorusKnotBufferGeometry:Fr,TorusGeometry:Ur,TorusBufferGeometry:$r,TextGeometry:Gr,TextBufferGeometry:Wr,SphereGeometry:qr,SphereBufferGeometry:Xr,RingGeometry:Zr,RingBufferGeometry:Yr,PlaneGeometry:Cn,PlaneBufferGeometry:Rn,LatheGeometry:Jr,LatheBufferGeometry:Kr,ShapeGeometry:Qr,ShapeBufferGeometry:eo,ExtrudeGeometry:zr,ExtrudeBufferGeometry:Vr,EdgesGeometry:to,ConeGeometry:ro,ConeBufferGeometry:oo,CylinderGeometry:io,CylinderBufferGeometry:no,CircleGeometry:ao,CircleBufferGeometry:so,BoxGeometry:Mn,BoxBufferGeometry:Sn});function co(e){Ii.call(this,{uniforms:yi.merge([vi.lights,{opacity:{value:1}}]),vertexShader:bi.shadow_vert,fragmentShader:bi.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}}}),this.setValues(e)}function uo(e){Ii.call(this,e),this.type="RawShaderMaterial"}function ho(e){Oi.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new gi(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new pt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function po(e){ho.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function fo(e){Oi.call(this),this.type="MeshPhongMaterial",this.color=new gi(16777215),this.specular=new gi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new pt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function mo(e){fo.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function go(e){Oi.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new pt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function vo(e){Oi.call(this),this.type="MeshLambertMaterial",this.color=new gi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function yo(e){Oi.call(this),this.type="LineDashedMaterial",this.color=new gi(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(e)}co.prototype=Object.create(Ii.prototype),co.prototype.constructor=co,co.prototype.isShadowMaterial=!0,uo.prototype=Object.create(Ii.prototype),uo.prototype.constructor=uo,uo.prototype.isRawShaderMaterial=!0,ho.prototype=Object.create(Oi.prototype),ho.prototype.constructor=ho,ho.prototype.isMeshStandardMaterial=!0,ho.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},po.prototype=Object.create(ho.prototype),po.prototype.constructor=po,po.prototype.isMeshPhysicalMaterial=!0,po.prototype.copy=function(e){return ho.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},fo.prototype=Object.create(Oi.prototype),fo.prototype.constructor=fo,fo.prototype.isMeshPhongMaterial=!0,fo.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},mo.prototype=Object.create(fo.prototype),mo.prototype.constructor=mo,mo.prototype.isMeshToonMaterial=!0,mo.prototype.copy=function(e){return fo.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},go.prototype=Object.create(Oi.prototype),go.prototype.constructor=go,go.prototype.isMeshNormalMaterial=!0,go.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},vo.prototype=Object.create(Oi.prototype),vo.prototype.constructor=vo,vo.prototype.isMeshLambertMaterial=!0,vo.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},yo.prototype=Object.create(Oi.prototype),yo.prototype.constructor=yo,yo.prototype.isLineDashedMaterial=!0,yo.prototype.copy=function(e){return Oi.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var bo=Object.freeze({ShadowMaterial:co,SpriteMaterial:ar,RawShaderMaterial:uo,ShaderMaterial:Ii,PointsMaterial:gr,MeshPhysicalMaterial:po,MeshStandardMaterial:ho,MeshPhongMaterial:fo,MeshToonMaterial:mo,MeshNormalMaterial:go,MeshLambertMaterial:vo,MeshDepthMaterial:ki,MeshBasicMaterial:An,LineDashedMaterial:yo,LineBasicMaterial:dr,Material:Oi}),xo={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function _o(e,t,i){var n=this,r=!1,o=0,a=0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){a++,!1===r&&void 0!==n.onStart&&n.onStart(e,o,a),r=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,a),o===a&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)}}var wo=new _o;function Eo(e){this.manager=void 0!==e?e:wo}function To(e){this.manager=void 0!==e?e:wo,this._parser=null}function Mo(e){this.manager=void 0!==e?e:wo,this._parser=null}function So(e){this.manager=void 0!==e?e:wo}function Co(e){this.manager=void 0!==e?e:wo}function Ro(e){this.manager=void 0!==e?e:wo}function Ao(e,t){Zi.call(this),this.type="Light",this.color=new gi(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Po(e,t,i){Ao.call(this,e,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Zi.DefaultUp),this.updateMatrix(),this.groundColor=new gi(t)}function Lo(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new pt(512,512),this.map=null,this.matrix=new Ct}function Oo(){Lo.call(this,new Ki(50,1,.5,500))}function Io(e,t,i,n,r,o){Ao.call(this,e,t),this.type="SpotLight",this.position.copy(Zi.DefaultUp),this.updateMatrix(),this.target=new Zi,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new Oo}function ko(e,t,i,n){Ao.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new Lo(new Ki(90,1,.5,500))}function Do(){Lo.call(this,new Ji(-5,5,5,-5,.5,500))}function No(e,t){Ao.call(this,e,t),this.type="DirectionalLight",this.position.copy(Zi.DefaultUp),this.updateMatrix(),this.target=new Zi,this.shadow=new Do}function Ho(e,t){Ao.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Bo(e,t,i,n){Ao.call(this,e,t),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}Object.assign(Eo.prototype,{load:function(e,t,i,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e);var r=this,o=xo.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o;var a=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],l=!!a[2],c=a[3];c=window.decodeURIComponent(c),l&&(c=window.atob(c));try{var u,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":u=new ArrayBuffer(c.length);for(var d=new Uint8Array(u),p=0;p<c.length;p++)d[p]=c.charCodeAt(p);"blob"===h&&(u=new Blob([u],{type:s}));break;case"document":var f=new DOMParser;u=f.parseFromString(c,s);break;case"json":u=JSON.parse(c);break;default:u=c}window.setTimeout(function(){t&&t(u),r.manager.itemEnd(e)},0)}catch(t){window.setTimeout(function(){n&&n(t),r.manager.itemEnd(e),r.manager.itemError(e)},0)}}else{var m=new XMLHttpRequest;for(var g in m.open("GET",e,!0),m.addEventListener("load",function(i){var o=i.target.response;xo.add(e,o),200===this.status?(t&&t(o),r.manager.itemEnd(e)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),t&&t(o),r.manager.itemEnd(e)):(n&&n(i),r.manager.itemEnd(e),r.manager.itemError(e))},!1),void 0!==i&&m.addEventListener("progress",function(e){i(e)},!1),m.addEventListener("error",function(t){n&&n(t),r.manager.itemEnd(e),r.manager.itemError(e)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return r.manager.itemStart(e),m},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(To.prototype,{load:function(e,t,i,n){var r=this,o=[],a=new xr;a.image=o;var s=new Eo(this.manager);function l(l){s.load(e[l],function(e){var i=r._parser(e,!0);o[l]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},6===(c+=1)&&(1===i.mipmapCount&&(a.minFilter=xe),a.format=i.format,a.needsUpdate=!0,t&&t(a))},i,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var c=0,u=0,h=e.length;u<h;++u)l(u);else s.load(e,function(e){var i=r._parser(e,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,s=0;s<n;s++){o[s]={mipmaps:[]};for(var l=0;l<i.mipmapCount;l++)o[s].mipmaps.push(i.mipmaps[s*i.mipmapCount+l]),o[s].format=i.format,o[s].width=i.width,o[s].height=i.height}else a.image.width=i.width,a.image.height=i.height,a.mipmaps=i.mipmaps;1===i.mipmapCount&&(a.minFilter=xe),a.format=i.format,a.needsUpdate=!0,t&&t(a)},i,n);return a},setPath:function(e){return this.path=e,this}}),Object.assign(Mo.prototype,{load:function(e,t,i,n){var r=this,o=new Rt,a=new Eo(this.manager);return a.setResponseType("arraybuffer"),a.load(e,function(e){var i=r._parser(e);i&&(void 0!==i.image?o.image=i.image:void 0!==i.data&&(o.image.width=i.width,o.image.height=i.height,o.image.data=i.data),o.wrapS=void 0!==i.wrapS?i.wrapS:me,o.wrapT=void 0!==i.wrapT?i.wrapT:me,o.magFilter=void 0!==i.magFilter?i.magFilter:xe,o.minFilter=void 0!==i.minFilter?i.minFilter:we,o.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(o.format=i.format),void 0!==i.type&&(o.type=i.type),void 0!==i.mipmaps&&(o.mipmaps=i.mipmaps),1===i.mipmapCount&&(o.minFilter=xe),o.needsUpdate=!0,t&&t(o,i))},i,n),o}}),Object.assign(So.prototype,{load:function(e,t,i,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e);var r=this,o=xo.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");return a.addEventListener("load",function(){xo.add(e,this),t&&t(this),r.manager.itemEnd(e)},!1),a.addEventListener("error",function(t){n&&n(t),r.manager.itemEnd(e),r.manager.itemError(e)},!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(e),a.src=e,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Co.prototype,{load:function(e,t,i,n){var r=new At,o=new So(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(i){o.load(e[i],function(e){r.images[i]=e,6===++a&&(r.needsUpdate=!0,t&&t(r))},void 0,n)}for(var l=0;l<e.length;++l)s(l);return r},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Ro.prototype,{load:function(e,t,i,n){var r=new So(this.manager);r.setCrossOrigin(this.crossOrigin),r.setPath(this.path);var o=new _t;return o.image=r.load(e,function(){var i=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data\:image\/jpeg/);o.format=i?Ne:He,o.needsUpdate=!0,void 0!==t&&t(o)},i,n),o},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Ao.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Ao,isLight:!0,copy:function(e){return Zi.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=Zi.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Po.prototype=Object.assign(Object.create(Ao.prototype),{constructor:Po,isHemisphereLight:!0,copy:function(e){return Ao.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Lo.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Oo.prototype=Object.assign(Object.create(Lo.prototype),{constructor:Oo,isSpotLightShadow:!0,update:function(e){var t=this.camera,i=2*dt.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;i===t.fov&&n===t.aspect&&r===t.far||(t.fov=i,t.aspect=n,t.far=r,t.updateProjectionMatrix())}}),Io.prototype=Object.assign(Object.create(Ao.prototype),{constructor:Io,isSpotLight:!0,copy:function(e){return Ao.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),ko.prototype=Object.assign(Object.create(Ao.prototype),{constructor:ko,isPointLight:!0,copy:function(e){return Ao.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Do.prototype=Object.assign(Object.create(Lo.prototype),{constructor:Do}),No.prototype=Object.assign(Object.create(Ao.prototype),{constructor:No,isDirectionalLight:!0,copy:function(e){return Ao.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Ho.prototype=Object.assign(Object.create(Ao.prototype),{constructor:Ho,isAmbientLight:!0}),Bo.prototype=Object.assign(Object.create(Ao.prototype),{constructor:Bo,isRectAreaLight:!0,copy:function(e){return Ao.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Ao.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});var Fo,Uo={arraySlice:function(e,t,i){return Uo.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==i?i:e.length)):e.slice(t,i)},convertArray:function(e,t,i){return!e||!i&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,i=new Array(t),n=0;n!==t;++n)i[n]=n;return i.sort(function(t,i){return e[t]-e[i]}),i},sortedArray:function(e,t,i){for(var n=e.length,r=new e.constructor(n),o=0,a=0;a!==n;++o)for(var s=i[o]*t,l=0;l!==t;++l)r[a++]=e[s+l];return r},flattenJSON:function(e,t,i,n){for(var r=1,o=e[0];void 0!==o&&void 0===o[n];)o=e[r++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[n])&&(t.push(o.time),i.push.apply(i,a)),o=e[r++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[n])&&(t.push(o.time),a.toArray(i,i.length)),o=e[r++]}while(void 0!==o);else do{void 0!==(a=o[n])&&(t.push(o.time),i.push(a)),o=e[r++]}while(void 0!==o)}}};function $o(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i}function jo(e,t,i,n){$o.call(this,e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function zo(e,t,i,n){$o.call(this,e,t,i,n)}function Vo(e,t,i,n){$o.call(this,e,t,i,n)}function Go(e,t,i,n){if(void 0===e)throw new Error("track name is undefined");if(void 0===t||0===t.length)throw new Error("no keyframes in track named "+e);this.name=e,this.times=Uo.convertArray(t,this.TimeBufferType),this.values=Uo.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()}function Wo(e,t,i,n){Go.call(this,e,t,i,n)}function qo(e,t,i,n){$o.call(this,e,t,i,n)}function Xo(e,t,i,n){Go.call(this,e,t,i,n)}function Zo(e,t,i,n){Go.call(this,e,t,i,n)}function Yo(e,t,i,n){Go.call(this,e,t,i,n)}function Jo(e,t,i){Go.call(this,e,t,i)}function Ko(e,t,i,n){Go.call(this,e,t,i,n)}function Qo(e,t,i,n){Go.apply(this,arguments)}function ea(e,t,i){this.name=e,this.tracks=i,this.duration=void 0!==t?t:-1,this.uuid=dt.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function ta(e){this.manager=void 0!==e?e:wo,this.textures={}}function ia(e){this.manager=void 0!==e?e:wo}Object.assign($o.prototype,{evaluate:function(e){var t=this.parameterPositions,i=this._cachedIndex,n=t[i],r=t[i-1];e:{t:{var o;i:{n:if(!(e<n)){for(var a=i+2;;){if(void 0===n){if(e<r)break n;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,r)}if(i===a)break;if(r=n,e<(n=t[++i]))break t}o=t.length;break i}if(e>=r)break e;var s=t[1];e<s&&(i=2,r=s);for(a=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(i===a)break;if(n=r,e>=(r=t[--i-1]))break t}o=i,i=0}for(;i<o;){var l=i+o>>>1;e<t[l]?o=l:i=l+1}if(n=t[i],void 0===(r=t[i-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,r,e)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n,o=0;o!==n;++o)t[o]=i[r+o];return t},interpolate_:function(e,t,i,n){throw new Error("call to abstract method")},intervalChanged_:function(e,t,i){}}),Object.assign($o.prototype,{beforeStart_:$o.prototype.copySampleValue_,afterEnd_:$o.prototype.copySampleValue_}),jo.prototype=Object.assign(Object.create($o.prototype),{constructor:jo,DefaultSettings_:{endingStart:Qe,endingEnd:Qe},intervalChanged_:function(e,t,i){var n=this.parameterPositions,r=e-2,o=e+1,a=n[r],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:r=e,a=2*t-i;break;case 2402:a=t+n[r=n.length-2]-n[r+1];break;default:r=e,a=i}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=e,s=2*i-t;break;case 2402:o=1,s=i+n[1]-n[0];break;default:o=e-1,s=t}var l=.5*(i-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(s-i),this._offsetPrev=r*c,this._offsetNext=o*c},interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(i-t)/(n-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f,x=0;x!==a;++x)r[x]=g*o[c+x]+v*o[l+x]+y*o[s+x]+b*o[u+x];return r}}),zo.prototype=Object.assign(Object.create($o.prototype),{constructor:zo,interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,c=(i-t)/(n-t),u=1-c,h=0;h!==a;++h)r[h]=o[l+h]*u+o[s+h]*c;return r}}),Vo.prototype=Object.assign(Object.create($o.prototype),{constructor:Vo,interpolate_:function(e,t,i,n){return this.copySampleValue_(e-1)}}),Fo={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Vo(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new zo(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new jo(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0!==t)this.createInterpolant=t;else{var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrackPrototype:",i)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,i=0,n=t.length;i!==n;++i)t[i]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,i=0,n=t.length;i!==n;++i)t[i]*=e;return this},trim:function(e,t){for(var i=this.times,n=i.length,r=0,o=n-1;r!==n&&i[r]<e;)++r;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==r||o!==n){r>=o&&(r=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Uo.arraySlice(i,r,o),this.values=Uo.arraySlice(this.values,r*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrackPrototype: Invalid value size in track.",this),e=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrackPrototype: Track is empty.",this),e=!1);for(var o=null,a=0;a!==r;a++){var s=i[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrackPrototype: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrackPrototype: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==n&&Uo.isTypedArray(n)){a=0;for(var l=n.length;a!==l;++a){var c=n[a];if(isNaN(c)){console.error("THREE.KeyframeTrackPrototype: Value is not a valid number.",this,a,c),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,i=this.getValueSize(),n=2302===this.getInterpolation(),r=1,o=e.length-1,a=1;a<o;++a){var s=!1,l=e[a];if(l!==e[a+1]&&(1!==a||l!==l[0]))if(n)s=!0;else for(var c=a*i,u=c-i,h=c+i,d=0;d!==i;++d){var p=t[c+d];if(p!==t[u+d]||p!==t[h+d]){s=!0;break}}if(s){if(a!==r){e[r]=e[a];var f=a*i,m=r*i;for(d=0;d!==i;++d)t[m+d]=t[f+d]}++r}}if(o>0){e[r]=e[o];for(f=o*i,m=r*i,d=0;d!==i;++d)t[m+d]=t[f+d];++r}return r!==e.length&&(this.times=Uo.arraySlice(e,0,r),this.values=Uo.arraySlice(t,0,r*i)),this}},Wo.prototype=Object.assign(Object.create(Fo),{constructor:Wo,ValueTypeName:"vector"}),qo.prototype=Object.assign(Object.create($o.prototype),{constructor:qo,interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=(i-t)/(n-t),c=s+a;s!==c;s+=4)Mt.slerpFlat(r,0,o,s-a,o,s,l);return r}}),Xo.prototype=Object.assign(Object.create(Fo),{constructor:Xo,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new qo(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Zo.prototype=Object.assign(Object.create(Fo),{constructor:Zo,ValueTypeName:"number"}),Yo.prototype=Object.assign(Object.create(Fo),{constructor:Yo,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Jo.prototype=Object.assign(Object.create(Fo),{constructor:Jo,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ko.prototype=Object.assign(Object.create(Fo),{constructor:Ko,ValueTypeName:"color"}),Qo.prototype=Fo,Fo.constructor=Qo,Object.assign(Qo,{parse:function(e){if(void 0===e.type)throw new Error("track type undefined, can not parse");var t=Qo._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var i=[],n=[];Uo.flattenJSON(e.keys,i,n,"value"),e.times=i,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t,i=e.constructor;if(void 0!==i.toJSON)t=i.toJSON(e);else{t={name:e.name,times:Uo.convertArray(e.times,Array),values:Uo.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Zo;case"vector":case"vector2":case"vector3":case"vector4":return Wo;case"color":return Ko;case"quaternion":return Xo;case"bool":case"boolean":return Jo;case"string":return Yo}throw new Error("Unsupported typeName: "+e)}}),Object.assign(ea,{parse:function(e){for(var t=[],i=e.tracks,n=1/(e.fps||1),r=0,o=i.length;r!==o;++r)t.push(Qo.parse(i[r]).scale(n));return new ea(e.name,e.duration,t)},toJSON:function(e){for(var t=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:t},r=0,o=i.length;r!==o;++r)t.push(Qo.toJSON(i[r]));return n},CreateFromMorphTargetSequence:function(e,t,i,n){for(var r=t.length,o=[],a=0;a<r;a++){var s=[],l=[];s.push((a+r-1)%r,a,(a+1)%r),l.push(0,1,0);var c=Uo.getKeyframeOrder(s);s=Uo.sortedArray(s,1,c),l=Uo.sortedArray(l,1,c),n||0!==s[0]||(s.push(r),l.push(l[0])),o.push(new Zo(".morphTargetInfluences["+t[a].name+"]",s,l).scale(1/i))}return new ea(e,-1,o)},findByName:function(e,t){var i=e;if(!Array.isArray(e)){var n=e;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],l=s.name.match(r);if(l&&l.length>1){var c=n[h=l[1]];c||(n[h]=c=[]),c.push(s)}}var u=[];for(var h in n)u.push(ea.CreateFromMorphTargetSequence(h,n[h],t,i));return u},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var i=function(e,t,i,n,r){if(0!==i.length){var o=[],a=[];Uo.flattenJSON(i,o,a,n),0!==o.length&&r.push(new e(t,o,a))}},n=[],r=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],l=0;l<s.length;l++){var c=s[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var u={},h=0;h<c.length;h++)if(c[h].morphTargets)for(var d=0;d<c[h].morphTargets.length;d++)u[c[h].morphTargets[d]]=-1;for(var p in u){var f=[],m=[];for(d=0;d!==c[h].morphTargets.length;++d){var g=c[h];f.push(g.time),m.push(g.morphTarget===p?1:0)}n.push(new Zo(".morphTargetInfluence["+p+"]",f,m))}o=u.length*(a||1)}else{var v=".bones["+t[l].name+"]";i(Wo,v+".position",c,"pos",n),i(Xo,v+".quaternion",c,"rot",n),i(Wo,v+".scale",c,"scl",n)}}return 0===n.length?null:new ea(r,o,n)}}),Object.assign(ea.prototype,{resetDuration:function(){for(var e=0,t=0,i=this.tracks.length;t!==i;++t){var n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}this.duration=e},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(ta.prototype,{load:function(e,t,i,n){var r=this;new Eo(r.manager).load(e,function(e){t(r.parse(JSON.parse(e)))},i,n)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function i(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var n=new bo[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearCoat&&(n.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(n.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(n.uniforms=e.uniforms),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(n.vertexColors=e.vertexColors),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.shading&&(n.shading=e.shading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=i(e.map)),void 0!==e.alphaMap&&(n.alphaMap=i(e.alphaMap),n.transparent=!0),void 0!==e.bumpMap&&(n.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=i(e.normalMap)),void 0!==e.normalScale){var r=e.normalScale;!1===Array.isArray(r)&&(r=[r,r]),n.normalScale=(new pt).fromArray(r)}return void 0!==e.displacementMap&&(n.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=i(e.specularMap)),void 0!==e.envMap&&(n.envMap=i(e.envMap)),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.lightMap&&(n.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=i(e.gradientMap)),n}}),Object.assign(ia.prototype,{load:function(e,t,i,n){var r=this;new Eo(r.manager).load(e,function(e){t(r.parse(JSON.parse(e)))},i,n)},parse:function(e){var t=new Tn,i=e.data.index;if(void 0!==i){var n=new sa[i.type](i.array);t.setIndex(new dn(n,1))}var r=e.data.attributes;for(var o in r){var a=r[o];n=new sa[a.type](a.array);t.addAttribute(o,new dn(n,a.itemSize,a.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var l=0,c=s.length;l!==c;++l){var u=s[l];t.addGroup(u.start,u.count,u.materialIndex)}var h=e.data.boundingSphere;if(void 0!==h){var d=new St;void 0!==h.center&&d.fromArray(h.center),t.boundingSphere=new Ni(d,h.radius)}return t}});var na,ra,oa,aa,sa={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function la(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function ca(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:wo,this.withCredentials=!1}function ua(e){this.manager=void 0!==e?e:wo,this.texturePath=""}la.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,i=0,n=t.length;i<n;i+=2){var r=t[i],o=t[i+1];if(r.test(e))return o}return null}},Object.assign(la.prototype,{crossOrigin:void 0,extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t,i){for(var n=[],r=0;r<e.length;++r)n[r]=this.createMaterial(e[r],t,i);return n},createMaterial:(na={NoBlending:E,NormalBlending:T,AdditiveBlending:M,SubtractiveBlending:S,MultiplyBlending:C,CustomBlending:R},ra=new gi,oa=new Ro,aa=new ta,function(e,t,i){var n={};function r(e,r,o,a,s){var l,c=t+e,u=la.Handlers.get(c);null!==u?l=u.load(c):(oa.setCrossOrigin(i),l=oa.load(c)),void 0!==r&&(l.repeat.fromArray(r),1!==r[0]&&(l.wrapS=fe),1!==r[1]&&(l.wrapT=fe)),void 0!==o&&l.offset.fromArray(o),void 0!==a&&("repeat"===a[0]&&(l.wrapS=fe),"mirror"===a[0]&&(l.wrapS=ge),"repeat"===a[1]&&(l.wrapT=fe),"mirror"===a[1]&&(l.wrapT=ge)),void 0!==s&&(l.anisotropy=s);var h=dt.generateUUID();return n[h]=l,h}var o={uuid:dt.generateUUID(),type:"MeshLambertMaterial"};for(var a in e){var s=e[a];switch(a){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":o.name=s;break;case"blending":o.blending=na[s];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",a,"is no longer supported.");break;case"colorDiffuse":o.color=ra.fromArray(s).getHex();break;case"colorSpecular":o.specular=ra.fromArray(s).getHex();break;case"colorEmissive":o.emissive=ra.fromArray(s).getHex();break;case"specularCoef":o.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(o.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(o.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(o.type="MeshStandardMaterial");break;case"mapDiffuse":o.map=r(s,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":o.emissiveMap=r(s,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":o.lightMap=r(s,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":o.aoMap=r(s,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":o.bumpMap=r(s,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":o.bumpScale=s;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":o.normalMap=r(s,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":o.normalScale=[s,s];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":o.specularMap=r(s,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":o.metalnessMap=r(s,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":o.roughnessMap=r(s,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":o.alphaMap=r(s,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":o.side=g;break;case"doubleSided":o.side=v;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),o.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":o[a]=s;break;case"vertexColors":!0===s&&(o.vertexColors=w),"face"===s&&(o.vertexColors=_);break;default:console.error("THREE.Loader.createMaterial: Unsupported",a,s)}}return"MeshBasicMaterial"===o.type&&delete o.emissive,"MeshPhongMaterial"!==o.type&&delete o.specular,o.opacity<1&&(o.transparent=!0),aa.setTextures(n),aa.parse(o)})}),Object.assign(ca.prototype,{load:function(e,t,i,n){var r=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:la.prototype.extractUrlBase(e),a=new Eo(this.manager);a.setWithCredentials(this.withCredentials),a.load(e,function(i){var n=JSON.parse(i),a=n.metadata;if(void 0!==a){var s=a.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.")}}var l=r.parse(n,o);t(l.geometry,l.materials)},i,n)},setTexturePath:function(e){this.texturePath=e},parse:function(){return function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var i=new hn;return function(e,t){function i(e,t){return e&1<<t}var n,r,o,a,s,l,c,u,h,d,p,f,m,g,v,y,b,x,_,w,E,T,M,S,C,R=e.faces,A=e.vertices,P=e.normals,L=e.colors,O=e.scale,I=0;if(void 0!==e.uvs){for(n=0;n<e.uvs.length;n++)e.uvs[n].length&&I++;for(n=0;n<I;n++)t.faceVertexUvs[n]=[]}for(a=0,s=A.length;a<s;)(x=new St).x=A[a++]*O,x.y=A[a++]*O,x.z=A[a++]*O,t.vertices.push(x);for(a=0,s=R.length;a<s;)if(p=i(d=R[a++],0),f=i(d,1),m=i(d,3),g=i(d,4),v=i(d,5),y=i(d,6),b=i(d,7),p){if((w=new Qi).a=R[a],w.b=R[a+1],w.c=R[a+3],(E=new Qi).a=R[a+1],E.b=R[a+2],E.c=R[a+3],a+=4,f&&(h=R[a++],w.materialIndex=h,E.materialIndex=h),o=t.faces.length,m)for(n=0;n<I;n++)for(S=e.uvs[n],t.faceVertexUvs[n][o]=[],t.faceVertexUvs[n][o+1]=[],r=0;r<4;r++)C=new pt(S[2*(u=R[a++])],S[2*u+1]),2!==r&&t.faceVertexUvs[n][o].push(C),0!==r&&t.faceVertexUvs[n][o+1].push(C);if(g&&(c=3*R[a++],w.normal.set(P[c++],P[c++],P[c]),E.normal.copy(w.normal)),v)for(n=0;n<4;n++)c=3*R[a++],M=new St(P[c++],P[c++],P[c]),2!==n&&w.vertexNormals.push(M),0!==n&&E.vertexNormals.push(M);if(y&&(T=L[l=R[a++]],w.color.setHex(T),E.color.setHex(T)),b)for(n=0;n<4;n++)T=L[l=R[a++]],2!==n&&w.vertexColors.push(new gi(T)),0!==n&&E.vertexColors.push(new gi(T));t.faces.push(w),t.faces.push(E)}else{if((_=new Qi).a=R[a++],_.b=R[a++],_.c=R[a++],f&&(h=R[a++],_.materialIndex=h),o=t.faces.length,m)for(n=0;n<I;n++)for(S=e.uvs[n],t.faceVertexUvs[n][o]=[],r=0;r<3;r++)C=new pt(S[2*(u=R[a++])],S[2*u+1]),t.faceVertexUvs[n][o].push(C);if(g&&(c=3*R[a++],_.normal.set(P[c++],P[c++],P[c])),v)for(n=0;n<3;n++)c=3*R[a++],M=new St(P[c++],P[c++],P[c]),_.vertexNormals.push(M);if(y&&(l=R[a++],_.color.setHex(L[l])),b)for(n=0;n<3;n++)l=R[a++],_.vertexColors.push(new gi(L[l]));t.faces.push(_)}}(e,i),function(e,t){var i=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,r=e.skinWeights.length;n<r;n+=i){var o=e.skinWeights[n],a=i>1?e.skinWeights[n+1]:0,s=i>2?e.skinWeights[n+2]:0,l=i>3?e.skinWeights[n+3]:0;t.skinWeights.push(new wt(o,a,s,l))}if(e.skinIndices)for(n=0,r=e.skinIndices.length;n<r;n+=i){var c=e.skinIndices[n],u=i>1?e.skinIndices[n+1]:0,h=i>2?e.skinIndices[n+2]:0,d=i>3?e.skinIndices[n+3]:0;t.skinIndices.push(new wt(c,u,h,d))}t.bones=e.bones,t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,i),function(e,t){var i=e.scale;if(void 0!==e.morphTargets)for(var n=0,r=e.morphTargets.length;n<r;n++){t.morphTargets[n]={},t.morphTargets[n].name=e.morphTargets[n].name,t.morphTargets[n].vertices=[];for(var o=t.morphTargets[n].vertices,a=e.morphTargets[n].vertices,s=0,l=a.length;s<l;s+=3){var c=new St;c.x=a[s]*i,c.y=a[s+1]*i,c.z=a[s+2]*i,o.push(c)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var u=t.faces,h=e.morphColors[0].colors;for(n=0,r=u.length;n<r;n++)u[n].color.fromArray(h,3*n)}}(e,i),function(e,t){var i=[],n=[];void 0!==e.animation&&n.push(e.animation),void 0!==e.animations&&(e.animations.length?n=n.concat(e.animations):n.push(e.animations));for(var r=0;r<n.length;r++){var o=ea.parseAnimation(n[r],t.bones);o&&i.push(o)}if(t.morphTargets){var a=ea.CreateClipsFromMorphTargetSequences(t.morphTargets,10);i=i.concat(a)}i.length>0&&(t.animations=i)}(e,i),i.computeFaceNormals(),i.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:i}:{geometry:i,materials:la.prototype.initMaterials(e.materials,t,this.crossOrigin)}}}()}),Object.assign(ua.prototype,{load:function(e,t,i,n){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var r=this;new Eo(r.manager).load(e,function(i){var o=null;try{o=JSON.parse(i)}catch(t){return void 0!==n&&n(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?r.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.")},i,n)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var i=this.parseGeometries(e.geometries),n=this.parseImages(e.images,function(){void 0!==t&&t(a)}),r=this.parseTextures(e.textures,n),o=this.parseMaterials(e.materials,r),a=this.parseObject(e.object,i,o);return e.animations&&(a.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(a),a},parseGeometries:function(e){var t={};if(void 0!==e)for(var i=new ca,n=new ia,r=0,o=e.length;r<o;r++){var a,s=e[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new lo[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new lo[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new lo[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new lo[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new lo[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new lo[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":a=new lo[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new lo[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new lo[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new lo[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new lo[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=n.parse(s);break;case"Geometry":a=i.parse(s,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),t[s.uuid]=a}return t},parseMaterials:function(e,t){var i={};if(void 0!==e){var n=new ta;n.setTextures(t);for(var r=0,o=e.length;r<o;r++){var a=e[r];if("MultiMaterial"===a.type){for(var s=[],l=0;l<a.materials.length;l++)s.push(n.parse(a.materials[l]));i[a.uuid]=s}else i[a.uuid]=n.parse(a)}}return i},parseAnimations:function(e){for(var t=[],i=0;i<e.length;i++){var n=ea.parse(e[i]);t.push(n)}return t},parseImages:function(e,t){var i=this,n={};function r(e){return i.manager.itemStart(e),o.load(e,function(){i.manager.itemEnd(e)},void 0,function(){i.manager.itemEnd(e),i.manager.itemError(e)})}if(void 0!==e&&e.length>0){var o=new So(new _o(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var l=e[a],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:i.texturePath+l.url;n[l.uuid]=r(c)}}return n},parseTextures:function(e,t){function i(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==e)for(var r=0,o=e.length;r<o;r++){var a=e[r];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new _t(t[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=i(a.mapping,ha)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.wrap&&(s.wrapS=i(a.wrap[0],da),s.wrapT=i(a.wrap[1],da)),void 0!==a.minFilter&&(s.minFilter=i(a.minFilter,pa)),void 0!==a.magFilter&&(s.magFilter=i(a.magFilter,pa)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),n[a.uuid]=s}return n},parseObject:function(){var e=new Ct;return function(t,i,n){var r;function o(e){return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),i[e]}function a(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],i=0,r=e.length;i<r;i++){var o=e[i];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(n[o])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(t.type){case"Scene":r=new rr,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new gi(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new nr(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new ir(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new Ki(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new Ji(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":r=new Ho(t.color,t.intensity);break;case"DirectionalLight":r=new No(t.color,t.intensity);break;case"PointLight":r=new ko(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new Bo(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new Io(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new Po(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var s=o(t.geometry),l=a(t.material);r=s.bones&&s.bones.length>0?new hr(s,l):new In(s,l);break;case"LOD":r=new lr;break;case"Line":r=new pr(o(t.geometry),a(t.material),t.mode);break;case"LineLoop":r=new mr(o(t.geometry),a(t.material));break;case"LineSegments":r=new fr(o(t.geometry),a(t.material));break;case"PointCloud":case"Points":r=new vr(o(t.geometry),a(t.material));break;case"Sprite":r=new sr(a(t.material));break;case"Group":r=new yr;break;default:r=new Zi}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.children)for(var c in t.children)r.add(this.parseObject(t.children[c],i,n));if("LOD"===t.type)for(var u=t.levels,h=0;h<u.length;h++){var d=u[h];void 0!==(c=r.getObjectByProperty("uuid",d.object))&&r.addLevel(c,d.distance)}return r}}()});var ha={UVMapping:300,CubeReflectionMapping:se,CubeRefractionMapping:le,EquirectangularReflectionMapping:ce,EquirectangularRefractionMapping:ue,SphericalReflectionMapping:he,CubeUVReflectionMapping:de,CubeUVRefractionMapping:pe},da={RepeatWrapping:fe,ClampToEdgeWrapping:me,MirroredRepeatWrapping:ge},pa={NearestFilter:ve,NearestMipMapNearestFilter:ye,NearestMipMapLinearFilter:be,LinearFilter:xe,LinearMipMapNearestFilter:_e,LinearMipMapLinearFilter:we};function fa(e,t,i,n,r){var o=.5*(n-t),a=.5*(r-i),s=e*e;return(2*i-2*n+o+a)*(e*s)+(-3*i+3*n-2*o-a)*s+o*e+i}function ma(e,t,i,n){return function(e,t){var i=1-e;return i*i*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,i)+function(e,t){return e*e*t}(e,n)}function ga(e,t,i,n,r){return function(e,t){var i=1-e;return i*i*i*t}(e,t)+function(e,t){var i=1-e;return 3*i*i*e*t}(e,i)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,r)}function va(){this.arcLengthDivisions=200}function ya(e,t){va.call(this),this.v1=e,this.v2=t}function ba(){va.call(this),this.curves=[],this.autoClose=!1}function xa(e,t,i,n,r,o,a,s){va.call(this),this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0}function _a(e){va.call(this),this.points=void 0===e?[]:e}function wa(e,t,i,n){va.call(this),this.v0=e,this.v1=t,this.v2=i,this.v3=n}function Ea(e,t,i){va.call(this),this.v0=e,this.v1=t,this.v2=i}Object.assign(va.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,i,n=[],r=this.getPoint(0),o=0;for(n.push(0),i=1;i<=e;i++)o+=(t=this.getPoint(i/e)).distanceTo(r),n.push(o),r=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var i,n=this.getLengths(),r=0,o=n.length;i=t||e*n[o-1];for(var a,s=0,l=o-1;s<=l;)if((a=n[r=Math.floor(s+(l-s)/2)]-i)<0)s=r+1;else{if(!(a>0)){l=r;break}l=r-1}if(n[r=l]===i)return r/(o-1);var c=n[r];return(r+(i-c)/(n[r+1]-c))/(o-1)},getTangent:function(e){var t=e-1e-4,i=e+1e-4;t<0&&(t=0),i>1&&(i=1);var n=this.getPoint(t);return this.getPoint(i).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var i,n,r,o=new St,a=[],s=[],l=[],c=new St,u=new Ct;for(i=0;i<=e;i++)n=i/e,a[i]=this.getTangentAt(n),a[i].normalize();s[0]=new St,l[0]=new St;var h=Number.MAX_VALUE,d=Math.abs(a[0].x),p=Math.abs(a[0].y),f=Math.abs(a[0].z);for(d<=h&&(h=d,o.set(1,0,0)),p<=h&&(h=p,o.set(0,1,0)),f<=h&&o.set(0,0,1),c.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],c),l[0].crossVectors(a[0],s[0]),i=1;i<=e;i++)s[i]=s[i-1].clone(),l[i]=l[i-1].clone(),c.crossVectors(a[i-1],a[i]),c.length()>Number.EPSILON&&(c.normalize(),r=Math.acos(dt.clamp(a[i-1].dot(a[i]),-1,1)),s[i].applyMatrix4(u.makeRotationAxis(c,r))),l[i].crossVectors(a[i],s[i]);if(!0===t)for(r=Math.acos(dt.clamp(s[0].dot(s[e]),-1,1)),r/=e,a[0].dot(c.crossVectors(s[0],s[e]))>0&&(r=-r),i=1;i<=e;i++)s[i].applyMatrix4(u.makeRotationAxis(a[i],r*i)),l[i].crossVectors(a[i],s[i]);return{tangents:a,normals:s,binormals:l}}}),ya.prototype=Object.create(va.prototype),ya.prototype.constructor=ya,ya.prototype.isLineCurve=!0,ya.prototype.getPoint=function(e){if(1===e)return this.v2.clone();var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},ya.prototype.getPointAt=function(e){return this.getPoint(e)},ya.prototype.getTangent=function(e){return this.v2.clone().sub(this.v1).normalize()},ba.prototype=Object.assign(Object.create(va.prototype),{constructor:ba,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new ya(t,e))},getPoint:function(e){for(var t=e*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=t){var r=i[n]-t,o=this.curves[n],a=o.getLength(),s=0===a?0:1-r/a;return o.getPointAt(s)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,i=0,n=this.curves.length;i<n;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,i=[],n=0,r=this.curves;n<r.length;n++)for(var o=r[n],a=o&&o.isEllipseCurve?2*e:o&&o.isLineCurve?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),l=0;l<s.length;l++){var c=s[l];t&&t.equals(c)||(i.push(c),t=c)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},createPointsGeometry:function(e){var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){for(var t=new hn,i=0,n=e.length;i<n;i++){var r=e[i];t.vertices.push(new St(r.x,r.y,r.z||0))}return t}}),xa.prototype=Object.create(va.prototype),xa.prototype.constructor=xa,xa.prototype.isEllipseCurve=!0,xa.prototype.getPoint=function(e){for(var t=2*Math.PI,i=this.aEndAngle-this.aStartAngle,n=Math.abs(i)<Number.EPSILON;i<0;)i+=t;for(;i>t;)i-=t;i<Number.EPSILON&&(i=n?0:t),!0!==this.aClockwise||n||(i===t?i=-t:i-=t);var r=this.aStartAngle+e*i,o=this.aX+this.xRadius*Math.cos(r),a=this.aY+this.yRadius*Math.sin(r);if(0!==this.aRotation){var s=Math.cos(this.aRotation),l=Math.sin(this.aRotation),c=o-this.aX,u=a-this.aY;o=c*s-u*l+this.aX,a=c*l+u*s+this.aY}return new pt(o,a)},_a.prototype=Object.create(va.prototype),_a.prototype.constructor=_a,_a.prototype.isSplineCurve=!0,_a.prototype.getPoint=function(e){var t=this.points,i=(t.length-1)*e,n=Math.floor(i),r=i-n,o=t[0===n?n:n-1],a=t[n],s=t[n>t.length-2?t.length-1:n+1],l=t[n>t.length-3?t.length-1:n+2];return new pt(fa(r,o.x,a.x,s.x,l.x),fa(r,o.y,a.y,s.y,l.y))},wa.prototype=Object.create(va.prototype),wa.prototype.constructor=wa,wa.prototype.getPoint=function(e){var t=this.v0,i=this.v1,n=this.v2,r=this.v3;return new pt(ga(e,t.x,i.x,n.x,r.x),ga(e,t.y,i.y,n.y,r.y))},Ea.prototype=Object.create(va.prototype),Ea.prototype.constructor=Ea,Ea.prototype.getPoint=function(e){var t=this.v0,i=this.v1,n=this.v2;return new pt(ma(e,t.x,i.x,n.x),ma(e,t.y,i.y,n.y))};var Ta,Ma=Object.assign(Object.create(ba.prototype),{fromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var i=new ya(this.currentPoint.clone(),new pt(e,t));this.curves.push(i),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,i,n){var r=new Ea(this.currentPoint.clone(),new pt(e,t),new pt(i,n));this.curves.push(r),this.currentPoint.set(i,n)},bezierCurveTo:function(e,t,i,n,r,o){var a=new wa(this.currentPoint.clone(),new pt(e,t),new pt(i,n),new pt(r,o));this.curves.push(a),this.currentPoint.set(r,o)},splineThru:function(e){var t=new _a([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,i,n,r,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,i,n,r,o)},absarc:function(e,t,i,n,r,o){this.absellipse(e,t,i,i,n,r,o)},ellipse:function(e,t,i,n,r,o,a,s){var l=this.currentPoint.x,c=this.currentPoint.y;this.absellipse(e+l,t+c,i,n,r,o,a,s)},absellipse:function(e,t,i,n,r,o,a,s){var l=new xa(e,t,i,n,r,o,a,s);if(this.curves.length>0){var c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);var u=l.getPoint(1);this.currentPoint.copy(u)}});function Sa(e){ba.call(this),this.currentPoint=new pt,e&&this.fromPoints(e)}function Ca(){Sa.apply(this,arguments),this.holes=[]}function Ra(){this.subPaths=[],this.currentPath=null}function Aa(e){this.data=e}function Pa(e){this.manager=void 0!==e?e:wo}Sa.prototype=Ma,Ma.constructor=Sa,Ca.prototype=Object.assign(Object.create(Ma),{constructor:Ca,getPointsHoles:function(e){for(var t=[],i=0,n=this.holes.length;i<n;i++)t[i]=this.holes[i].getPoints(e);return t},extractAllPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},extractPoints:function(e){return this.extractAllPoints(e)}}),Object.assign(Ra.prototype,{moveTo:function(e,t){this.currentPath=new Sa,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,i,n){this.currentPath.quadraticCurveTo(e,t,i,n)},bezierCurveTo:function(e,t,i,n,r,o){this.currentPath.bezierCurveTo(e,t,i,n,r,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function i(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i],o=new Ca;o.curves=r.curves,t.push(o)}return t}function n(e,t){for(var i=t.length,n=!1,r=i-1,o=0;o<i;r=o++){var a=t[r],s=t[o],l=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=t[o],l=-l,s=t[r],c=-c),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var u=c*(e.x-a.x)-l*(e.y-a.y);if(0===u)return!0;if(u<0)continue;n=!n}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return n}var r=jr.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return i(o);var a,s,l,c=[];if(1===o.length)return s=o[0],(l=new Ca).curves=s.curves,c.push(l),c;var u=!r(o[0].getPoints());u=e?!u:u;var h,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)a=r(h=(s=o[v]).getPoints()),(a=e?!a:a)?(!u&&f[g]&&g++,f[g]={s:new Ca,p:h},f[g].s.curves=s.curves,u&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!f[0])return i(o);if(f.length>1){for(var b=!1,x=[],_=0,w=f.length;_<w;_++)p[_]=[];for(_=0,w=f.length;_<w;_++)for(var E=m[_],T=0;T<E.length;T++){for(var M=E[T],S=!0,C=0;C<f.length;C++)n(M.p,f[C].p)&&(_!==C&&x.push({froms:_,tos:C,hole:T}),S?(S=!1,p[C].push(M)):b=!0);S&&p[_].push(M)}x.length>0&&(b||(m=p))}v=0;for(var R=f.length;v<R;v++){l=f[v].s,c.push(l);for(var A=0,P=(d=m[v]).length;A<P;A++)l.holes.push(d[A].h)}return c}}),Object.assign(Aa.prototype,{isFont:!0,generateShapes:function(e,t,i){function n(e,t,n,o){var a=r.glyphs[e]||r.glyphs["?"];if(a){var s,l,c,u,h,d,p,f,m,g,v,y=new Ra,b=[];if(a.o)for(var x=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),_=0,w=x.length;_<w;){switch(x[_++]){case"m":s=x[_++]*t+n,l=x[_++]*t+o,y.moveTo(s,l);break;case"l":s=x[_++]*t+n,l=x[_++]*t+o,y.lineTo(s,l);break;case"q":if(c=x[_++]*t+n,u=x[_++]*t+o,p=x[_++]*t+n,f=x[_++]*t+o,y.quadraticCurveTo(p,f,c,u),v=b[b.length-1]){h=v.x,d=v.y;for(var E=1;E<=i;E++){ma(T=E/i,h,p,c),ma(T,d,f,u)}}break;case"b":if(c=x[_++]*t+n,u=x[_++]*t+o,p=x[_++]*t+n,f=x[_++]*t+o,m=x[_++]*t+n,g=x[_++]*t+o,y.bezierCurveTo(p,f,m,g,c,u),v=b[b.length-1]){h=v.x,d=v.y;for(E=1;E<=i;E++){var T;ga(T=E/i,h,p,m,c),ga(T,d,f,g,u)}}}}return{offsetX:a.ha*t,path:y}}}void 0===t&&(t=100),void 0===i&&(i=4);for(var r=this.data,o=function(e){for(var i=String(e).split(""),o=t/r.resolution,a=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*o,s=0,l=0,c=[],u=0;u<i.length;u++){var h=i[u];if("\n"===h)s=0,l-=a;else{var d=n(h,o,s,l);s+=d.offsetX,c.push(d.path)}}return c}(e),a=[],s=0,l=o.length;s<l;s++)Array.prototype.push.apply(a,o[s].toShapes());return a}}),Object.assign(Pa.prototype,{load:function(e,t,i,n){var r=this;new Eo(this.manager).load(e,function(e){var i;try{i=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(e.substring(65,e.length-2))}var n=r.parse(i);t&&t(n)},i,n)},parse:function(e){return new Aa(e)}});var La,Oa,Ia,ka,Da,Na,Ha,Ba,Fa,Ua,$a,ja,za,Va,Ga,Wa,qa,Xa,Za={getContext:function(){return void 0===Ta&&(Ta=new(window.AudioContext||window.webkitAudioContext)),Ta},setContext:function(e){Ta=e}};function Ya(e){this.manager=void 0!==e?e:wo}function Ja(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ki,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ki,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Ka(e,t,i){Zi.call(this),this.type="CubeCamera";var n=new Ki(90,1,e,t);n.up.set(0,-1,0),n.lookAt(new St(1,0,0)),this.add(n);var r=new Ki(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new St(-1,0,0)),this.add(r);var o=new Ki(90,1,e,t);o.up.set(0,0,1),o.lookAt(new St(0,1,0)),this.add(o);var a=new Ki(90,1,e,t);a.up.set(0,0,-1),a.lookAt(new St(0,-1,0)),this.add(a);var s=new Ki(90,1,e,t);s.up.set(0,-1,0),s.lookAt(new St(0,0,1)),this.add(s);var l=new Ki(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new St(0,0,-1)),this.add(l);var c={format:Ne,magFilter:xe,minFilter:xe};this.renderTarget=new Tt(i,i,c),this.renderTarget.texture.name="CubeCamera",this.updateCubeMap=function(e,t){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,c=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,e.render(t,n,i),i.activeCubeFace=1,e.render(t,r,i),i.activeCubeFace=2,e.render(t,o,i),i.activeCubeFace=3,e.render(t,a,i),i.activeCubeFace=4,e.render(t,s,i),i.texture.generateMipmaps=c,i.activeCubeFace=5,e.render(t,l,i),e.setRenderTarget(null)}}function Qa(){Zi.call(this),this.type="AudioListener",this.context=Za.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function es(e){Zi.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function ts(e){es.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function is(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function ns(e,t,i){this.binding=e,this.valueSize=i;var n,r=Float64Array;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":r=Array,n=this._select;break;default:n=this._lerp}this.buffer=new r(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function rs(e,t,i){var n=i||os.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function os(e,t,i){this.path=t,this.parsedPath=i||os.parseTrackName(t),this.node=os.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function as(e){this.uuid=dt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var i=0,n=arguments.length;i!==n;++i)t[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function ss(e,t,i){this._mixer=e,this._clip=t,this._localRoot=i||null;for(var n=t.tracks,r=n.length,o=new Array(r),a={endingStart:Qe,endingEnd:Qe},s=0;s!==r;++s){var l=n[s].createInterpolant(null);o[s]=l,l.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ke,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function ls(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function cs(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function us(){Tn.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function hs(e,t,i,n){this.uuid=dt.generateUUID(),this.data=e,this.itemSize=t,this.offset=i,this.normalized=!0===n}function ds(e,t){this.uuid=dt.generateUUID(),this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function ps(e,t,i){ds.call(this,e,t),this.meshPerAttribute=i||1}function fs(e,t,i){dn.call(this,e,t),this.meshPerAttribute=i||1}function ms(e,t,i,n){this.ray=new Pn(e,t),this.near=i||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function gs(e,t){return e.distance-t.distance}function vs(e,t,i,n){if(!1!==e.visible&&(e.raycast(t,i),!0===n))for(var r=e.children,o=0,a=r.length;o<a;o++)vs(r[o],t,i,!0)}function ys(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function bs(e,t,i){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==i?i:0,this}function xs(e,t,i){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==i?i:0,this}function _s(e,t){In.call(this,e,t),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n=i-1,r=i/1;this.createAnimation("__default",0,n,r),this.setAnimationWeight("__default",1)}function ws(e){Zi.call(this),this.material=e,this.render=function(e){}}function Es(e,t,i,n){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==i?i:16711680,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var l=new Tn,c=new xn(2*a*3,3);l.addAttribute("position",c),fr.call(this,l,new dr({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Ts(e){Zi.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;for(var t=new Tn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,r=1;n<32;n++,r++){var o=n/32*Math.PI*2,a=r/32*Math.PI*2;i.push(Math.cos(o),Math.sin(o),1,Math.cos(a),Math.sin(a),1)}t.addAttribute("position",new xn(i,3));var s=new dr({fog:!1});this.cone=new fr(t,s),this.add(this.cone),this.update()}function Ms(e){for(var t=function e(t){var i=[];t&&t.isBone&&i.push(t);for(var n=0;n<t.children.length;n++)i.push.apply(i,e(t.children[n]));return i}(e),i=new Tn,n=[],r=[],o=new gi(0,0,1),a=new gi(0,1,0),s=0;s<t.length;s++){var l=t[s];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}i.addAttribute("position",new xn(n,3)),i.addAttribute("color",new xn(r,3));var c=new dr({vertexColors:w,depthTest:!1,depthWrite:!1,transparent:!0});fr.call(this,i,c),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.onBeforeRender()}function Ss(e,t){this.light=e,this.light.updateMatrixWorld();var i=new Xr(t,4,2),n=new An({wireframe:!0,fog:!1});n.color.copy(this.light.color),In.call(this,i,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function Cs(e){Zi.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var t=new dr({color:e.color}),i=new Tn;i.addAttribute("position",new dn(new Float32Array(15),3)),this.add(new pr(i,t)),this.update()}function Rs(e,t){Zi.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var i=new Lr(t);i.rotateY(.5*Math.PI);var n=new An({vertexColors:w,wireframe:!0}),r=i.getAttribute("position"),o=new Float32Array(3*r.count);i.addAttribute("color",new dn(o,3)),this.add(new In(i,n)),this.update()}function As(e,t,i,n){e=e||10,t=t||10,i=new gi(void 0!==i?i:4473924),n=new gi(void 0!==n?n:8947848);for(var r=t/2,o=e/t,a=e/2,s=[],l=[],c=0,u=0,h=-a;c<=t;c++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var d=c===r?i:n;d.toArray(l,u),u+=3,d.toArray(l,u),u+=3,d.toArray(l,u),u+=3,d.toArray(l,u),u+=3}var p=new Tn;p.addAttribute("position",new xn(s,3)),p.addAttribute("color",new xn(l,3));var f=new dr({vertexColors:w});fr.call(this,p,f)}function Ps(e,t,i,n,r,o){e=e||10,t=t||16,i=i||8,n=n||64,r=new gi(void 0!==r?r:4473924),o=new gi(void 0!==o?o:8947848);var a,s,l,c,u,h,d,p=[],f=[];for(c=0;c<=t;c++)l=c/t*(2*Math.PI),a=Math.sin(l)*e,s=Math.cos(l)*e,p.push(0,0,0),p.push(a,0,s),d=1&c?r:o,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(c=0;c<=i;c++)for(d=1&c?r:o,h=e-e/i*c,u=0;u<n;u++)l=u/n*(2*Math.PI),a=Math.sin(l)*h,s=Math.cos(l)*h,p.push(a,0,s),f.push(d.r,d.g,d.b),l=(u+1)/n*(2*Math.PI),a=Math.sin(l)*h,s=Math.cos(l)*h,p.push(a,0,s),f.push(d.r,d.g,d.b);var m=new Tn;m.addAttribute("position",new xn(p,3)),m.addAttribute("color",new xn(f,3));var g=new dr({vertexColors:w});fr.call(this,m,g)}function Ls(e,t,i,n){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==i?i:16776960,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new Tn,c=new xn(2*a*3,3);l.addAttribute("position",c),fr.call(this,l,new dr({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Os(e,t){Zi.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,void 0===t&&(t=1);var i=new Tn;i.addAttribute("position",new xn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var n=new dr({fog:!1});this.add(new pr(i,n)),(i=new Tn).addAttribute("position",new xn([0,0,0,0,0,1],3)),this.add(new pr(i,n)),this.update()}function Is(e){var t=new Tn,i=new dr({color:16777215,vertexColors:_}),n=[],r=[],o={},a=new gi(16755200),s=new gi(16711680),l=new gi(43775),c=new gi(16777215),u=new gi(3355443);function h(e,t,i){d(e,i),d(t,i)}function d(e,t){n.push(0,0,0),r.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(n.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",c),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),t.addAttribute("position",new xn(n,3)),t.addAttribute("color",new xn(r,3)),fr.call(this,t,i),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function ks(e,t){this.object=e,void 0===t&&(t=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new Tn;r.setIndex(new dn(i,1)),r.addAttribute("position",new dn(n,3)),fr.call(this,r,new dr({color:t})),this.matrixAutoUpdate=!1,this.update()}function Ds(e,t,i,n,r,o){Zi.call(this),void 0===n&&(n=16776960),void 0===i&&(i=1),void 0===r&&(r=.2*i),void 0===o&&(o=.2*r),void 0===Ga&&((Ga=new Tn).addAttribute("position",new xn([0,0,0,0,1,0],3)),(Wa=new no(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new pr(Ga,new dr({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new In(Wa,new An({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,r,o)}function Ns(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=new Tn;i.addAttribute("position",new xn(t,3)),i.addAttribute("color",new xn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new dr({vertexColors:w});fr.call(this,i,n)}function Hs(){var e=0,t=0,i=0,n=0;function r(r,o,a,s){e=r,t=a,i=-3*r+3*o-2*a-s,n=2*r-2*o+a+s}return{initCatmullRom:function(e,t,i,n,o){r(t,i,o*(i-e),o*(n-t))},initNonuniformCatmullRom:function(e,t,i,n,o,a,s){var l=(t-e)/o-(i-e)/(o+a)+(i-t)/a,c=(i-t)/a-(n-t)/(a+s)+(n-i)/s;r(t,i,l*=a,c*=a)},calc:function(r){var o=r*r;return e+t*r+i*o+n*(o*r)}}}Object.assign(Ya.prototype,{load:function(e,t,i,n){var r=new Eo(this.manager);r.setResponseType("arraybuffer"),r.load(e,function(e){Za.getContext().decodeAudioData(e,function(e){t(e)})},i,n)}}),Object.assign(Ja.prototype,{update:(Fa=new Ct,Ua=new Ct,function(e){if(La!==this||Oa!==e.focus||Ia!==e.fov||ka!==e.aspect*this.aspect||Da!==e.near||Na!==e.far||Ha!==e.zoom||Ba!==this.eyeSep){La=this,Oa=e.focus,Ia=e.fov,ka=e.aspect*this.aspect,Da=e.near,Na=e.far,Ha=e.zoom;var t,i,n=e.projectionMatrix.clone(),r=(Ba=this.eyeSep/2)*Da/Oa,o=Da*Math.tan(dt.DEG2RAD*Ia*.5)/Ha;Ua.elements[12]=-Ba,Fa.elements[12]=Ba,t=-o*ka+r,i=o*ka+r,n.elements[0]=2*Da/(i-t),n.elements[8]=(i+t)/(i-t),this.cameraL.projectionMatrix.copy(n),t=-o*ka-r,i=o*ka-r,n.elements[0]=2*Da/(i-t),n.elements[8]=(i+t)/(i-t),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Ua),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Fa)})}),Ka.prototype=Object.create(Zi.prototype),Ka.prototype.constructor=Ka,Qa.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Qa,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:function(){var e=new St,t=new Mt,i=new St,n=new St;return function(r){Zi.prototype.updateMatrixWorld.call(this,r);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(e,t,i),n.set(0,0,-1).applyQuaternion(t),o.positionX?(o.positionX.setValueAtTime(e.x,this.context.currentTime),o.positionY.setValueAtTime(e.y,this.context.currentTime),o.positionZ.setValueAtTime(e.z,this.context.currentTime),o.forwardX.setValueAtTime(n.x,this.context.currentTime),o.forwardY.setValueAtTime(n.y,this.context.currentTime),o.forwardZ.setValueAtTime(n.z,this.context.currentTime),o.upX.setValueAtTime(a.x,this.context.currentTime),o.upY.setValueAtTime(a.y,this.context.currentTime),o.upZ.setValueAtTime(a.z,this.context.currentTime)):(o.setPosition(e.x,e.y,e.z),o.setOrientation(n.x,n.y,n.z,a.x,a.y,a.z))}}()}),es.prototype=Object.assign(Object.create(Zi.prototype),{constructor:es,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),e.start(0,this.startTime),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}}),ts.prototype=Object.assign(Object.create(es.prototype),{constructor:ts,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var e=new St;return function(t){Zi.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}()}),Object.assign(is.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),i=0;i<t.length;i++)e+=t[i];return e/t.length}}),Object.assign(ns.prototype,{accumulate:function(e,t){var i=this.buffer,n=this.valueSize,r=e*n+n,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==n;++a)i[r+a]=i[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(i,r,0,s,n)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,i=this.buffer,n=e*t+t,r=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,r<1){var a=3*t;this._mixBufferRegion(i,n,a,1-r,t)}for(var s=t,l=t+t;s!==l;++s)if(i[s]!==i[s+t]){o.setValue(i,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,i=this.valueSize,n=3*i;e.getValue(t,n);for(var r=i,o=n;r!==o;++r)t[r]=t[n+r%i];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,i,n,r){if(n>=.5)for(var o=0;o!==r;++o)e[t+o]=e[i+o]},_slerp:function(e,t,i,n){Mt.slerpFlat(e,t,e,t,e,i,n)},_lerp:function(e,t,i,n,r){for(var o=1-n,a=0;a!==r;++a){var s=t+a;e[s]=e[s]*o+e[i+a]*n}}}),Object.assign(rs.prototype,{getValue:function(e,t){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}),Object.assign(os,{Composite:rs,create:function(e,t,i){return e&&e.isAnimationObjectGroup?new os.Composite(e,t,i):new os(e,t,i)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:($a=new RegExp("^"+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),ja=["material","materials","bones"],function(e){var t=$a.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var r=i.nodeName.substring(n+1);-1!==ja.indexOf(r)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var i=function(e){for(var i=0;i<e.bones.length;i++){var n=e.bones[i];if(n.name===t)return n}return null}(e.skeleton);if(i)return i}if(e.children){var n=function(e){for(var i=0;i<e.length;i++){var r=e[i];if(r.name===t||r.uuid===t)return r;var o=n(r.children);if(o)return o}return null},r=n(e.children);if(r)return r}return null}}),Object.assign(os.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)e[t++]=i[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.node[this.propertyName]=e[t]},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.node[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++]},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,i=t.objectName,n=t.propertyName,r=t.propertyIndex;if(e||(e=os.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(i){var o=t.objectIndex;switch(i){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[i]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[n];if(void 0!==s){var l=this.Versioning.None;void 0!==e.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var c=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===r){r=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===r){r=a;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+n+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(os.prototype,{_getValue_unbound:os.prototype.getValue,_setValue_unbound:os.prototype.setValue}),Object.assign(as.prototype,{isAnimationObjectGroup:!0,add:function(e){for(var t=this._objects,i=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,l=s.length,c=0,u=arguments.length;c!==u;++c){var h=arguments[c],d=h.uuid,p=r[d],f=void 0;if(void 0===p){p=i++,r[d]=p,t.push(h);for(var m=0,g=l;m!==g;++m)s[m].push(new os(h,o[m],a[m]))}else if(p<n){f=t[p];var v=--n,y=t[v];r[y.uuid]=p,t[p]=y,r[d]=v,t[v]=h;for(m=0,g=l;m!==g;++m){var b=s[m],x=b[v],_=b[p];b[p]=x,void 0===_&&(_=new os(h,o[m],a[m])),b[v]=_}}else t[p]!==f&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(e){for(var t=this._objects,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,o=r.length,a=0,s=arguments.length;a!==s;++a){var l=arguments[a],c=l.uuid,u=n[c];if(void 0!==u&&u>=i){var h=i++,d=t[h];n[d.uuid]=u,t[u]=d,n[c]=h,t[h]=l;for(var p=0,f=o;p!==f;++p){var m=r[p],g=m[h],v=m[u];m[u]=g,m[h]=v}}}this.nCachedObjects_=i},uncache:function(e){for(var t=this._objects,i=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,o=this._bindings,a=o.length,s=0,l=arguments.length;s!==l;++s){var c=arguments[s].uuid,u=r[c];if(void 0!==u)if(delete r[c],u<n){var h=--n,d=t[h],p=t[y=--i];r[d.uuid]=u,t[u]=d,r[p.uuid]=h,t[h]=p,t.pop();for(var f=0,m=a;f!==m;++f){var g=(b=o[f])[h],v=b[y];b[u]=g,b[h]=v,b.pop()}}else{var y;r[(p=t[y=--i]).uuid]=u,t[u]=p,t.pop();for(f=0,m=a;f!==m;++f){var b;(b=o[f])[u]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var i=this._bindingsIndicesByPath,n=i[e],r=this._bindings;if(void 0!==n)return r[n];var o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=new Array(l);n=r.length,i[e]=n,o.push(e),a.push(t),r.push(u);for(var h=c,d=s.length;h!==d;++h){var p=s[h];u[h]=new os(p,e,t)}return u},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,i=t[e];if(void 0!==i){var n=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=i,o[i]=s,o.pop(),r[i]=r[a],r.pop(),n[i]=n[a],n.pop()}}}),Object.assign(ss.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){var n=this._clip.duration,r=e._clip.duration,o=r/n,a=n/r;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,i){return e.crossFadeFrom(this,t,i)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,i){var n=this._mixer,r=n.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=r,s[1]=r+i,l[0]=e/a,l[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,i,n){if(this.enabled){var r=this._startTime;if(null!==r){var o=(e-r)*i;if(o<0||0===i)return;this._startTime=null,t=i*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var l=this._interpolants,c=this._propertyBindings,u=0,h=l.length;u!==h;++u)l[u].evaluate(a),c[u].accumulate(n,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(e)[0];t*=n,e>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i)t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var i=this._clip.duration,n=this.loop,r=this._loopCount;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=i)t=i;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var o=2202===n;if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),t>=i||t<0){var a=Math.floor(t/i);t-=i*a,r+=Math.abs(a);var s=this.repetitions-r;if(s<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(0===s){var l=e<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&r))return this.time=t,i-t}return this.time=t,t},_setEndings:function(e,t,i){var n=this._interpolantSettings;i?(n.endingStart=2401,n.endingEnd=2401):(n.endingStart=e?this.zeroSlopeAtStart?2401:Qe:2402,n.endingEnd=t?this.zeroSlopeAtEnd?2401:Qe:2402)},_scheduleFading:function(e,t,i){var n=this._mixer,r=n.time,o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=t,a[1]=r+e,s[1]=i,this}}),Object.assign(ls.prototype,t.prototype,{_bindAction:function(e,t){var i=e._localRoot||this._root,n=e._clip.tracks,r=n.length,o=e._propertyBindings,a=e._interpolants,s=i.uuid,l=this._bindingsByRootAndName,c=l[s];void 0===c&&(c={},l[s]=c);for(var u=0;u!==r;++u){var h=n[u],d=h.name,p=c[d];if(void 0!==p)o[u]=p;else{if(void 0!==(p=o[u])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=t&&t._propertyBindings[u].binding.parsedPath;++(p=new ns(os.create(i,d,f),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),o[u]=p}a[u].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,t)}for(var r=e._propertyBindings,o=0,a=r.length;o!==a;++o){var s=r[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,i=0,n=t.length;i!==n;++i){var r=t[i];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,i){var n=this._actions,r=this._actionsByClip,o=r[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=n.length,n.push(e),o.actionByRoot[i]=e},_removeInactiveAction:function(e){var t=this._actions,i=t[t.length-1],n=e._cacheIndex;i._cacheIndex=n,t[n]=i,t.pop(),e._cacheIndex=null;var r=e._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,i=0,n=t.length;i!==n;++i){var r=t[i];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(e){var t=this._actions,i=e._cacheIndex,n=this._nActiveActions++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_takeBackAction:function(e){var t=this._actions,i=e._cacheIndex,n=--this._nActiveActions,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_addInactiveBinding:function(e,t,i){var n=this._bindingsByRootAndName,r=n[t],o=this._bindings;void 0===r&&(r={},n[t]=r),r[i]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,i=e.binding,n=i.rootNode.uuid,r=i.path,o=this._bindingsByRootAndName,a=o[n],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete a[r];e:{for(var c in a)break e;delete o[n]}},_lendBinding:function(e){var t=this._bindings,i=e._cacheIndex,n=this._nActiveBindings++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_takeBackBinding:function(e){var t=this._bindings,i=e._cacheIndex,n=--this._nActiveBindings,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return void 0===i&&((i=new zo(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=i),i},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,i=e.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];e.__cacheIndex=n,t[n]=e,r.__cacheIndex=i,t[i]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var i=t||this._root,n=i.uuid,r="string"==typeof e?ea.findByName(i,e):e,o=null!==r?r.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var l=a.actionByRoot[n];if(void 0!==l)return l;s=a.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var c=new ss(this,r,t);return this._bindAction(c,s),this._addInactiveAction(c,o,n),c},existingAction:function(e,t){var i=t||this._root,n=i.uuid,r="string"==typeof e?ea.findByName(i,e):e,o=r?r.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==t;++r)e[r].reset();for(r=0;r!==n;++r)i[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,i=this._nActiveActions,n=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1,a=0;a!==i;++a){t[a]._update(n,e,r,o)}var s=this._bindings,l=this._nActiveBindings;for(a=0;a!==l;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,i=e.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){for(var o=r.knownActions,a=0,s=o.length;a!==s;++a){var l=o[a];this._deactivateAction(l);var c=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,t[c]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete n[i]}},uncacheRoot:function(e){var t=e.uuid,i=this._actionsByClip;for(var n in i){var r=i[n].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),cs.prototype.clone=function(){return new cs(void 0===this.value.clone?this.value:this.value.clone())},us.prototype=Object.assign(Object.create(Tn.prototype),{constructor:us,isInstancedBufferGeometry:!0,addGroup:function(e,t,i){this.groups.push({start:e,count:t,materialIndex:i})},copy:function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var i=e.attributes;for(var n in i){var r=i[n];this.addAttribute(n,r.clone())}for(var o=e.groups,a=0,s=o.length;a<s;a++){var l=o[a];this.addGroup(l.start,l.count,l.materialIndex)}return this}}),Object.defineProperties(hs.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(hs.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}}),Object.defineProperty(ds.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ds.prototype,{isInterleavedBuffer:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.stride:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,i){e*=this.stride,i*=t.stride;for(var n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[i+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),ps.prototype=Object.assign(Object.create(ds.prototype),{constructor:ps,isInstancedInterleavedBuffer:!0,copy:function(e){return ds.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),fs.prototype=Object.assign(Object.create(dn.prototype),{constructor:fs,isInstancedBufferAttribute:!0,copy:function(e){return dn.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(ms.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t){var i=[];return vs(e,this,i,t),i.sort(gs),i},intersectObjects:function(e,t){var i=[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var n=0,r=e.length;n<r;n++)vs(e[n],this,i,t);return i.sort(gs),i}}),Object.assign(ys.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(bs.prototype,{set:function(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(dt.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(xs.prototype,{set:function(e,t,i){return this.radius=e,this.theta=t,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),_s.prototype=Object.create(In.prototype),_s.prototype.constructor=_s,_s.prototype.createAnimation=function(e,t,i,n){var r={start:t,end:i,length:i-t+1,fps:n,duration:(i-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=r,this.animationsList.push(r)},_s.prototype.autoCreateAnimations=function(e){for(var t,i=/([a-z]+)_?(\d+)/i,n={},r=this.geometry,o=0,a=r.morphTargets.length;o<a;o++){var s=r.morphTargets[o].name.match(i);if(s&&s.length>1)n[l=s[1]]||(n[l]={start:1/0,end:-1/0}),o<(c=n[l]).start&&(c.start=o),o>c.end&&(c.end=o),t||(t=l)}for(var l in n){var c=n[l];this.createAnimation(l,c.start,c.end,e)}this.firstAnimation=t},_s.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},_s.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},_s.prototype.setAnimationFPS=function(e,t){var i=this.animationsMap[e];i&&(i.fps=t,i.duration=(i.end-i.start)/i.fps)},_s.prototype.setAnimationDuration=function(e,t){var i=this.animationsMap[e];i&&(i.duration=t,i.fps=(i.end-i.start)/i.duration)},_s.prototype.setAnimationWeight=function(e,t){var i=this.animationsMap[e];i&&(i.weight=t)},_s.prototype.setAnimationTime=function(e,t){var i=this.animationsMap[e];i&&(i.time=t)},_s.prototype.getAnimationTime=function(e){var t=0,i=this.animationsMap[e];return i&&(t=i.time),t},_s.prototype.getAnimationDuration=function(e){var t=-1,i=this.animationsMap[e];return i&&(t=i.duration),t},_s.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},_s.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},_s.prototype.update=function(e){for(var t=0,i=this.animationsList.length;t<i;t++){var n=this.animationsList[t];if(n.active){var r=n.duration/n.length;n.time+=n.direction*e,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var o=n.start+dt.clamp(Math.floor(n.time/r),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o);var s=n.time%r/r;n.directionBackwards&&(s=1-s),n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=s*a,this.morphTargetInfluences[n.lastFrame]=(1-s)*a):this.morphTargetInfluences[n.currentFrame]=a}}},ws.prototype=Object.create(Zi.prototype),ws.prototype.constructor=ws,ws.prototype.isImmediateRenderObject=!0,Es.prototype=Object.create(fr.prototype),Es.prototype.constructor=Es,Es.prototype.update=function(){var e=new St,t=new St,i=new Hi;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,l=a.faces,c=0,u=0,h=l.length;u<h;u++)for(var d=l[u],p=0,f=d.vertexNormals.length;p<f;p++){var m=s[d[n[p]]],g=d.vertexNormals[p];e.copy(m).applyMatrix4(r),t.copy(g).applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),o.setXYZ(c,e.x,e.y,e.z),c+=1,o.setXYZ(c,t.x,t.y,t.z),c+=1}else if(a&&a.isBufferGeometry){var v=a.attributes.position,y=a.attributes.normal;for(c=0,p=0,f=v.count;p<f;p++)e.set(v.getX(p),v.getY(p),v.getZ(p)).applyMatrix4(r),t.set(y.getX(p),y.getY(p),y.getZ(p)),t.applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),o.setXYZ(c,e.x,e.y,e.z),c+=1,o.setXYZ(c,t.x,t.y,t.z),c+=1}o.needsUpdate=!0}}(),Ts.prototype=Object.create(Zi.prototype),Ts.prototype.constructor=Ts,Ts.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ts.prototype.update=(za=new St,Va=new St,function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),za.setFromMatrixPosition(this.light.matrixWorld),Va.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Va.sub(za)),this.cone.material.color.copy(this.light.color)}),Ms.prototype=Object.create(fr.prototype),Ms.prototype.constructor=Ms,Ms.prototype.onBeforeRender=function(){var e=new St,t=new Ct,i=new Ct;return function(){var n=this.bones,r=this.geometry,o=r.getAttribute("position");i.getInverse(this.root.matrixWorld);for(var a=0,s=0;a<n.length;a++){var l=n[a];l.parent&&l.parent.isBone&&(t.multiplyMatrices(i,l.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(s,e.x,e.y,e.z),t.multiplyMatrices(i,l.parent.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(s+1,e.x,e.y,e.z),s+=2)}r.getAttribute("position").needsUpdate=!0}}(),Ss.prototype=Object.create(In.prototype),Ss.prototype.constructor=Ss,Ss.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Ss.prototype.update=function(){this.material.color.copy(this.light.color)},Cs.prototype=Object.create(Zi.prototype),Cs.prototype.constructor=Cs,Cs.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Cs.prototype.update=function(){var e=this.children[0];e.material.color.copy(this.light.color);var t=.5*this.light.width,i=.5*this.light.height,n=e.geometry.attributes.position,r=n.array;r[0]=t,r[1]=-i,r[2]=0,r[3]=t,r[4]=i,r[5]=0,r[6]=-t,r[7]=i,r[8]=0,r[9]=-t,r[10]=-i,r[11]=0,r[12]=t,r[13]=-i,r[14]=0,n.needsUpdate=!0},Rs.prototype=Object.create(Zi.prototype),Rs.prototype.constructor=Rs,Rs.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Rs.prototype.update=function(){var e=new St,t=new gi,i=new gi;return function(){var n=this.children[0],r=n.geometry.getAttribute("color");t.copy(this.light.color),i.copy(this.light.groundColor);for(var o=0,a=r.count;o<a;o++){var s=o<a/2?t:i;r.setXYZ(o,s.r,s.g,s.b)}n.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate()),r.needsUpdate=!0}}(),As.prototype=Object.create(fr.prototype),As.prototype.constructor=As,Ps.prototype=Object.create(fr.prototype),Ps.prototype.constructor=Ps,Ls.prototype=Object.create(fr.prototype),Ls.prototype.constructor=Ls,Ls.prototype.update=function(){var e=new St,t=new St,i=new Hi;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,r=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,l=0,c=0,u=s.length;c<u;c++){var h=s[c],d=h.normal;e.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(n),t.copy(d).applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),r.setXYZ(l,e.x,e.y,e.z),l+=1,r.setXYZ(l,t.x,t.y,t.z),l+=1}r.needsUpdate=!0}}(),Os.prototype=Object.create(Zi.prototype),Os.prototype.constructor=Os,Os.prototype.dispose=function(){var e=this.children[0],t=this.children[1];e.geometry.dispose(),e.material.dispose(),t.geometry.dispose(),t.material.dispose()},Os.prototype.update=function(){var e=new St,t=new St,i=new St;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(t,e);var n=this.children[0],r=this.children[1];n.lookAt(i),n.material.color.copy(this.light.color),r.lookAt(i),r.scale.z=i.length()}}(),Is.prototype=Object.create(fr.prototype),Is.prototype.constructor=Is,Is.prototype.update=function(){var e,t,i=new St,n=new Yi;function r(r,o,a,s){i.set(o,a,s).unproject(n);var l=t[r];if(void 0!==l)for(var c=e.getAttribute("position"),u=0,h=l.length;u<h;u++)c.setXYZ(l[u],i.x,i.y,i.z)}return function(){e=this.geometry,t=this.pointMap;n.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-1,-1,-1),r("n2",1,-1,-1),r("n3",-1,1,-1),r("n4",1,1,-1),r("f1",-1,-1,1),r("f2",1,-1,1),r("f3",-1,1,1),r("f4",1,1,1),r("u1",.7,1.1,-1),r("u2",-.7,1.1,-1),r("u3",0,2,-1),r("cf1",-1,0,1),r("cf2",1,0,1),r("cf3",0,-1,1),r("cf4",0,1,1),r("cn1",-1,0,-1),r("cn2",1,0,-1),r("cn3",0,-1,-1),r("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),ks.prototype=Object.create(fr.prototype),ks.prototype.constructor=ks,ks.prototype.update=function(){var e=new Di;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var i=e.min,n=e.max,r=this.geometry.attributes.position,o=r.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=i.x,o[4]=n.y,o[5]=n.z,o[6]=i.x,o[7]=i.y,o[8]=n.z,o[9]=n.x,o[10]=i.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=i.z,o[15]=i.x,o[16]=n.y,o[17]=i.z,o[18]=i.x,o[19]=i.y,o[20]=i.z,o[21]=n.x,o[22]=i.y,o[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),ks.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Ds.prototype=Object.create(Zi.prototype),Ds.prototype.constructor=Ds,Ds.prototype.setDirection=(Xa=new St,function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(Xa.set(e.z,0,-e.x).normalize(),qa=Math.acos(e.y),this.quaternion.setFromAxisAngle(Xa,qa))}),Ds.prototype.setLength=function(e,t,i){void 0===t&&(t=.2*e),void 0===i&&(i=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()},Ds.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},Ns.prototype=Object.create(fr.prototype),Ns.prototype.constructor=Ns;var Bs=new St,Fs=new Hs,Us=new Hs,$s=new Hs;function js(e){va.call(this),e.length<2&&console.warn("THREE.CatmullRomCurve3: Points array needs at least two entries."),this.points=e||[],this.closed=!1}function zs(e,t,i,n){va.call(this),this.v0=e,this.v1=t,this.v2=i,this.v3=n}function Vs(e,t,i){va.call(this),this.v0=e,this.v1=t,this.v2=i}function Gs(e,t){va.call(this),this.v1=e,this.v2=t}function Ws(e,t,i,n,r,o){xa.call(this,e,t,i,i,n,r,o)}js.prototype=Object.create(va.prototype),js.prototype.constructor=js,js.prototype.getPoint=function(e){var t,i,n,r,o=this.points,a=o.length,s=(a-(this.closed?0:1))*e,l=Math.floor(s),c=s-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/o.length)+1)*o.length:0===c&&l===a-1&&(l=a-2,c=1),this.closed||l>0?t=o[(l-1)%a]:(Bs.subVectors(o[0],o[1]).add(o[0]),t=Bs),i=o[l%a],n=o[(l+1)%a],this.closed||l+2<a?r=o[(l+2)%a]:(Bs.subVectors(o[a-1],o[a-2]).add(o[a-1]),r=Bs),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var u="chordal"===this.type?.5:.25,h=Math.pow(t.distanceToSquared(i),u),d=Math.pow(i.distanceToSquared(n),u),p=Math.pow(n.distanceToSquared(r),u);d<1e-4&&(d=1),h<1e-4&&(h=d),p<1e-4&&(p=d),Fs.initNonuniformCatmullRom(t.x,i.x,n.x,r.x,h,d,p),Us.initNonuniformCatmullRom(t.y,i.y,n.y,r.y,h,d,p),$s.initNonuniformCatmullRom(t.z,i.z,n.z,r.z,h,d,p)}else if("catmullrom"===this.type){var f=void 0!==this.tension?this.tension:.5;Fs.initCatmullRom(t.x,i.x,n.x,r.x,f),Us.initCatmullRom(t.y,i.y,n.y,r.y,f),$s.initCatmullRom(t.z,i.z,n.z,r.z,f)}return new St(Fs.calc(c),Us.calc(c),$s.calc(c))},zs.prototype=Object.create(va.prototype),zs.prototype.constructor=zs,zs.prototype.getPoint=function(e){var t=this.v0,i=this.v1,n=this.v2,r=this.v3;return new St(ga(e,t.x,i.x,n.x,r.x),ga(e,t.y,i.y,n.y,r.y),ga(e,t.z,i.z,n.z,r.z))},Vs.prototype=Object.create(va.prototype),Vs.prototype.constructor=Vs,Vs.prototype.getPoint=function(e){var t=this.v0,i=this.v1,n=this.v2;return new St(ma(e,t.x,i.x,n.x),ma(e,t.y,i.y,n.y),ma(e,t.z,i.z,n.z))},Gs.prototype=Object.create(va.prototype),Gs.prototype.constructor=Gs,Gs.prototype.getPoint=function(e){if(1===e)return this.v2.clone();var t=new St;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t},Ws.prototype=Object.create(xa.prototype),Ws.prototype.constructor=Ws;var qs={createMultiMaterialObject:function(e,t){for(var i=new yr,n=0,r=t.length;n<r;n++)i.add(new In(e,t[n]));return i},detach:function(e,t,i){e.applyMatrix(t.matrixWorld),t.remove(e),i.add(e)},attach:function(e,t,i){e.applyMatrix((new Ct).getInverse(i.matrixWorld)),t.remove(e),i.add(e)}};function Xs(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),js.call(this,e),this.type="catmullrom",this.closed=!0}function Zs(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),js.call(this,e),this.type="catmullrom"}function Ys(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),js.call(this,e),this.type="catmullrom"}va.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(va.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Xs.prototype=Object.create(js.prototype),Zs.prototype=Object.create(js.prototype),Ys.prototype=Object.create(js.prototype),Object.assign(Ys.prototype,{initFromArray:function(e){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(e){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(e){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),As.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Ms.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(_i.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Di.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Ln.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},dt.random16=function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},Object.assign(Hi.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e,t,i){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(e,t,i){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Ct.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new St),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e,t,i){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(e,t,i){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,i,n,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,n,i,r,o)}}),Bi.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Mt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Pn.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Ca.prototype,{extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new zr(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Qr(this,e)}}),Object.assign(pt.prototype,{fromAttribute:function(e,t,i){return console.error("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)}}),Object.assign(St.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,i){return console.error("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)}}),Object.assign(wt.prototype,{fromAttribute:function(e,t,i){return console.error("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)}}),hn.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(Zi.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)}}),Object.defineProperties(Zi.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(lr.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(cr.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(va.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ki.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Ao.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(dn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(Tn.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Tn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(cs.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Oi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new gi}}}),Object.defineProperties(fo.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Ii.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(tr.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(tr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=e}}}),Object.defineProperties(Ui.prototype,{cullFace:{get:function(){return this.renderReverseSided?h:u},set:function(e){var t=e!==u;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(Et.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),es.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Ya).load(e,function(e){t.setBuffer(e)}),this},is.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};var Js={merge:function(e,t,i){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,i)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},Ks={crossOrigin:void 0,loadTexture:function(e,t,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new Ro;r.setCrossOrigin(this.crossOrigin);var o=r.load(e,i,void 0,n);return t&&(o.mapping=t),o},loadTextureCube:function(e,t,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Co;r.setCrossOrigin(this.crossOrigin);var o=r.load(e,i,void 0,n);return t&&(o.mapping=t),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};e.WebGLRenderTargetCube=Tt,e.WebGLRenderTarget=Et,e.WebGLRenderer=tr,e.ShaderLib=xi,e.UniformsLib=vi,e.UniformsUtils=yi,e.ShaderChunk=bi,e.FogExp2=ir,e.Fog=nr,e.Scene=rr,e.LensFlare=or,e.Sprite=sr,e.LOD=lr,e.SkinnedMesh=hr,e.Skeleton=cr,e.Bone=ur,e.Mesh=In,e.LineSegments=fr,e.LineLoop=mr,e.Line=pr,e.Points=vr,e.Group=yr,e.VideoTexture=br,e.DataTexture=Rt,e.CompressedTexture=xr,e.CubeTexture=At,e.CanvasTexture=_r,e.DepthTexture=wr,e.Texture=_t,e.CompressedTextureLoader=To,e.DataTextureLoader=Mo,e.CubeTextureLoader=Co,e.TextureLoader=Ro,e.ObjectLoader=ua,e.MaterialLoader=ta,e.BufferGeometryLoader=ia,e.DefaultLoadingManager=wo,e.LoadingManager=_o,e.JSONLoader=ca,e.ImageLoader=So,e.FontLoader=Pa,e.FileLoader=Eo,e.Loader=la,e.Cache=xo,e.AudioLoader=Ya,e.SpotLightShadow=Oo,e.SpotLight=Io,e.PointLight=ko,e.RectAreaLight=Bo,e.HemisphereLight=Po,e.DirectionalLightShadow=Do,e.DirectionalLight=No,e.AmbientLight=Ho,e.LightShadow=Lo,e.Light=Ao,e.StereoCamera=Ja,e.PerspectiveCamera=Ki,e.OrthographicCamera=Ji,e.CubeCamera=Ka,e.ArrayCamera=er,e.Camera=Yi,e.AudioListener=Qa,e.PositionalAudio=ts,e.AudioContext=Za,e.AudioAnalyser=is,e.Audio=es,e.VectorKeyframeTrack=Wo,e.StringKeyframeTrack=Yo,e.QuaternionKeyframeTrack=Xo,e.NumberKeyframeTrack=Zo,e.ColorKeyframeTrack=Ko,e.BooleanKeyframeTrack=Jo,e.PropertyMixer=ns,e.PropertyBinding=os,e.KeyframeTrack=Qo,e.AnimationUtils=Uo,e.AnimationObjectGroup=as,e.AnimationMixer=ls,e.AnimationClip=ea,e.Uniform=cs,e.InstancedBufferGeometry=us,e.BufferGeometry=Tn,e.GeometryIdCount=un,e.Geometry=hn,e.InterleavedBufferAttribute=hs,e.InstancedInterleavedBuffer=ps,e.InterleavedBuffer=ds,e.InstancedBufferAttribute=fs,e.Face3=Qi,e.Object3D=Zi,e.Raycaster=ms,e.Layers=zi,e.EventDispatcher=t,e.Clock=ys,e.QuaternionLinearInterpolant=qo,e.LinearInterpolant=zo,e.DiscreteInterpolant=Vo,e.CubicInterpolant=jo,e.Interpolant=$o,e.Triangle=On,e.Math=dt,e.Spherical=bs,e.Cylindrical=xs,e.Plane=Bi,e.Frustum=Fi,e.Sphere=Ni,e.Ray=Pn,e.Matrix4=Ct,e.Matrix3=Hi,e.Box3=Di,e.Box2=_i,e.Line3=Ln,e.Euler=ji,e.Vector4=wt,e.Vector3=St,e.Vector2=pt,e.Quaternion=Mt,e.Color=gi,e.MorphBlendMesh=_s,e.ImmediateRenderObject=ws,e.VertexNormalsHelper=Es,e.SpotLightHelper=Ts,e.SkeletonHelper=Ms,e.PointLightHelper=Ss,e.RectAreaLightHelper=Cs,e.HemisphereLightHelper=Rs,e.GridHelper=As,e.PolarGridHelper=Ps,e.FaceNormalsHelper=Ls,e.DirectionalLightHelper=Os,e.CameraHelper=Is,e.BoxHelper=ks,e.ArrowHelper=Ds,e.AxisHelper=Ns,e.CatmullRomCurve3=js,e.CubicBezierCurve3=zs,e.QuadraticBezierCurve3=Vs,e.LineCurve3=Gs,e.ArcCurve=Ws,e.EllipseCurve=xa,e.SplineCurve=_a,e.CubicBezierCurve=wa,e.QuadraticBezierCurve=Ea,e.LineCurve=ya,e.Shape=Ca,e.Path=Sa,e.ShapePath=Ra,e.Font=Aa,e.CurvePath=ba,e.Curve=va,e.ShapeUtils=jr,e.SceneUtils=qs,e.WireframeGeometry=Er,e.ParametricGeometry=Tr,e.ParametricBufferGeometry=Mr,e.TetrahedronGeometry=Rr,e.TetrahedronBufferGeometry=Ar,e.OctahedronGeometry=Pr,e.OctahedronBufferGeometry=Lr,e.IcosahedronGeometry=Or,e.IcosahedronBufferGeometry=Ir,e.DodecahedronGeometry=kr,e.DodecahedronBufferGeometry=Dr,e.PolyhedronGeometry=Sr,e.PolyhedronBufferGeometry=Cr,e.TubeGeometry=Nr,e.TubeBufferGeometry=Hr,e.TorusKnotGeometry=Br,e.TorusKnotBufferGeometry=Fr,e.TorusGeometry=Ur,e.TorusBufferGeometry=$r,e.TextGeometry=Gr,e.TextBufferGeometry=Wr,e.SphereGeometry=qr,e.SphereBufferGeometry=Xr,e.RingGeometry=Zr,e.RingBufferGeometry=Yr,e.PlaneGeometry=Cn,e.PlaneBufferGeometry=Rn,e.LatheGeometry=Jr,e.LatheBufferGeometry=Kr,e.ShapeGeometry=Qr,e.ShapeBufferGeometry=eo,e.ExtrudeGeometry=zr,e.ExtrudeBufferGeometry=Vr,e.EdgesGeometry=to,e.ConeGeometry=ro,e.ConeBufferGeometry=oo,e.CylinderGeometry=io,e.CylinderBufferGeometry=no,e.CircleGeometry=ao,e.CircleBufferGeometry=so,e.BoxGeometry=Mn,e.BoxBufferGeometry=Sn,e.ShadowMaterial=co,e.SpriteMaterial=ar,e.RawShaderMaterial=uo,e.ShaderMaterial=Ii,e.PointsMaterial=gr,e.MeshPhysicalMaterial=po,e.MeshStandardMaterial=ho,e.MeshPhongMaterial=fo,e.MeshToonMaterial=mo,e.MeshNormalMaterial=go,e.MeshLambertMaterial=vo,e.MeshDepthMaterial=ki,e.MeshBasicMaterial=An,e.LineDashedMaterial=yo,e.LineBasicMaterial=dr,e.Material=Oi,e.Float64BufferAttribute=_n,e.Float32BufferAttribute=xn,e.Uint32BufferAttribute=bn,e.Int32BufferAttribute=yn,e.Uint16BufferAttribute=vn,e.Int16BufferAttribute=gn,e.Uint8ClampedBufferAttribute=mn,e.Uint8BufferAttribute=fn,e.Int8BufferAttribute=pn,e.BufferAttribute=dn,e.REVISION=l,e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=c,e.CullFaceBack=u,e.CullFaceFront=h,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=d,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=p,e.PCFSoftShadowMap=f,e.FrontSide=m,e.BackSide=g,e.DoubleSide=v,e.FlatShading=y,e.SmoothShading=b,e.NoColors=x,e.FaceColors=_,e.VertexColors=w,e.NoBlending=E,e.NormalBlending=T,e.AdditiveBlending=M,e.SubtractiveBlending=S,e.MultiplyBlending=C,e.CustomBlending=R,e.AddEquation=A,e.SubtractEquation=P,e.ReverseSubtractEquation=L,e.MinEquation=O,e.MaxEquation=I,e.ZeroFactor=k,e.OneFactor=D,e.SrcColorFactor=N,e.OneMinusSrcColorFactor=H,e.SrcAlphaFactor=B,e.OneMinusSrcAlphaFactor=F,e.DstAlphaFactor=U,e.OneMinusDstAlphaFactor=$,e.DstColorFactor=j,e.OneMinusDstColorFactor=z,e.SrcAlphaSaturateFactor=V,e.NeverDepth=G,e.AlwaysDepth=W,e.LessDepth=q,e.LessEqualDepth=X,e.EqualDepth=Z,e.GreaterEqualDepth=Y,e.GreaterDepth=J,e.NotEqualDepth=K,e.MultiplyOperation=Q,e.MixOperation=ee,e.AddOperation=te,e.NoToneMapping=ie,e.LinearToneMapping=ne,e.ReinhardToneMapping=re,e.Uncharted2ToneMapping=oe,e.CineonToneMapping=ae,e.UVMapping=300,e.CubeReflectionMapping=se,e.CubeRefractionMapping=le,e.EquirectangularReflectionMapping=ce,e.EquirectangularRefractionMapping=ue,e.SphericalReflectionMapping=he,e.CubeUVReflectionMapping=de,e.CubeUVRefractionMapping=pe,e.RepeatWrapping=fe,e.ClampToEdgeWrapping=me,e.MirroredRepeatWrapping=ge,e.NearestFilter=ve,e.NearestMipMapNearestFilter=ye,e.NearestMipMapLinearFilter=be,e.LinearFilter=xe,e.LinearMipMapNearestFilter=_e,e.LinearMipMapLinearFilter=we,e.UnsignedByteType=Ee,e.ByteType=Te,e.ShortType=Me,e.UnsignedShortType=Se,e.IntType=Ce,e.UnsignedIntType=Re,e.FloatType=Ae,e.HalfFloatType=Pe,e.UnsignedShort4444Type=Le,e.UnsignedShort5551Type=Oe,e.UnsignedShort565Type=Ie,e.UnsignedInt248Type=ke,e.AlphaFormat=De,e.RGBFormat=Ne,e.RGBAFormat=He,e.LuminanceFormat=Be,e.LuminanceAlphaFormat=Fe,e.RGBEFormat=Ue,e.DepthFormat=$e,e.DepthStencilFormat=je,e.RGB_S3TC_DXT1_Format=ze,e.RGBA_S3TC_DXT1_Format=Ve,e.RGBA_S3TC_DXT3_Format=Ge,e.RGBA_S3TC_DXT5_Format=We,e.RGB_PVRTC_4BPPV1_Format=qe,e.RGB_PVRTC_2BPPV1_Format=Xe,e.RGBA_PVRTC_4BPPV1_Format=Ze,e.RGBA_PVRTC_2BPPV1_Format=Ye,e.RGB_ETC1_Format=Je,e.LoopOnce=2200,e.LoopRepeat=Ke,e.LoopPingPong=2202,e.InterpolateDiscrete=2300,e.InterpolateLinear=2301,e.InterpolateSmooth=2302,e.ZeroCurvatureEnding=Qe,e.ZeroSlopeEnding=2401,e.WrapAroundEnding=2402,e.TrianglesDrawMode=et,e.TriangleStripDrawMode=tt,e.TriangleFanDrawMode=it,e.LinearEncoding=nt,e.sRGBEncoding=rt,e.GammaEncoding=ot,e.RGBEEncoding=at,e.LogLuvEncoding=3003,e.RGBM7Encoding=st,e.RGBM16Encoding=lt,e.RGBDEncoding=ct,e.BasicDepthPacking=ut,e.RGBADepthPacking=ht,e.CubeGeometry=Mn,e.Face4=function(e,t,i,n,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Qi(e,t,i,r,o,a)},e.LineStrip=0,e.LinePieces=1,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new vr(e,t)},e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new sr(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new vr(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new gr(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new gr(e)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new gr(e)},e.Vertex=function(e,t,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new St(e,t,i)},e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new dn(e,t).setDynamic(!0)},e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new pn(e,t)},e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new fn(e,t)},e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new mn(e,t)},e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new gn(e,t)},e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new vn(e,t)},e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new yn(e,t)},e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new bn(e,t)},e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new xn(e,t)},e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new _n(e,t)},e.ClosedSplineCurve3=Xs,e.SplineCurve3=Zs,e.Spline=Ys,e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new ks(e,t)},e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new fr(new to(e.geometry),new dr({color:void 0!==t?t:16777215}))},e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new fr(new Er(e.geometry),new dr({color:void 0!==t?t:16777215}))},e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Eo(e)},e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Mo(e)},e.GeometryUtils=Js,e.ImageUtils=Ks,e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(e,"__esModule",{value:!0})}),THREE.Object3D.prototype.getDescendants=function(e){void 0===e&&(e=[]),Array.prototype.push.apply(e,this.children);for(var t=0,i=this.children.length;t<i;t++)this.children[t].getDescendants(e);return e},THREE.ColladaLoader=function(){var e,t,i,n,r,o,a,s,l,c,u=null,h=null,d=null,p={},f={},m={},g={},v={},y={},b={},x={},_={},w=THREE.SmoothShading,E={centerGeometry:!1,convertUpAxis:!1,subdivideFaces:!0,upAxis:"Y",defaultEnvMap:null},T=1,M="Y",S=null;function C(c,p,w){if(u=(new DOMParser).parseFromString(c,"text/xml"),p=p||d,void 0!==w){var C=w.split("/");C.pop(),a=(C.length<1?".":C.join("/"))+"/"}!function(){var e=u.querySelectorAll("asset")[0];if(e&&e.childNodes)for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"unit":var n=i.getAttribute("meter");n&&(T=parseFloat(n));break;case"up_axis":M=i.textContent.charAt(0)}}}(),function(){if(!0!==E.convertUpAxis||M===E.upAxis)S=null;else switch(M){case"X":S="Y"===E.upAxis?"XtoY":"XtoZ";break;case"Y":S="X"===E.upAxis?"YtoX":"YtoZ";break;case"Z":S="X"===E.upAxis?"ZtoX":"ZtoY"}}(),f=R("library_images image",B,"image"),y=R("library_materials material",re,"material"),b=R("library_effects effect",ce,"effect"),v=R("library_geometries geometry",X,"geometry"),x=R("library_cameras camera",me,"camera"),_=R("library_lights light",ve,"light"),g=R("library_controllers controller",F,"controller"),m=R("library_animations animation",he,"animation"),r=R("library_visual_scenes visual_scene",j,"visual_scene"),o=R("library_kinematics_models kinematics_model",be,"kinematics_model"),s=[],l=[],e=function(){var e=u.querySelectorAll("scene instance_visual_scene")[0];if(e){var t=e.getAttribute("url").replace(/^#/,"");return r[t.length>0?t:"visual_scene0"]}return null}(),h=new THREE.Group;for(var A=0;A<e.nodes.length;A++)h.add(I(e.nodes[A]));h.scale.multiplyScalar(T),i=[],function t(n){var r=e.getChildById(n.colladaId,!0),o=null;if(r&&r.keys){o={fps:60,hierarchy:[{node:r,keys:r.keys,sids:r.sids}],node:n,name:"animation_"+n.name,length:0},i.push(o);for(var a=0,s=r.keys.length;a<s;a++)o.length=Math.max(o.length,r.keys[a].time)}else o={hierarchy:[{keys:[],sids:[]}]};for(var a=0,s=n.children.length;a<s;a++)for(var l=t(n.children[a]),c=0,u=l.hierarchy.length;c<u;c++)o.hierarchy.push({keys:[],sids:[]});return o}(h),t=function(){var e=u.querySelectorAll("instance_kinematics_model")[0];if(e){var t=e.getAttribute("url").replace(/^#/,"");return o[t.length>0?t:"kinematics_model0"]}return null}(),function(){if(t&&0===t.joints.length)return void(n=void 0);var i={},r=function(n,r){var o=r.getAttribute("id"),a=e.getChildById(o,!0),s=t.joints[n];h.traverse(function(e){e.colladaId==o&&(i[n]={node:e,transforms:a.transforms,joint:s,position:s.zeroPosition})})};n={joints:t&&t.joints,getJointValue:function(e){var t=i[e];if(t)return t.position;console.log("getJointValue: joint "+e+" doesn't exist")},setJointValue:function(e,t){var n=i[e];if(n){var r=n.joint;if(t>r.limits.max||t<r.limits.min)console.log("setJointValue: joint "+e+" value "+t+" outside of limits (min: "+r.limits.min+", max: "+r.limits.max+")");else if(r.static)console.log("setJointValue: joint "+e+" is static");else{var o=n.node,s=r.axis,l=n.transforms,c=new THREE.Matrix4,u=new THREE.Matrix4;for(a=0;a<l.length;a++){var h=l[a];if(h.sid&&-1!==h.sid.indexOf("joint"+e))switch(r.type){case"revolute":c.multiply(u.makeRotationAxis(s,THREE.Math.degToRad(t)));break;case"prismatic":c.multiply(u.makeTranslation(s.x*t,s.y*t,s.z*t));break;default:console.warn("setJointValue: unknown joint type: "+r.type)}else switch(h.type){case"matrix":c.multiply(h.obj);break;case"translate":c.multiply(u.makeTranslation(h.obj.x,h.obj.y,h.obj.z));break;case"rotate":c.multiply(u.makeRotationAxis(h.obj,h.angle))}}var d=c.elements,p=Array.prototype.slice.call(d),f=[p[0],p[4],p[8],p[12],p[1],p[5],p[9],p[13],p[2],p[6],p[10],p[14],p[3],p[7],p[11],p[15]];o.matrix.set.apply(o.matrix,f),o.matrix.decompose(o.position,o.quaternion,o.scale),i[e].position=t}}else console.log("setJointValue: joint "+e+" doesn't exist")}};var o=u.querySelector("scene instance_kinematics_scene");if(o)for(var a=0;a<o.childNodes.length;a++){var s=o.childNodes[a];if(1==s.nodeType)switch(s.nodeName){case"bind_joint_axis":var l=s.getAttribute("target").split("/").pop(),c=s.querySelector("axis param").textContent,d=parseInt(c.split("joint").pop().split(".")[0]),p=u.querySelector('[sid="'+l+'"]');if(p){var f=p.parentElement;r(d,f)}}}}();var P={scene:h,morphs:s,skins:l,animations:i,kinematics:n,dae:{images:f,materials:y,cameras:x,lights:_,effects:b,geometries:v,controllers:g,animations:m,visualScenes:r,visualScene:e,scene:e,kinematicsModels:o,kinematicsModel:t}};return p&&p(P),P}function R(e,t,i){for(var n=u.querySelectorAll(e),r={},o=0,a=n.length,s=0;s<a;s++){var l=n[s],c=(new t).parse(l);c.id&&0!==c.id.length||(c.id=i+o++),r[c.id]=c}return r}function A(e,t){var i=t instanceof G?g[t.url]:t;if(i&&i.morph){for(var n=i.morph,r=0;r<n.targets.length;r++){var o=n.targets[r],a=v[o];if(a.mesh&&a.mesh.primitives&&a.mesh.primitives.length){var s=a.mesh.primitives[0].geometry;s.vertices.length===e.vertices.length&&e.morphTargets.push({name:"target_1",vertices:s.vertices})}}e.morphTargets.push({name:"target_Z",vertices:e.vertices})}else console.log("could not find morph controller!")}function P(e,t,i,n){if(e.world=e.world||new THREE.Matrix4,e.localworld=e.localworld||new THREE.Matrix4,e.world.copy(e.matrix),e.localworld.copy(e.matrix),e.channels&&e.channels.length){var r=e.channels[0].sampler.output[i];r instanceof THREE.Matrix4&&(e.world.copy(r),e.localworld.copy(r),0===i&&e.matrix.copy(r))}n&&e.world.multiplyMatrices(n,e.world),t.push(e);for(var o=0;o<e.nodes.length;o++)P(e.nodes[o],t,i,e.world)}function L(e,t){for(var i=0;i<e.length;i++){var n=e[i],r=-1;if("JOINT"==n.type){for(var o=0;o<t.joints.length;o++)if(n.sid===t.joints[o]){r=o;break}if(r>=0){var a=t.invBindMatrices[r];n.invBindMatrix=a,n.skinningMatrix=new THREE.Matrix4,n.skinningMatrix.multiplyMatrices(n.world,a),n.animatrix=new THREE.Matrix4,n.animatrix.copy(n.localworld),n.weights=[];for(o=0;o<t.weights.length;o++)for(var s=0;s<t.weights[o].length;s++){var l=t.weights[o][s];l.joint===r&&n.weights.push(l)}}else console.warn("ColladaLoader: Could not find joint '"+n.sid+"'."),n.skinningMatrix=new THREE.Matrix4,n.weights=[]}}}function O(t,i,n){void 0===n&&(n=40);var r=g[i.url];if(r&&r.skin)if(i.skeleton&&i.skeleton.length){for(var o=function(){var e,t=1e6,i=-t,n=0;for(var r in m){var o=m[r];e=e||o.id;for(var a=0;a<o.sampler.length;a++){var s=o.sampler[a];s.create(),t=Math.min(t,s.startTime),i=Math.max(i,s.endTime),n=Math.max(n,s.input.length)}}return{start:t,end:i,frames:n,ID:e}}(),a=e.getChildById(i.skeleton[0],!0)||e.getChildBySid(i.skeleton[0],!0),s=function(e){var t=[],i=function(e,t,n){var r={};r.name=t.sid,r.parent=e,r.matrix=t.matrix;var o=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];for(var a in r.matrix.decompose(o[0],o[1],o[2]),r.pos=[o[0].x,o[0].y,o[0].z],r.scl=[o[2].x,o[2].y,o[2].z],r.rotq=[o[1].x,o[1].y,o[1].z,o[1].w],n.push(r),t.nodes)i(t.sid,t.nodes[a],n)};return i(-1,e,t),t}(a),l=r.skin.joints,c=[],u=0;u<l.length;u++)for(var h=0;h<s.length;h++)s[h].name===l[u]&&(c[u]=s[h]);for(var u=0;u<c.length;u++)for(var h=0;h<c.length;h++)c[u].parent===c[h].name&&(c[u].parent=h);new THREE.Vector3;for(u=0;u<t.vertices.length;u++)t.vertices[u].applyMatrix4(r.skin.bindShapeMatrix);var d=[],p=[],f=r.skin.weights;for(u=0;u<f.length;u++){var v=new THREE.Vector4(f[u][0]?f[u][0].joint:0,f[u][1]?f[u][1].joint:0,f[u][2]?f[u][2].joint:0,f[u][3]?f[u][3].joint:0),y=new THREE.Vector4(f[u][0]?f[u][0].weight:0,f[u][1]?f[u][1].weight:0,f[u][2]?f[u][2].weight:0,f[u][3]?f[u][3].weight:0);d.push(v),p.push(y)}t.skinIndices=d,t.skinWeights=p,t.bones=c;var b={name:o.ID,fps:30,length:o.frames/30,hierarchy:[]};for(h=0;h<c.length;h++)b.hierarchy.push({parent:c[h].parent,name:c[h].name,keys:[]});for(console.log("ColladaLoader:",o.ID+" has "+c.length+" bones."),function(e,t,i){var n=[];P(t,n,-1),L(n,i.skin);for(var r=new THREE.Vector3,o=[],a=0;a<e.vertices.length;a++)o.push(new THREE.Vector3);for(a=0;a<n.length;a++)if("JOINT"==n[a].type)for(var s=0;s<n[a].weights.length;s++){var l=n[a].weights[s],c=l.index,u=l.weight,h=e.vertices[c],d=o[c];r.x=h.x,r.y=h.y,r.z=h.z,r.applyMatrix4(n[a].skinningMatrix),d.x+=r.x*u,d.y+=r.y*u,d.z+=r.z*u}for(a=0;a<e.vertices.length;a++)e.vertices[a]=o[a]}(t,a,r),n=0;n<o.frames;n++){var x=[];P(a,x,n),L(x,r.skin);for(u=0;u<x.length;u++)for(h=0;h<b.hierarchy.length;h++)if(b.hierarchy[h].name===x[u].sid){var _={};_.time=n/30,_.matrix=x[u].animatrix,0===n&&(x[u].matrix=_.matrix);var w=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];_.matrix.decompose(w[0],w[1],w[2]),_.pos=[w[0].x,w[0].y,w[0].z],_.scl=[w[2].x,w[2].y,w[2].z],_.rot=w[1],b.hierarchy[h].keys.push(_)}t.animation=b}}else console.log("ColladaLoader: Could not find the skeleton for the skin. ");else console.log("ColladaLoader: Could not find skin controller.")}function I(e,t){var i,n,r,o,a=new THREE.Object3D;for(r=0;r<e.controllers.length;r++){var c=g[e.controllers[r].url];switch(c.type){case"skin":if(v[c.skin.source])(h=new q).url=c.skin.source,h.instance_material=e.controllers[r].instance_material,e.geometries.push(h),!0,i=e.controllers[r];else if(g[c.skin.source]){var u=g[c.skin.source];if(n=u,u.morph&&v[u.morph.source])(h=new q).url=u.morph.source,h.instance_material=e.controllers[r].instance_material,e.geometries.push(h)}break;case"morph":var h;if(v[c.morph.source])(h=new q).url=c.morph.source,h.instance_material=e.controllers[r].instance_material,e.geometries.push(h),n=e.controllers[r];console.log("ColladaLoader: Morph-controller partially supported.")}}var d={};for(r=0;r<e.geometries.length;r++){var p,f=e.geometries[r],m=f.instance_material,w=v[f.url],T={},M=[],S=0;if(w){if(!w.mesh||!w.mesh.primitives)continue;if(0===a.name.length&&(a.name=w.id),m)for(o=0;o<m.length;o++){var C=m[o],R=y[C.target],P=R.instance_effect.url,L=b[P].shader.material;if(w.doubleSided){if(!(C.symbol in d)){var k=L.clone();k.side=THREE.DoubleSide,d[C.symbol]=k}L=d[C.symbol]}L.opacity=L.opacity?L.opacity:1,T[C.symbol]=S,M.push(L),(p=L).name=null===R.name||""===R.name?R.id:R.name,S++}var D,N=p||new THREE.MeshLambertMaterial({color:14540253,side:w.doubleSided?THREE.DoubleSide:THREE.FrontSide}),H=w.mesh.geometry3js;if(S>1)for(N=new THREE.MultiMaterial(M),o=0;o<H.faces.length;o++){var B=H.faces[o];B.materialIndex=T[B.daeMaterial]}void 0!==i?(O(H,i),H.morphTargets.length>0?(N.morphTargets=!0,N.skinning=!1):(N.morphTargets=!1,N.skinning=!0),(D=new THREE.SkinnedMesh(H,N,!1)).name="skin_"+l.length,l.push(D)):void 0!==n?(A(H,n),N.morphTargets=!0,(D=new THREE.Mesh(H,N)).name="morph_"+s.length,s.push(D)):!0===H.isLineStrip?D=new THREE.Line(H):(D=new THREE.Mesh(H,N)).geometry.name=w.name,a.add(D)}}for(r=0;r<e.cameras.length;r++){var F=e.cameras[r],U=x[F.url],$=new THREE.PerspectiveCamera(U.yfov,parseFloat(U.aspect_ratio),parseFloat(U.znear),parseFloat(U.zfar));a.add($)}for(r=0;r<e.lights.length;r++){var j=null,z=e.lights[r],V=_[z.url];if(V&&V.technique){var G=V.color.getHex(),W=V.intensity,X=V.distance,Z=V.falloff_angle;switch(V.technique){case"directional":(j=new THREE.DirectionalLight(G,W,X)).position.set(0,0,1);break;case"point":j=new THREE.PointLight(G,W,X);break;case"spot":(j=new THREE.SpotLight(G,W,X,Z)).position.set(0,0,1);break;case"ambient":j=new THREE.AmbientLight(G)}}j&&a.add(j)}if(a.name=e.name||e.id||"",a.colladaId=e.id||"",a.layer=e.layer||"",a.matrix=e.matrix,a.matrix.decompose(a.position,a.quaternion,a.scale),E.centerGeometry&&a.geometry){var Y=a.geometry.center();Y.multiply(a.scale),Y.applyQuaternion(a.quaternion),a.position.sub(Y)}for(r=0;r<e.nodes.length;r++)a.add(I(e.nodes[r],e));return a}function k(e){for(var t=u.querySelectorAll("library_nodes node"),i=0;i<t.length;i++){var n=t[i].attributes.getNamedItem("id");if(n&&n.value===e)return t[i]}}function D(e,t){for(var i=null,n=0,r=e.length;n<r&&null===i;n++){var o=e[n];if(o.time===t)i=o;else if(o.time>t)break}return i}function N(e,t){for(var i=-1,n=0,r=e.length;n<r&&-1===i;n++){e[n].time>=t&&(i=n)}return i}function H(e,t,i,n){var r=function(e,t,i){for(i=i>=0?i:i+e.length;i>=0;i--){var n=e[i];if(n.hasTarget(t))return n}return null}(e,n,i?i-1:0),o=function(e,t,i){for(;i<e.length;i++){var n=e[i];if(n.hasTarget(t))return n}return null}(e,n,i+1);if(r&&o){var a,s=(t.time-r.time)/(o.time-r.time),l=r.getTarget(n),c=o.getTarget(n).data,u=l.data;if("matrix"===l.type)a=u;else if(u.length){a=[];for(var h=0;h<u.length;++h)a[h]=u[h]+(c[h]-u[h])*s}else a=u+(c-u)*s;t.addTarget(n,l.transform,l.member,a)}}function B(){this.id="",this.init_from=""}function F(){this.id="",this.name="",this.type="",this.skin=null,this.morph=null}function U(){this.method=null,this.source=null,this.targets=null,this.weights=null}function $(){this.source="",this.bindShapeMatrix=null,this.invBindMatrices=[],this.joints=[],this.weights=[]}function j(){this.id="",this.name="",this.nodes=[],this.scene=new THREE.Group}function z(){this.id="",this.name="",this.sid="",this.nodes=[],this.controllers=[],this.transforms=[],this.geometries=[],this.channels=[],this.matrix=new THREE.Matrix4}function V(){this.sid="",this.type="",this.data=[],this.obj=null}function G(){this.url="",this.skeleton=[],this.instance_material=[]}function W(){this.symbol="",this.target=""}function q(){this.url="",this.instance_material=[]}function X(){this.id="",this.name="",this.mesh=null}function Z(e){this.geometry=e.id,this.primitives=[],this.vertices=null,this.geometry3js=null}function Y(){this.material="",this.count=0,this.inputs=[],this.vcount=null,this.p=[],this.geometry=new THREE.Geometry}function J(){Y.call(this),this.vcount=[]}function K(){Y.call(this),this.vcount=1}function Q(){Y.call(this),this.vcount=3}function ee(){this.source="",this.count=0,this.stride=0,this.params=[]}function te(){this.input={}}function ie(){this.semantic="",this.offset=0,this.source="",this.set=0}function ne(e){this.id=e,this.type=null}function re(){this.id="",this.name="",this.instance_effect=null}function oe(){this.color=new THREE.Color,this.color.setRGB(Math.random(),Math.random(),Math.random()),this.color.a=1,this.texture=null,this.texcoord=null,this.texOpts=null}function ae(e,t){this.type=e,this.effect=t,this.material=null}function se(e){this.effect=e,this.init_from=null,this.format=null}function le(e){this.effect=e,this.source=null,this.wrap_s=null,this.wrap_t=null,this.minfilter=null,this.magfilter=null,this.mipfilter=null}function ce(){this.id="",this.name="",this.shader=null,this.surface={},this.sampler={}}function ue(){this.url=""}function he(){this.id="",this.name="",this.source={},this.sampler=[],this.channel=[]}function de(e){this.animation=e,this.source="",this.target="",this.fullSid=null,this.sid=null,this.dotSyntax=null,this.arrSyntax=null,this.arrIndices=null,this.member=null}function pe(e){this.id="",this.animation=e,this.inputs=[],this.input=null,this.output=null,this.strideOut=null,this.interpolation=null,this.startTime=null,this.endTime=null,this.duration=0}function fe(e){this.targets=[],this.time=e}function me(){this.id="",this.name="",this.technique=""}function ge(){this.url=""}function ve(){this.id="",this.name="",this.technique=""}function ye(){this.url=""}function be(){this.id="",this.name="",this.joints=[],this.links=[]}function xe(){this.sid="",this.name="",this.axis=new THREE.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0}function _e(){this.sid="",this.name="",this.transforms=[],this.attachments=[]}function we(){this.joint="",this.transforms=[],this.links=[]}function Ee(e){var t=e.getAttribute("id");return void 0!=p[t]?p[t]:(p[t]=new ne(t).parse(e),p[t])}function Te(e){for(var t=Ce(e),i=[],n=0,r=t.length;n<r;n++)i.push("true"===t[n]||"1"===t[n]);return i}function Me(e){for(var t=Ce(e),i=[],n=0,r=t.length;n<r;n++)i.push(parseFloat(t[n]));return i}function Se(e){for(var t=Ce(e),i=[],n=0,r=t.length;n<r;n++)i.push(parseInt(t[n],10));return i}function Ce(e){return e.length>0?function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}(e).split(/\s+/):[]}function Re(e,t,i){return e.hasAttribute(t)?parseInt(e.getAttribute(t),10):i}function Ae(e,t){var i=new THREE.ImageLoader;i.setCrossOrigin(""),i.load(t,function(t){e.image=t,e.needsUpdate=!0})}function Pe(e,t){e.doubleSided=!1;var i=t.querySelectorAll("extra double_sided")[0];i&&i&&1===parseInt(i.textContent,10)&&(e.doubleSided=!0)}function Le(e,t){if(!0===E.convertUpAxis&&M!==E.upAxis)switch(S){case"XtoY":var i=e[0];e[0]=t*e[1],e[1]=i;break;case"XtoZ":i=e[2];e[2]=e[1],e[1]=e[0],e[0]=i;break;case"YtoX":i=e[0];e[0]=e[1],e[1]=t*i;break;case"YtoZ":i=e[1];e[1]=t*e[2],e[2]=i;break;case"ZtoX":i=e[0];e[0]=e[1],e[1]=e[2],e[2]=i;break;case"ZtoY":i=e[1];e[1]=e[2],e[2]=t*i}}function Oe(e,t){var i=[e[t],e[t+1],e[t+2]];return Le(i,-1),new THREE.Vector3(i[0],i[1],i[2])}function Ie(e){if(E.convertUpAxis){var t=[e[0],e[4],e[8]];Le(t,-1),e[0]=t[0],e[4]=t[1],e[8]=t[2],Le(t=[e[1],e[5],e[9]],-1),e[1]=t[0],e[5]=t[1],e[9]=t[2],Le(t=[e[2],e[6],e[10]],-1),e[2]=t[0],e[6]=t[1],e[10]=t[2],Le(t=[e[0],e[1],e[2]],-1),e[0]=t[0],e[1]=t[1],e[2]=t[2],Le(t=[e[4],e[5],e[6]],-1),e[4]=t[0],e[5]=t[1],e[6]=t[2],Le(t=[e[8],e[9],e[10]],-1),e[8]=t[0],e[9]=t[1],e[10]=t[2],Le(t=[e[3],e[7],e[11]],-1),e[3]=t[0],e[7]=t[1],e[11]=t[2]}return(new THREE.Matrix4).set(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function ke(e){if(e>-1&&e<3){e={X:0,Y:1,Z:2}[e=De(["X","Y","Z"][e])]}return e}function De(e){if(E.convertUpAxis)switch(e){case"X":switch(S){case"XtoY":case"XtoZ":case"YtoX":e="Y";break;case"ZtoX":e="Z"}break;case"Y":switch(S){case"XtoY":case"YtoX":case"ZtoX":e="X";break;case"XtoZ":case"YtoZ":case"ZtoY":e="Z"}break;case"Z":switch(S){case"XtoZ":e="X";break;case"YtoZ":case"ZtoX":case"ZtoY":e="Y"}}return e}return B.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];"init_from"===i.nodeName&&(this.init_from=i.textContent)}return this},F.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.type="none";for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"skin":this.skin=(new $).parse(i),this.type=i.nodeName;break;case"morph":this.morph=(new U).parse(i),this.type=i.nodeName}}return this},U.prototype.parse=function(e){var t,i={},n=[];for(this.method=e.getAttribute("method"),this.source=e.getAttribute("source").replace(/^#/,""),t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"source":i[(a=(new ne).parse(r)).id]=a;break;case"targets":n=this.parseInputs(r);break;default:console.log(r.nodeName)}}for(t=0;t<n.length;t++){var o=n[t],a=i[o.source];switch(o.semantic){case"MORPH_TARGET":this.targets=a.read();break;case"MORPH_WEIGHT":this.weights=a.read()}}return this},U.prototype.parseInputs=function(e){for(var t=[],i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(1==n.nodeType)switch(n.nodeName){case"input":t.push((new ie).parse(n))}}return t},$.prototype.parse=function(e){var t,i,n={};this.source=e.getAttribute("source").replace(/^#/,""),this.invBindMatrices=[],this.joints=[],this.weights=[];for(var r=0;r<e.childNodes.length;r++){var o=e.childNodes[r];if(1==o.nodeType)switch(o.nodeName){case"bind_shape_matrix":var a=Me(o.textContent);this.bindShapeMatrix=Ie(a);break;case"source":var s=(new ne).parse(o);n[s.id]=s;break;case"joints":t=o;break;case"vertex_weights":i=o;break;default:console.log(o.nodeName)}}return this.parseJoints(t,n),this.parseWeights(i,n),this},$.prototype.parseJoints=function(e,t){for(var i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(1==n.nodeType)switch(n.nodeName){case"input":var r=(new ie).parse(n),o=t[r.source];"JOINT"===r.semantic?this.joints=o.read():"INV_BIND_MATRIX"===r.semantic&&(this.invBindMatrices=o.read())}}},$.prototype.parseWeights=function(e,t){for(var i,n,r=[],o=0;o<e.childNodes.length;o++){var a=e.childNodes[o];if(1==a.nodeType)switch(a.nodeName){case"input":r.push((new ie).parse(a));break;case"v":i=Se(a.textContent);break;case"vcount":n=Se(a.textContent)}}var s=0;for(o=0;o<n.length;o++){for(var l=n[o],c=[],u=0;u<l;u++){for(var h={},d=0;d<r.length;d++){var p=r[d],f=i[s+p.offset];switch(p.semantic){case"JOINT":h.joint=f;break;case"WEIGHT":h.weight=t[p.source].data[f]}}c.push(h),s+=r.length}for(u=0;u<c.length;u++)c[u].index=o;this.weights.push(c)}},j.prototype.getChildById=function(e,t){for(var i=0;i<this.nodes.length;i++){var n=this.nodes[i].getChildById(e,t);if(n)return n}return null},j.prototype.getChildBySid=function(e,t){for(var i=0;i<this.nodes.length;i++){var n=this.nodes[i].getChildBySid(e,t);if(n)return n}return null},j.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.nodes=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"node":this.nodes.push((new z).parse(i))}}return this},z.prototype.getChannelForTransform=function(e){for(var t=0;t<this.channels.length;t++){var i,n=this.channels[t],r=n.target.split("/"),o=(r.shift(),r.shift()),a=o.indexOf(".")>=0,s=o.indexOf("(")>=0;if(a)o=(r=o.split(".")).shift();else if(s){o=(i=o.split("(")).shift();for(var l=0;l<i.length;l++)i[l]=parseInt(i[l].replace(/\)/,""))}if(o===e)return n.info={sid:o,dotSyntax:a,arrSyntax:s,arrIndices:i},n}return null},z.prototype.getChildById=function(e,t){if(this.id===e)return this;if(t)for(var i=0;i<this.nodes.length;i++){var n=this.nodes[i].getChildById(e,t);if(n)return n}return null},z.prototype.getChildBySid=function(e,t){if(this.sid===e)return this;if(t)for(var i=0;i<this.nodes.length;i++){var n=this.nodes[i].getChildBySid(e,t);if(n)return n}return null},z.prototype.getTransformBySid=function(e){for(var t=0;t<this.transforms.length;t++)if(this.transforms[t].sid===e)return this.transforms[t];return null},z.prototype.parse=function(e){this.id=e.getAttribute("id"),this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.type=e.getAttribute("type"),this.layer=e.getAttribute("layer"),this.type="JOINT"===this.type?this.type:"NODE",this.nodes=[],this.transforms=[],this.geometries=[],this.cameras=[],this.lights=[],this.controllers=[],this.matrix=new THREE.Matrix4;for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"node":this.nodes.push((new z).parse(i));break;case"instance_camera":this.cameras.push((new ge).parse(i));break;case"instance_controller":this.controllers.push((new G).parse(i));break;case"instance_geometry":this.geometries.push((new q).parse(i));break;case"instance_light":this.lights.push((new ye).parse(i));break;case"instance_node":var n=k(i.getAttribute("url").replace(/^#/,""));n&&this.nodes.push((new z).parse(n));break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new V).parse(i));break;case"extra":break;default:console.log(i.nodeName)}}return this.channels=function(e){var t=[],i=1e6,n=-1e6;for(var r in m)for(var o=m[r],a=0;a<o.channel.length;a++){var s=o.channel[a],l=o.sampler[a];(r=s.target.split("/")[0])==e.id&&(l.create(),s.sampler=l,i=Math.min(i,l.startTime),n=Math.max(n,l.endTime),t.push(s))}return t.length&&(e.startTime=i,e.endTime=n),t}(this),function(e){if(e.channels&&e.channels.length){for(var t=[],i=[],n=0,r=e.channels.length;n<r;n++){var o,a=e.channels[n],s=a.fullSid,l=a.sampler,c=l.input,u=e.getTransformBySid(a.sid);if(a.arrIndices){o=[];for(var h=0,d=a.arrIndices.length;h<d;h++)o[h]=ke(a.arrIndices[h])}else o=De(a.member);if(u)for(-1===i.indexOf(s)&&i.push(s),h=0,d=c.length;h<d;h++){var p=c[h],f=l.getData(u.type,h,o);if(!(v=D(t,p))){v=new fe(p);var m=N(t,p);t.splice(-1===m?t.length:m,0,v)}v.addTarget(s,u,o,f)}else console.log('Could not find transform "'+a.sid+'" in node '+e.id)}for(n=0;n<i.length;n++){var g=i[n];for(h=0;h<t.length;h++){var v;(v=t[h]).hasTarget(g)||H(t,v,h,g)}}e.keys=t,e.sids=i}}(this),this.updateMatrix(),this},z.prototype.updateMatrix=function(){this.matrix.identity();for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(this.matrix)},V.prototype.parse=function(e){return this.sid=e.getAttribute("sid"),this.type=e.nodeName,this.data=Me(e.textContent),this.convert(),this},V.prototype.convert=function(){switch(this.type){case"matrix":this.obj=Ie(this.data);break;case"rotate":this.angle=THREE.Math.degToRad(this.data[3]);case"translate":Le(this.data,-1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":Le(this.data,1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type)}},V.prototype.apply=(c=new THREE.Matrix4,function(e){switch(this.type){case"matrix":e.multiply(this.obj);break;case"translate":e.multiply(c.makeTranslation(this.obj.x,this.obj.y,this.obj.z));break;case"rotate":e.multiply(c.makeRotationAxis(this.obj,this.angle));break;case"scale":e.scale(this.obj)}}),V.prototype.update=function(e,t){var i=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(t)if(1===t.length)switch(t[0]){case 0:this.obj.n11=e[0],this.obj.n21=e[1],this.obj.n31=e[2],this.obj.n41=e[3];break;case 1:this.obj.n12=e[0],this.obj.n22=e[1],this.obj.n32=e[2],this.obj.n42=e[3];break;case 2:this.obj.n13=e[0],this.obj.n23=e[1],this.obj.n33=e[2],this.obj.n43=e[3];break;case 3:this.obj.n14=e[0],this.obj.n24=e[1],this.obj.n34=e[2],this.obj.n44=e[3]}else if(2===t.length){var n="n"+(t[0]+1)+(t[1]+1);this.obj[n]=e}else console.log("Incorrect addressing of matrix in transform.");else this.obj.copy(e);break;case"translate":case"scale":switch("[object Array]"===Object.prototype.toString.call(t)&&(t=i[t[0]]),t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;default:this.obj.x=e[0],this.obj.y=e[1],this.obj.z=e[2]}break;case"rotate":switch("[object Array]"===Object.prototype.toString.call(t)&&(t=i[t[0]]),t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;case"ANGLE":this.angle=THREE.Math.degToRad(e);break;default:this.obj.x=e[0],this.obj.y=e[1],this.obj.z=e[2],this.angle=THREE.Math.degToRad(e[3])}}},G.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,""),this.skeleton=[],this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1===i.nodeType)switch(i.nodeName){case"skeleton":this.skeleton.push(i.textContent.replace(/^#/,""));break;case"bind_material":for(var n=i.querySelectorAll("instance_material"),r=0;r<n.length;r++){var o=n[r];this.instance_material.push((new W).parse(o))}}}return this},W.prototype.parse=function(e){return this.symbol=e.getAttribute("symbol"),this.target=e.getAttribute("target").replace(/^#/,""),this},q.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,""),this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType&&"bind_material"===i.nodeName){for(var n=i.querySelectorAll("instance_material"),r=0;r<n.length;r++){var o=n[r];this.instance_material.push((new W).parse(o))}break}}return this},X.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),Pe(this,e);for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"mesh":this.mesh=new Z(this).parse(i)}}return this},Z.prototype.parse=function(e){this.primitives=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"source":Ee(i);break;case"vertices":this.vertices=(new te).parse(i);break;case"linestrips":this.primitives.push((new K).parse(i));break;case"triangles":this.primitives.push((new Q).parse(i));break;case"polygons":this.primitives.push((new Y).parse(i));break;case"polylist":this.primitives.push((new J).parse(i))}}if(this.geometry3js=new THREE.Geometry,null===this.vertices)return this;var n=p[this.vertices.input.POSITION.source].data;for(t=0;t<n.length;t+=3)this.geometry3js.vertices.push(Oe(n,t).clone());for(t=0;t<this.primitives.length;t++){var r=this.primitives[t];r.setVertices(this.vertices),this.handlePrimitive(r,this.geometry3js)}return this.geometry3js.calcNormals&&(this.geometry3js.computeVertexNormals(),delete this.geometry3js.calcNormals),this},Z.prototype.handlePrimitive=function(e,t){if(e instanceof K)t.isLineStrip=!0;else{var i,n,r,o,a,s,l,c,u=e.p,h=e.inputs,d=0,f=0,m=[];for(i=0;i<h.length;i++){var g=(r=h[i]).offset+1;switch(f=f<g?g:f,r.semantic){case"TEXCOORD":m.push(r.set)}}for(var v=0;v<u.length;++v)for(var y=u[v],b=0;b<y.length;){var x=[],_=[],w=null,T=[];for(c=e.vcount?e.vcount.length?e.vcount[d++]:e.vcount:y.length/f,i=0;i<c;i++)for(n=0;n<h.length;n++)switch(r=h[n],s=p[r.source],a=(o=y[b+i*f+r.offset])*(l=s.accessor.params.length),r.semantic){case"VERTEX":x.push(o);break;case"NORMAL":_.push(Oe(s.data,a));break;case"TEXCOORD":void 0===(w=w||{})[r.set]&&(w[r.set]=[]),w[r.set].push(new THREE.Vector2(s.data[a],s.data[a+1]));break;case"COLOR":T.push((new THREE.Color).setRGB(s.data[a],s.data[a+1],s.data[a+2]))}if(0===_.length)if(r=this.vertices.input.NORMAL){l=(s=p[r.source]).accessor.params.length;for(var M=0,S=x.length;M<S;M++)_.push(Oe(s.data,x[M]*l))}else t.calcNormals=!0;if(!w&&(w={},r=this.vertices.input.TEXCOORD)){m.push(r.set),l=(s=p[r.source]).accessor.params.length;for(M=0,S=x.length;M<S;M++)a=x[M]*l,void 0===w[r.set]&&(w[r.set]=[]),w[r.set].push(new THREE.Vector2(s.data[a],1-s.data[a+1]))}if(0===T.length&&(r=this.vertices.input.COLOR)){l=(s=p[r.source]).accessor.params.length;for(M=0,S=x.length;M<S;M++)a=x[M]*l,T.push((new THREE.Color).setRGB(s.data[a],s.data[a+1],s.data[a+2]))}var C,R,A=null,P=[];if(3===c)P.push(new THREE.Face3(x[0],x[1],x[2],_,T.length?T:new THREE.Color));else if(4===c)P.push(new THREE.Face3(x[0],x[1],x[3],_.length?[_[0].clone(),_[1].clone(),_[3].clone()]:[],T.length?[T[0],T[1],T[3]]:new THREE.Color)),P.push(new THREE.Face3(x[1],x[2],x[3],_.length?[_[1].clone(),_[2].clone(),_[3].clone()]:[],T.length?[T[1],T[2],T[3]]:new THREE.Color));else if(c>4&&E.subdivideFaces){var L=T.length?T:new THREE.Color;for(n=1;n<c-1;)P.push(new THREE.Face3(x[0],x[n],x[n+1],_.length?[_[0].clone(),_[n++].clone(),_[n].clone()]:[],L))}if(P.length)for(M=0,S=P.length;M<S;M++)for((A=P[M]).daeMaterial=e.material,t.faces.push(A),n=0;n<m.length;n++)C=w[m[n]],R=c>4?[C[0],C[M+1],C[M+2]]:4===c?0===M?[C[0],C[1],C[3]]:[C[1].clone(),C[2],C[3].clone()]:[C[0],C[1],C[2]],void 0===t.faceVertexUvs[n]&&(t.faceVertexUvs[n]=[]),t.faceVertexUvs[n].push(R);else console.log("dropped face with vcount "+c+" for geometry with id: "+t.id);b+=f*c}}},Y.prototype.setVertices=function(e){for(var t=0;t<this.inputs.length;t++)this.inputs[t].source===e.id&&(this.inputs[t].source=e.input.POSITION.source)},Y.prototype.parse=function(e){this.material=e.getAttribute("material"),this.count=Re(e,"count",0);for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"input":this.inputs.push((new ie).parse(e.childNodes[t]));break;case"vcount":this.vcount=Se(i.textContent);break;case"p":this.p.push(Se(i.textContent));break;case"ph":console.warn("polygon holes not yet supported!")}}return this},J.prototype=Object.create(Y.prototype),J.prototype.constructor=J,K.prototype=Object.create(Y.prototype),K.prototype.constructor=K,Q.prototype=Object.create(Y.prototype),Q.prototype.constructor=Q,ee.prototype.parse=function(e){this.params=[],this.source=e.getAttribute("source"),this.count=Re(e,"count",0),this.stride=Re(e,"stride",0);for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if("param"===i.nodeName){var n={};n.name=i.getAttribute("name"),n.type=i.getAttribute("type"),this.params.push(n)}}return this},te.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++)if("input"===e.childNodes[t].nodeName){var i=(new ie).parse(e.childNodes[t]);this.input[i.semantic]=i}return this},ie.prototype.parse=function(e){return this.semantic=e.getAttribute("semantic"),this.source=e.getAttribute("source").replace(/^#/,""),this.set=Re(e,"set",-1),this.offset=Re(e,"offset",0),"TEXCOORD"===this.semantic&&this.set<0&&(this.set=0),this},ne.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"bool_array":this.data=Te(i.textContent),this.type=i.nodeName;break;case"float_array":this.data=Me(i.textContent),this.type=i.nodeName;break;case"int_array":this.data=Se(i.textContent),this.type=i.nodeName;break;case"IDREF_array":case"Name_array":this.data=Ce(i.textContent),this.type=i.nodeName;break;case"technique_common":for(var n=0;n<i.childNodes.length;n++)if("accessor"===i.childNodes[n].nodeName){this.accessor=(new ee).parse(i.childNodes[n]);break}}}return this},ne.prototype.read=function(){var e=[],t=this.accessor.params[0];switch(t.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var i=0;i<this.data.length;i+=16){var n=Ie(this.data.slice(i,i+16));e.push(n)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+t.type+".")}return e},re.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++)if("instance_effect"===e.childNodes[t].nodeName){this.instance_effect=(new ue).parse(e.childNodes[t]);break}return this},oe.prototype.isColor=function(){return null===this.texture},oe.prototype.isTexture=function(){return null!=this.texture},oe.prototype.parse=function(e){"transparent"===e.nodeName&&(this.opaque=e.getAttribute("opaque"));for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"color":var n=Me(i.textContent);this.color=new THREE.Color,this.color.setRGB(n[0],n[1],n[2]),this.color.a=n[3];break;case"texture":this.texture=i.getAttribute("texture"),this.texcoord=i.getAttribute("texcoord"),this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1},this.parseTexture(i)}}return this},oe.prototype.parseTexture=function(e){if(!e.childNodes)return this;e.childNodes[1]&&"extra"===e.childNodes[1].nodeName&&(e=e.childNodes[1]).childNodes[1]&&"technique"===e.childNodes[1].nodeName&&(e=e.childNodes[1]);for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":"TRUE"===i.textContent.toUpperCase()?this.texOpts[i.nodeName]=1:this.texOpts[i.nodeName]=parseInt(i.textContent);break;default:this.texOpts[i.nodeName]=i.textContent}}return this},ae.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"transparent":this[i.nodeName]=(new oe).parse(i);break;case"bump":var n=i.getAttribute("bumptype");n?"heightfield"===n.toLowerCase()?this.bump=(new oe).parse(i):"normalmap"===n.toLowerCase()?this.normal=(new oe).parse(i):(console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+n+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'"),this.bump=(new oe).parse(i)):(console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+n+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'NORMALMAP'"),this.normal=(new oe).parse(i));break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var r=i.querySelectorAll("float");r.length>0&&(this[i.nodeName]=parseFloat(r[0].textContent))}}return this.create(),this},ae.prototype.create=function(){var e={},t=!1;if(void 0!==this.transparency&&void 0!==this.transparent){this.transparent;var i=(this.transparent.color.r+this.transparent.color.g+this.transparent.color.b)/3*this.transparency;i>0&&(t=!0,e.transparent=!0,e.opacity=1-i)}var n={diffuse:"map",ambient:"lightMap",specular:"specularMap",emission:"emissionMap",bump:"bumpMap",normal:"normalMap"};for(var r in this)switch(r){case"ambient":case"emission":case"diffuse":case"specular":case"bump":case"normal":var o=this[r];if(o instanceof oe)if(o.isTexture()){var s=o.texture,l=this.effect.sampler[s],c=void 0;if(void 0!==l&&void 0!==l.source){var u=this.effect.surface[l.source];void 0!==u&&(c=f[u.init_from])}else c=f[s];if(c){var h,d=a+c.init_from,p=THREE.Loader.Handlers.get(d);null!==p?(p.crossOrigin="",h=p.load(d)):Ae(h=new THREE.Texture,d),l&&"MIRROR"===l.wrap_s?h.wrapS=THREE.MirroredRepeatWrapping:l&&"WRAP"===l.wrap_s||o.texOpts.wrapU?h.wrapS=THREE.RepeatWrapping:h.wrapS=THREE.ClampToEdgeWrapping,l&&"MIRROR"===l.wrap_t?h.wrapT=THREE.MirroredRepeatWrapping:l&&"WRAP"===l.wrap_t||o.texOpts.wrapV?h.wrapT=THREE.RepeatWrapping:h.wrapT=THREE.ClampToEdgeWrapping,h.offset.x=o.texOpts.offsetU,h.offset.y=o.texOpts.offsetV,h.repeat.x=o.texOpts.repeatU,h.repeat.y=o.texOpts.repeatV,e[n[r]]=h,"emission"===r&&(e.emissive=16777215)}}else"diffuse"!==r&&t||("emission"===r?e.emissive=o.color.getHex():e[r]=o.color.getHex());break;case"shininess":e[r]=this[r];break;case"reflectivity":e[r]=this[r],e[r]>0&&(e.envMap=E.defaultEnvMap),e.combine=THREE.MixOperation;break;case"index_of_refraction":e.refractionRatio=this[r],1!==this[r]&&(e.envMap=E.defaultEnvMap)}switch(e.shading=w,e.side=this.effect.doubleSided?THREE.DoubleSide:THREE.FrontSide,void 0!==e.diffuse&&(e.color=e.diffuse,delete e.diffuse),this.type){case"constant":void 0!=e.emissive&&(e.color=e.emissive),this.material=new THREE.MeshBasicMaterial(e);break;case"phong":case"blinn":this.material=new THREE.MeshPhongMaterial(e);break;case"lambert":default:void 0!==e.normalMap?this.material=new THREE.MeshPhongMaterial(e):this.material=new THREE.MeshLambertMaterial(e)}return this.material},se.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"init_from":this.init_from=i.textContent;break;case"format":this.format=i.textContent;break;default:console.log("unhandled Surface prop: "+i.nodeName)}}return this},le.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"source":this.source=i.textContent;break;case"minfilter":this.minfilter=i.textContent;break;case"magfilter":this.magfilter=i.textContent;break;case"mipfilter":this.mipfilter=i.textContent;break;case"wrap_s":this.wrap_s=i.textContent;break;case"wrap_t":this.wrap_t=i.textContent;break;default:console.log("unhandled Sampler2D prop: "+i.nodeName)}}return this},ce.prototype.create=function(){if(null===this.shader)return null},ce.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),Pe(this,e),this.shader=null;for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"profile_COMMON":this.parseTechnique(this.parseProfileCOMMON(i))}}return this},ce.prototype.parseNewparam=function(e){for(var t=e.getAttribute("sid"),i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(1==n.nodeType)switch(n.nodeName){case"surface":this.surface[t]=new se(this).parse(n);break;case"sampler2D":this.sampler[t]=new le(this).parse(n);break;case"extra":break;default:console.log(n.nodeName)}}},ce.prototype.parseProfileCOMMON=function(e){for(var t,i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(1==n.nodeType)switch(n.nodeName){case"profile_COMMON":this.parseProfileCOMMON(n);break;case"technique":t=n;break;case"newparam":this.parseNewparam(n);break;case"image":var r=(new B).parse(n);f[r.id]=r;break;case"extra":break;default:console.log(n.nodeName)}}return t},ce.prototype.parseTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=new ae(i.nodeName,this).parse(i);break;case"extra":this.parseExtra(i)}}},ce.prototype.parseExtra=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"technique":this.parseExtraTechnique(i)}}},ce.prototype.parseExtraTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"bump":this.shader.parse(e)}}},ue.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},he.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.source={};for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"animation":var n=(new he).parse(i);for(var r in n.source)this.source[r]=n.source[r];for(var o=0;o<n.channel.length;o++)this.channel.push(n.channel[o]),this.sampler.push(n.sampler[o]);break;case"source":r=(new ne).parse(i);this.source[r.id]=r;break;case"sampler":this.sampler.push(new pe(this).parse(i));break;case"channel":this.channel.push(new de(this).parse(i))}}return this},de.prototype.parse=function(e){this.source=e.getAttribute("source").replace(/^#/,""),this.target=e.getAttribute("target");var t=this.target.split("/"),i=(t.shift(),t.shift()),n=i.indexOf(".")>=0,r=i.indexOf("(")>=0;if(n)t=i.split("."),this.sid=t.shift(),this.member=t.shift();else if(r){var o=i.split("(");this.sid=o.shift();for(var a=0;a<o.length;a++)o[a]=parseInt(o[a].replace(/\)/,""));this.arrIndices=o}else this.sid=i;return this.fullSid=i,this.dotSyntax=n,this.arrSyntax=r,this},pe.prototype.parse=function(e){this.id=e.getAttribute("id"),this.inputs=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"input":this.inputs.push((new ie).parse(i))}}return this},pe.prototype.create=function(){for(var e=0;e<this.inputs.length;e++){var t=this.inputs[e],i=this.animation.source[t.source];switch(t.semantic){case"INPUT":this.input=i.read();break;case"OUTPUT":this.output=i.read(),this.strideOut=i.accessor.stride;break;case"INTERPOLATION":this.interpolation=i.read();break;case"IN_TANGENT":case"OUT_TANGENT":break;default:console.log(t.semantic)}}if(this.startTime=0,this.endTime=0,this.duration=0,this.input.length){this.startTime=1e8,this.endTime=-1e8;for(e=0;e<this.input.length;e++)this.startTime=Math.min(this.startTime,this.input[e]),this.endTime=Math.max(this.endTime,this.input[e]);this.duration=this.endTime-this.startTime}},pe.prototype.getData=function(e,t,i){var n;if("matrix"===e&&16===this.strideOut)n=this.output[t];else if(this.strideOut>1){n=[],t*=this.strideOut;for(var r=0;r<this.strideOut;++r)n[r]=this.output[t+r];if(3===this.strideOut)switch(e){case"rotate":case"translate":Le(n,-1);break;case"scale":Le(n,1)}else 4===this.strideOut&&"matrix"===e&&Le(n,-1)}else n=this.output[t],i&&"translate"===e&&(n=function(e,t){if(!0!==E.convertUpAxis||M===E.upAxis)return t;switch(e){case"X":t="XtoY"===S?-1*t:t;break;case"Y":t="YtoZ"===S||"YtoX"===S?-1*t:t;break;case"Z":t="ZtoY"===S?-1*t:t}return t}(i,n));return n},fe.prototype.addTarget=function(e,t,i,n){this.targets.push({sid:e,member:i,transform:t,data:n})},fe.prototype.apply=function(e){for(var t=0;t<this.targets.length;++t){var i=this.targets[t];e&&i.sid!==e||i.transform.update(i.data,i.member)}},fe.prototype.getTarget=function(e){for(var t=0;t<this.targets.length;++t)if(this.targets[t].sid===e)return this.targets[t];return null},fe.prototype.hasTarget=function(e){for(var t=0;t<this.targets.length;++t)if(this.targets[t].sid===e)return!0;return!1},fe.prototype.interpolate=function(e,t){for(var i=0,n=this.targets.length;i<n;i++){var r,o=this.targets[i],a=e.getTarget(o.sid);if("matrix"!==o.transform.type&&a){var s=(t-this.time)/(e.time-this.time),l=a.data,c=o.data;if(s<0&&(s=0),s>1&&(s=1),c.length){r=[];for(var u=0;u<c.length;++u)r[u]=c[u]+(l[u]-c[u])*s}else r=c+(l-c)*s}else r=o.data;o.transform.update(r,o.member)}},me.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"optics":this.parseOptics(i)}}return this},me.prototype.parseOptics=function(e){for(var t=0;t<e.childNodes.length;t++)if("technique_common"===e.childNodes[t].nodeName)for(var i=e.childNodes[t],n=0;n<i.childNodes.length;n++)if(this.technique=i.childNodes[n].nodeName,"perspective"===this.technique)for(var r=i.childNodes[n],o=0;o<r.childNodes.length;o++){switch((s=r.childNodes[o]).nodeName){case"yfov":this.yfov=s.textContent;break;case"xfov":this.xfov=s.textContent;break;case"znear":this.znear=s.textContent;break;case"zfar":this.zfar=s.textContent;break;case"aspect_ratio":this.aspect_ratio=s.textContent}}else if("orthographic"===this.technique){var a=i.childNodes[n];for(o=0;o<a.childNodes.length;o++){var s;switch((s=a.childNodes[o]).nodeName){case"xmag":this.xmag=s.textContent;break;case"ymag":this.ymag=s.textContent;break;case"znear":this.znear=s.textContent;break;case"zfar":this.zfar=s.textContent;break;case"aspect_ratio":this.aspect_ratio=s.textContent}}}return this},ge.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},ve.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"technique_common":this.parseCommon(i);break;case"technique":this.parseTechnique(i)}}return this},ve.prototype.parseCommon=function(e){for(var t=0;t<e.childNodes.length;t++)switch(e.childNodes[t].nodeName){case"directional":case"point":case"spot":case"ambient":this.technique=e.childNodes[t].nodeName;for(var i=e.childNodes[t],n=0;n<i.childNodes.length;n++){var r=i.childNodes[n];switch(r.nodeName){case"color":var o=Me(r.textContent);this.color=new THREE.Color(0),this.color.setRGB(o[0],o[1],o[2]),this.color.a=o[3];break;case"falloff_angle":this.falloff_angle=parseFloat(r.textContent);break;case"quadratic_attenuation":var a=parseFloat(r.textContent);this.distance=a?Math.sqrt(1/a):0}}}return this},ve.prototype.parseTechnique=function(e){this.profile=e.getAttribute("profile");for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeName){case"intensity":this.intensity=parseFloat(i.textContent)}}return this},ye.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},be.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.joints=[],this.links=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"technique_common":this.parseCommon(i)}}return this},be.prototype.parseCommon=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(e.childNodes[t].nodeName){case"joint":this.joints.push((new xe).parse(i));break;case"link":this.links.push((new _e).parse(i))}}return this},xe.prototype.parse=function(e){this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.axis=new THREE.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0;var t=Me(e.querySelector("axis").textContent);this.axis=Oe(t,0);var i=e.querySelector("limits min")?parseFloat(e.querySelector("limits min").textContent):-360,n=e.querySelector("limits max")?parseFloat(e.querySelector("limits max").textContent):360;this.limits={min:i,max:n};for(var r=["prismatic","revolute"],o=0;o<r.length;o++){var a=r[o];e.querySelector(a)&&(this.type=a)}return this.limits.min>=this.limits.max&&(this.static=!0),this.middlePosition=(this.limits.min+this.limits.max)/2,this},_e.prototype.parse=function(e){this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.transforms=[],this.attachments=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"attachment_full":this.attachments.push((new we).parse(i));break;case"rotate":case"translate":case"matrix":this.transforms.push((new V).parse(i))}}return this},we.prototype.parse=function(e){this.joint=e.getAttribute("joint").split("/").pop(),this.links=[];for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"link":this.links.push((new _e).parse(i));break;case"rotate":case"translate":case"matrix":this.transforms.push((new V).parse(i))}}return this},{load:function(e,t,i,n){var r=0;if(document.implementation&&document.implementation.createDocument){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState?0===o.status||200===o.status?o.response?(d=t,C(o.response,void 0,e)):n?n({type:"error",url:e}):console.error("ColladaLoader: Empty or non-existing file ("+e+")"):n?n({type:"error",url:e}):console.error("ColladaLoader: Couldn't load \""+e+'" ('+o.status+")"):3===o.readyState&&i&&(0===r&&(r=o.getResponseHeader("Content-Length")),i({total:r,loaded:o.responseText.length}))},o.open("GET",e,!0),o.send(null)}else alert("Don't know how to parse XML!")},parse:C,setPreferredShading:function(e){w=e},applySkin:O,geometries:v,options:E}};var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,i,n;t=void 0!==(e=e||{}).parent?e.parent:document.body,i=void 0!==e.id?e.id:"oldie",(n=Detector.getWebGLErrorMessage()).id=i,t.appendChild(n)}};"object"==typeof module&&(module.exports=Detector),THREE.MTLLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(e,t,i,n){var r=this,o=new THREE.FileLoader(this.manager);o.setPath(this.path),o.load(e,function(e){t(r.parse(e))},i,n)},setPath:function(e){this.path=e},setTexturePath:function(e){this.texturePath=e},setBaseUrl:function(e){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(e)},setCrossOrigin:function(e){this.crossOrigin=e},setMaterialOptions:function(e){this.materialOptions=e},parse:function(e){for(var t=e.split("\n"),i={},n=/\s+/,r={},o=0;o<t.length;o++){var a=t[o];if(0!==(a=a.trim()).length&&"#"!==a.charAt(0)){var s=a.indexOf(" "),l=s>=0?a.substring(0,s):a;l=l.toLowerCase();var c=s>=0?a.substring(s+1):"";if(c=c.trim(),"newmtl"===l)i={name:c},r[c]=i;else if(i)if("ka"===l||"kd"===l||"ks"===l){var u=c.split(n,3);i[l]=[parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2])]}else i[l]=c}}var h=new THREE.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);return h.setCrossOrigin(this.crossOrigin),h.setManager(this.manager),h.setMaterials(r),h}},THREE.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e||"",this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var i in e){var n=e[i],r={};for(var o in t[i]=r,n){var a=!0,s=n[o],l=o.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(a=!1)}a&&(r[l]=s)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var t=this,i=this.materialsInfo[e],n={name:e,side:this.side};function r(e,i){if(!n[e]){var r,o,a=t.getTextureParams(i,n),s=t.loadTexture((r=t.baseUrl,"string"!=typeof(o=a.url)||""===o?"":/^https?:\/\//i.test(o)?o:r+o));s.repeat.copy(a.scale),s.offset.copy(a.offset),s.wrapS=t.wrap,s.wrapT=t.wrap,n[e]=s}}for(var o in i){var a,s=i[o];if(""!==s)switch(o.toLowerCase()){case"kd":n.color=(new THREE.Color).fromArray(s);break;case"ks":n.specular=(new THREE.Color).fromArray(s);break;case"map_kd":r("map",s);break;case"map_ks":r("specularMap",s);break;case"map_bump":case"bump":r("bumpMap",s);break;case"ns":n.shininess=parseFloat(s);break;case"d":(a=parseFloat(s))<1&&(n.opacity=a,n.transparent=!0);break;case"tr":(a=parseFloat(s))>0&&(n.opacity=1-a,n.transparent=!0)}}return this.materials[e]=new THREE.MeshPhongMaterial(n),this.materials[e]},getTextureParams:function(e,t){var i,n={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},r=e.split(/\s+/);return(i=r.indexOf("-bm"))>=0&&(t.bumpScale=parseFloat(r[i+1]),r.splice(i,2)),(i=r.indexOf("-s"))>=0&&(n.scale.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),(i=r.indexOf("-o"))>=0&&(n.offset.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),n.url=r.join(" ").trim(),n},loadTexture:function(e,t,i,n,r){var o,a=THREE.Loader.Handlers.get(e),s=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===a&&(a=new THREE.TextureLoader(s)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin),o=a.load(e,i,n,r),void 0!==t&&(o.mapping=t),o}},THREE.OBJLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null,this.regexp={vertex_pattern:/^v\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)/,normal_pattern:/^vn\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)/,uv_pattern:/^vt\s+([\d\.\+\-eE]+)\s+([\d\.\+\-eE]+)/,face_vertex:/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,face_vertex_uv:/^f\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+))?/,face_vertex_uv_normal:/^f\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+)\/(-?\d+))?/,face_vertex_normal:/^f\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)(?:\s+(-?\d+)\/\/(-?\d+))?/,object_pattern:/^[og]\s*(.+)?/,smoothing_pattern:/^s\s+(\d+|on|off)/,material_library_pattern:/^mtllib /,material_use_pattern:/^usemtl /}},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(e,t,i,n){var r=this,o=new THREE.FileLoader(r.manager);o.setPath(this.path),o.load(e,function(e){t(r.parse(e))},i,n)},setPath:function(e){this.path=e},setMaterials:function(e){this.materials=e},_createParserState:function(){var e={objects:[],object:{},vertices:[],normals:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);var n={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==i?i.smooth:this.smooth,groupStart:void 0!==i?i.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var i=this.materials.length-1;i>=0;i--)this.materials[i].groupCount<=0&&this.materials.splice(i,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},i&&i.name&&"function"==typeof i.clone){var n=i.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseNormalIndex:function(e,t){var i=parseInt(e,10);return 3*(i>=0?i-1:i+t/3)},parseUVIndex:function(e,t){var i=parseInt(e,10);return 2*(i>=0?i-1:i+t/2)},addVertex:function(e,t,i){var n=this.vertices,r=this.object.geometry.vertices;r.push(n[e+0]),r.push(n[e+1]),r.push(n[e+2]),r.push(n[t+0]),r.push(n[t+1]),r.push(n[t+2]),r.push(n[i+0]),r.push(n[i+1]),r.push(n[i+2])},addVertexLine:function(e){var t=this.vertices,i=this.object.geometry.vertices;i.push(t[e+0]),i.push(t[e+1]),i.push(t[e+2])},addNormal:function(e,t,i){var n=this.normals,r=this.object.geometry.normals;r.push(n[e+0]),r.push(n[e+1]),r.push(n[e+2]),r.push(n[t+0]),r.push(n[t+1]),r.push(n[t+2]),r.push(n[i+0]),r.push(n[i+1]),r.push(n[i+2])},addUV:function(e,t,i){var n=this.uvs,r=this.object.geometry.uvs;r.push(n[e+0]),r.push(n[e+1]),r.push(n[t+0]),r.push(n[t+1]),r.push(n[i+0]),r.push(n[i+1])},addUVLine:function(e){var t=this.uvs,i=this.object.geometry.uvs;i.push(t[e+0]),i.push(t[e+1])},addFace:function(e,t,i,n,r,o,a,s,l,c,u,h){var d,p=this.vertices.length,f=this.parseVertexIndex(e,p),m=this.parseVertexIndex(t,p),g=this.parseVertexIndex(i,p);if(void 0===n?this.addVertex(f,m,g):(d=this.parseVertexIndex(n,p),this.addVertex(f,m,d),this.addVertex(m,g,d)),void 0!==r){var v=this.uvs.length;f=this.parseUVIndex(r,v),m=this.parseUVIndex(o,v),g=this.parseUVIndex(a,v),void 0===n?this.addUV(f,m,g):(d=this.parseUVIndex(s,v),this.addUV(f,m,d),this.addUV(m,g,d))}if(void 0!==l){var y=this.normals.length;f=this.parseNormalIndex(l,y),m=l===c?f:this.parseNormalIndex(c,y),g=l===u?f:this.parseNormalIndex(u,y),void 0===n?this.addNormal(f,m,g):(d=this.parseNormalIndex(h,y),this.addNormal(f,m,d),this.addNormal(m,g,d))}},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var i=this.vertices.length,n=this.uvs.length,r=0,o=e.length;r<o;r++)this.addVertexLine(this.parseVertexIndex(e[r],i));var a=0;for(o=t.length;a<o;a++)this.addUVLine(this.parseUVIndex(t[a],n))}};return e.startObject("",!1),e},parse:function(e){console.time("OBJLoader");var t=this._createParserState();-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));for(var i=e.split("\n"),n="",r="",o="",a=[],s="function"==typeof"".trimLeft,l=0,c=i.length;l<c;l++)if(n=i[l],0!==(n=s?n.trimLeft():n.trim()).length&&"#"!==(r=n.charAt(0)))if("v"===r)if(" "===(o=n.charAt(1))&&null!==(a=this.regexp.vertex_pattern.exec(n)))t.vertices.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));else if("n"===o&&null!==(a=this.regexp.normal_pattern.exec(n)))t.normals.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));else{if("t"!==o||null===(a=this.regexp.uv_pattern.exec(n)))throw new Error("Unexpected vertex/normal/uv line: '"+n+"'");t.uvs.push(parseFloat(a[1]),parseFloat(a[2]))}else if("f"===r)if(null!==(a=this.regexp.face_vertex_uv_normal.exec(n)))t.addFace(a[1],a[4],a[7],a[10],a[2],a[5],a[8],a[11],a[3],a[6],a[9],a[12]);else if(null!==(a=this.regexp.face_vertex_uv.exec(n)))t.addFace(a[1],a[3],a[5],a[7],a[2],a[4],a[6],a[8]);else if(null!==(a=this.regexp.face_vertex_normal.exec(n)))t.addFace(a[1],a[3],a[5],a[7],void 0,void 0,void 0,void 0,a[2],a[4],a[6],a[8]);else{if(null===(a=this.regexp.face_vertex.exec(n)))throw new Error("Unexpected face line: '"+n+"'");t.addFace(a[1],a[2],a[3],a[4])}else if("l"===r){var u=n.substring(1).trim().split(" "),h=[],d=[];if(-1===n.indexOf("/"))h=u;else for(var p=0,f=u.length;p<f;p++){var m=u[p].split("/");""!==m[0]&&h.push(m[0]),""!==m[1]&&d.push(m[1])}t.addLineGeometry(h,d)}else if(null!==(a=this.regexp.object_pattern.exec(n))){var g=(" "+a[0].substr(1).trim()).substr(1);t.startObject(g)}else if(this.regexp.material_use_pattern.test(n))t.object.startMaterial(n.substring(7).trim(),t.materialLibraries);else if(this.regexp.material_library_pattern.test(n))t.materialLibraries.push(n.substring(7).trim());else{if(null===(a=this.regexp.smoothing_pattern.exec(n))){if("\0"===n)continue;throw new Error("Unexpected line: '"+n+"'")}var v=a[1].trim().toLowerCase();t.object.smooth="0"!==v&&"off"!==v,(A=t.object.currentMaterial())&&(A.smooth=t.object.smooth)}t.finalize();var y=new THREE.Group;y.materialLibraries=[].concat(t.materialLibraries);for(l=0,c=t.objects.length;l<c;l++){var b=t.objects[l],x=b.geometry,_=b.materials,w="Line"===x.type;if(0!==x.vertices.length){var E=new THREE.BufferGeometry;E.addAttribute("position",new THREE.BufferAttribute(new Float32Array(x.vertices),3)),x.normals.length>0?E.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(x.normals),3)):E.computeVertexNormals(),x.uvs.length>0&&E.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(x.uvs),2));for(var T,M=[],S=0,C=_.length;S<C;S++){var R=_[S],A=void 0;if(null!==this.materials&&(A=this.materials.create(R.name),w&&A&&!(A instanceof THREE.LineBasicMaterial))){var P=new THREE.LineBasicMaterial;P.copy(A),A=P}A||((A=w?new THREE.LineBasicMaterial:new THREE.MeshPhongMaterial).name=R.name),A.shading=R.smooth?THREE.SmoothShading:THREE.FlatShading,M.push(A)}if(M.length>1){for(S=0,C=_.length;S<C;S++){R=_[S];E.addGroup(R.groupStart,R.groupCount,S)}T=w?new THREE.LineSegments(E,M):new THREE.Mesh(E,M)}else T=w?new THREE.LineSegments(E,M[0]):new THREE.Mesh(E,M[0]);T.name=b.name,y.add(T)}}return console.timeEnd("OBJLoader"),y}},THREE.OrbitControls=function(e,t){this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.targetIndicator=new THREE.Mesh(new THREE.SphereGeometry(1,20,20),new THREE.MeshPhongMaterial({emissive:3355392,color:16776960,shading:THREE.SmoothShading})),this.targetIndicator.visible=!1,this.showTargetIndicator=!1,this.center=this.target,this.object.lookAt(this.target),this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var i=this,n=new THREE.Vector2,r=new THREE.Vector2,o=new THREE.Vector2,a=new THREE.Vector2,s=new THREE.Vector2,l=new THREE.Vector2,c=new THREE.Vector2,u=new THREE.Vector2,h=new THREE.Vector2,d=0,p=0,f=1,m=new THREE.Vector3,g=new THREE.Vector3,v={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},y=v.NONE,b=null,x={type:"change"};function _(e){i.targetIndicator.visible=e,i.showTargetIndicator||(i.targetIndicator.visible=!1)}function w(){return 2*Math.PI/60/60*i.autoRotateSpeed}function E(){return Math.pow(.95,i.zoomSpeed)}function T(e){if(!1===i.enabled)return i.domElement.removeEventListener("mousemove",T,!1),void i.domElement.removeEventListener("mouseup",M,!1);e.preventDefault();var t=i.domElement===document?i.domElement.body:i.domElement;if(y===v.ROTATE){if(!0===i.noRotate)return;r.set(e.clientX,e.clientY),o.subVectors(r,n),i.rotateLeft(2*Math.PI*o.x/t.clientWidth*i.rotateSpeed),i.rotateUp(2*Math.PI*o.y/t.clientHeight*i.rotateSpeed),n.copy(r)}else if(y===v.DOLLY){if(!0===i.noZoom)return;u.set(e.clientX,e.clientY),h.subVectors(u,c),h.y>0?i.dollyIn():i.dollyOut(),c.copy(u)}else if(y===v.PAN){if(!0===i.noPan)return;s.set(e.clientX,e.clientY),l.subVectors(s,a),i.pan(l),a.copy(s)}i.update()}function M(){!1!==i.enabled&&(i.domElement.removeEventListener("mousemove",T,!1),i.domElement.removeEventListener("mouseup",M,!1),y=v.NONE,_(!1))}function S(e){if(!1!==i.enabled&&!0!==i.noZoom){i.targetIndicator.position.set(i.target.x,i.target.y,i.target.z),_(!0),b=(new Date).getTime();var t=0;e.wheelDelta?t=e.wheelDelta:e.detail&&(t=-e.detail),t>0?i.dollyOut():i.dollyIn()}}this.rotateLeft=function(e){void 0===e&&(e=w()),p-=e},this.rotateUp=function(e){void 0===e&&(e=w()),d-=e},this.panLeft=function(e){var t=new THREE.Vector3,i=this.object.matrix.elements;t.set(i[0],i[1],i[2]),t.multiplyScalar(-e),m.add(t)},this.panUp=function(e){var t=new THREE.Vector3,i=this.object.matrix.elements;t.set(i[4],i[5],i[6]),t.multiplyScalar(e),m.add(t)},this.pan=function(e){var t=i.domElement===document?i.domElement.body:i.domElement;if(void 0!==i.object.fov){var n=i.object.position.clone().sub(i.target).length(),r=i.object.fov*Math.PI/180,o=2*Math.atan(Math.tan(r/2)*i.object.aspect);i.panLeft(2*e.x*n*Math.tan(o/2)/t.clientWidth),i.panUp(2*e.y*n*Math.tan(r/2)/t.clientHeight)}else void 0!==i.object.top?(i.panLeft(e.x*(i.object.right-i.object.left)/t.clientWidth),i.panUp(e.y*(i.object.top-i.object.bottom)/t.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknowncamera type - pan disabled.")},this.dollyIn=function(e){void 0===e&&(e=E()),f/=e},this.dollyOut=function(e){void 0===e&&(e=E()),f*=e},this.update=function(){var t=this.object.position,n=t.clone().sub(this.target),r=Math.atan2(n.x,n.y),o=Math.atan2(Math.sqrt(n.x*n.x+n.y*n.y),n.z);this.autoRotate&&this.rotateLeft(w());var a=r,s=o;r-=p,o+=d,o=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,o)),o=Math.max(1e-6,Math.min(Math.PI-1e-6,o));var l=n.length()*f;if(l=Math.max(this.minDistance,Math.min(this.maxDistance,l)),this.target.add(m),n.x=l*Math.sin(o)*Math.sin(r),n.z=l*Math.cos(o),n.y=l*Math.sin(o)*Math.cos(r),p||d){var c=function(e,t,i){rotWorldMatrix=new THREE.Matrix4,rotWorldMatrix.makeRotationAxis(t.normalize(),i),rotWorldMatrix.multiply(e.matrix),rotWorldMatrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrix()};this.object.position.sub(this.target),this.object.updateMatrix(),c(this.object,new THREE.Vector3(0,0,1),a-r);var u=new THREE.Vector3(1,0,0);u.applyQuaternion(this.object.quaternion),c(this.object,u,o-s),this.object.position.add(this.target),this.object.updateMatrix()}else t.copy(this.target).add(n);p=0,d=0,f=1,m.set(0,0,0),g.distanceTo(this.object.position)>0&&(this.dispatchEvent(x),g.copy(this.object.position)),!1===i.enabled&&_(!1);var h=(new Date).getTime();if(b&&h-b>400&&(_(!1),b=null),i.targetIndicator.visible){var v=new THREE.Vector3;v.copy(e.position).sub(i.targetIndicator.position);var y=v.length()/100;i.targetIndicator.scale.set(y,y,y)}},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",function(e){if(!1!==i.enabled){if(e.preventDefault(),e.shiftKey&&0===e.button){if(!0===i.noRotate)return;y=v.ROTATE,n.set(e.clientX,e.clientY)}else if(1===e.button){if(!0===i.noRotate)return;y=v.ROTATE,n.set(e.clientX,e.clientY)}else if(2===e.button){if(!0===i.noZoom)return;y=v.DOLLY,c.set(e.clientX,e.clientY)}else if(0===e.button){if(!0===i.noPan)return;y=v.PAN,a.set(e.clientX,e.clientY)}i.targetIndicator.position.set(i.target.x,i.target.y,i.target.z),_(!0),i.domElement.addEventListener("mousemove",T,!1),i.domElement.addEventListener("mouseup",M,!1)}},!1),this.domElement.addEventListener("mousewheel",S,!1),this.domElement.addEventListener("DOMMouseScroll",S,!1),this.domElement.addEventListener("keydown",function(e){if(!1!==i.enabled&&!0!==i.noKeys&&!0!==i.noPan){var t=!1;switch(e.keyCode){case i.keys.UP:i.pan(new THREE.Vector2(0,i.keyPanSpeed)),t=!0;break;case i.keys.BOTTOM:i.pan(new THREE.Vector2(0,-i.keyPanSpeed)),t=!0;break;case i.keys.LEFT:i.pan(new THREE.Vector2(i.keyPanSpeed,0)),t=!0;break;case i.keys.RIGHT:i.pan(new THREE.Vector2(-i.keyPanSpeed,0)),t=!0}t&&i.update()}},!1),this.domElement.addEventListener("touchstart",function(e){if(!1!==i.enabled)switch(i.targetIndicator.position.set(i.target.x,i.target.y,i.target.z),_(!0),e.touches.length){case 1:if(!0===i.noRotate)return;y=v.TOUCH_ROTATE,n.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(!1===i.noZoom){y=v.TOUCH_DOLLY_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+r*r);c.set(0,o)}if(!1===i.noPan){var s=(e.touches[0].pageX+e.touches[1].pageX)/2,l=(e.touches[0].pageY+e.touches[1].pageY)/2;a.set(s,l)}break;default:y=v.NONE}},!1),this.domElement.addEventListener("touchend",function(){!1!==i.enabled&&(y=v.NONE,i.noPan=!1,i.noZoom=!1,_(!1))},!1),this.domElement.addEventListener("touchmove",function(e){if(!1!==i.enabled){e.preventDefault(),e.stopPropagation();var t=i.domElement===document?i.domElement.body:i.domElement;switch(e.touches.length){case 1:if(!0===i.noRotate)return;if(y!==v.TOUCH_ROTATE)return;r.set(e.touches[0].pageX,e.touches[0].pageY),o.subVectors(r,n),i.rotateLeft(2*Math.PI*o.x/t.clientWidth*i.rotateSpeed),i.rotateUp(2*Math.PI*o.y/t.clientHeight*i.rotateSpeed),n.copy(r);break;case 2:if(y!==v.TOUCH_DOLLY_PAN)return;if(!1===i.noZoom){var d=e.touches[0].pageX-e.touches[1].pageX,p=e.touches[0].pageY-e.touches[1].pageY,f=Math.sqrt(d*d+p*p);u.set(0,f),h.subVectors(u,c);var m=Math.abs(h.y);c.copy(u)}if(!1===i.noPan){var g=(e.touches[0].pageX+e.touches[1].pageX)/2,b=(e.touches[0].pageY+e.touches[1].pageY)/2;s.set(g,b),l.subVectors(s,a);var x=Math.max(Math.abs(l.x),Math.abs(l.y));a.copy(s)}!1===i.noPan&&!1===i.noZoom&&(m>x?i.noPan=!0:i.noZoom=!0),!1===i.noZoom&&Math.abs(h.y)>1.3&&(h.y>0?i.dollyOut():i.dollyIn()),!1===i.noPan&&i.pan(l);break;default:y=v.NONE}}},!1)},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.STLLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.STLLoader.prototype={constructor:THREE.STLLoader,load:function(e,t,i,n){var r=this,o=new THREE.FileLoader(r.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){t(r.parse(e))},i,n)},parse:function(e){var t=function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=255&e.charCodeAt(i);return t.buffer||t}return e}(e);return function(e){var t;if(84+50*(t=new DataView(e)).getUint32(80,!0)===t.byteLength)return!0;for(var i=[115,111,108,105,100],n=0;n<5;n++)if(i[n]!=t.getUint8(n,!1))return!0;return!1}(t)?function(e){for(var t,i,n,r,o,a,s,l,c=new DataView(e),u=c.getUint32(80,!0),h=!1,d=0;d<70;d++)1129270351==c.getUint32(d,!1)&&82==c.getUint8(d+4)&&61==c.getUint8(d+5)&&(h=!0,r=[],o=c.getUint8(d+6)/255,a=c.getUint8(d+7)/255,s=c.getUint8(d+8)/255,l=c.getUint8(d+9)/255);for(var p=new THREE.BufferGeometry,f=[],m=[],g=0;g<u;g++){var v=84+50*g,y=c.getFloat32(v,!0),b=c.getFloat32(v+4,!0),x=c.getFloat32(v+8,!0);if(h){var _=c.getUint16(v+48,!0);0==(32768&_)?(t=(31&_)/31,i=(_>>5&31)/31,n=(_>>10&31)/31):(t=o,i=a,n=s)}for(var w=1;w<=3;w++){var E=v+12*w;f.push(c.getFloat32(E,!0)),f.push(c.getFloat32(E+4,!0)),f.push(c.getFloat32(E+8,!0)),m.push(y,b,x),h&&r.push(t,i,n)}}return p.addAttribute("position",new THREE.BufferAttribute(new Float32Array(f),3)),p.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(m),3)),h&&(p.addAttribute("color",new THREE.BufferAttribute(new Float32Array(r),3)),p.hasColors=!0,p.alpha=l),p}(t):function(e){for(var t,i=new THREE.BufferGeometry,n=/facet([\s\S]*?)endfacet/g,r=0,o=/[\s]+([+-]?(?:\d+.\d+|\d+.|\d+|.\d+)(?:[eE][+-]?\d+)?)/.source,a=new RegExp("vertex"+o+o+o,"g"),s=new RegExp("normal"+o+o+o,"g"),l=[],c=[],u=new THREE.Vector3;null!==(t=n.exec(e));){for(var h=0,d=0,p=t[0];null!==(t=s.exec(p));)u.x=parseFloat(t[1]),u.y=parseFloat(t[2]),u.z=parseFloat(t[3]),d++;for(;null!==(t=a.exec(p));)l.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),c.push(u.x,u.y,u.z),h++;1!==d&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+r),3!==h&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+r),r++}return i.addAttribute("position",new THREE.Float32BufferAttribute(l,3)),i.addAttribute("normal",new THREE.Float32BufferAttribute(c,3)),i}(function(e){if("string"!=typeof e){var t=new Uint8Array(e);if(void 0!==window.TextDecoder)return(new TextDecoder).decode(t);for(var i="",n=0,r=e.byteLength;n<r;n++)i+=String.fromCharCode(t[n]);return i}return e}(e))}},function(e,t,i){"use strict";function n(e){return function(){var t,i=arguments[0];i="["+(e?e+":":"")+i+"] http://errors.angularjs.org/1.3.0-beta.7/"+(e?e+"/":"")+i;for(t=1;t<arguments.length;t++)i=i+(1==t?"?":"&")+"p"+(t-1)+"="+encodeURIComponent("function"==typeof arguments[t]?arguments[t].toString().replace(/ \{[\s\S]*$/,""):void 0===arguments[t]?"undefined":"string"!=typeof arguments[t]?JSON.stringify(arguments[t]):arguments[t]);return Error(i)}}function r(e){if(null==e||M(e))return!1;var t=e.length;return!(1!==e.nodeType||!t)||(b(e)||w(e)||0===t||"number"==typeof t&&0<t&&t-1 in e)}function o(e,t,i){var n;if(e)if(E(e))for(n in e)"prototype"==n||"length"==n||"name"==n||e.hasOwnProperty&&!e.hasOwnProperty(n)||t.call(i,e[n],n);else if(e.forEach&&e.forEach!==o)e.forEach(t,i);else if(r(e))for(n=0;n<e.length;n++)t.call(i,e[n],n);else for(n in e)e.hasOwnProperty(n)&&t.call(i,e[n],n);return e}function a(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(t);return i.sort()}function s(e){return function(t,i){e(i,t)}}function l(){for(var e,t=Jt.length;t;){if(57==(e=Jt[--t].charCodeAt(0)))return Jt[t]="A",Jt.join("");if(90!=e)return Jt[t]=String.fromCharCode(e+1),Jt.join("");Jt[t]="0"}return Jt.unshift("0"),Jt.join("")}function c(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function u(e){var t=e.$$hashKey;return o(arguments,function(t){t!==e&&o(t,function(t,i){e[i]=t})}),c(e,t),e}function h(e){return parseInt(e,10)}function d(e,t){return u(new(u(function(){},{prototype:e})),t)}function p(){}function f(e){return e}function m(e){return function(){return e}}function g(e){return void 0===e}function v(e){return void 0!==e}function y(e){return null!=e&&"object"==typeof e}function b(e){return"string"==typeof e}function x(e){return"number"==typeof e}function _(e){return"[object Date]"===Xt.call(e)}function w(e){return"[object Array]"===Xt.call(e)}function E(e){return"function"==typeof e}function T(e){return"[object RegExp]"===Xt.call(e)}function M(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function S(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}function C(e,t){if(e.indexOf)return e.indexOf(t);for(var i=0;i<e.length;i++)if(t===e[i])return i;return-1}function R(e,t){var i=C(e,t);return 0<=i&&e.splice(i,1),t}function A(e,t){if(M(e)||e&&e.$evalAsync&&e.$watch)throw Zt("cpws");if(t){if(e===t)throw Zt("cpi");if(w(e))for(var i=t.length=0;i<e.length;i++)t.push(A(e[i]));else{for(var n in i=t.$$hashKey,o(t,function(e,i){delete t[i]}),e)t[n]=A(e[n]);c(t,i)}}else(t=e)&&(w(e)?t=A(e,[]):_(e)?t=new Date(e.getTime()):T(e)?t=RegExp(e.source):y(e)&&(t=A(e,{})));return t}function P(e,t){for(var i in t=t||{},e)!e.hasOwnProperty(i)||"$"===i.charAt(0)&&"$"===i.charAt(1)||(t[i]=e[i]);return t}function L(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!=e&&t!=t)return!0;var n,r=typeof e;if(r==typeof t&&"object"==r){if(!w(e)){if(_(e))return _(t)&&e.getTime()==t.getTime();if(T(e)&&T(t))return e.toString()==t.toString();if(e&&e.$evalAsync&&e.$watch||t&&t.$evalAsync&&t.$watch||M(e)||M(t)||w(t))return!1;for(n in r={},e)if("$"!==n.charAt(0)&&!E(e[n])){if(!L(e[n],t[n]))return!1;r[n]=!0}for(n in t)if(!r.hasOwnProperty(n)&&"$"!==n.charAt(0)&&t[n]!==i&&!E(t[n]))return!1;return!0}if(!w(t))return!1;if((r=e.length)==t.length){for(n=0;n<r;n++)if(!L(e[n],t[n]))return!1;return!0}}return!1}function O(){return t.securityPolicy&&t.securityPolicy.isActive||t.querySelector&&!(!t.querySelector("[ng-csp]")&&!t.querySelector("[data-ng-csp]"))}function I(e,t){var i=2<arguments.length?Wt.call(arguments,2):[];return!E(t)||t instanceof RegExp?t:i.length?function(){return arguments.length?t.apply(e,i.concat(Wt.call(arguments,0))):t.apply(e,i)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function k(e,n){var r=n;return"string"==typeof e&&"$"===e.charAt(0)?r=i:M(n)?r="$WINDOW":n&&t===n?r="$DOCUMENT":n&&n.$evalAsync&&n.$watch&&(r="$SCOPE"),r}function D(e,t){return void 0===e?i:JSON.stringify(e,k,t?"  ":null)}function N(e){return b(e)?JSON.parse(e):e}function H(e){return"function"==typeof e?e=!0:e&&0!==e.length?e=!("f"==(e=zt(""+e))||"0"==e||"false"==e||"no"==e||"n"==e||"[]"==e):e=!1,e}function B(e){e=Ft(e).clone();try{e.empty()}catch(e){}var t=Ft("<div>").append(e).html();try{return 3===e[0].nodeType?zt(t):t.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(e,t){return"<"+zt(t)})}catch(e){return zt(t)}}function F(e){try{return decodeURIComponent(e)}catch(e){}}function U(e){var t,i,n={};return o((e||"").split("&"),function(e){e&&(t=e.split("="),v(i=F(t[0]))&&(e=!v(t[1])||F(t[1]),n[i]?w(n[i])?n[i].push(e):n[i]=[n[i],e]:n[i]=e))}),n}function $(e){var t=[];return o(e,function(e,i){w(e)?o(e,function(e){t.push(z(i,!0)+(!0===e?"":"="+z(e,!0)))}):t.push(z(i,!0)+(!0===e?"":"="+z(e,!0)))}),t.length?t.join("&"):""}function j(e){return z(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function z(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}function V(e,i){function n(e){e&&s.push(e)}var r,a,s=[e],l={},c=["ng:app","ng-app","x-ng-app","data-ng-app"],u=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;o(c,function(i){c[i]=!0,n(t.getElementById(i)),i=i.replace(":","\\:"),e.querySelectorAll&&(o(e.querySelectorAll("."+i),n),o(e.querySelectorAll("."+i+"\\:"),n),o(e.querySelectorAll("["+i+"]"),n))}),o(s,function(e){if(!r){var t=u.exec(" "+e.className+" ");t?(r=e,a=(t[2]||"").replace(/\s+/g,",")):o(e.attributes,function(t){!r&&c[t.name]&&(r=e,a=t.value)})}}),r&&(l.strictDi=null!==function(e,t){var i,n,r=Qt.length;for(e=Ft(e),n=0;n<r;++n)if(i=Qt[n]+t,b(i=e.attr(i)))return i;return null}(r,"strict-di"),i(r,a?[a]:[],l))}function G(i,n,r){y(r)||(r={}),r=u({strictDi:!1},r);var a=function(){if((i=Ft(i)).injector()){var e=i[0]===t?"document":B(i);throw Zt("btstrpd",e)}return(n=n||[]).unshift(["$provide",function(e){e.value("$rootElement",i)}]),n.unshift("ng"),(e=ye(n,r.strictDi)).invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(e,t,i,n,r){e.$apply(function(){t.data("$injector",n),i(t)(e)})}]),e},s=/^NG_DEFER_BOOTSTRAP!/;if(e&&!s.test(e.name))return a();e.name=e.name.replace(s,""),Yt.resumeBootstrap=function(e){o(e,function(e){n.push(e)}),a()}}function W(e,t){return t=t||"_",e.replace(ei,function(e,i){return(i?t:"")+e.toLowerCase()})}function q(e,t,i){if(!e)throw Zt("areq",t||"?",i||"required");return e}function X(e,t,i){return i&&w(e)&&(e=e[e.length-1]),q(E(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function Z(e,t){if("hasOwnProperty"===e)throw Zt("badname",t)}function Y(e,t,i){if(!t)return e;for(var n,r=e,o=(t=t.split(".")).length,a=0;a<o;a++)n=t[a],e&&(e=(r=e)[n]);return!i&&E(e)?I(r,e):e}function J(e){var t=e[0];if(t===(e=e[e.length-1]))return Ft(t);var i=[t];do{if(!(t=t.nextSibling))break;i.push(t)}while(t!==e);return Ft(i)}function K(e){return e.replace(si,function(e,t,i,n){return n?i.toUpperCase():i}).replace(li,"Moz$1")}function Q(e,t,i,n){function r(e){var r,a,s,l,c,u,h=i&&e?[this.filter(e)]:[this],d=t;if(!n||null!=e)for(;h.length;)for(a=0,s=(r=h.shift()).length;a<s;a++)for(l=Ft(r[a]),d?l.triggerHandler("$destroy"):d=!d,c=0,l=(u=l.children()).length;c<l;c++)h.push(Ut(u[c]));return o.apply(this,arguments)}var o=(o=Ut.fn[e]).$original||o;r.$original=o,Ut.fn[e]=r}function ee(e){if(e instanceof ee)return e;if(b(e)&&(e=Kt(e)),!(this instanceof ee)){if(b(e)&&"<"!=e.charAt(0))throw ci("nosel");return new ee(e)}var i,n;b(e)&&(i=t,e=(n=ui.exec(e))?[i.createElement(n[1])]:(n=function(e,t){var i,n,r=t.createDocumentFragment(),a=[];if(hi.test(e)){for(i=i||r.appendChild(t.createElement("div")),n=(di.exec(e)||["",""])[1].toLowerCase(),n=fi[n]||fi._default,i.innerHTML=n[1]+e.replace(pi,"<$1></$2>")+n[2],n=n[0];n--;)i=i.lastChild;a=a.concat(Wt.call(i.childNodes,void 0)),(i=r.firstChild).textContent=""}else a.push(t.createTextNode(e));return r.textContent="",r.innerHTML="",o(a,function(e){r.appendChild(e)}),r}(e,i))?n.childNodes:[]);ue(this,e)}function te(e){return e.cloneNode(!0)}function ie(e){re(e);var t=0;for(e=e.childNodes||[];t<e.length;t++)ie(e[t])}function ne(e,t,i,n){if(v(n))throw ci("offargs");var r=oe(e,"events");oe(e,"handle")&&(g(t)?o(r,function(t,i){ai(e,i,t),delete r[i]}):o(t.split(" "),function(t){g(i)?(ai(e,t,r[t]),delete r[t]):R(r[t]||[],i)}))}function re(e,t){var n=e[ni],r=ii[n];r&&(t?delete ii[n].data[t]:(r.handle&&(r.events.$destroy&&r.handle({},"$destroy"),ne(e)),delete ii[n],e[ni]=i))}function oe(e,t,i){var n=e[ni];n=ii[n||-1];if(!v(i))return n&&n[t];n||(e[ni]=n=++ri,n=ii[n]={}),n[t]=i}function ae(e,t,i){var n=oe(e,"data"),r=v(i),o=!r&&v(t),a=o&&!y(t);if(n||a||oe(e,"data",n={}),r)n[t]=i;else{if(!o)return n;if(a)return n&&n[t];u(n,t)}}function se(e,t){return!!e.getAttribute&&-1<(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")}function le(e,t){t&&e.setAttribute&&o(t.split(" "),function(t){e.setAttribute("class",Kt((" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+Kt(t)+" "," ")))})}function ce(e,t){if(t&&e.setAttribute){var i=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");o(t.split(" "),function(e){e=Kt(e),-1===i.indexOf(" "+e+" ")&&(i+=e+" ")}),e.setAttribute("class",Kt(i))}}function ue(e,t){if(t){t=t.nodeName||!v(t.length)||M(t)?[t]:t;for(var i=0;i<t.length;i++)e.push(t[i])}}function he(e,t){return de(e,"$"+(t||"ngController")+"Controller")}function de(e,t,n){for(9==(e=Ft(e))[0].nodeType&&(e=e.find("html")),t=w(t)?t:[t];e.length;){for(var r=e[0],o=0,a=t.length;o<a;o++)if((n=e.data(t[o]))!==i)return n;e=Ft(r.parentNode||11===r.nodeType&&r.host)}}function pe(e){for(var t=0,i=e.childNodes;t<i.length;t++)ie(i[t]);for(;e.firstChild;)e.removeChild(e.firstChild)}function fe(e,t){var i=gi[t.toLowerCase()];return i&&vi[e.nodeName]&&i}function me(e){var t,n=typeof e;return"object"==n&&null!==e?"function"==typeof(t=e.$$hashKey)?t=e.$$hashKey():t===i&&(t=e.$$hashKey=l()):t=e,n+":"+t}function ge(e){o(e,this.put,this)}function ve(e,t,i){var n;if("function"==typeof e){if(!(n=e.$inject)){if(n=[],e.length){if(t)throw b(i)&&i||(i=e.name||function(e){return(e=e.toString().replace(_i,"").match(yi))?"function("+(e[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}(e)),wi("strictdi",i);o((t=(t=e.toString().replace(_i,"")).match(yi))[1].split(bi),function(e){e.replace(xi,function(e,t,i){n.push(i)})})}e.$inject=n}}else w(e)?(X(e[t=e.length-1],"fn"),n=e.slice(0,t)):X(e,"fn",!0);return n}function ye(e,t){function n(e){return function(t,i){if(!y(t))return e(t,i);o(t,s(e))}}function r(e,t){if(Z(e,"service"),(E(t)||w(t))&&(t=g.instantiate(t)),!t.$get)throw wi("pget",e);return f[e+u]=t}function a(e,t){return r(e,{$get:t})}function l(e,i){function n(t){if(e.hasOwnProperty(t)){if(e[t]===c)throw wi("cdep",h.join(" <- "));return e[t]}try{return h.unshift(t),e[t]=c,e[t]=i(t)}catch(i){throw e[t]===c&&delete e[t],i}finally{h.shift()}}function r(e,i,r,o){"string"==typeof r&&(o=r,r=null);var a,s,l,c=[];for(s=0,a=(o=ve(e,t,o)).length;s<a;s++){if("string"!=typeof(l=o[s]))throw wi("itkn",l);c.push(r&&r.hasOwnProperty(l)?r[l]:n(l))}return e.$inject||(e=e[a]),e.apply(i,c)}return{invoke:r,instantiate:function(e,t,i){var n=function(){};return n.prototype=(w(e)?e[e.length-1]:e).prototype,y(e=r(e,n=new n,t,i))||E(e)?e:n},get:n,annotate:ve,has:function(t){return f.hasOwnProperty(t+u)||e.hasOwnProperty(t)}}}t=!0===t;var c={},u="Provider",h=[],d=new ge,f={$provide:{provider:n(r),factory:n(a),service:n(function(e,t){return a(e,["$injector",function(e){return e.instantiate(t)}])}),value:n(function(e,t){return a(e,m(t))}),constant:n(function(e,t){Z(e,"constant"),f[e]=t,v[e]=t}),decorator:function(e,t){var i=g.get(e+u),n=i.$get;i.$get=function(){var e=x.invoke(n,i);return x.invoke(t,null,{$delegate:e})}}}},g=f.$injector=l(f,function(){throw wi("unpr",h.join(" <- "))}),v={},x=v.$injector=l(v,function(e){var t=g.get(e+u);return x.invoke(t.$get,t,i,e)});return o(function e(t){var i,n,r,a,s=[];return o(t,function(t){if(!d.get(t)){d.put(t,!0);try{if(b(t))for(i=$t(t),s=s.concat(e(i.requires)).concat(i._runBlocks),n=i._invokeQueue,r=0,a=n.length;r<a;r++){var o=n[r],l=g.get(o[0]);l[o[1]].apply(l,o[2])}else E(t)?s.push(g.invoke(t)):w(t)?s.push(g.invoke(t)):X(t,"module")}catch(e){throw w(t)&&(t=t[t.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),wi("modulerr",t,e.stack||e.message||e)}}}),s}(e),function(e){x.invoke(e||p)}),x}function be(){var e=!0;this.disableAutoScrolling=function(){e=!1},this.$get=["$window","$location","$rootScope",function(t,i,n){function r(){var e,n=i.hash();n?(e=a.getElementById(n))?e.scrollIntoView():(e=function(e){var t=null;return o(e,function(e){t||"a"!==zt(e.nodeName)||(t=e)}),t}(a.getElementsByName(n)))?e.scrollIntoView():"top"===n&&t.scrollTo(0,0):t.scrollTo(0,0)}var a=t.document;return e&&n.$watch(function(){return i.hash()},function(){n.$evalAsync(r)}),r}]}function xe(){this.$get=["$$rAF","$timeout",function(e,t){return e.supported?function(t){return e(t)}:function(e){return t(e,0,!1)}}]}function _e(e,t,n,r){function a(e){try{e.apply(null,Wt.call(arguments,1))}finally{if(0===--v)for(;y.length;)try{y.pop()()}catch(e){n.error(e)}}}function s(){T=null,w!=l.url()&&(w=l.url(),o(M,function(e){e(l.url())}))}var l=this,c=t[0],u=e.location,h=e.history,d=e.setTimeout,f=e.clearTimeout,m={};l.isMock=!1;var v=0,y=[];l.$$completeOutstandingRequest=a,l.$$incOutstandingRequestCount=function(){v++},l.notifyWhenNoOutstandingRequests=function(e){o(_,function(e){e()}),0===v?e():y.push(e)};var x,_=[];l.addPollFn=function(e){return g(x)&&function(e,t){!function i(){o(_,function(e){e()}),x=t(i,e)}()}(100,d),_.push(e),e};var w=u.href,E=t.find("base"),T=null;l.url=function(t,i){return u!==e.location&&(u=e.location),h!==e.history&&(h=e.history),t?w!=t?(w=t,r.history?i?h.replaceState(null,"",t):(h.pushState(null,"",t),E.attr("href",E.attr("href"))):(T=t,i?u.replace(t):u.href=t),l):void 0:T||u.href.replace(/%27/g,"'")};var M=[],S=!1;l.onUrlChange=function(t){return S||(r.history&&Ft(e).on("popstate",s),r.hashchange?Ft(e).on("hashchange",s):l.addPollFn(s),S=!0),M.push(t),t},l.baseHref=function(){var e=E.attr("href");return e?e.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var C={},R="",A=l.baseHref();l.cookies=function(e,t){var r,o,a,s;if(!e){if(c.cookie!==R)for(r=(R=c.cookie).split("; "),C={},a=0;a<r.length;a++)0<(s=(o=r[a]).indexOf("="))&&(e=unescape(o.substring(0,s)),C[e]===i&&(C[e]=unescape(o.substring(s+1))));return C}t===i?c.cookie=escape(e)+"=;path="+A+";expires=Thu, 01 Jan 1970 00:00:00 GMT":b(t)&&(4096<(r=(c.cookie=escape(e)+"="+escape(t)+";path="+A).length+1)&&n.warn("Cookie '"+e+"' possibly not set or overflowed because it was too large ("+r+" > 4096 bytes)!"))},l.defer=function(e,t){var i;return v++,i=d(function(){delete m[i],a(e)},t||0),m[i]=!0,i},l.defer.cancel=function(e){return!!m[e]&&(delete m[e],f(e),a(p),!0)}}function we(){this.$get=["$window","$log","$sniffer","$document",function(e,t,i,n){return new _e(e,n,t,i)}]}function Ee(){this.$get=function(){function e(e,i){function r(e){e!=d&&(p?p==e&&(p=e.n):p=e,o(e.n,e.p),o(e,d),(d=e).n=null)}function o(e,t){e!=t&&(e&&(e.p=t),t&&(t.n=e))}if(e in t)throw n("$cacheFactory")("iid",e);var a=0,s=u({},i,{id:e}),l={},c=i&&i.capacity||Number.MAX_VALUE,h={},d=null,p=null;return t[e]={put:function(e,t){c<Number.MAX_VALUE&&r(h[e]||(h[e]={key:e}));if(!g(t))return e in l||a++,l[e]=t,a>c&&this.remove(p.key),t},get:function(e){if(c<Number.MAX_VALUE){var t=h[e];if(!t)return;r(t)}return l[e]},remove:function(e){if(c<Number.MAX_VALUE){var t=h[e];if(!t)return;t==d&&(d=t.p),t==p&&(p=t.n),o(t.n,t.p),delete h[e]}delete l[e],a--},removeAll:function(){l={},a=0,h={},d=p=null},destroy:function(){h=s=l=null,delete t[e]},info:function(){return u({},s,{size:a})}}}var t={};return e.info=function(){var e={};return o(t,function(t,i){e[i]=t.info()}),e},e.get=function(e){return t[e]},e}}function Te(){this.$get=["$cacheFactory",function(e){return e("templates")}]}function Me(e,n){var r={},a="Directive",l=/^\s*directive\:\s*([\d\w\-_]+)\s+(.*)$/,c=/(([\d\w\-_]+)(?:\:([^;]+))?;?)/,h=/^(on[a-z]+|formaction)$/;this.directive=function t(i,n){return Z(i,"directive"),b(i)?(q(n,"directiveFactory"),r.hasOwnProperty(i)||(r[i]=[],e.factory(i+a,["$injector","$exceptionHandler",function(e,t){var n=[];return o(r[i],function(r,o){try{var a=e.invoke(r);E(a)?a={compile:m(a)}:!a.compile&&a.link&&(a.compile=m(a.link)),a.priority=a.priority||0,a.index=o,a.name=a.name||i,a.require=a.require||a.controller&&a.name,a.restrict=a.restrict||"A",n.push(a)}catch(e){t(e)}}),n}])),r[i].push(n)):o(i,s(t)),this},this.aHrefSanitizationWhitelist=function(e){return v(e)?(n.aHrefSanitizationWhitelist(e),this):n.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(e){return v(e)?(n.imgSrcSanitizationWhitelist(e),this):n.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(e,n,s,p,g,v,x,_,T,M,S,C){function A(e,t,i,n,r){e instanceof Ft||(e=Ft(e)),o(e,function(t,i){3==t.nodeType&&t.nodeValue.match(/\S+/)&&(e[i]=Ft(t).wrap("<span></span>").parent()[0])});var a=k(e,t,e,i,n,r);return O(e,"ng-scope"),function(t,i,n){q(t,"scope");var r=i?mi.clone.call(e):e;o(n,function(e,t){r.data("$"+t+"Controller",e)}),n=0;for(var s=r.length;n<s;n++){var l=r[n].nodeType;1!==l&&9!==l||r.eq(n).data("$scope",t)}return i&&i(r,t),a&&a(t,r,r),r}}function O(e,t){try{e.addClass(t)}catch(e){}}function k(e,t,n,r,o,a){for(var s,l,c,u,h=[],d=0;d<e.length;d++)s=new Q,(a=(l=N(e[d],[],s,0===d?r:i,o)).length?U(l,e[d],s,t,n,null,[],[],a):null)&&a.scope&&O(Ft(e[d]),"ng-scope"),s=a&&a.terminal||!(c=e[d].childNodes)||!c.length?null:k(c,a?a.transclude:t),h.push(a,s),u=u||a||s,a=null;return u?function(e,n,r,o){var a,s,l,c,u,d,p;a=n.length;var f=Array(a);for(u=0;u<a;u++)f[u]=n[u];for(p=u=0,d=h.length;u<d;p++)s=f[p],n=h[u++],a=h[u++],l=Ft(s),n?(n.scope?(c=e.$new(),l.data("$scope",c)):c=e,(l=n.transclude)||!o&&t?n(a,c,s,r,D(e,l||t)):n(a,c,s,r,o)):a&&a(e,s.childNodes,i,o)}:null}function D(e,t){return function(i,n,r){var o=!1;return i||(o=(i=e.$new()).$$transcluded=!0),n=t(i,n,r),o&&n.on("$destroy",I(i,i.$destroy)),n}}function N(e,t,i,n,r){var o,a=i.$attr;switch(e.nodeType){case 1:var s,u,h;j(t,Se(jt(e).toLowerCase()),"E",n,r);for(var d=0,p=(o=e.attributes)&&o.length;d<p;d++){var f=!1,m=!1;if(s=o[d],!Bt||8<=Bt||s.specified)h=Se(u=s.name),re.test(h)&&(u=W(h.substr(6),"-")),h===h.replace(/(Start|End)$/,"")+"Start"&&(f=u,m=u.substr(0,u.length-5)+"end",u=u.substr(0,u.length-6)),a[h=Se(u.toLowerCase())]=u,i[h]=s=Kt(s.value),fe(e,h)&&(i[h]=!0),Y(e,t,s,h),j(t,h,"A",n,r,f,m)}if(b(e=e.className)&&""!==e)for(;o=c.exec(e);)j(t,h=Se(o[2]),"C",n,r)&&(i[h]=Kt(o[3])),e=e.substr(o.index+o[0].length);break;case 3:Z(t,e.nodeValue);break;case 8:try{(o=l.exec(e.nodeValue))&&(j(t,h=Se(o[1]),"M",n,r)&&(i[h]=Kt(o[2])))}catch(e){}}return t.sort(G),t}function H(e,t,i){var n=[],r=0;if(t&&e.hasAttribute&&e.hasAttribute(t))do{if(!e)throw Mi("uterdir",t,i);1==e.nodeType&&(e.hasAttribute(t)&&r++,e.hasAttribute(i)&&r--),n.push(e),e=e.nextSibling}while(0<r);else n.push(e);return Ft(n)}function F(e,t,i){return function(n,r,o,a,s){return r=H(r[0],t,i),e(n,r,o,a,s)}}function U(e,r,a,l,c,u,h,d,p){function f(e,t,i,n){e&&(i&&(e=F(e,i,n)),e.require=T.require,e.directiveName=M,(k===T||T.$$isolateScope)&&(e=K(e,{isolateScope:!0})),h.push(e)),t&&(i&&(t=F(t,i,n)),t.require=T.require,t.directiveName=M,(k===T||T.$$isolateScope)&&(t=K(t,{isolateScope:!0})),d.push(t))}function m(e,t,i,n){var r,a="data",s=!1;if(b(t)){for(;"^"==(r=t.charAt(0))||"?"==r;)t=t.substr(1),"^"==r&&(a="inheritedData"),s=s||"?"==r;if(r=null,n&&"data"===a&&(r=n[t]),!(r=r||i[a]("$"+t+"Controller"))&&!s)throw Mi("ctreq",t,e)}else w(t)&&(r=[],o(t,function(t){r.push(m(e,t,i,n))}));return r}function g(e,t,l,c,u){var p,f,g,y,b,_,w,E={};if(p=r===l?a:P(a,new Q(Ft(l),a.$attr)),f=p.$$element,k){var T=/^\s*([@=&])(\??)\s*(\w*)\s*$/;c=Ft(l),_=t.$new(!0),D&&D===k.$$originalDirective?c.data("$isolateScope",_):c.data("$isolateScopeNoTemplate",_),O(c,"ng-isolate-scope"),o(k.scope,function(e,i){var r,o,a,s,l=(u=e.match(T)||[])[3]||i,c="?"==u[2],u=u[1];switch(_.$$isolateBindings[i]=u+l,u){case"@":p.$observe(l,function(e){_[i]=e}),p.$$observers[l].$$scope=t,p[l]&&(_[i]=n(p[l])(t));break;case"=":if(c&&!p[l])break;o=v(p[l]),s=o.literal?L:function(e,t){return e===t},a=o.assign||function(){throw r=_[i]=o(t),Mi("nonassign",p[l],k.name)},r=_[i]=o(t),_.$watch(function(){var e=o(t);return s(e,_[i])||(s(e,r)?a(t,e=_[i]):_[i]=e),r=e},null,o.literal);break;case"&":o=v(p[l]),_[i]=function(e){return o(t,e)};break;default:throw Mi("iscp",k.name,i,e)}})}for(w=u&&function(e,t){var n;return 2>arguments.length&&(t=e,e=i),G&&(n=E),u(e,t,n)},I&&o(I,function(e){var i,n={$scope:e===k||e.$$isolateScope?_:t,$element:f,$attrs:p,$transclude:w};"@"==(b=e.controller)&&(b=p[e.name]),i=x(b,n),E[e.name]=i,G||f.data("$"+e.name+"Controller",i),e.controllerAs&&(n.$scope[e.controllerAs]=i)}),c=0,g=h.length;c<g;c++)try{(y=h[c])(y.isolateScope?_:t,f,p,y.require&&m(y.directiveName,y.require,f,E),w)}catch(e){s(e,B(f))}for(c=t,k&&(k.template||null===k.templateUrl)&&(c=_),e&&e(c,l.childNodes,i,u),c=d.length-1;0<=c;c--)try{(y=d[c])(y.isolateScope?_:t,f,p,y.require&&m(y.directiveName,y.require,f,E),w)}catch(e){s(e,B(f))}}p=p||{};for(var _,T,M,S,C,R=-Number.MAX_VALUE,I=p.controllerDirectives,k=p.newIsolateScopeDirective,D=p.templateDirective,U=p.nonTlbTranscludeDirective,j=!1,G=p.hasElementTranscludeDirective,W=a.$$element=Ft(r),q=l,Z=0,Y=e.length;Z<Y;Z++){var ee=(T=e[Z]).$$start,ie=T.$$end;if(ee&&(W=H(r,ee,ie)),S=i,R>T.priority)break;if((S=T.scope)&&(_=_||T,T.templateUrl||(X("new/isolated scope",k,T,W),y(S)&&(k=T))),M=T.name,!T.templateUrl&&T.controller&&(S=T.controller,X("'"+M+"' controller",(I=I||{})[M],T,W),I[M]=T),(S=T.transclude)&&(j=!0,T.$$tlb||(X("transclusion",U,T,W),U=T),"element"==S?(G=!0,R=T.priority,S=H(r,ee,ie),W=a.$$element=Ft(t.createComment(" "+M+": "+a[M]+" ")),r=W[0],J(c,Ft(Wt.call(S,0)),r),q=A(S,l,R,u&&u.name,{nonTlbTranscludeDirective:U})):(S=Ft(te(r)).contents(),W.empty(),q=A(S,l))),T.template)if(X("template",D,T,W),D=T,S=E(T.template)?T.template(W,a):T.template,S=ne(S),T.replace){if(u=T,S=hi.test(S)?Ft(Kt(S)):[],r=S[0],1!=S.length||1!==r.nodeType)throw Mi("tplrt",M,"");J(c,W,r),S=N(r,[],Y={$attr:{}});var re=e.splice(Z+1,e.length-(Z+1));k&&$(S),e=e.concat(S).concat(re),z(a,Y),Y=e.length}else W.html(S);if(T.templateUrl)X("template",D,T,W),D=T,T.replace&&(u=T),g=V(e.splice(Z,e.length-Z),W,a,c,q,h,d,{controllerDirectives:I,newIsolateScopeDirective:k,templateDirective:D,nonTlbTranscludeDirective:U}),Y=e.length;else if(T.compile)try{E(C=T.compile(W,a,q))?f(null,C,ee,ie):C&&f(C.pre,C.post,ee,ie)}catch(e){s(e,B(W))}T.terminal&&(g.terminal=!0,R=Math.max(R,T.priority))}return g.scope=_&&!0===_.scope,g.transclude=j&&q,p.hasElementTranscludeDirective=G,g}function $(e){for(var t=0,i=e.length;t<i;t++)e[t]=d(e[t],{$$isolateScope:!0})}function j(t,n,o,l,c,u,h){if(n===c)return null;if(c=null,r.hasOwnProperty(n))for(var p,f=0,m=(n=e.get(n+a)).length;f<m;f++)try{p=n[f],(l===i||l>p.priority)&&-1!=p.restrict.indexOf(o)&&(u&&(p=d(p,{$$start:u,$$end:h})),t.push(p),c=p)}catch(e){s(e)}return c}function z(e,t){var i=t.$attr,n=e.$attr,r=e.$$element;o(e,function(n,r){"$"!=r.charAt(0)&&(t[r]&&(n+=("style"===r?";":" ")+t[r]),e.$set(r,n,!0,i[r]))}),o(t,function(t,o){"class"==o?(O(r,t),e.class=(e.class?e.class+" ":"")+t):"style"==o?(r.attr("style",r.attr("style")+";"+t),e.style=(e.style?e.style+";":"")+t):"$"==o.charAt(0)||e.hasOwnProperty(o)||(e[o]=t,n[o]=i[o])})}function V(e,t,i,n,r,a,s,l){var c,h,d=[],f=t[0],m=e.shift(),v=u({},m,{templateUrl:null,transclude:null,replace:null,$$originalDirective:m}),b=E(m.templateUrl)?m.templateUrl(t,i):m.templateUrl;return t.empty(),p.get(M.getTrustedResourceUrl(b),{cache:g}).success(function(u){var p,g;if(u=ne(u),m.replace){if(u=hi.test(u)?Ft(Kt(u)):[],p=u[0],1!=u.length||1!==p.nodeType)throw Mi("tplrt",m.name,b);u={$attr:{}},J(n,t,p);var x=N(p,[],u);y(m.scope)&&$(x),e=x.concat(e),z(i,u)}else p=f,t.html(u);for(e.unshift(v),c=U(e,p,i,r,t,m,a,s,l),o(n,function(e,i){e==p&&(n[i]=t[0])}),h=k(t[0].childNodes,r);d.length;){u=d.shift(),g=d.shift();var _=d.shift(),w=d.shift();x=t[0];if(g!==f){var E=g.className;l.hasElementTranscludeDirective&&m.replace||(x=te(p)),J(_,Ft(g),x),O(Ft(x),E)}g=c.transclude?D(u,c.transclude):w,c(h,u,x,n,g)}d=null}).error(function(e,t,i,n){throw Mi("tpload",n.url)}),function(e,t,i,n,r){d?(d.push(t),d.push(i),d.push(n),d.push(r)):c(h,t,i,n,r)}}function G(e,t){var i=t.priority-e.priority;return 0!==i?i:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function X(e,t,i,n){if(t)throw Mi("multidir",t.name,i.name,e,B(n))}function Z(e,t){var i=n(t,!0);i&&e.push({priority:0,compile:m(function(e,t){var n=t.parent(),r=n.data("$binding")||[];r.push(i),O(n.data("$binding",r),"ng-binding"),e.$watch(i,function(e){t[0].nodeValue=e})})})}function Y(e,t,i,r){var o=n(i,!0);if(o){if("multiple"===r&&"SELECT"===jt(e))throw Mi("selmulti",B(e));t.push({priority:100,compile:function(){return{pre:function(t,i,a){if(i=a.$$observers||(a.$$observers={}),h.test(r))throw Mi("nodomevents");(o=n(a[r],!0,function(e,t){if("srcdoc"==t)return M.HTML;var i=jt(e);return"xlinkHref"==t||"FORM"==i&&"action"==t||"IMG"!=i&&("src"==t||"ngSrc"==t)?M.RESOURCE_URL:void 0}(e,r)))&&(a[r]=o(t),(i[r]||(i[r]=[])).$$inter=!0,(a.$$observers&&a.$$observers[r].$$scope||t).$watch(o,function(e,t){"class"===r&&e!=t?a.$updateClass(e,t):a.$set(r,e)}))}}}})}}function J(e,i,n){var r,o,a=i[0],s=i.length,l=a.parentNode;if(e)for(r=0,o=e.length;r<o;r++)if(e[r]==a){e[r++]=n,o=r+s-1;for(var c=e.length;r<c;r++,o++)o<c?e[r]=e[o]:delete e[r];e.length-=s-1;break}for(l&&l.replaceChild(n,a),(e=t.createDocumentFragment()).appendChild(a),n[Ft.expando]=a[Ft.expando],a=1,s=i.length;a<s;a++)l=i[a],Ft(l).remove(),e.appendChild(l),delete i[a];i[0]=n,i.length=1}function K(e,t){return u(function(){return e.apply(null,arguments)},e,t)}var Q=function(e,t){this.$$element=e,this.$attr=t||{}};Q.prototype={$normalize:Se,$addClass:function(e){e&&0<e.length&&S.addClass(this.$$element,e)},$removeClass:function(e){e&&0<e.length&&S.removeClass(this.$$element,e)},$updateClass:function(e,t){var i=Ce(e,t),n=Ce(t,e);0===i.length?S.removeClass(this.$$element,n):0===n.length?S.addClass(this.$$element,i):S.setClass(this.$$element,i,n)},$set:function(e,t,n,r){var a=fe(this.$$element[0],e);a&&(this.$$element.prop(e,t),r=a),this[e]=t,r?this.$attr[e]=r:(r=this.$attr[e])||(this.$attr[e]=r=W(e,"-")),("A"===(a=jt(this.$$element))&&"href"===e||"IMG"===a&&"src"===e)&&(this[e]=t=C(t,"src"===e)),!1!==n&&(null===t||t===i?this.$$element.removeAttr(r):this.$$element.attr(r,t)),(n=this.$$observers)&&o(n[e],function(e){try{e(t)}catch(e){s(e)}})},$observe:function(e,t){var i=this,n=i.$$observers||(i.$$observers={}),r=n[e]||(n[e]=[]);return r.push(t),_.$evalAsync(function(){r.$$inter||t(i[e])}),function(){R(r,t)}}};var ee=n.startSymbol(),ie=n.endSymbol(),ne="{{"==ee||"}}"==ie?f:function(e){return e.replace(/\{\{/g,ee).replace(/}}/g,ie)},re=/^ngAttr[A-Z]/;return A}]}function Se(e){return K(e.replace(Si,""))}function Ce(e,t){var i="",n=e.split(/\s+/),r=t.split(/\s+/),o=0;e:for(;o<n.length;o++){for(var a=n[o],s=0;s<r.length;s++)if(a==r[s])continue e;i+=(0<i.length?" ":"")+a}return i}function Re(){var e={},t=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(t,i){Z(t,"controller"),y(t)?u(e,t):e[t]=i},this.$get=["$injector","$window",function(i,r){return function(o,a){var s,l,c;if(b(o)&&(l=(s=o.match(t))[1],c=s[3],X(o=e.hasOwnProperty(l)?e[l]:Y(a.$scope,l,!0)||Y(r,l,!0),l,!0)),s=i.instantiate(o,a,l),c){if(!a||"object"!=typeof a.$scope)throw n("$controller")("noscp",l||o.name,c);a.$scope[c]=s}return s}}]}function Ae(){this.$get=["$window",function(e){return Ft(e.document)}]}function Pe(){this.$get=["$log",function(e){return function(t,i){e.error.apply(e,arguments)}}]}function Le(e){var t,i,n,r={};return e?(o(e.split("\n"),function(e){n=e.indexOf(":"),t=zt(Kt(e.substr(0,n))),i=Kt(e.substr(n+1)),t&&(r[t]=r[t]?r[t]+", "+i:i)}),r):r}function Oe(e){var t=y(e)?e:i;return function(i){return t||(t=Le(e)),i?t[zt(i)]||null:t}}function Ie(e,t,i){return E(i)?i(e,t):(o(i,function(i){e=i(e,t)}),e)}function ke(){var e=/^\s*(\[|\{[^\{])/,t=/[\}\]]\s*$/,n=/^\)\]\}',?\n/,r={"Content-Type":"application/json;charset=utf-8"},s=this.defaults={transformResponse:[function(i){return b(i)&&(i=i.replace(n,""),e.test(i)&&t.test(i)&&(i=N(i))),i}],transformRequest:[function(e){return y(e)&&"[object File]"!==Xt.call(e)&&"[object Blob]"!==Xt.call(e)?D(e):e}],headers:{common:{Accept:"application/json, text/plain, */*"},post:A(r),put:A(r),patch:A(r)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},l=this.interceptors=[],c=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(e,t,n,r,h,d){function p(e){function n(e){var t=u({},e,{data:Ie(e.data,e.headers,r.transformResponse)});return 200<=e.status&&300>e.status?t:h.reject(t)}var r={method:"get",transformRequest:s.transformRequest,transformResponse:s.transformResponse},a=function(e){function t(e){var t;o(e,function(i,n){E(i)&&(null!=(t=i())?e[n]=t:delete e[n])})}var i,n,r=s.headers,a=u({},e.headers);t(r=u({},r.common,r[zt(e.method)])),t(a);e:for(i in r){for(n in e=zt(i),a)if(zt(n)===e)continue e;a[i]=r[i]}return a}(e);u(r,e),r.headers=a,r.method=Gt(r.method),(e=mt(r.url)?t.cookies()[r.xsrfCookieName||s.xsrfCookieName]:i)&&(a[r.xsrfHeaderName||s.xsrfHeaderName]=e);var l=[function(e){a=e.headers;var t=Ie(e.data,Oe(a),e.transformRequest);return g(e.data)&&o(a,function(e,t){"content-type"===zt(t)&&delete a[t]}),g(e.withCredentials)&&!g(s.withCredentials)&&(e.withCredentials=s.withCredentials),f(e,t,a).then(n,n)},i],c=h.when(r);for(o(_,function(e){(e.request||e.requestError)&&l.unshift(e.request,e.requestError),(e.response||e.responseError)&&l.push(e.response,e.responseError)});l.length;){e=l.shift();var d=l.shift();c=c.then(e,d)}return c.success=function(e){return c.then(function(t){e(t.data,t.status,t.headers,r)}),c},c.error=function(e){return c.then(null,function(t){e(t.data,t.status,t.headers,r)}),c},c}function f(t,i,n){function o(e,i,n,r){(200<=(i=Math.max(i,0))&&300>i?u.resolve:u.reject)({data:e,status:i,headers:Oe(n),config:t,statusText:r})}function a(){var e=C(p.pendingRequests,t);-1!==e&&p.pendingRequests.splice(e,1)}var l,c,u=h.defer(),d=u.promise,f=m(t.url,t.params);if(p.pendingRequests.push(t),d.then(a,a),(t.cache||s.cache)&&!1!==t.cache&&"GET"==t.method&&(l=y(t.cache)?t.cache:y(s.cache)?s.cache:x),l)if(v(c=l.get(f))){if(c.then)return c.then(a,a),c;w(c)?o(c[1],c[0],A(c[2]),c[3]):o(c,200,{},"OK")}else l.put(f,d);return g(c)&&e(t.method,f,i,function(e,t,i,n){l&&(200<=e&&300>e?l.put(f,[e,t,Le(i),n]):l.remove(f)),o(t,e,i,n),r.$$phase||r.$apply()},n,t.timeout,t.withCredentials,t.responseType),d}function m(e,t){if(!t)return e;var i=[];return function(e,t,i){for(var n=a(e),r=0;r<n.length;r++)t.call(i,e[n[r]],n[r])}(t,function(e,t){null===e||g(e)||(w(e)||(e=[e]),o(e,function(e){y(e)&&(e=D(e)),i.push(z(t)+"="+z(e))}))}),0<i.length&&(e+=(-1==e.indexOf("?")?"?":"&")+i.join("&")),e}var x=n("$http"),_=[];return o(l,function(e){_.unshift(b(e)?d.get(e):d.invoke(e))}),o(c,function(e,t){var i=b(e)?d.get(e):d.invoke(e);_.splice(t,0,{response:function(e){return i(h.when(e))},responseError:function(e){return i(h.reject(e))}})}),p.pendingRequests=[],function(e){o(arguments,function(e){p[e]=function(t,i){return p(u(i||{},{method:e,url:t}))}})}("get","delete","head","jsonp"),function(e){o(arguments,function(e){p[e]=function(t,i,n){return p(u(n||{},{method:e,url:t,data:i}))}})}("post","put"),p.defaults=s,p}]}function De(t){if(8>=Bt&&(!t.match(/^(get|post|head|put|delete|options)$/i)||!e.XMLHttpRequest))return new e.ActiveXObject("Microsoft.XMLHTTP");if(e.XMLHttpRequest)return new e.XMLHttpRequest;throw n("$httpBackend")("noxhr")}function Ne(){this.$get=["$browser","$window","$document",function(e,t,i){return function(e,t,i,n,r){function a(e,t,i){var o=r.createElement("script"),a=null;return o.type="text/javascript",o.src=e,o.async=!0,a=function(e){ai(o,"load",a),ai(o,"error",a),r.body.removeChild(o),o=null;var s=-1,l="unknown";e&&("load"!==e.type||n[t].called||(e={type:"error"}),l=e.type,s="error"===e.type?404:200),i&&i(s,l)},oi(o,"load",a),oi(o,"error",a),r.body.appendChild(o),a}var s=-1;return function(r,l,c,u,h,d,f,m){function g(){b=s,_&&_(),w&&w.abort()}function y(t,n,r,o,a){E&&i.cancel(E),_=w=null,0===n&&(n=r?200:"file"==ft(l).protocol?404:0),t(1223===n?204:n,r,o,a||""),e.$$completeOutstandingRequest(p)}var b;if(e.$$incOutstandingRequestCount(),l=l||e.url(),"jsonp"==zt(r)){var x="_"+(n.counter++).toString(36);n[x]=function(e){n[x].data=e,n[x].called=!0};var _=a(l.replace("JSON_CALLBACK","angular.callbacks."+x),x,function(e,t){y(u,e,n[x].data,"",t),n[x]=p})}else{var w=t(r);if(w.open(r,l,!0),o(h,function(e,t){v(e)&&w.setRequestHeader(t,e)}),w.onreadystatechange=function(){if(w&&4==w.readyState){var e=null,t=null;b!==s&&(e=w.getAllResponseHeaders(),t="response"in w?w.response:w.responseText),y(u,b||w.status,t,e,w.statusText||"")}},f&&(w.withCredentials=!0),m)try{w.responseType=m}catch(e){if("json"!==m)throw e}w.send(c||null)}if(0<d)var E=i(g,d);else d&&d.then&&d.then(g)}}(e,De,e.defer,t.angular.callbacks,i[0])}]}function He(){var e="{{",t="}}";this.startSymbol=function(t){return t?(e=t,this):e},this.endSymbol=function(e){return e?(t=e,this):t},this.$get=["$parse","$exceptionHandler","$sce",function(n,r,o){function a(a,c,h){for(var d,p,f=0,m=[],v=[],y=[],b=a.length,x=!1,_=!1,w=[],E={},T={};f<b;){if(-1==(d=a.indexOf(e,f))||-1==(p=a.indexOf(t,d+s))){f!==b&&(_=!0,m.push(a.substring(f)));break}f!==d&&(_=!0),m.push(a.substring(f,d)),f=a.substring(d+s,p),v.push(f),y.push(n(f)),f=p+l,x=!0}if(m.length===v.length&&m.push(""),h&&x&&(_||1<v.length))throw Ci("noconcat",a);if(!c||x){w.length=m.length+v.length;var M=function(e){return null===(e=h?o.getTrusted(h,e):o.valueOf(e))||g(e)?e="":"string"!=typeof e&&(e=D(e)),e};return u(function(e){var t,n=e.$id||"notAScope",o=E[n],s=T[n],l=0,c=v.length,u=Array(c),h=s===i;o||(o=[],h=!0,e.$on&&e.$on("$destroy",function(){E[n]=null,T[n]=null}));try{for(;l<c;l++)(t=M(y[l](e)))!==o[l]&&(h=!0),u[l]=t;h&&(E[n]=u,T[n]=s=function(e){for(var t=0,i=v.length;t<i;t++)w[2*t]=m[t],w[2*t+1]=e[t];return w[2*i]=m[i],w.join("")}(u))}catch(t){e=Ci("interr",a,t.toString()),r(e)}return s},{exp:a,separators:m,expressions:v})}}var s=e.length,l=t.length;return a.startSymbol=function(){return e},a.endSymbol=function(){return t},a}]}function Be(){this.$get=["$rootScope","$window","$q",function(e,t,i){function n(n,o,a,s){var l=t.setInterval,c=t.clearInterval,u=i.defer(),h=u.promise,d=0,p=v(s)&&!s;return a=v(a)?a:0,h.then(null,null,n),h.$$intervalId=l(function(){u.notify(d++),0<a&&d>=a&&(u.resolve(d),c(h.$$intervalId),delete r[h.$$intervalId]),p||e.$apply()},o),r[h.$$intervalId]=u,h}var r={};return n.cancel=function(e){return!!(e&&e.$$intervalId in r)&&(r[e.$$intervalId].reject("canceled"),clearInterval(e.$$intervalId),delete r[e.$$intervalId],!0)},n}]}function Fe(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"",posSuf:"",negPre:"(",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January February March April May June July August September October November December".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a",short:"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(e){return 1===e?"one":"other"}}}}function Ue(e){for(var t=(e=e.split("/")).length;t--;)e[t]=j(e[t]);return e.join("/")}function $e(e,t,i){e=ft(e,i),t.$$protocol=e.protocol,t.$$host=e.hostname,t.$$port=h(e.port)||Ai[e.protocol]||null}function je(e,t,i){var n="/"!==e.charAt(0);n&&(e="/"+e),e=ft(e,i),t.$$path=decodeURIComponent(n&&"/"===e.pathname.charAt(0)?e.pathname.substring(1):e.pathname),t.$$search=U(e.search),t.$$hash=decodeURIComponent(e.hash),t.$$path&&"/"!=t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function ze(e,t){if(0===t.indexOf(e))return t.substr(e.length)}function Ve(e){var t=e.indexOf("#");return-1==t?e:e.substr(0,t)}function Ge(e){return e.substr(0,Ve(e).lastIndexOf("/")+1)}function We(e,t){this.$$html5=!0,t=t||"";var n=Ge(e);$e(e,this,e),this.$$parse=function(t){var i=ze(n,t);if(!b(i))throw Pi("ipthprfx",t,n);je(i,this,e),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var e=$(this.$$search),t=this.$$hash?"#"+j(this.$$hash):"";this.$$url=Ue(this.$$path)+(e?"?"+e:"")+t,this.$$absUrl=n+this.$$url.substr(1)},this.$$rewrite=function(r){var o;return(o=ze(e,r))!==i?(r=o,(o=ze(t,o))!==i?n+(ze("/",o)||o):e+r):(o=ze(n,r))!==i?n+o:n==r+"/"?n:void 0}}function qe(e,t){var i=Ge(e);$e(e,this,e),this.$$parse=function(n){var r;if(!b(r="#"==(r=ze(e,n)||ze(i,n)).charAt(0)?ze(t,r):this.$$html5?r:""))throw Pi("ihshprfx",n,t);je(r,this,e),n=this.$$path;var o=/^\/[A-Z]:(\/.*)/;0===r.indexOf(e)&&(r=r.replace(e,"")),o.exec(r)||(n=(r=o.exec(n))?r[1]:n),this.$$path=n,this.$$compose()},this.$$compose=function(){var i=$(this.$$search),n=this.$$hash?"#"+j(this.$$hash):"";this.$$url=Ue(this.$$path)+(i?"?"+i:"")+n,this.$$absUrl=e+(this.$$url?t+this.$$url:"")},this.$$rewrite=function(t){if(Ve(e)==Ve(t))return t}}function Xe(e,t){this.$$html5=!0,qe.apply(this,arguments);var i=Ge(e);this.$$rewrite=function(n){var r;return e==Ve(n)?n:(r=ze(i,n))?e+t+r:i===n+"/"?i:void 0},this.$$compose=function(){var i=$(this.$$search),n=this.$$hash?"#"+j(this.$$hash):"";this.$$url=Ue(this.$$path)+(i?"?"+i:"")+n,this.$$absUrl=e+t+this.$$url}}function Ze(e){return function(){return this[e]}}function Ye(e,t){return function(i){return g(i)?this[e]:(this[e]=t(i),this.$$compose(),this)}}function Je(){var t="",i=!1;this.hashPrefix=function(e){return v(e)?(t=e,this):t},this.html5Mode=function(e){return v(e)?(i=e,this):i},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(n,r,o,a){function s(e){n.$broadcast("$locationChangeSuccess",l.absUrl(),e)}var l,c,u,h=r.baseHref(),d=r.url();i?(u=d.substring(0,d.indexOf("/",d.indexOf("//")+2))+(h||"/"),c=o.history?We:Xe):(u=Ve(d),c=qe),(l=new c(u,"#"+t)).$$parse(l.$$rewrite(d)),a.on("click",function(i){if(!i.ctrlKey&&!i.metaKey&&2!=i.which){for(var o=Ft(i.target);"a"!==zt(o[0].nodeName);)if(o[0]===a[0]||!(o=o.parent())[0])return;var s=o.prop("href");if(y(s)&&"[object SVGAnimatedString]"===s.toString()&&(s=ft(s.animVal).href),c===Xe)if(0>(d=o.attr("href")||o.attr("xlink:href")).indexOf("://"))if(s="#"+t,"/"==d[0])s=u+s+d;else if("#"==d[0])s=u+s+(l.path()||"/")+d;else{for(var h=l.path().split("/"),d=d.split("/"),p=0;p<d.length;p++)"."!=d[p]&&(".."==d[p]?h.pop():d[p].length&&h.push(d[p]));s=u+s+h.join("/")}h=l.$$rewrite(s),s&&!o.attr("target")&&h&&!i.isDefaultPrevented()&&(i.preventDefault(),h!=r.url()&&(l.$$parse(h),n.$apply(),e.angular["ff-684208-preventDefault"]=!0))}}),l.absUrl()!=d&&r.url(l.absUrl(),!0),r.onUrlChange(function(e){l.absUrl()!=e&&(n.$evalAsync(function(){var t=l.absUrl();l.$$parse(e),n.$broadcast("$locationChangeStart",e,t).defaultPrevented?(l.$$parse(t),r.url(t)):s(t)}),n.$$phase||n.$digest())});var p=0;return n.$watch(function(){var e=r.url(),t=l.$$replace;return p&&e==l.absUrl()||(p++,n.$evalAsync(function(){n.$broadcast("$locationChangeStart",l.absUrl(),e).defaultPrevented?l.$$parse(e):(r.url(l.absUrl(),t),s(e))})),l.$$replace=!1,p}),l}]}function Ke(){var e=!0,t=this;this.debugEnabled=function(t){return v(t)?(e=t,this):e},this.$get=["$window",function(i){function n(e){var t=i.console||{},n=t[e]||t.log||p;e=!1;try{e=!!n.apply}catch(e){}return e?function(){var e=[];return o(arguments,function(t){e.push(function(e){return e instanceof Error&&(e.stack?e=e.message&&-1===e.stack.indexOf(e.message)?"Error: "+e.message+"\n"+e.stack:e.stack:e.sourceURL&&(e=e.message+"\n"+e.sourceURL+":"+e.line)),e}(t))}),n.apply(t,e)}:function(e,t){n(e,null==t?"":t)}}return{log:n("log"),info:n("info"),warn:n("warn"),error:n("error"),debug:function(){var i=n("debug");return function(){e&&i.apply(t,arguments)}}()}}]}function Qe(e,t){if("constructor"===e)throw Oi("isecfld",t);return e}function et(e,t){if(e){if(e.constructor===e)throw Oi("isecfn",t);if(e.document&&e.location&&e.alert&&e.setInterval)throw Oi("isecwindow",t);if(e.children&&(e.nodeName||e.prop&&e.attr&&e.find))throw Oi("isecdom",t)}return e}function tt(e,t,n,r,o){o=o||{},t=t.split(".");for(var a,s=0;1<t.length;s++){var l=e[a=Qe(t.shift(),r)];l||(l={},e[a]=l),(e=l).then&&o.unwrapPromises&&(Li(r),"$$v"in e||function(e){e.then(function(t){e.$$v=t})}(e),e.$$v===i&&(e.$$v={}),e=e.$$v)}return e[a=Qe(t.shift(),r)]=n}function it(e,t,n,r,o,a,s){return Qe(e,a),Qe(t,a),Qe(n,a),Qe(r,a),Qe(o,a),s.unwrapPromises?function(s,l){var c,u=l&&l.hasOwnProperty(e)?l:s;return null==u?u:((u=u[e])&&u.then&&(Li(a),"$$v"in u||((c=u).$$v=i,c.then(function(e){c.$$v=e})),u=u.$$v),t?null==u?i:((u=u[t])&&u.then&&(Li(a),"$$v"in u||((c=u).$$v=i,c.then(function(e){c.$$v=e})),u=u.$$v),n?null==u?i:((u=u[n])&&u.then&&(Li(a),"$$v"in u||((c=u).$$v=i,c.then(function(e){c.$$v=e})),u=u.$$v),r?null==u?i:((u=u[r])&&u.then&&(Li(a),"$$v"in u||((c=u).$$v=i,c.then(function(e){c.$$v=e})),u=u.$$v),o?null==u?i:((u=u[o])&&u.then&&(Li(a),"$$v"in u||((c=u).$$v=i,c.then(function(e){c.$$v=e})),u=u.$$v),u):u):u):u):u)}:function(a,s){var l=s&&s.hasOwnProperty(e)?s:a;return null==l?l:(l=l[e],t?null==l?i:(l=l[t],n?null==l?i:(l=l[n],r?null==l?i:(l=l[r],o?null==l?i:l=l[o]:l):l):l):l)}}function nt(e,t,n){if(Bi.hasOwnProperty(e))return Bi[e];var r,a=e.split("."),s=a.length;if(t.unwrapPromises||1!==s)if(t.unwrapPromises||2!==s)if(t.csp)r=6>s?it(a[0],a[1],a[2],a[3],a[4],n,t):function(e,r){var o,l=0;do{o=it(a[l++],a[l++],a[l++],a[l++],a[l++],n,t)(e,r),r=i,e=o}while(l<s);return o};else{var l="var p;\n";o(a,function(e,i){Qe(e,n),l+="if(s == null) return undefined;\ns="+(i?"s":'((k&&k.hasOwnProperty("'+e+'"))?k:s)')+'["'+e+'"];\n'+(t.unwrapPromises?'if (s && s.then) {\n pw("'+n.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n':"")});l=l+"return s;";var c=new Function("s","k","pw",l);c.toString=m(l),r=t.unwrapPromises?function(e,t){return c(e,t,Li)}:c}else r=function(e,t,n){return Qe(e,n),Qe(t,n),function(n,r){return null==n?i:null==(n=(r&&r.hasOwnProperty(e)?r:n)[e])?i:n[t]}}(a[0],a[1],n);else r=function(e,t){return Qe(e,t),function(t,n){return null==t?i:(n&&n.hasOwnProperty(e)?n:t)[e]}}(a[0],n);return"hasOwnProperty"!==e&&(Bi[e]=r),r}function rt(){var e={},t={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0};this.unwrapPromises=function(e){return v(e)?(t.unwrapPromises=!!e,this):t.unwrapPromises},this.logPromiseWarnings=function(e){return v(e)?(t.logPromiseWarnings=e,this):t.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function(i,n,r){return t.csp=n.csp,Li=function(e){t.logPromiseWarnings&&!Ii.hasOwnProperty(e)&&(Ii[e]=!0,r.warn("[$parse] Promise found in the expression `"+e+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))},function(n){var r;switch(typeof n){case"string":return e.hasOwnProperty(n)?e[n]:(r=new Ni(t),r=new Hi(r,i,t).parse(n,!1),"hasOwnProperty"!==n&&(e[n]=r),r);case"function":return n;default:return p}}}]}function ot(){this.$get=["$rootScope","$exceptionHandler",function(e,t){return function(e,t){function n(e){return e}function r(e){return l(e)}var a=function(){var o,l,u=[];return l={resolve:function(t){if(u){var n=u;u=i,o=s(t),n.length&&e(function(){for(var e,t=0,i=n.length;t<i;t++)e=n[t],o.then(e[0],e[1],e[2])})}},reject:function(e){l.resolve(c(e))},notify:function(t){if(u){var i=u;u.length&&e(function(){for(var e=0,n=i.length;e<n;e++)i[e][2](t)})}},promise:{then:function(e,i,s){var l=a(),c=function(i){try{l.resolve((E(e)?e:n)(i))}catch(e){l.reject(e),t(e)}},h=function(e){try{l.resolve((E(i)?i:r)(e))}catch(e){l.reject(e),t(e)}},d=function(e){try{l.notify((E(s)?s:n)(e))}catch(e){t(e)}};return u?u.push([c,h,d]):o.then(c,h,d),l.promise},catch:function(e){return this.then(null,e)},finally:function(e){function t(e,t){var i=a();return t?i.resolve(e):i.reject(e),i.promise}function i(i,r){var o=null;try{o=(e||n)()}catch(e){return t(e,!1)}return o&&E(o.then)?o.then(function(){return t(i,r)},function(e){return t(e,!1)}):t(i,r)}return this.then(function(e){return i(e,!0)},function(e){return i(e,!1)})}}}},s=function(t){return t&&E(t.then)?t:{then:function(i){var n=a();return e(function(){n.resolve(i(t))}),n.promise}}},l=function(e){var t=a();return t.reject(e),t.promise},c=function(i){return{then:function(n,o){var s=a();return e(function(){try{s.resolve((E(o)?o:r)(i))}catch(e){s.reject(e),t(e)}}),s.promise}}};return{defer:a,reject:l,when:function(i,o,c,u){var h,d=a(),p=function(e){try{return(E(o)?o:n)(e)}catch(e){return t(e),l(e)}},f=function(e){try{return(E(c)?c:r)(e)}catch(e){return t(e),l(e)}},m=function(e){try{return(E(u)?u:n)(e)}catch(e){t(e)}};return e(function(){s(i).then(function(e){h||(h=!0,d.resolve(s(e).then(p,f,m)))},function(e){h||(h=!0,d.resolve(f(e)))},function(e){h||d.notify(m(e))})}),d.promise},all:function(e){var t=a(),i=0,n=w(e)?[]:{};return o(e,function(e,r){i++,s(e).then(function(e){n.hasOwnProperty(r)||(n[r]=e,--i||t.resolve(n))},function(e){n.hasOwnProperty(r)||t.reject(e)})}),0===i&&t.resolve(n),t.promise}}}(function(t){e.$evalAsync(t)},t)}]}function at(){this.$get=["$window","$timeout",function(e,t){var i=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame,n=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,r=!!i,o=r?function(e){var t=i(e);return function(){n(t)}}:function(e){var i=t(e,16.66,!1);return function(){t.cancel(i)}};return o.supported=r,o}]}function st(){var e=10,t=n("$rootScope"),i=null;this.digestTtl=function(t){return arguments.length&&(e=t),e},this.$get=["$injector","$exceptionHandler","$parse","$browser",function(n,a,s,c){function u(){this.$id=l(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.this=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}function h(e){if(g.$$phase)throw t("inprog",g.$$phase);g.$$phase=e}function d(e,t){var i=s(e);return X(i,t),i}function f(e,t,i){do{e.$$listenerCount[i]-=t,0===e.$$listenerCount[i]&&delete e.$$listenerCount[i]}while(e=e.$parent)}function m(){}u.prototype={constructor:u,$new:function(e){return e?((e=new u).$root=this.$root,e.$$asyncQueue=this.$$asyncQueue,e.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=l(),this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),e=new this.$$childScopeClass),e.this=e,e.$parent=this,e.$$prevSibling=this.$$childTail,this.$$childHead?this.$$childTail=this.$$childTail.$$nextSibling=e:this.$$childHead=this.$$childTail=e,e},$watch:function(e,t,n){var r=d(e,"watch"),o=this.$$watchers,a={fn:t,last:m,get:r,exp:e,eq:!!n};if(i=null,!E(t)){var s=d(t||p,"listener");a.fn=function(e,t,i){s(i)}}if("string"==typeof e&&r.constant){var l=a.fn;a.fn=function(e,t,i){l.call(this,e,t,i),R(o,a)}}return o||(o=this.$$watchers=[]),o.unshift(a),function(){R(o,a),i=null}},$watchGroup:function(e,t){var i=Array(e.length),n=Array(e.length),r=[],a=0,s=this;return o(e,function(e,t){r.push(s.$watch(e,function(e,r){n[t]=e,i[t]=r,a++}))},this),r.push(s.$watch(function(){return a},function(){t(n,i,s)})),function(){o(r,function(e){e()})}},$watchCollection:function(e,t){var i,n,o,a=this,l=1<t.length,c=0,u=s(e),h=[],d={},p=!0,f=0;return this.$watch(function(){var e,t;if(y(i=u(a)))if(r(i))for(n!==h&&(f=(n=h).length=0,c++),e=i.length,f!==e&&(c++,n.length=f=e),t=0;t<e;t++)n[t]!=n[t]&&i[t]!=i[t]||n[t]===i[t]||(c++,n[t]=i[t]);else{for(t in n!==d&&(n=d={},f=0,c++),e=0,i)i.hasOwnProperty(t)&&(e++,n.hasOwnProperty(t)?n[t]!==i[t]&&(c++,n[t]=i[t]):(f++,n[t]=i[t],c++));if(f>e)for(t in c++,n)n.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(f--,delete n[t])}else n!==i&&(n=i,c++);return c},function(){if(p?(p=!1,t(i,i,a)):t(i,o,a),l)if(y(i))if(r(i)){o=Array(i.length);for(var e=0;e<i.length;e++)o[e]=i[e]}else for(e in o={},i)Vt.call(i,e)&&(o[e]=i[e]);else o=i})},$digest:function(){var n,r,o,s,l,c,u,d,p,f,v=this.$$asyncQueue,y=this.$$postDigestQueue,b=e,x=[];h("$digest"),i=null;do{for(c=!1,u=this;v.length;){try{(f=v.shift()).scope.$eval(f.expression)}catch(e){g.$$phase=null,a(e)}i=null}e:do{if(s=u.$$watchers)for(l=s.length;l--;)try{if(n=s[l])if((r=n.get(u))===(o=n.last)||(n.eq?L(r,o):"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))){if(n===i){c=!1;break e}}else c=!0,i=n,n.last=n.eq?A(r):r,n.fn(r,o===m?r:o,u),5>b&&(x[d=4-b]||(x[d]=[]),p=E(n.exp)?"fn: "+(n.exp.name||n.exp.toString()):n.exp,p+="; newVal: "+D(r)+"; oldVal: "+D(o),x[d].push(p))}catch(e){g.$$phase=null,a(e)}if(!(s=u.$$childHead||u!==this&&u.$$nextSibling))for(;u!==this&&!(s=u.$$nextSibling);)u=u.$parent}while(u=s);if((c||v.length)&&!b--)throw g.$$phase=null,t("infdig",e,D(x))}while(c||v.length);for(g.$$phase=null;y.length;)try{y.shift()()}catch(e){a(e)}},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==g&&(o(this.$$listenerCount,I(null,f,this)),e.$$childHead==this&&(e.$$childHead=this.$$nextSibling),e.$$childTail==this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=p,this.$on=this.$watch=this.$watchGroup=function(){return p})}},$eval:function(e,t){return s(e)(this,t)},$evalAsync:function(e){g.$$phase||g.$$asyncQueue.length||c.defer(function(){g.$$asyncQueue.length&&g.$digest()}),this.$$asyncQueue.push({scope:this,expression:e})},$$postDigest:function(e){this.$$postDigestQueue.push(e)},$apply:function(e){try{return h("$apply"),this.$eval(e)}catch(e){a(e)}finally{g.$$phase=null;try{g.$digest()}catch(e){throw a(e),e}}},$on:function(e,t){var i=this.$$listeners[e];i||(this.$$listeners[e]=i=[]),i.push(t);var n=this;do{n.$$listenerCount[e]||(n.$$listenerCount[e]=0),n.$$listenerCount[e]++}while(n=n.$parent);var r=this;return function(){i[C(i,t)]=null,f(r,1,e)}},$emit:function(e,t){var i,n,r,o=[],s=this,l=!1,c={name:e,targetScope:s,stopPropagation:function(){l=!0},preventDefault:function(){c.defaultPrevented=!0},defaultPrevented:!1},u=[c].concat(Wt.call(arguments,1));do{for(i=s.$$listeners[e]||o,c.currentScope=s,n=0,r=i.length;n<r;n++)if(i[n])try{i[n].apply(null,u)}catch(e){a(e)}else i.splice(n,1),n--,r--;if(l)break;s=s.$parent}while(s);return c},$broadcast:function(e,t){for(var i,n,r=this,o=this,s={name:e,targetScope:this,preventDefault:function(){s.defaultPrevented=!0},defaultPrevented:!1},l=[s].concat(Wt.call(arguments,1));r=o;){for(s.currentScope=r,i=0,n=(o=r.$$listeners[e]||[]).length;i<n;i++)if(o[i])try{o[i].apply(null,l)}catch(e){a(e)}else o.splice(i,1),i--,n--;if(!(o=r.$$listenerCount[e]&&r.$$childHead||r!==this&&r.$$nextSibling))for(;r!==this&&!(o=r.$$nextSibling);)r=r.$parent}return s}};var g=new u;return g}]}function lt(){var e=/^\s*(https?|ftp|mailto|tel|file):/,t=/^\s*(https?|ftp|file|blob):|data:image\//;this.aHrefSanitizationWhitelist=function(t){return v(t)?(e=t,this):e},this.imgSrcSanitizationWhitelist=function(e){return v(e)?(t=e,this):t},this.$get=function(){return function(i,n){var r,o=n?t:e;return Bt&&!(8<=Bt)||(""===(r=ft(i).href)||r.match(o))?i:"unsafe:"+r}}}function ct(e){var t=[];return v(e)&&o(e,function(e){t.push(function(e){if("self"===e)return e;if(b(e)){if(-1<e.indexOf("***"))throw Fi("iwcard",e);return e=e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08").replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),RegExp("^"+e+"$")}if(T(e))return RegExp("^"+e.source+"$");throw Fi("imatcher")}(e))}),t}function ut(){this.SCE_CONTEXTS=Ui;var e=["self"],t=[];this.resourceUrlWhitelist=function(t){return arguments.length&&(e=ct(t)),e},this.resourceUrlBlacklist=function(e){return arguments.length&&(t=ct(e)),t},this.$get=["$injector",function(n){function r(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}var o=function(e){throw Fi("unsafe")};n.has("$sanitize")&&(o=n.get("$sanitize"));var a=r(),s={};return s[Ui.HTML]=r(a),s[Ui.CSS]=r(a),s[Ui.URL]=r(a),s[Ui.JS]=r(a),s[Ui.RESOURCE_URL]=r(s[Ui.URL]),{trustAs:function(e,t){var n=s.hasOwnProperty(e)?s[e]:null;if(!n)throw Fi("icontext",e,t);if(null===t||t===i||""===t)return t;if("string"!=typeof t)throw Fi("itype",e);return new n(t)},getTrusted:function(n,r){if(null===r||r===i||""===r)return r;if((c=s.hasOwnProperty(n)?s[n]:null)&&r instanceof c)return r.$$unwrapTrustedValue();if(n===Ui.RESOURCE_URL){var a,l,c=ft(r.toString()),u=!1;for(a=0,l=e.length;a<l;a++)if("self"===e[a]?mt(c):e[a].exec(c.href)){u=!0;break}if(u)for(a=0,l=t.length;a<l;a++)if("self"===t[a]?mt(c):t[a].exec(c.href)){u=!1;break}if(u)return r;throw Fi("insecurl",r.toString())}if(n===Ui.HTML)return o(r);throw Fi("unsafe")},valueOf:function(e){return e instanceof a?e.$$unwrapTrustedValue():e}}}]}function ht(){var e=!0;this.enabled=function(t){return arguments.length&&(e=!!t),e},this.$get=["$parse","$sniffer","$sceDelegate",function(t,i,n){if(e&&i.msie&&8>i.msieDocumentMode)throw Fi("iequirks");var r=A(Ui);r.isEnabled=function(){return e},r.trustAs=n.trustAs,r.getTrusted=n.getTrusted,r.valueOf=n.valueOf,e||(r.trustAs=r.getTrusted=function(e,t){return t},r.valueOf=f),r.parseAs=function(e,i){var n=t(i);return n.literal&&n.constant?n:function(t,i){return r.getTrusted(e,n(t,i))}};var a=r.parseAs,s=r.getTrusted,l=r.trustAs;return o(Ui,function(e,t){var i=zt(t);r[K("parse_as_"+i)]=function(t){return a(e,t)},r[K("get_trusted_"+i)]=function(t){return s(e,t)},r[K("trust_as_"+i)]=function(t){return l(e,t)}}),r}]}function dt(){this.$get=["$window","$document",function(e,t){var i,n={},r=h((/android (\d+)/.exec(zt((e.navigator||{}).userAgent))||[])[1]),o=/Boxee/i.test((e.navigator||{}).userAgent),a=t[0]||{},s=a.documentMode,l=/^(Moz|webkit|O|ms)(?=[A-Z])/,c=a.body&&a.body.style,u=!1,d=!1;if(c){for(var p in c)if(u=l.exec(p)){i=(i=u[0]).substr(0,1).toUpperCase()+i.substr(1);break}i||(i="WebkitOpacity"in c&&"webkit"),u=!!("transition"in c||i+"Transition"in c),d=!!("animation"in c||i+"Animation"in c),!r||u&&d||(u=b(a.body.style.webkitTransition),d=b(a.body.style.webkitAnimation))}return{history:!(!e.history||!e.history.pushState||4>r||o),hashchange:"onhashchange"in e&&(!s||7<s),hasEvent:function(e){if("input"==e&&9==Bt)return!1;if(g(n[e])){var t=a.createElement("div");n[e]="on"+e in t}return n[e]},csp:O(),vendorPrefix:i,transitions:u,animations:d,android:r,msie:Bt,msieDocumentMode:s}}]}function pt(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(e,t,i,n){function r(r,a,s){var l=i.defer(),c=l.promise,u=v(s)&&!s;return a=t.defer(function(){try{l.resolve(r())}catch(e){l.reject(e),n(e)}finally{delete o[c.$$timeoutId]}u||e.$apply()},a),c.$$timeoutId=a,o[a]=l,c}var o={};return r.cancel=function(e){return!!(e&&e.$$timeoutId in o)&&(o[e.$$timeoutId].reject("canceled"),delete o[e.$$timeoutId],t.defer.cancel(e.$$timeoutId))},r}]}function ft(e,t){var i=e;return Bt&&($i.setAttribute("href",i),i=$i.href),$i.setAttribute("href",i),{href:$i.href,protocol:$i.protocol?$i.protocol.replace(/:$/,""):"",host:$i.host,search:$i.search?$i.search.replace(/^\?/,""):"",hash:$i.hash?$i.hash.replace(/^#/,""):"",hostname:$i.hostname,port:$i.port,pathname:"/"===$i.pathname.charAt(0)?$i.pathname:"/"+$i.pathname}}function mt(e){return(e=b(e)?ft(e):e).protocol===ji.protocol&&e.host===ji.host}function gt(){this.$get=m(e)}function vt(e){function t(n,r){if(y(n)){var a={};return o(n,function(e,i){a[i]=t(i,e)}),a}return e.factory(n+i,r)}var i="Filter";this.register=t,this.$get=["$injector",function(e){return function(t){return e.get(t+i)}}],t("currency",bt),t("date",Ct),t("filter",yt),t("json",Rt),t("limitTo",At),t("lowercase",qi),t("number",xt),t("orderBy",Pt),t("uppercase",Xi)}function yt(){return function(e,t,i){if(!w(e))return e;var n=typeof i,r=[];r.check=function(e){for(var t=0;t<r.length;t++)if(!r[t](e))return!1;return!0},"function"!==n&&(i="boolean"===n&&i?function(e,t){return Yt.equals(e,t)}:function(e,t){if(e&&t&&"object"==typeof e&&"object"==typeof t){for(var n in e)if("$"!==n.charAt(0)&&Vt.call(e,n)&&i(e[n],t[n]))return!0;return!1}return t=(""+t).toLowerCase(),-1<(""+e).toLowerCase().indexOf(t)});var o=function(e,t){if("string"==typeof t&&"!"===t.charAt(0))return!o(e,t.substr(1));switch(typeof e){case"boolean":case"number":case"string":return i(e,t);case"object":switch(typeof t){case"object":return i(e,t);default:for(var n in e)if("$"!==n.charAt(0)&&o(e[n],t))return!0}return!1;case"array":for(n=0;n<e.length;n++)if(o(e[n],t))return!0;return!1;default:return!1}};switch(typeof t){case"boolean":case"number":case"string":t={$:t};case"object":for(var a in t)!function(e){void 0!==t[e]&&r.push(function(i){return o("$"==e?i:i&&i[e],t[e])})}(a);break;case"function":r.push(t);break;default:return e}for(n=[],a=0;a<e.length;a++){var s=e[a];r.check(s)&&n.push(s)}return n}}function bt(e){var t=e.NUMBER_FORMATS;return function(e,i){return g(i)&&(i=t.CURRENCY_SYM),_t(e,t.PATTERNS[1],t.GROUP_SEP,t.DECIMAL_SEP,2).replace(/\u00A4/g,i)}}function xt(e){var t=e.NUMBER_FORMATS;return function(e,i){return _t(e,t.PATTERNS[0],t.GROUP_SEP,t.DECIMAL_SEP,i)}}function _t(e,t,i,n,r){if(null==e||!isFinite(e)||y(e))return"";var o=0>e,a=(e=Math.abs(e))+"",s="",l=[],c=!1;-1!==a.indexOf("e")&&((u=a.match(/([\d\.]+)e(-?)(\d+)/))&&"-"==u[2]&&u[3]>r+1?a="0":(s=a,c=!0));if(c)0<r&&-1<e&&1>e&&(s=e.toFixed(r));else{a=(a.split(zi)[1]||"").length,g(r)&&(r=Math.min(Math.max(t.minFrac,a),t.maxFrac)),a=Math.pow(10,r),a=(e=(""+(e=Math.round(e*a)/a)).split(zi))[0],e=e[1]||"";var u=0,h=t.lgSize,d=t.gSize;if(a.length>=h+d)for(u=a.length-h,c=0;c<u;c++)0==(u-c)%d&&0!==c&&(s+=i),s+=a.charAt(c);for(c=u;c<a.length;c++)0==(a.length-c)%h&&0!==c&&(s+=i),s+=a.charAt(c);for(;e.length<r;)e+="0";r&&"0"!==r&&(s+=n+e.substr(0,r))}return l.push(o?t.negPre:t.posPre),l.push(s),l.push(o?t.negSuf:t.posSuf),l.join("")}function wt(e,t,i){var n="";for(0>e&&(n="-",e=-e),e=""+e;e.length<t;)e="0"+e;return i&&(e=e.substr(e.length-t)),n+e}function Et(e,t,i,n){return i=i||0,function(r){return r=r["get"+e](),(0<i||r>-i)&&(r+=i),0===r&&-12==i&&(r=12),wt(r,t,n)}}function Tt(e,t){return function(i,n){var r=i["get"+e]();return n[Gt(t?"SHORT"+e:e)][r]}}function Mt(e){var t=new Date(e,0,1).getDay();return new Date(e,0,(4>=t?5:12)-t)}function St(e){return function(t){var i=Mt(t.getFullYear());return t=+new Date(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay()))-+i,wt(t=1+Math.round(t/6048e5),e)}}function Ct(e){function t(e){var t;if(t=e.match(i)){e=new Date(0);var n=0,r=0,o=t[8]?e.setUTCFullYear:e.setFullYear,a=t[8]?e.setUTCHours:e.setHours;t[9]&&(n=h(t[9]+t[10]),r=h(t[9]+t[11])),o.call(e,h(t[1]),h(t[2])-1,h(t[3])),n=h(t[4]||0)-n,r=h(t[5]||0)-r,o=h(t[6]||0),t=Math.round(1e3*parseFloat("0."+(t[7]||0))),a.call(e,n,r,o,t)}return e}var i=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(i,n){var r,a,s="",l=[];if(n=n||"mediumDate",n=e.DATETIME_FORMATS[n]||n,b(i)&&(i=Wi.test(i)?h(i):t(i)),x(i)&&(i=new Date(i)),!_(i))return i;for(;n;)(a=Gi.exec(n))?n=(l=l.concat(Wt.call(a,1))).pop():(l.push(n),n=null);return o(l,function(t){r=Vi[t],s+=r?r(i,e.DATETIME_FORMATS):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),s}}function Rt(){return function(e){return D(e,!0)}}function At(){return function(e,t){if(!w(e)&&!b(e))return e;if(t=1/0===Math.abs(Number(t))?Number(t):h(t),b(e))return t?0<=t?e.slice(0,t):e.slice(t,e.length):"";var i,n,r=[];for(t>e.length?t=e.length:t<-e.length&&(t=-e.length),0<t?(i=0,n=t):(i=e.length+t,n=e.length);i<n;i++)r.push(e[i]);return r}}function Pt(e){return function(t,i,n){function r(e,t){return H(t)?function(t,i){return e(i,t)}:e}function a(e,t){var i=typeof e,n=typeof t;return i==n?("string"==i&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t?0:e<t?-1:1):i<n?-1:1}if(!w(t)||!i)return t;i=function(e,t,i){var n=[];return o(e,function(e,r,o){n.push(t.call(i,e,r,o))}),n}(i=w(i)?i:[i],function(t){var i=!1,n=t||f;if(b(t)&&("+"!=t.charAt(0)&&"-"!=t.charAt(0)||(i="-"==t.charAt(0),t=t.substring(1)),(n=e(t)).constant)){var o=n();return r(function(e,t){return a(e[o],t[o])},i)}return r(function(e,t){return a(n(e),n(t))},i)});for(var s=[],l=0;l<t.length;l++)s.push(t[l]);return s.sort(r(function(e,t){for(var n=0;n<i.length;n++){var r=i[n](e,t);if(0!==r)return r}return 0},n))}}function Lt(e){return E(e)&&(e={link:e}),e.restrict=e.restrict||"AC",m(e)}function Ot(e,t,i,n){function r(t,i){i=i?"-"+W(i,"-"):"",n.removeClass(e,(t?fn:pn)+i),n.addClass(e,(t?pn:fn)+i)}var a=this,s=e.parent().controller("form")||Ji,l=0,c=a.$error={},u=[];a.$name=t.name||t.ngForm,a.$dirty=!1,a.$pristine=!0,a.$valid=!0,a.$invalid=!1,s.$addControl(a),e.addClass(mn),r(!0),a.$addControl=function(e){Z(e.$name,"input"),u.push(e),e.$name&&(a[e.$name]=e)},a.$removeControl=function(e){e.$name&&a[e.$name]===e&&delete a[e.$name],o(c,function(t,i){a.$setValidity(i,!0,e)}),R(u,e)},a.$setValidity=function(e,t,i){var n=c[e];if(t)n&&(R(n,i),n.length||(--l||(r(t),a.$valid=!0,a.$invalid=!1),c[e]=!1,r(!0,e),s.$setValidity(e,!0,a)));else{if(l||r(t),n){if(-1!=C(n,i))return}else c[e]=n=[],l++,r(!1,e),s.$setValidity(e,!1,a);n.push(i),a.$valid=!1,a.$invalid=!0}},a.$setDirty=function(){n.removeClass(e,mn),n.addClass(e,gn),a.$dirty=!0,a.$pristine=!1,s.$setDirty()},a.$setPristine=function(){n.removeClass(e,gn),n.addClass(e,mn),a.$dirty=!1,a.$pristine=!0,o(u,function(e){e.$setPristine()})}}function It(e,t,n,r){return e.$setValidity(t,n),n?r:i}function kt(e,t,i,r,o,a){var s=t.prop("validity"),l=t[0].placeholder,c={};if(!o.android){var u=!1;t.on("compositionstart",function(e){u=!0}),t.on("compositionend",function(){u=!1,d()})}var d=function(n){if(!u){var o=t.val(),a=n&&n.type;Bt&&"input"===(n||c).type&&t[0].placeholder!==l?l=t[0].placeholder:(H(i.ngTrim||"T")&&(o=Kt(o)),(r.$viewValue!==o||s&&""===o&&!s.valueMissing)&&(e.$$phase?r.$setViewValue(o,a):e.$apply(function(){r.$setViewValue(o,a)})))}};if(r.$options&&r.$options.updateOn&&t.on(r.$options.updateOn,d),!r.$options||r.$options.updateOnDefault){if(o.hasEvent("input"))t.on("input",d);else{var p,f=function(e){p||(p=a.defer(function(){d(e),p=null}))};t.on("keydown",function(e){var t=e.keyCode;91===t||15<t&&19>t||37<=t&&40>=t||f(e)}),o.hasEvent("paste")&&t.on("paste cut",f)}t.on("change",d)}r.$render=function(){t.val(r.$isEmpty(r.$viewValue)?"":r.$viewValue)};var m=i.ngPattern;if(m&&((o=m.match(/^\/(.*)\/([gim]*)$/))?(m=RegExp(o[1],o[2]),o=function(e){return It(r,"pattern",r.$isEmpty(e)||m.test(e),e)}):o=function(i){var o=e.$eval(m);if(!o||!o.test)throw n("ngPattern")("noregexp",m,o,B(t));return It(r,"pattern",r.$isEmpty(i)||o.test(i),i)},r.$formatters.push(o),r.$parsers.push(o)),i.ngMinlength){var g=h(i.ngMinlength);o=function(e){return It(r,"minlength",r.$isEmpty(e)||e.length>=g,e)},r.$parsers.push(o),r.$formatters.push(o)}if(i.ngMaxlength){var v=h(i.ngMaxlength);o=function(e){return It(r,"maxlength",r.$isEmpty(e)||e.length<=v,e)},r.$parsers.push(o),r.$formatters.push(o)}}function Dt(e,t){return function(i){var n;return _(i)?i:b(i)&&(e.lastIndex=0,i=e.exec(i))?(i.shift(),n={yyyy:0,MM:1,dd:1,HH:0,mm:0},o(i,function(e,i){i<t.length&&(n[t[i]]=+e)}),new Date(n.yyyy,n.MM-1,n.dd,n.HH,n.mm)):NaN}}function Nt(e,t,n,r){return function(o,a,s,l,c,u,h){kt(o,a,s,l,c,u),l.$parsers.push(function(r){return l.$isEmpty(r)?(l.$setValidity(e,!0),null):t.test(r)?(l.$setValidity(e,!0),n(r)):(l.$setValidity(e,!1),i)}),l.$formatters.push(function(e){return _(e)?h("date")(e,r):""}),s.min&&(o=function(e){var t=l.$isEmpty(e)||n(e)>=n(s.min);return l.$setValidity("min",t),t?e:i},l.$parsers.push(o),l.$formatters.push(o)),s.max&&(o=function(e){var t=l.$isEmpty(e)||n(e)<=n(s.max);return l.$setValidity("max",t),t?e:i},l.$parsers.push(o),l.$formatters.push(o))}}function Ht(e,t){return e="ngClass"+e,["$animate",function(i){function n(e,t){var i=[],n=0;e:for(;n<e.length;n++){for(var r=e[n],o=0;o<t.length;o++)if(r==t[o])continue e;i.push(r)}return i}function r(e){if(!w(e)){if(b(e))return e.split(" ");if(y(e)){var t=[];return o(e,function(e,i){e&&t.push(i)}),t}}return e}return{restrict:"AC",link:function(a,s,l){function c(e,t){var i=s.data("$classCounts")||{},n=[];return o(e,function(e){(0<t||i[e])&&(i[e]=(i[e]||0)+t,i[e]===+(0<t)&&n.push(e))}),s.data("$classCounts",i),n.join(" ")}function u(e){if(!0===t||a.$index%2===t){var o=r(e||[]);if(h){if(!L(e,h)){var u=r(h);d=n(o,u),o=c(o=n(u,o),-1);0===(d=c(d,1)).length?i.removeClass(s,o):0===o.length?i.addClass(s,d):i.setClass(s,d,o)}}else{var d=c(o,1);l.$addClass(d)}}h=A(e)}var h;a.$watch(l[e],u,!0),l.$observe("class",function(t){u(a.$eval(l[e]))}),"ngClass"!==e&&a.$watch("$index",function(i,n){var o=1&i;if(o!==n&1){var s=r(a.$eval(l[e]));o===t?(o=c(s,1),l.$addClass(o)):(o=c(s,-1),l.$removeClass(o))}})}}}]}var Bt,Ft,Ut,$t,jt,zt=function(e){return b(e)?e.toLowerCase():e},Vt=Object.prototype.hasOwnProperty,Gt=function(e){return b(e)?e.toUpperCase():e},Wt=[].slice,qt=[].push,Xt=Object.prototype.toString,Zt=n("ng"),Yt=e.angular||(e.angular={}),Jt=["0","0","0"];Bt=h((/msie (\d+)/.exec(zt(navigator.userAgent))||[])[1]),isNaN(Bt)&&(Bt=h((/trident\/.*; rv:(\d+)/.exec(zt(navigator.userAgent))||[])[1])),p.$inject=[],f.$inject=[];var Kt=String.prototype.trim?function(e){return b(e)?e.trim():e}:function(e){return b(e)?e.replace(/^\s\s*/,"").replace(/\s\s*$/,""):e};jt=9>Bt?function(e){return(e=e.nodeName?e:e[0]).scopeName&&"HTML"!=e.scopeName?Gt(e.scopeName+":"+e.nodeName):e.nodeName}:function(e){return e.nodeName?e.nodeName:e[0].nodeName};var Qt=["ng-","data-ng-","ng:","x-ng-"],ei=/[A-Z]/g,ti={full:"1.3.0-beta.7",major:1,minor:3,dot:0,codeName:"proper-attribution"},ii=ee.cache={},ni=ee.expando="ng-"+(new Date).getTime(),ri=1,oi=e.document.addEventListener?function(e,t,i){e.addEventListener(t,i,!1)}:function(e,t,i){e.attachEvent("on"+t,i)},ai=e.document.removeEventListener?function(e,t,i){e.removeEventListener(t,i,!1)}:function(e,t,i){e.detachEvent("on"+t,i)};ee._data=function(e){return this.cache[e[this.expando]]||{}};var si=/([\:\-\_]+(.))/g,li=/^moz([A-Z])/,ci=n("jqLite"),ui=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,hi=/<|&#?\w+;/,di=/<([\w:]+)/,pi=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,fi={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};fi.optgroup=fi.option,fi.tbody=fi.tfoot=fi.colgroup=fi.caption=fi.thead,fi.th=fi.td;var mi=ee.prototype={ready:function(i){function n(){r||(r=!0,i())}var r=!1;"complete"===t.readyState?setTimeout(n):(this.on("DOMContentLoaded",n),ee(e).on("load",n))},toString:function(){var e=[];return o(this,function(t){e.push(""+t)}),"["+e.join(", ")+"]"},eq:function(e){return Ft(0<=e?this[e]:this[this.length+e])},length:0,push:qt,sort:[].sort,splice:[].splice},gi={};o("multiple selected checked disabled readOnly required open".split(" "),function(e){gi[zt(e)]=e});var vi={};o("input select option textarea button form details".split(" "),function(e){vi[Gt(e)]=!0}),o({data:ae,inheritedData:de,scope:function(e){return Ft(e).data("$scope")||de(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return Ft(e).data("$isolateScope")||Ft(e).data("$isolateScopeNoTemplate")},controller:he,injector:function(e){return de(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:se,css:function(e,t,n){var r;if(t=K(t),!v(n))return 8>=Bt&&(""===(r=e.currentStyle&&e.currentStyle[t])&&(r="auto")),r=r||e.style[t],8>=Bt&&(r=""===r?i:r),r;e.style[t]=n},attr:function(e,t,n){var r=zt(t);if(gi[r]){if(!v(n))return e[t]||(e.attributes.getNamedItem(t)||p).specified?r:i;n?(e[t]=!0,e.setAttribute(t,r)):(e[t]=!1,e.removeAttribute(r))}else if(v(n))e.setAttribute(t,n);else if(e.getAttribute)return null===(e=e.getAttribute(t,2))?i:e},prop:function(e,t,i){if(!v(i))return e[t];e[t]=i},text:function(){function e(e,i){var n=t[e.nodeType];if(g(i))return n?e[n]:"";e[n]=i}var t=[];return 9>Bt?(t[1]="innerText",t[3]="nodeValue"):t[1]=t[3]="textContent",e.$dv="",e}(),val:function(e,t){if(g(t)){if("SELECT"===jt(e)&&e.multiple){var i=[];return o(e.options,function(e){e.selected&&i.push(e.value||e.text)}),0===i.length?null:i}return e.value}e.value=t},html:function(e,t){if(g(t))return e.innerHTML;for(var i=0,n=e.childNodes;i<n.length;i++)ie(n[i]);e.innerHTML=t},empty:pe},function(e,t){ee.prototype[t]=function(t,n){var r,o;if(e!==pe&&(2==e.length&&e!==se&&e!==he?t:n)===i){if(y(t)){for(r=0;r<this.length;r++)if(e===ae)e(this[r],t);else for(o in t)e(this[r],o,t[o]);return this}o=(r=e.$dv)===i?Math.min(this.length,1):this.length;for(var a=0;a<o;a++){var s=e(this[a],t,n);r=r?r+s:s}return r}for(r=0;r<this.length;r++)e(this[r],t,n);return this}}),o({removeData:re,dealoc:ie,on:function e(i,n,r,a){if(v(a))throw ci("onargs");var s=oe(i,"events"),l=oe(i,"handle");s||oe(i,"events",s={}),l||oe(i,"handle",l=function(e,i){var n=function(n,r){if(n.preventDefault||(n.preventDefault=function(){n.returnValue=!1}),n.stopPropagation||(n.stopPropagation=function(){n.cancelBubble=!0}),n.target||(n.target=n.srcElement||t),g(n.defaultPrevented)){var a=n.preventDefault;n.preventDefault=function(){n.defaultPrevented=!0,a.call(n)},n.defaultPrevented=!1}n.isDefaultPrevented=function(){return n.defaultPrevented||!1===n.returnValue},o(P(i[r||n.type]||[]),function(t){t.call(e,n)}),8>=Bt?(n.preventDefault=null,n.stopPropagation=null,n.isDefaultPrevented=null):(delete n.preventDefault,delete n.stopPropagation,delete n.isDefaultPrevented)};return n.elem=e,n}(i,s)),o(n.split(" "),function(n){var o=s[n];if(!o){if("mouseenter"==n||"mouseleave"==n){var a=t.body.contains||t.body.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1};s[n]=[],e(i,{mouseleave:"mouseout",mouseenter:"mouseover"}[n],function(e){var t=e.relatedTarget;t&&(t===this||a(this,t))||l(e,n)})}else oi(i,n,l),s[n]=[];o=s[n]}o.push(r)})},off:ne,one:function(e,t,i){(e=Ft(e)).on(t,function n(){e.off(t,i),e.off(t,n)}),e.on(t,i)},replaceWith:function(e,t){var i,n=e.parentNode;ie(e),o(new ee(t),function(t){i?n.insertBefore(t,i.nextSibling):n.replaceChild(t,e),i=t})},children:function(e){var t=[];return o(e.childNodes,function(e){1===e.nodeType&&t.push(e)}),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(e,t){o(new ee(t),function(t){1!==e.nodeType&&11!==e.nodeType||e.appendChild(t)})},prepend:function(e,t){if(1===e.nodeType){var i=e.firstChild;o(new ee(t),function(t){e.insertBefore(t,i)})}},wrap:function(e,t){t=Ft(t)[0];var i=e.parentNode;i&&i.replaceChild(t,e),t.appendChild(e)},remove:function(e){ie(e);var t=e.parentNode;t&&t.removeChild(e)},after:function(e,t){var i=e,n=e.parentNode;o(new ee(t),function(e){n.insertBefore(e,i.nextSibling),i=e})},addClass:ce,removeClass:le,toggleClass:function(e,t,i){t&&o(t.split(" "),function(t){var n=i;g(n)&&(n=!se(e,t)),(n?ce:le)(e,t)})},parent:function(e){return(e=e.parentNode)&&11!==e.nodeType?e:null},next:function(e){if(e.nextElementSibling)return e.nextElementSibling;for(e=e.nextSibling;null!=e&&1!==e.nodeType;)e=e.nextSibling;return e},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:te,triggerHandler:function(e,t,i){t=(oe(e,"events")||{})[t],i=i||[];var n=[{preventDefault:p,stopPropagation:p}];o(t,function(t){t.apply(e,n.concat(i))})}},function(e,t){ee.prototype[t]=function(t,i,n){for(var r,o=0;o<this.length;o++)g(r)?v(r=e(this[o],t,i,n))&&(r=Ft(r)):ue(r,e(this[o],t,i,n));return v(r)?r:this},ee.prototype.bind=ee.prototype.on,ee.prototype.unbind=ee.prototype.off}),ge.prototype={put:function(e,t){this[me(e)]=t},get:function(e){return this[me(e)]},remove:function(e){var t=this[e=me(e)];return delete this[e],t}};var yi=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,bi=/,/,xi=/^\s*(_?)(\S+?)\1\s*$/,_i=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,wi=n("$injector");ye.$$annotate=ve;var Ei=n("$animate"),Ti=["$provide",function(e){this.$$selectors={},this.register=function(t,i){var n=t+"-animation";if(t&&"."!=t.charAt(0))throw Ei("notcsel",t);this.$$selectors[t.substr(1)]=n,e.factory(n,i)},this.classNameFilter=function(e){return 1===arguments.length&&(this.$$classNameFilter=e instanceof RegExp?e:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function(e,t){return{enter:function(e,i,n,r){n?n.after(e):i.prepend(e),r&&t(r)},leave:function(e,i){e.remove(),i&&t(i)},move:function(e,t,i,n){this.enter(e,t,i,n)},addClass:function(e,i,n){i=b(i)?i:w(i)?i.join(" "):"",o(e,function(e){ce(e,i)}),n&&t(n)},removeClass:function(e,i,n){i=b(i)?i:w(i)?i.join(" "):"",o(e,function(e){le(e,i)}),n&&t(n)},setClass:function(e,i,n,r){o(e,function(e){ce(e,i),le(e,n)}),r&&t(r)},enabled:p}}]}],Mi=n("$compile");Me.$inject=["$provide","$$sanitizeUriProvider"];var Si=/^(x[\:\-_]|data[\:\-_])/i,Ci=n("$interpolate"),Ri=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,Ai={http:80,https:443,ftp:21},Pi=n("$location");Xe.prototype=qe.prototype=We.prototype={$$html5:!1,$$replace:!1,absUrl:Ze("$$absUrl"),url:function(e,t){if(g(e))return this.$$url;var i=Ri.exec(e);return i[1]&&this.path(decodeURIComponent(i[1])),(i[2]||i[1])&&this.search(i[3]||""),this.hash(i[5]||"",t),this},protocol:Ze("$$protocol"),host:Ze("$$host"),port:Ze("$$port"),path:Ye("$$path",function(e){return"/"==e.charAt(0)?e:"/"+e}),search:function(e,t){switch(arguments.length){case 0:return this.$$search;case 1:if(b(e))this.$$search=U(e);else{if(!y(e))throw Pi("isrcharg");this.$$search=e}break;default:g(t)||null===t?delete this.$$search[e]:this.$$search[e]=t}return this.$$compose(),this},hash:Ye("$$hash",f),replace:function(){return this.$$replace=!0,this}};var Li,Oi=n("$parse"),Ii={},ki={null:function(){return null},true:function(){return!0},false:function(){return!1},undefined:p,"+":function(e,t,n,r){return n=n(e,t),r=r(e,t),v(n)?v(r)?n+r:n:v(r)?r:i},"-":function(e,t,i,n){return i=i(e,t),n=n(e,t),(v(i)?i:0)-(v(n)?n:0)},"*":function(e,t,i,n){return i(e,t)*n(e,t)},"/":function(e,t,i,n){return i(e,t)/n(e,t)},"%":function(e,t,i,n){return i(e,t)%n(e,t)},"^":function(e,t,i,n){return i(e,t)^n(e,t)},"=":p,"===":function(e,t,i,n){return i(e,t)===n(e,t)},"!==":function(e,t,i,n){return i(e,t)!==n(e,t)},"==":function(e,t,i,n){return i(e,t)==n(e,t)},"!=":function(e,t,i,n){return i(e,t)!=n(e,t)},"<":function(e,t,i,n){return i(e,t)<n(e,t)},">":function(e,t,i,n){return i(e,t)>n(e,t)},"<=":function(e,t,i,n){return i(e,t)<=n(e,t)},">=":function(e,t,i,n){return i(e,t)>=n(e,t)},"&&":function(e,t,i,n){return i(e,t)&&n(e,t)},"||":function(e,t,i,n){return i(e,t)||n(e,t)},"&":function(e,t,i,n){return i(e,t)&n(e,t)},"|":function(e,t,i,n){return n(e,t)(e,t,i(e,t))},"!":function(e,t,i){return!i(e,t)}},Di={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},Ni=function(e){this.options=e};Ni.prototype={constructor:Ni,lex:function(e){var t;for(this.text=e,this.index=0,this.ch=i,this.lastCh=":",this.tokens=[],e=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent(),this.was("{,")&&"{"===e[0]&&(t=this.tokens[this.tokens.length-1])&&(t.json=-1===t.text.indexOf("."));else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch,json:this.was(":[,")&&this.is("{[")||this.is("}]:,")}),this.is("{[")&&e.unshift(this.ch),this.is("}]")&&e.shift(),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var n=this.ch+this.peek(),r=n+this.peek(2),o=ki[this.ch],a=ki[n],s=ki[r];s?(this.tokens.push({index:this.index,text:r,fn:s}),this.index+=3):a?(this.tokens.push({index:this.index,text:n,fn:a}),this.index+=2):o?(this.tokens.push({index:this.index,text:this.ch,fn:o,json:this.was("[,:")&&this.is("+-")}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(e){return-1!==e.indexOf(this.ch)},was:function(e){return-1!==e.indexOf(this.lastCh)},peek:function(e){return e=e||1,this.index+e<this.text.length&&this.text.charAt(this.index+e)},isNumber:function(e){return"0"<=e&&"9">=e},isWhitespace:function(e){return" "===e||"\r"===e||"\t"===e||"\n"===e||"\v"===e||""===e},isIdent:function(e){return"a"<=e&&"z">=e||"A"<=e&&"Z">=e||"_"===e||"$"===e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,i){throw i=i||this.index,t=v(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,i)+"]":" "+i,Oi("lexerr",e,t,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var i=zt(this.text.charAt(this.index));if("."==i||this.isNumber(i))e+=i;else{var n=this.peek();if("e"==i&&this.isExpOperator(n))e+=i;else if(this.isExpOperator(i)&&n&&this.isNumber(n)&&"e"==e.charAt(e.length-1))e+=i;else{if(!this.isExpOperator(i)||n&&this.isNumber(n)||"e"!=e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}e*=1,this.tokens.push({index:t,text:e,json:!0,fn:function(){return e}})},readIdent:function(){for(var e,t,i,n,r=this,o="",a=this.index;this.index<this.text.length&&("."===(n=this.text.charAt(this.index))||this.isIdent(n)||this.isNumber(n));)"."===n&&(e=this.index),o+=n,this.index++;if(e)for(t=this.index;t<this.text.length;){if("("===(n=this.text.charAt(t))){i=o.substr(e-a+1),o=o.substr(0,e-a),this.index=t;break}if(!this.isWhitespace(n))break;t++}if(a={index:a,text:o},ki.hasOwnProperty(o))a.fn=ki[o],a.json=ki[o];else{var s=nt(o,this.options,this.text);a.fn=u(function(e,t){return s(e,t)},{assign:function(e,t){return tt(e,o,t,r.text,r.options)}})}this.tokens.push(a),i&&(this.tokens.push({index:e,text:".",json:!1}),this.tokens.push({index:e+1,text:i,json:!1}))},readString:function(e){var t=this.index;this.index++;for(var i="",n=e,r=!1;this.index<this.text.length;){var o=this.text.charAt(this.index);n=n+o;if(r)"u"===o?((o=this.text.substring(this.index+1,this.index+5)).match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+o+"]"),this.index+=4,i+=String.fromCharCode(parseInt(o,16))):i=(r=Di[o])?i+r:i+o,r=!1;else if("\\"===o)r=!0;else{if(o===e)return this.index++,void this.tokens.push({index:t,text:n,string:i,json:!0,fn:function(){return i}});i+=o}this.index++}this.throwError("Unterminated quote",t)}};var Hi=function(e,t,i){this.lexer=e,this.$filter=t,this.options=i};Hi.ZERO=u(function(){return 0},{constant:!0}),Hi.prototype={constructor:Hi,parse:function(e,t){this.text=e,this.json=t,this.tokens=this.lexer.lex(e),t&&(this.assignment=this.logicalOR,this.functionCall=this.fieldAccess=this.objectIndex=this.filterChain=function(){this.throwError("is not valid json",{text:e,index:0})});var i=t?this.primary():this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),i.literal=!!i.literal,i.constant=!!i.constant,i},primary:function(){var e,t;if(this.expect("("))e=this.filterChain(),this.consume(")");else if(this.expect("["))e=this.arrayDeclaration();else if(this.expect("{"))e=this.object();else{var i=this.expect();(e=i.fn)||this.throwError("not a primary expression",i),i.json&&(e.constant=!0,e.literal=!0)}for(;i=this.expect("(","[",".");)"("===i.text?(e=this.functionCall(e,t),t=null):"["===i.text?(t=e,e=this.objectIndex(e)):"."===i.text?(t=e,e=this.fieldAccess(e)):this.throwError("IMPOSSIBLE");return e},throwError:function(e,t){throw Oi("syntax",t.text,e,t.index+1,this.text,this.text.substring(t.index))},peekToken:function(){if(0===this.tokens.length)throw Oi("ueoe",this.text);return this.tokens[0]},peek:function(e,t,i,n){if(0<this.tokens.length){var r=this.tokens[0],o=r.text;if(o===e||o===t||o===i||o===n||!(e||t||i||n))return r}return!1},expect:function(e,t,i,n){return!!(e=this.peek(e,t,i,n))&&(this.json&&!e.json&&this.throwError("is not valid json",e),this.tokens.shift(),e)},consume:function(e){this.expect(e)||this.throwError("is unexpected, expecting ["+e+"]",this.peek())},unaryFn:function(e,t){return u(function(i,n){return e(i,n,t)},{constant:t.constant})},ternaryFn:function(e,t,i){return u(function(n,r){return e(n,r)?t(n,r):i(n,r)},{constant:e.constant&&t.constant&&i.constant})},binaryFn:function(e,t,i){return u(function(n,r){return t(n,r,e,i)},{constant:e.constant&&i.constant})},statements:function(){for(var e=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&e.push(this.filterChain()),!this.expect(";"))return 1===e.length?e[0]:function(t,i){for(var n,r=0;r<e.length;r++){var o=e[r];o&&(n=o(t,i))}return n}},filterChain:function(){for(var e,t=this.expression();;){if(!(e=this.expect("|")))return t;t=this.binaryFn(t,e.fn,this.filter())}},filter:function(){for(var e=this.expect(),t=this.$filter(e.text),i=[];;){if(!(e=this.expect(":"))){var n=function(e,n,r){r=[r];for(var o=0;o<i.length;o++)r.push(i[o](e,n));return t.apply(e,r)};return function(){return n}}i.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var e,t,i=this.ternary();return(t=this.expect("="))?(i.assign||this.throwError("implies assignment but ["+this.text.substring(0,t.index)+"] can not be assigned to",t),e=this.ternary(),function(t,n){return i.assign(t,e(t,n),n)}):i},ternary:function(){var e,t,i=this.logicalOR();return this.expect("?")?(e=this.ternary(),(t=this.expect(":"))?this.ternaryFn(i,e,this.ternary()):void this.throwError("expected :",t)):i},logicalOR:function(){for(var e,t=this.logicalAND();;){if(!(e=this.expect("||")))return t;t=this.binaryFn(t,e.fn,this.logicalAND())}},logicalAND:function(){var e,t=this.equality();return(e=this.expect("&&"))&&(t=this.binaryFn(t,e.fn,this.logicalAND())),t},equality:function(){var e,t=this.relational();return(e=this.expect("==","!=","===","!=="))&&(t=this.binaryFn(t,e.fn,this.equality())),t},relational:function(){var e,t=this.additive();return(e=this.expect("<",">","<=",">="))&&(t=this.binaryFn(t,e.fn,this.relational())),t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t=this.binaryFn(t,e.fn,this.multiplicative());return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t=this.binaryFn(t,e.fn,this.unary());return t},unary:function(){var e;return this.expect("+")?this.primary():(e=this.expect("-"))?this.binaryFn(Hi.ZERO,e.fn,this.unary()):(e=this.expect("!"))?this.unaryFn(e.fn,this.unary()):this.primary()},fieldAccess:function(e){var t=this,i=this.expect().text,n=nt(i,this.options,this.text);return u(function(t,i,r){return n(r||e(t,i))},{assign:function(n,r,o){return tt(e(n,o),i,r,t.text,t.options)}})},objectIndex:function(e){var t=this,n=this.expression();return this.consume("]"),u(function(r,o){var a,s=e(r,o),l=n(r,o);return s?((s=et(s[l],t.text))&&s.then&&t.options.unwrapPromises&&(a=s,"$$v"in s||(a.$$v=i,a.then(function(e){a.$$v=e})),s=s.$$v),s):i},{assign:function(i,r,o){var a=n(i,o);return et(e(i,o),t.text)[a]=r}})},functionCall:function(e,t){var i=[];if(")"!==this.peekToken().text)do{i.push(this.expression())}while(this.expect(","));this.consume(")");var n=this;return function(r,o){for(var a=[],s=t?t(r,o):r,l=0;l<i.length;l++)a.push(i[l](r,o));return l=e(r,o,s)||p,et(s,n.text),et(l,n.text),et(a=l.apply?l.apply(s,a):l(a[0],a[1],a[2],a[3],a[4]),n.text)}},arrayDeclaration:function(){var e=[],t=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var i=this.expression();e.push(i),i.constant||(t=!1)}while(this.expect(","));return this.consume("]"),u(function(t,i){for(var n=[],r=0;r<e.length;r++)n.push(e[r](t,i));return n},{literal:!0,constant:t})},object:function(){var e=[],t=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var i=(i=this.expect()).string||i.text;this.consume(":");var n=this.expression();e.push({key:i,value:n}),n.constant||(t=!1)}while(this.expect(","));return this.consume("}"),u(function(t,i){for(var n={},r=0;r<e.length;r++){var o=e[r];n[o.key]=o.value(t,i)}return n},{literal:!0,constant:t})}};var Bi={},Fi=n("$sce"),Ui={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},$i=t.createElement("a"),ji=ft(e.location.href);vt.$inject=["$provide"],bt.$inject=["$locale"],xt.$inject=["$locale"];var zi=".",Vi={yyyy:Et("FullYear",4),yy:Et("FullYear",2,0,!0),y:Et("FullYear",1),MMMM:Tt("Month"),MMM:Tt("Month",!0),MM:Et("Month",2,1),M:Et("Month",1,1),dd:Et("Date",2),d:Et("Date",1),HH:Et("Hours",2),H:Et("Hours",1),hh:Et("Hours",2,-12),h:Et("Hours",1,-12),mm:Et("Minutes",2),m:Et("Minutes",1),ss:Et("Seconds",2),s:Et("Seconds",1),sss:Et("Milliseconds",3),EEEE:Tt("Day"),EEE:Tt("Day",!0),a:function(e,t){return 12>e.getHours()?t.AMPMS[0]:t.AMPMS[1]},Z:function(e){return(0<=(e=-1*e.getTimezoneOffset())?"+":"")+(wt(Math[0<e?"floor":"ceil"](e/60),2)+wt(Math.abs(e%60),2))},ww:St(2),w:St(1)},Gi=/((?:[^yMdHhmsaZEw']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|w+))(.*)/,Wi=/^\-?\d+$/;Ct.$inject=["$locale"];var qi=m(zt),Xi=m(Gt);Pt.$inject=["$parse"];var Zi=m({restrict:"E",compile:function(e,i){if(8>=Bt&&(i.href||i.name||i.$set("href",""),e.append(t.createComment("IE fix"))),!i.href&&!i.xlinkHref&&!i.name)return function(e,t){var i="[object SVGAnimatedString]"===Xt.call(t.prop("href"))?"xlink:href":"href";t.on("click",function(e){t.attr(i)||e.preventDefault()})}}}),Yi={};o(gi,function(e,t){if("multiple"!=e){var i=Se("ng-"+t);Yi[i]=function(){return{priority:100,link:function(e,n,r){e.$watch(r[i],function(e){r.$set(t,!!e)})}}}}}),o(["src","srcset","href"],function(e){var t=Se("ng-"+e);Yi[t]=function(){return{priority:99,link:function(i,n,r){var o=e,a=e;"href"===e&&"[object SVGAnimatedString]"===Xt.call(n.prop("href"))&&(a="xlinkHref",r.$attr[a]="xlink:href",o=null),r.$observe(t,function(e){e&&(r.$set(a,e),Bt&&o&&n.prop(o,r[a]))})}}}});var Ji={$addControl:p,$removeControl:p,$setValidity:p,$setDirty:p,$setPristine:p};Ot.$inject=["$element","$attrs","$scope","$animate"];var Ki=function(e){return["$timeout",function(t){return{name:"form",restrict:e?"EAC":"E",controller:Ot,compile:function(){return{pre:function(e,n,r,o){if(!r.action){var a=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1};oi(n[0],"submit",a),n.on("$destroy",function(){t(function(){ai(n[0],"submit",a)},0,!1)})}var s=n.parent().controller("form"),l=r.name||r.ngForm;l&&tt(e,l,o,l),s&&n.on("$destroy",function(){s.$removeControl(o),l&&tt(e,l,i,l),u(o,Ji)})}}}}}]},Qi=Ki(),en=Ki(!0),tn=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,nn=/^[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i,rn=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,on=/^(\d{4})-(\d{2})-(\d{2})$/,an=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)$/,sn=/^(\d{4})-W(\d\d)$/,ln=/^(\d{4})-(\d\d)$/,cn=/^(\d\d):(\d\d)$/,un=/(\b|^)default(\b|$)/,hn={text:kt,date:Nt("date",on,Dt(on,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":Nt("datetimelocal",an,Dt(an,["yyyy","MM","dd","HH","mm"]),"yyyy-MM-ddTHH:mm"),time:Nt("time",cn,Dt(cn,["HH","mm"]),"HH:mm"),week:Nt("week",sn,function(e){if(_(e))return e;if(b(e)&&(sn.lastIndex=0,i=sn.exec(e))){e=+i[1];var t=+i[2],i=Mt(e);t=7*(t-1);return new Date(e,0,i.getDate()+t)}return NaN},"yyyy-Www"),month:Nt("month",ln,Dt(ln,["yyyy","MM"]),"yyyy-MM"),number:function(e,t,n,r,o,a){kt(e,t,n,r,o,a),r.$parsers.push(function(e){var t=r.$isEmpty(e);return t||rn.test(e)?(r.$setValidity("number",!0),""===e?null:t?e:parseFloat(e)):(r.$setValidity("number",!1),i)}),function(e,t,i){var n=i.prop("validity");y(n)&&e.$parsers.push(function(i){if(e.$error[t]||!(n.badInput||n.customError||n.typeMismatch)||n.valueMissing)return i;e.$setValidity(t,!1)})}(r,"number",t),r.$formatters.push(function(e){return r.$isEmpty(e)?"":""+e}),n.min&&(e=function(e){var t=parseFloat(n.min);return It(r,"min",r.$isEmpty(e)||e>=t,e)},r.$parsers.push(e),r.$formatters.push(e)),n.max&&(e=function(e){var t=parseFloat(n.max);return It(r,"max",r.$isEmpty(e)||e<=t,e)},r.$parsers.push(e),r.$formatters.push(e)),r.$formatters.push(function(e){return It(r,"number",r.$isEmpty(e)||x(e),e)})},url:function(e,t,i,n,r,o){kt(e,t,i,n,r,o),e=function(e){return It(n,"url",n.$isEmpty(e)||tn.test(e),e)},n.$formatters.push(e),n.$parsers.push(e)},email:function(e,t,i,n,r,o){kt(e,t,i,n,r,o),e=function(e){return It(n,"email",n.$isEmpty(e)||nn.test(e),e)},n.$formatters.push(e),n.$parsers.push(e)},radio:function(e,t,i,n){g(i.name)&&t.attr("name",l());var r=function(r){t[0].checked&&e.$apply(function(){n.$setViewValue(i.value,r&&r.type)})};n.$options&&n.$options.updateOn&&t.on(n.$options.updateOn,r),n.$options&&!n.$options.updateOnDefault||t.on("click",r),n.$render=function(){t[0].checked=i.value==n.$viewValue},i.$observe("value",n.$render)},checkbox:function(e,t,i,n){var r=i.ngTrueValue,o=i.ngFalseValue;b(r)||(r=!0),b(o)||(o=!1),i=function(i){e.$apply(function(){n.$setViewValue(t[0].checked,i&&i.type)})},n.$options&&n.$options.updateOn&&t.on(n.$options.updateOn,i),n.$options&&!n.$options.updateOnDefault||t.on("click",i),n.$render=function(){t[0].checked=n.$viewValue},n.$isEmpty=function(e){return e!==r},n.$formatters.push(function(e){return e===r}),n.$parsers.push(function(e){return e?r:o})},hidden:p,button:p,submit:p,reset:p,file:p},dn=["$browser","$sniffer","$filter",function(e,t,i){return{restrict:"E",require:["?ngModel"],link:function(n,r,o,a){a[0]&&(hn[zt(o.type)]||hn.text)(n,r,o,a[0],t,e,i)}}}],pn="ng-valid",fn="ng-invalid",mn="ng-pristine",gn="ng-dirty",vn=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout",function(e,t,i,r,a,s,l){function c(e,t){t=t?"-"+W(t,"-"):"",s.removeClass(r,(e?fn:pn)+t),s.addClass(r,(e?pn:fn)+t)}this.$modelValue=this.$viewValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=i.name;var u=a(i.ngModel),h=u.assign,d=null,f=this;if(!h)throw n("ngModel")("nonassign",i.ngModel,B(r));this.$render=p,this.$isEmpty=function(e){return g(e)||""===e||null===e||e!=e};var m=r.inheritedData("$formController")||Ji,v=0,b=this.$error={};r.addClass(mn),c(!0),this.$setValidity=function(e,t){b[e]!==!t&&(t?(b[e]&&v--,v||(c(!0),f.$valid=!0,f.$invalid=!1)):(c(!1),f.$invalid=!0,f.$valid=!1,v++),b[e]=!t,c(t,e),m.$setValidity(e,t,f))},this.$setPristine=function(){f.$dirty=!1,f.$pristine=!0,s.removeClass(r,gn),s.addClass(r,mn)},this.$cancelUpdate=function(){l.cancel(d),f.$render()},this.$$realSetViewValue=function(i){f.$viewValue=i,f.$pristine&&(f.$dirty=!0,f.$pristine=!1,s.removeClass(r,mn),s.addClass(r,gn),m.$setDirty()),o(f.$parsers,function(e){i=e(i)}),f.$modelValue!==i&&(f.$modelValue=i,h(e,i),o(f.$viewChangeListeners,function(e){try{e()}catch(e){t(e)}}))},this.$setViewValue=function(e,t){var i=f.$options&&(y(f.$options.debounce)?f.$options.debounce[t]||f.$options.debounce.default||0:f.$options.debounce)||0;l.cancel(d),i?d=l(function(){f.$$realSetViewValue(e)},i):f.$$realSetViewValue(e)},e.$watch(function(){var t=u(e);if(f.$modelValue!==t){var i=f.$formatters,n=i.length;for(f.$modelValue=t;n--;)t=i[n](t);f.$viewValue!==t&&(f.$viewValue=t,f.$render())}return t})}],yn=function(){return{require:["ngModel","^?form","^?ngModelOptions"],controller:vn,link:function(e,t,i,n){var r=n[0],o=n[1]||Ji;o.$addControl(r),n[2]&&(r.$options=n[2].$options),e.$on("$destroy",function(){o.$removeControl(r)})}}},bn=m({require:"ngModel",link:function(e,t,i,n){n.$viewChangeListeners.push(function(){e.$eval(i.ngChange)})}}),xn=function(){return{require:"?ngModel",link:function(e,t,i,n){if(n){i.required=!0;var r=function(e){if(!i.required||!n.$isEmpty(e))return n.$setValidity("required",!0),e;n.$setValidity("required",!1)};n.$formatters.push(r),n.$parsers.unshift(r),i.$observe("required",function(){r(n.$viewValue)})}}}},_n=function(){return{require:"ngModel",link:function(e,t,n,r){var a=(e=/\/(.*)\//.exec(n.ngList))&&RegExp(e[1])||n.ngList||",";r.$parsers.push(function(e){if(!g(e)){var t=[];return e&&o(e.split(a),function(e){e&&t.push(Kt(e))}),t}}),r.$formatters.push(function(e){return w(e)?e.join(", "):i}),r.$isEmpty=function(e){return!e||!e.length}}}},wn=/^(true|false|\d+)$/,En=function(){return{priority:100,compile:function(e,t){return wn.test(t.ngValue)?function(e,t,i){i.$set("value",e.$eval(i.ngValue))}:function(e,t,i){e.$watch(i.ngValue,function(e){i.$set("value",e)})}}}},Tn=function(){return{controller:["$scope","$attrs",function(e,t){var i=this;this.$options=e.$eval(t.ngModelOptions),this.$options.updateOn?(this.$options.updateOnDefault=!1,this.$options.updateOn=this.$options.updateOn.replace(un,function(){return i.$options.updateOnDefault=!0," "})):this.$options.updateOnDefault=!0}]}},Mn=Lt(function(e,t,n){t.addClass("ng-binding").data("$binding",n.ngBind),e.$watch(n.ngBind,function(e){t.text(e==i?"":e)})}),Sn=["$interpolate",function(e){return function(t,i,n){t=e(i.attr(n.$attr.ngBindTemplate)),i.addClass("ng-binding").data("$binding",t),n.$observe("ngBindTemplate",function(e){i.text(e)})}}],Cn=["$sce","$parse",function(e,t){return function(i,n,r){n.addClass("ng-binding").data("$binding",r.ngBindHtml);var o=t(r.ngBindHtml);i.$watch(function(){return(o(i)||"").toString()},function(t){n.html(e.getTrustedHtml(o(i))||"")})}}],Rn=Ht("",!0),An=Ht("Odd",0),Pn=Ht("Even",1),Ln=Lt({compile:function(e,t){t.$set("ngCloak",i),e.removeClass("ng-cloak")}}),On=[function(){return{scope:!0,controller:"@",priority:500}}],In={};o("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(e){var t=Se("ng-"+e);In[t]=["$parse",function(i){return{compile:function(n,r){var o=i(r[t]);return function(t,i,n){i.on(zt(e),function(e){t.$apply(function(){o(t,{$event:e})})})}}}}]});var kn=["$animate",function(e){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(i,n,r,o,a){var s,l,c;i.$watch(r.ngIf,function(o){H(o)?l||(l=i.$new(),a(l,function(i){i[i.length++]=t.createComment(" end ngIf: "+r.ngIf+" "),s={clone:i},e.enter(i,n.parent(),n)})):(c&&(c.remove(),c=null),l&&(l.$destroy(),l=null),s&&(c=J(s.clone),e.leave(c,function(){c=null}),s=null))})}}}],Dn=["$http","$templateCache","$anchorScroll","$animate","$sce",function(e,t,i,n,r){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Yt.noop,compile:function(o,a){var s=a.ngInclude||a.src,l=a.onload||"",c=a.autoscroll;return function(o,a,u,h,d){var p,f,m,g=0,y=function(){f&&(f.remove(),f=null),p&&(p.$destroy(),p=null),m&&(n.leave(m,function(){f=null}),f=m,m=null)};o.$watch(r.parseAsResourceUrl(s),function(r){var s=function(){!v(c)||c&&!o.$eval(c)||i()},u=++g;r?(e.get(r,{cache:t}).success(function(e){if(u===g){var t=o.$new();h.template=e,e=d(t,function(e){y(),n.enter(e,null,a,s)}),m=e,(p=t).$emit("$includeContentLoaded"),o.$eval(l)}}).error(function(){u===g&&y()}),o.$emit("$includeContentRequested")):(y(),h.template=null)})}}}}],Nn=["$compile",function(e){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(t,i,n,r){i.html(r.template),e(i.contents())(t)}}}],Hn=Lt({priority:450,compile:function(){return{pre:function(e,t,i){e.$eval(i.ngInit)}}}}),Bn=Lt({terminal:!0,priority:1e3}),Fn=["$locale","$interpolate",function(e,t){var i=/{}/g;return{restrict:"EA",link:function(n,r,a){var s=a.count,l=a.$attr.when&&r.attr(a.$attr.when),c=a.offset||0,u=n.$eval(l)||{},h={},d=t.startSymbol(),p=t.endSymbol(),f=/^when(Minus)?(.+)$/;o(a,function(e,t){f.test(t)&&(u[zt(t.replace("when","").replace("Minus","-"))]=r.attr(a.$attr[t]))}),o(u,function(e,n){h[n]=t(e.replace(i,d+s+"-"+c+p))}),n.$watch(function(){var t=parseFloat(n.$eval(s));return isNaN(t)?"":(t in u||(t=e.pluralCat(t-c)),h[t](n))},function(e){r.text(e)})}}}],Un=["$parse","$animate",function(e,i){var a=n("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function(n,s,l,c,u){var h,d,p,f,m,g,v=l.ngRepeat,y=v.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),b={$id:me};if(!y)throw a("iexp",v);if(l=y[1],c=y[2],(y=y[3])?(h=e(y),d=function(e,t,i){return g&&(b[g]=e),b[m]=t,b.$index=i,h(n,b)}):(p=function(e,t){return me(t)},f=function(e){return e}),!(y=l.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/)))throw a("iidexp",l);m=y[3]||y[1],g=y[2];var x={};n.$watchCollection(c,function(e){var l,c,h,y,b,_,w,E,T,M=s[0],S={},C=[];if(r(e))E=e,h=d||p;else{for(_ in h=d||f,E=[],e)e.hasOwnProperty(_)&&"$"!=_.charAt(0)&&E.push(_);E.sort()}for(y=E.length,c=C.length=E.length,l=0;l<c;l++)if(Z(w=h(_=e===E?l:E[l],w=e[_],l),"`track by` id"),x.hasOwnProperty(w))T=x[w],delete x[w],S[w]=T,C[l]=T;else{if(S.hasOwnProperty(w))throw o(C,function(e){e&&e.scope&&(x[e.id]=e)}),a("dupes",v,w);C[l]={id:w},S[w]=!1}for(_ in x)x.hasOwnProperty(_)&&(l=J((T=x[_]).clone),i.leave(l),o(l,function(e){e.$$NG_REMOVED=!0}),T.scope.$destroy());for(l=0,c=E.length;l<c;l++){if(w=e[_=e===E?l:E[l]],T=C[l],C[l-1]&&(M=C[l-1].clone[C[l-1].clone.length-1]),T.scope){b=T.scope,h=M;do{h=h.nextSibling}while(h&&h.$$NG_REMOVED);T.clone[0]!=h&&i.move(J(T.clone),null,Ft(M)),M=T.clone[T.clone.length-1]}else b=n.$new();b[m]=w,g&&(b[g]=_),b.$index=l,b.$first=0===l,b.$last=l===y-1,b.$middle=!(b.$first||b.$last),b.$odd=!(b.$even=0==(1&l)),T.scope||u(b,function(e){e[e.length++]=t.createComment(" end ngRepeat: "+v+" "),i.enter(e,null,Ft(M)),M=e,T.scope=b,T.clone=e,S[T.id]=T})}x=S})}}}],$n=["$animate",function(e){return function(t,i,n){t.$watch(n.ngShow,function(t){e[H(t)?"removeClass":"addClass"](i,"ng-hide")})}}],jn=["$animate",function(e){return function(t,i,n){t.$watch(n.ngHide,function(t){e[H(t)?"addClass":"removeClass"](i,"ng-hide")})}}],zn=Lt(function(e,t,i){e.$watch(i.ngStyle,function(e,i){i&&e!==i&&o(i,function(e,i){t.css(i,"")}),e&&t.css(e)},!0)}),Vn=["$animate",function(e){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(t,i,n,r){var a,s,l,c=[];t.$watch(n.ngSwitch||n.on,function(i){var u,h=c.length;if(0<h){if(l){for(u=0;u<h;u++)l[u].remove();l=null}for(l=[],u=0;u<h;u++){var d=s[u];c[u].$destroy(),l[u]=d,e.leave(d,function(){l.splice(u,1),0===l.length&&(l=null)})}}s=[],c=[],(a=r.cases["!"+i]||r.cases["?"])&&(t.$eval(n.change),o(a,function(i){var n=t.$new();c.push(n),i.transclude(n,function(t){var n=i.element;s.push(t),e.enter(t,n.parent(),n)})}))})}}}],Gn=Lt({transclude:"element",priority:800,require:"^ngSwitch",link:function(e,t,i,n,r){n.cases["!"+i.ngSwitchWhen]=n.cases["!"+i.ngSwitchWhen]||[],n.cases["!"+i.ngSwitchWhen].push({transclude:r,element:t})}}),Wn=Lt({transclude:"element",priority:800,require:"^ngSwitch",link:function(e,t,i,n,r){n.cases["?"]=n.cases["?"]||[],n.cases["?"].push({transclude:r,element:t})}}),qn=Lt({link:function(e,t,i,r,o){if(!o)throw n("ngTransclude")("orphan",B(t));o(function(e){t.empty(),t.append(e)})}}),Xn=["$templateCache",function(e){return{restrict:"E",terminal:!0,compile:function(t,i){"text/ng-template"==i.type&&e.put(i.id,t[0].text)}}}],Zn=n("ngOptions"),Yn=m({terminal:!0}),Jn=["$compile","$parse",function(e,n){var r=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,s={$setViewValue:p};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(e,t,i){var n,r=this,o={},a=s;r.databound=i.ngModel,r.init=function(e,t,i){a=e,n=i},r.addOption=function(t){Z(t,'"option value"'),o[t]=!0,a.$viewValue==t&&(e.val(t),n.parent()&&n.remove())},r.removeOption=function(e){this.hasOption(e)&&(delete o[e],a.$viewValue==e&&this.renderUnknownOption(e))},r.renderUnknownOption=function(t){t="? "+me(t)+" ?",n.val(t),e.prepend(n),e.val(t),n.prop("selected",!0)},r.hasOption=function(e){return o.hasOwnProperty(e)},t.$on("$destroy",function(){r.renderUnknownOption=p})}],link:function(s,l,c,u){if(u[1]){var h=u[0];u=u[1];var d,p=c.multiple,f=c.ngOptions,m=!1,y=Ft(t.createElement("option")),b=Ft(t.createElement("optgroup")),x=y.clone();c=0;for(var _=l.children(),E=_.length;c<E;c++)if(""===_[c].value){d=m=_.eq(c);break}h.init(u,m,x),p&&(u.$isEmpty=function(e){return!e||0===e.length}),f?function(t,o,s){function l(){var e,i,n,r,l,c={"":[]},f=[""];r=s.$modelValue,l=_(t)||[];var M,S,C,R,A,P=d?a(l):l;if(S={},n=!1,p)if(E&&w(r))for(n=new ge([]),C=0;C<r.length;C++)S[h]=r[C],n.put(E(t,S),r[C]);else n=new ge(r);for(C=0;C<(M=P.length);C++){if(i=C,d){if("$"===(i=P[C]).charAt(0))continue;S[d]=i}S[h]=l[i],(i=c[e=g(t,S)||""])||(i=c[e]=[],f.push(e)),p?e=v(n.remove(E?E(t,S):x(t,S))):(E?((e={})[h]=r,e=E(t,e)===E(t,S)):e=r===x(t,S),n=n||e),R=v(R=u(t,S))?R:"",i.push({id:E?E(t,S):d?P[C]:C,label:R,selected:e})}for(p||(m||null===r?c[""].unshift({id:"",label:"",selected:!n}):n||c[""].unshift({id:"?",label:"",selected:!0})),S=0,P=f.length;S<P;S++){for(i=c[e=f[S]],T.length<=S?(l=[r={element:b.clone().attr("label",e),label:i.label}],T.push(l),o.append(r.element)):(r=(l=T[S])[0]).label!=e&&r.element.attr("label",r.label=e),R=null,C=0,M=i.length;C<M;C++)n=i[C],(e=l[C+1])?(R=e.element,e.label!==n.label&&R.text(e.label=n.label),e.id!==n.id&&R.val(e.id=n.id),e.selected!==n.selected&&R.prop("selected",e.selected=n.selected)):(""===n.id&&m?A=m:(A=y.clone()).val(n.id).attr("selected",n.selected).text(n.label),l.push({element:A,label:n.label,id:n.id,selected:n.selected}),R?R.after(A):r.element.append(A),R=A);for(C++;l.length>C;)l.pop().element.remove()}for(;T.length>S;)T.pop()[0].element.remove()}var c;if(!(c=f.match(r)))throw Zn("iexp",f,B(o));var u=n(c[2]||c[1]),h=c[4]||c[6],d=c[5],g=n(c[3]||""),x=n(c[2]?c[1]:h),_=n(c[7]),E=c[8]?n(c[8]):null,T=[[{element:o,label:""}]];m&&(e(m)(t),m.removeClass("ng-scope"),m.remove()),o.empty(),o.on("change",function(){t.$apply(function(){var e,n,r,a,l,c,u,f,m=_(t)||[],g={};if(p){for(r=[],l=0,u=T.length;l<u;l++)for(a=1,c=(e=T[l]).length;a<c;a++)if((n=e[a].element)[0].selected){if(n=n.val(),d&&(g[d]=n),E)for(f=0;f<m.length&&(g[h]=m[f],E(t,g)!=n);f++);else g[h]=m[n];r.push(x(t,g))}}else{if("?"==(n=o.val()))r=i;else if(""===n)r=null;else if(E){for(f=0;f<m.length;f++)if(g[h]=m[f],E(t,g)==n){r=x(t,g);break}}else g[h]=m[n],d&&(g[d]=n),r=x(t,g);1<T[0].length&&T[0][1].id!==n&&(T[0][1].selected=!1)}s.$setViewValue(r)})}),s.$render=l,t.$watch(l)}(s,l,u):p?function(e,t,i){var n;i.$render=function(){var e=new ge(i.$viewValue);o(t.find("option"),function(t){t.selected=v(e.get(t.value))})},e.$watch(function(){L(n,i.$viewValue)||(n=A(i.$viewValue),i.$render())}),t.on("change",function(){e.$apply(function(){var e=[];o(t.find("option"),function(t){t.selected&&e.push(t.value)}),i.$setViewValue(e)})})}(s,l,u):function(e,t,i,n){i.$render=function(){var e=i.$viewValue;n.hasOption(e)?(x.parent()&&x.remove(),t.val(e),""===e&&d.prop("selected",!0)):g(e)&&d?t.val(""):n.renderUnknownOption(e)},t.on("change",function(){e.$apply(function(){x.parent()&&x.remove(),i.$setViewValue(t.val())})})}(s,l,u,h)}}}}],Kn=["$interpolate",function(e){var t={addOption:p,removeOption:p};return{restrict:"E",priority:100,compile:function(i,n){if(g(n.value)){var r=e(i.text(),!0);r||n.$set("value",i.text())}return function(e,i,n){var o=i.parent(),a=o.data("$selectController")||o.parent().data("$selectController");a&&a.databound?i.prop("selected",!1):a=t,r?e.$watch(r,function(e,t){n.$set("value",e),t!==e&&a.removeOption(t),a.addOption(e)}):a.addOption(n.value),i.on("$destroy",function(){a.removeOption(n.value)})}}}}],Qn=m({restrict:"E",terminal:!1});e.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):((Ut=e.jQuery)?(Ft=Ut,u(Ut.fn,{scope:mi.scope,isolateScope:mi.isolateScope,controller:mi.controller,injector:mi.injector,inheritedData:mi.inheritedData}),Q("remove",!0,!0,!1),Q("empty",!1,!1,!1),Q("html",!1,!1,!0)):Ft=ee,Yt.element=Ft,function(t){u(t,{bootstrap:G,copy:A,extend:u,equals:L,element:Ft,forEach:o,injector:ye,noop:p,bind:I,toJson:D,fromJson:N,identity:f,isUndefined:g,isDefined:v,isString:b,isFunction:E,isObject:y,isNumber:x,isElement:S,isArray:w,version:ti,isDate:_,lowercase:zt,uppercase:Gt,callbacks:{counter:0},$$minErr:n,$$csp:O}),$t=function(e){var t=n("$injector"),i=n("ng");return(e=e.angular||(e.angular={})).$$minErr=e.$$minErr||n,e.module||(e.module=function(){var e={};return function(n,r,o){if("hasOwnProperty"===n)throw i("badname","module");return r&&e.hasOwnProperty(n)&&(e[n]=null),e[n]||(e[n]=function(){function e(e,t,n){return function(){return i[n||"push"]([e,t,arguments]),l}}if(!r)throw t("nomod",n);var i=[],a=[],s=e("$injector","invoke"),l={_invokeQueue:i,_runBlocks:a,requires:r,name:n,provider:e("$provide","provider"),factory:e("$provide","factory"),service:e("$provide","service"),value:e("$provide","value"),constant:e("$provide","constant","unshift"),animation:e("$animateProvider","register"),filter:e("$filterProvider","register"),controller:e("$controllerProvider","register"),directive:e("$compileProvider","directive"),config:s,run:function(e){return a.push(e),this}};return o&&s(o),l}())}}())}(e);try{$t("ngLocale")}catch(e){$t("ngLocale",[]).provider("$locale",Fe)}$t("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:lt}),e.provider("$compile",Me).directive({a:Zi,input:dn,textarea:dn,form:Qi,script:Xn,select:Jn,style:Qn,option:Kn,ngBind:Mn,ngBindHtml:Cn,ngBindTemplate:Sn,ngClass:Rn,ngClassEven:Pn,ngClassOdd:An,ngCloak:Ln,ngController:On,ngForm:en,ngHide:jn,ngIf:kn,ngInclude:Dn,ngInit:Hn,ngNonBindable:Bn,ngPluralize:Fn,ngRepeat:Un,ngShow:$n,ngStyle:zn,ngSwitch:Vn,ngSwitchWhen:Gn,ngSwitchDefault:Wn,ngOptions:Yn,ngTransclude:qn,ngModel:yn,ngList:_n,ngChange:bn,required:xn,ngRequired:xn,ngValue:En,ngModelOptions:Tn}).directive({ngInclude:Nn}).directive(Yi).directive(In),e.provider({$anchorScroll:be,$animate:Ti,$browser:we,$cacheFactory:Ee,$controller:Re,$document:Ae,$exceptionHandler:Pe,$filter:vt,$interpolate:He,$interval:Be,$http:ke,$httpBackend:Ne,$location:Je,$log:Ke,$parse:rt,$rootScope:st,$q:ot,$sce:ht,$sceDelegate:ut,$sniffer:dt,$templateCache:Te,$timeout:pt,$window:gt,$$rAF:at,$$asyncCallback:xe})}])}(Yt),Ft(t).ready(function(){V(t,G)}))}(window,document),!angular.$$csp()&&angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}</style>'),function(e){var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=10;function n(){this._events={},this._conf&&r.call(this,this._conf)}function r(t){t?(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),this._maxListeners=t.maxListeners!==e?t.maxListeners:i,t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this._newListener=t.newListener),t.removeListener&&(this._removeListener=t.removeListener),t.verboseMemoryLeak&&(this.verboseMemoryLeak=t.verboseMemoryLeak),this.wildcard&&(this.listenerTree={})):this._maxListeners=i}function o(e,t){var i="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(i+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var n=new Error(i);n.name="MaxListenersExceededWarning",n.emitter=this,n.count=e,process.emitWarning(n)}else console.error(i),console.trace&&console.trace()}function a(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,r.call(this,e)}function s(e,t,i,n){if(!i)return[];var r,o,a,l,c,u,h,d=[],p=t.length,f=t[n],m=t[n+1];if(n===p&&i._listeners){if("function"==typeof i._listeners)return e&&e.push(i._listeners),[i];for(r=0,o=i._listeners.length;r<o;r++)e&&e.push(i._listeners[r]);return[i]}if("*"===f||"**"===f||i[f]){if("*"===f){for(a in i)"_listeners"!==a&&i.hasOwnProperty(a)&&(d=d.concat(s(e,t,i[a],n+1)));return d}if("**"===f){for(a in(h=n+1===p||n+2===p&&"*"===m)&&i._listeners&&(d=d.concat(s(e,t,i,p))),i)"_listeners"!==a&&i.hasOwnProperty(a)&&("*"===a||"**"===a?(i[a]._listeners&&!h&&(d=d.concat(s(e,t,i[a],p))),d=d.concat(s(e,t,i[a],n))):d=a===m?d.concat(s(e,t,i[a],n+2)):d.concat(s(e,t,i[a],n)));return d}d=d.concat(s(e,t,i[f],n+1))}if((l=i["*"])&&s(e,t,l,n+1),c=i["**"])if(n<p)for(a in c._listeners&&s(e,t,c,p),c)"_listeners"!==a&&c.hasOwnProperty(a)&&(a===m?s(e,t,c[a],n+2):a===f?s(e,t,c[a],n+1):((u={})[a]=c[a],s(e,t,{"**":u},n+1)));else c._listeners?s(e,t,c,p):c["*"]&&c["*"]._listeners&&s(e,t,c["*"],p);return d}a.EventEmitter2=a,a.prototype.delimiter=".",a.prototype.setMaxListeners=function(t){t!==e&&(this._maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t)},a.prototype.event="",a.prototype.once=function(e,t){return this._once(e,t,!1)},a.prototype.prependOnceListener=function(e,t){return this._once(e,t,!0)},a.prototype._once=function(e,t,i){return this._many(e,1,t,i),this},a.prototype.many=function(e,t,i){return this._many(e,t,i,!1)},a.prototype.prependMany=function(e,t,i){return this._many(e,t,i,!0)},a.prototype._many=function(e,t,i,n){var r=this;if("function"!=typeof i)throw new Error("many only accepts instances of Function");function o(){return 0==--t&&r.off(e,o),i.apply(this,arguments)}return o._origin=i,this._on(e,o,n),r},a.prototype.emit=function(){this._events||n.call(this);var e=arguments[0];if("newListener"===e&&!this._newListener&&!this._events.newListener)return!1;var t,i,r,o,a,l=arguments.length;if(this._all&&this._all.length){if(a=this._all.slice(),l>3)for(t=new Array(l),o=0;o<l;o++)t[o]=arguments[o];for(r=0,i=a.length;r<i;r++)switch(this.event=e,l){case 1:a[r].call(this,e);break;case 2:a[r].call(this,e,arguments[1]);break;case 3:a[r].call(this,e,arguments[1],arguments[2]);break;default:a[r].apply(this,t)}}if(this.wildcard){a=[];var c="string"==typeof e?e.split(this.delimiter):e.slice();s.call(this,a,c,this.listenerTree,0)}else{if("function"==typeof(a=this._events[e])){switch(this.event=e,l){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(l-1),o=1;o<l;o++)t[o-1]=arguments[o];a.apply(this,t)}return!0}a&&(a=a.slice())}if(a&&a.length){if(l>3)for(t=new Array(l-1),o=1;o<l;o++)t[o-1]=arguments[o];for(r=0,i=a.length;r<i;r++)switch(this.event=e,l){case 1:a[r].call(this);break;case 2:a[r].call(this,arguments[1]);break;case 3:a[r].call(this,arguments[1],arguments[2]);break;default:a[r].apply(this,t)}return!0}if(!this._all&&"error"===e)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},a.prototype.emitAsync=function(){this._events||n.call(this);var e=arguments[0];if("newListener"===e&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);var t,i,r,o,a,l=[],c=arguments.length;if(this._all){if(c>3)for(t=new Array(c),o=1;o<c;o++)t[o]=arguments[o];for(r=0,i=this._all.length;r<i;r++)switch(this.event=e,c){case 1:l.push(this._all[r].call(this,e));break;case 2:l.push(this._all[r].call(this,e,arguments[1]));break;case 3:l.push(this._all[r].call(this,e,arguments[1],arguments[2]));break;default:l.push(this._all[r].apply(this,t))}}if(this.wildcard){a=[];var u="string"==typeof e?e.split(this.delimiter):e.slice();s.call(this,a,u,this.listenerTree,0)}else a=this._events[e];if("function"==typeof a)switch(this.event=e,c){case 1:l.push(a.call(this));break;case 2:l.push(a.call(this,arguments[1]));break;case 3:l.push(a.call(this,arguments[1],arguments[2]));break;default:for(t=new Array(c-1),o=1;o<c;o++)t[o-1]=arguments[o];l.push(a.apply(this,t))}else if(a&&a.length){if(a=a.slice(),c>3)for(t=new Array(c-1),o=1;o<c;o++)t[o-1]=arguments[o];for(r=0,i=a.length;r<i;r++)switch(this.event=e,c){case 1:l.push(a[r].call(this));break;case 2:l.push(a[r].call(this,arguments[1]));break;case 3:l.push(a[r].call(this,arguments[1],arguments[2]));break;default:l.push(a[r].apply(this,t))}}else if(!this._all&&"error"===e)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(l)},a.prototype.on=function(e,t){return this._on(e,t,!1)},a.prototype.prependListener=function(e,t){return this._on(e,t,!0)},a.prototype.onAny=function(e){return this._onAny(e,!1)},a.prototype.prependAny=function(e){return this._onAny(e,!0)},a.prototype.addListener=a.prototype.on,a.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},a.prototype._on=function(t,i,r){if("function"==typeof t)return this._onAny(t,i),this;if("function"!=typeof i)throw new Error("on only accepts instances of Function");return this._events||n.call(this),this._newListener&&this.emit("newListener",t,i),this.wildcard?(function(t,i){for(var n=0,r=(t="string"==typeof t?t.split(this.delimiter):t.slice()).length;n+1<r;n++)if("**"===t[n]&&"**"===t[n+1])return;for(var a=this.listenerTree,s=t.shift();s!==e;){if(a[s]||(a[s]={}),a=a[s],0===t.length)return a._listeners?("function"==typeof a._listeners&&(a._listeners=[a._listeners]),a._listeners.push(i),!a._listeners.warned&&this._maxListeners>0&&a._listeners.length>this._maxListeners&&(a._listeners.warned=!0,o.call(this,a._listeners.length,s))):a._listeners=i,!0;s=t.shift()}return!0}.call(this,t,i),this):(this._events[t]?("function"==typeof this._events[t]&&(this._events[t]=[this._events[t]]),r?this._events[t].unshift(i):this._events[t].push(i),!this._events[t].warned&&this._maxListeners>0&&this._events[t].length>this._maxListeners&&(this._events[t].warned=!0,o.call(this,this._events[t].length,t))):this._events[t]=i,this)},a.prototype.off=function(i,n){if("function"!=typeof n)throw new Error("removeListener only takes instances of Function");var r,o=[];if(this.wildcard){var a="string"==typeof i?i.split(this.delimiter):i.slice();o=s.call(this,null,a,this.listenerTree,0)}else{if(!this._events[i])return this;r=this._events[i],o.push({_listeners:r})}for(var l=0;l<o.length;l++){var c=o[l];if(r=c._listeners,t(r)){for(var u=-1,h=0,d=r.length;h<d;h++)if(r[h]===n||r[h].listener&&r[h].listener===n||r[h]._origin&&r[h]._origin===n){u=h;break}if(u<0)continue;return this.wildcard?c._listeners.splice(u,1):this._events[i].splice(u,1),0===r.length&&(this.wildcard?delete c._listeners:delete this._events[i]),this._removeListener&&this.emit("removeListener",i,n),this}(r===n||r.listener&&r.listener===n||r._origin&&r._origin===n)&&(this.wildcard?delete c._listeners:delete this._events[i],this._removeListener&&this.emit("removeListener",i,n))}return function t(i){if(i!==e){var n=Object.keys(i);for(var r in n){var o=n[r],a=i[o];a instanceof Function||"object"!=typeof a||null===a||(Object.keys(a).length>0&&t(i[o]),0===Object.keys(a).length&&delete i[o])}}}(this.listenerTree),this},a.prototype.offAny=function(e){var t,i=0,n=0;if(e&&this._all&&this._all.length>0){for(i=0,n=(t=this._all).length;i<n;i++)if(e===t[i])return t.splice(i,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(i=0,n=t.length;i<n;i++)this.emit("removeListenerAny",t[i]);this._all=[]}return this},a.prototype.removeListener=a.prototype.off,a.prototype.removeAllListeners=function(e){if(0===arguments.length)return!this._events||n.call(this),this;if(this.wildcard)for(var t="string"==typeof e?e.split(this.delimiter):e.slice(),i=s.call(this,null,t,this.listenerTree,0),r=0;r<i.length;r++){i[r]._listeners=null}else this._events&&(this._events[e]=null);return this},a.prototype.listeners=function(e){if(this.wildcard){var i=[],r="string"==typeof e?e.split(this.delimiter):e.slice();return s.call(this,i,r,this.listenerTree,0),i}return this._events||n.call(this),this._events[e]||(this._events[e]=[]),t(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},a.prototype.eventNames=function(){return Object.keys(this._events)},a.prototype.listenerCount=function(e){return this.listeners(e).length},a.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof exports?module.exports=a:window.EventEmitter2=a}(),function(e,t){var i,n,r=typeof t,o=e.document,a=e.location,s=e.jQuery,l=e.$,c={},u=[],h=u.concat,d=u.push,p=u.slice,f=u.indexOf,m=c.toString,g=c.hasOwnProperty,v="1.9.1".trim,y=function(e,t){return new y.fn.init(e,t,n)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,x=/\S+/g,_=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,T=/^[\],:{}\s]*$/,M=/(?:^|:|,)(?:\s*\[)+/g,S=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,C=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,R=/^-ms-/,A=/-([\da-z])/gi,P=function(e,t){return t.toUpperCase()},L=function(e){(o.addEventListener||"load"===e.type||"complete"===o.readyState)&&(O(),y.ready())},O=function(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",L,!1),e.removeEventListener("load",L,!1)):(o.detachEvent("onreadystatechange",L),e.detachEvent("onload",L))};function I(e){var t=e.length,i=y.type(e);return!y.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)))}y.fn=y.prototype={jquery:"1.9.1",constructor:y,init:function(e,i,n){var r,a;if(!e)return this;if("string"==typeof e){if(!(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:w.exec(e))||!r[1]&&i)return!i||i.jquery?(i||n).find(e):this.constructor(i).find(e);if(r[1]){if(i=i instanceof y?i[0]:i,y.merge(this,y.parseHTML(r[1],i&&i.nodeType?i.ownerDocument||i:o,!0)),E.test(r[1])&&y.isPlainObject(i))for(r in i)y.isFunction(this[r])?this[r](i[r]):this.attr(r,i[r]);return this}if((a=o.getElementById(r[2]))&&a.parentNode){if(a.id!==r[2])return n.find(e);this.length=1,this[0]=a}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):y.isFunction(e)?n.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),y.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return p.call(this)},get:function(e){return null==e?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=y.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return y.each(this,e,t)},ready:function(e){return y.ready.promise().done(e),this},slice:function(){return this.pushStack(p.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},map:function(e){return this.pushStack(y.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},y.fn.init.prototype=y.fn,y.extend=y.fn.extend=function(){var e,i,n,r,o,a,s=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[1]||{},l=2),"object"==typeof s||y.isFunction(s)||(s={}),c===l&&(s=this,--l);l<c;l++)if(null!=(o=arguments[l]))for(r in o)e=s[r],s!==(n=o[r])&&(u&&n&&(y.isPlainObject(n)||(i=y.isArray(n)))?(i?(i=!1,a=e&&y.isArray(e)?e:[]):a=e&&y.isPlainObject(e)?e:{},s[r]=y.extend(u,a,n)):n!==t&&(s[r]=n));return s},y.extend({noConflict:function(t){return e.$===y&&(e.$=l),t&&e.jQuery===y&&(e.jQuery=s),y},isReady:!1,readyWait:1,holdReady:function(e){e?y.readyWait++:y.ready(!0)},ready:function(e){if(!0===e?!--y.readyWait:!y.isReady){if(!o.body)return setTimeout(y.ready);y.isReady=!0,!0!==e&&--y.readyWait>0||(i.resolveWith(o,[y]),y.fn.trigger&&y(o).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===y.type(e)},isArray:Array.isArray||function(e){return"array"===y.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?c[m.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==y.type(e)||e.nodeType||y.isWindow(e))return!1;try{if(e.constructor&&!g.call(e,"constructor")&&!g.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var i;for(i in e);return i===t||g.call(e,i)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||o;var n=E.exec(e),r=!i&&[];return n?[t.createElement(n[1])]:(n=y.buildFragment([e],t,r),r&&y(r).remove(),y.merge([],n.childNodes))},parseJSON:function(t){return e.JSON&&e.JSON.parse?e.JSON.parse(t):null===t?t:"string"==typeof t&&(t=y.trim(t))&&T.test(t.replace(S,"@").replace(C,"]").replace(M,""))?new Function("return "+t)():void y.error("Invalid JSON: "+t)},parseXML:function(i){var n;if(!i||"string"!=typeof i)return null;try{e.DOMParser?n=(new DOMParser).parseFromString(i,"text/xml"):((n=new ActiveXObject("Microsoft.XMLDOM")).async="false",n.loadXML(i))}catch(e){n=t}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||y.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(t){t&&y.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(R,"ms-").replace(A,P)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var n=0,r=e.length,o=I(e);if(i){if(o)for(;n<r&&!1!==t.apply(e[n],i);n++);else for(n in e)if(!1===t.apply(e[n],i))break}else if(o)for(;n<r&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:v&&!v.call("\ufeff")?function(e){return null==e?"":v.call(e)}:function(e){return null==e?"":(e+"").replace(_,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(I(Object(e))?y.merge(i,"string"==typeof e?[e]:e):d.call(i,e)),i},inArray:function(e,t,i){var n;if(t){if(f)return f.call(t,e,i);for(n=t.length,i=i?i<0?Math.max(0,n+i):i:0;i<n;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var n=i.length,r=e.length,o=0;if("number"==typeof n)for(;o<n;o++)e[r++]=i[o];else for(;i[o]!==t;)e[r++]=i[o++];return e.length=r,e},grep:function(e,t,i){var n=[],r=0,o=e.length;for(i=!!i;r<o;r++)i!==!!t(e[r],r)&&n.push(e[r]);return n},map:function(e,t,i){var n,r=0,o=e.length,a=[];if(I(e))for(;r<o;r++)null!=(n=t(e[r],r,i))&&(a[a.length]=n);else for(r in e)null!=(n=t(e[r],r,i))&&(a[a.length]=n);return h.apply([],a)},guid:1,proxy:function(e,i){var n,r,o;return"string"==typeof i&&(o=e[i],i=e,e=o),y.isFunction(e)?(n=p.call(arguments,2),(r=function(){return e.apply(i||this,n.concat(p.call(arguments)))}).guid=e.guid=e.guid||y.guid++,r):t},access:function(e,i,n,r,o,a,s){var l=0,c=e.length,u=null==n;if("object"===y.type(n))for(l in o=!0,n)y.access(e,i,l,n[l],!0,a,s);else if(r!==t&&(o=!0,y.isFunction(r)||(s=!0),u&&(s?(i.call(e,r),i=null):(u=i,i=function(e,t,i){return u.call(y(e),i)})),i))for(;l<c;l++)i(e[l],n,s?r:r.call(e[l],l,i(e[l],n)));return o?e:u?i.call(e):c?i(e[0],n):a},now:function(){return(new Date).getTime()}}),y.ready.promise=function(t){if(!i)if(i=y.Deferred(),"complete"===o.readyState)setTimeout(y.ready);else if(o.addEventListener)o.addEventListener("DOMContentLoaded",L,!1),e.addEventListener("load",L,!1);else{o.attachEvent("onreadystatechange",L),e.attachEvent("onload",L);var n=!1;try{n=null==e.frameElement&&o.documentElement}catch(e){}n&&n.doScroll&&function e(){if(!y.isReady){try{n.doScroll("left")}catch(t){return setTimeout(e,50)}O(),y.ready()}}()}return i.promise(t)},y.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){c["[object "+t+"]"]=t.toLowerCase()}),n=y(o);var k={};y.Callbacks=function(e){var i,n,r,o,a,s,l=[],c=!(e="string"==typeof e?k[e]||function(e){var t=k[e]={};return y.each(e.match(x)||[],function(e,i){t[i]=!0}),t}(e):y.extend({},e)).once&&[],u=function(t){for(n=e.memory&&t,r=!0,a=s||0,s=0,o=l.length,i=!0;l&&a<o;a++)if(!1===l[a].apply(t[0],t[1])&&e.stopOnFalse){n=!1;break}i=!1,l&&(c?c.length&&u(c.shift()):n?l=[]:h.disable())},h={add:function(){if(l){var t=l.length;!function t(i){y.each(i,function(i,n){var r=y.type(n);"function"===r?e.unique&&h.has(n)||l.push(n):n&&n.length&&"string"!==r&&t(n)})}(arguments),i?o=l.length:n&&(s=t,u(n))}return this},remove:function(){return l&&y.each(arguments,function(e,t){for(var n;(n=y.inArray(t,l,n))>-1;)l.splice(n,1),i&&(n<=o&&o--,n<=a&&a--)}),this},has:function(e){return e?y.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],this},disable:function(){return l=c=n=t,this},disabled:function(){return!l},lock:function(){return c=t,n||h.disable(),this},locked:function(){return!c},fireWith:function(e,t){return t=[e,(t=t||[]).slice?t.slice():t],!l||r&&!c||(i?c.push(t):u(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!r}};return h},y.extend({Deferred:function(e){var t=[["resolve","done",y.Callbacks("once memory"),"resolved"],["reject","fail",y.Callbacks("once memory"),"rejected"],["notify","progress",y.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return y.Deferred(function(i){y.each(t,function(t,o){var a=o[0],s=y.isFunction(e[t])&&e[t];r[o[1]](function(){var e=s&&s.apply(this,arguments);e&&y.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[a+"With"](this===n?i.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?y.extend(e,n):n}},r={};return n.pipe=n.then,y.each(t,function(e,o){var a=o[2],s=o[3];n[o[1]]=a.add,s&&a.add(function(){i=s},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=a.fireWith}),n.promise(r),e&&e.call(r,r),r},when:function(e){var t,i,n,r=0,o=p.call(arguments),a=o.length,s=1!==a||e&&y.isFunction(e.promise)?a:0,l=1===s?e:y.Deferred(),c=function(e,i,n){return function(r){i[e]=this,n[e]=arguments.length>1?p.call(arguments):r,n===t?l.notifyWith(i,n):--s||l.resolveWith(i,n)}};if(a>1)for(t=new Array(a),i=new Array(a),n=new Array(a);r<a;r++)o[r]&&y.isFunction(o[r].promise)?o[r].promise().done(c(r,n,o)).fail(l.reject).progress(c(r,i,t)):--s;return s||l.resolveWith(n,o),l.promise()}}),y.support=function(){var t,i,n,a,s,l,c,u,h,d,p=o.createElement("div");if(p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=p.getElementsByTagName("*"),n=p.getElementsByTagName("a")[0],!i||!n||!i.length)return{};c=(s=o.createElement("select")).appendChild(o.createElement("option")),a=p.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==p.className,leadingWhitespace:3===p.firstChild.nodeType,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(n.getAttribute("style")),hrefNormalized:"/a"===n.getAttribute("href"),opacity:/^0.5/.test(n.style.opacity),cssFloat:!!n.style.cssFloat,checkOn:!!a.value,optSelected:c.selected,enctype:!!o.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==o.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===o.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!c.disabled;try{delete p.test}catch(e){t.deleteExpando=!1}for(d in(a=o.createElement("input")).setAttribute("value",""),t.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),t.radioValue="t"===a.value,a.setAttribute("checked","t"),a.setAttribute("name","t"),(l=o.createDocumentFragment()).appendChild(a),t.appendChecked=a.checked,t.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,p.attachEvent&&(p.attachEvent("onclick",function(){t.noCloneEvent=!1}),p.cloneNode(!0).click()),{submit:!0,change:!0,focusin:!0})p.setAttribute(u="on"+d,"t"),t[d+"Bubbles"]=u in e||!1===p.attributes[u].expando;return p.style.backgroundClip="content-box",p.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===p.style.backgroundClip,y(function(){var i,n,a,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",l=o.getElementsByTagName("body")[0];l&&((i=o.createElement("div")).style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",l.appendChild(i).appendChild(p),p.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(a=p.getElementsByTagName("td"))[0].style.cssText="padding:0;margin:0;border:0;display:none",h=0===a[0].offsetHeight,a[0].style.display="",a[1].style.display="none",t.reliableHiddenOffsets=h&&0===a[0].offsetHeight,p.innerHTML="",p.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===p.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==l.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(p,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(p,null)||{width:"4px"}).width,(n=p.appendChild(o.createElement("div"))).style.cssText=p.style.cssText=s,n.style.marginRight=n.style.width="0",p.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight)),typeof p.style.zoom!==r&&(p.innerHTML="",p.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===p.offsetWidth,p.style.display="block",p.innerHTML="<div></div>",p.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==p.offsetWidth,t.inlineBlockNeedsLayout&&(l.style.zoom=1)),l.removeChild(i),i=p=a=n=null)}),i=s=l=c=n=a=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,N=/([A-Z])/g;function H(e,i,n,r){if(y.acceptData(e)){var o,a,s=y.expando,l="string"==typeof i,c=e.nodeType,h=c?y.cache:e,d=c?e[s]:e[s]&&s;if(d&&h[d]&&(r||h[d].data)||!l||n!==t)return d||(c?e[s]=d=u.pop()||y.guid++:d=s),h[d]||(h[d]={},c||(h[d].toJSON=y.noop)),"object"!=typeof i&&"function"!=typeof i||(r?h[d]=y.extend(h[d],i):h[d].data=y.extend(h[d].data,i)),o=h[d],r||(o.data||(o.data={}),o=o.data),n!==t&&(o[y.camelCase(i)]=n),l?null==(a=o[i])&&(a=o[y.camelCase(i)]):a=o,a}}function B(e,t,i){if(y.acceptData(e)){var n,r,o,a=e.nodeType,s=a?y.cache:e,l=a?e[y.expando]:y.expando;if(s[l]){if(t&&(o=i?s[l]:s[l].data)){for((n=0,r=(t=y.isArray(t)?t.concat(y.map(t,y.camelCase)):t in o?[t]:(t=y.camelCase(t))in o?[t]:t.split(" ")).length);n<r;n++)delete o[t[n]];if(!(i?U:y.isEmptyObject)(o))return}(i||(delete s[l].data,U(s[l])))&&(a?y.cleanData([e],!0):y.support.deleteExpando||s!=s.window?delete s[l]:s[l]=null)}}}function F(e,i,n){if(n===t&&1===e.nodeType){var r="data-"+i.replace(N,"-$1").toLowerCase();if("string"==typeof(n=e.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:D.test(n)?y.parseJSON(n):n)}catch(e){}y.data(e,i,n)}else n=t}return n}function U(e){var t;for(t in e)if(("data"!==t||!y.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}y.extend({cache:{},expando:"jQuery"+("1.9.1"+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return!!(e=e.nodeType?y.cache[e[y.expando]]:e[y.expando])&&!U(e)},data:function(e,t,i){return H(e,t,i)},removeData:function(e,t){return B(e,t)},_data:function(e,t,i){return H(e,t,i,!0)},_removeData:function(e,t){return B(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&y.noData[e.nodeName.toLowerCase()];return!t||!0!==t&&e.getAttribute("classid")===t}}),y.fn.extend({data:function(e,i){var n,r,o=this[0],a=0,s=null;if(e===t){if(this.length&&(s=y.data(o),1===o.nodeType&&!y._data(o,"parsedAttrs"))){for(n=o.attributes;a<n.length;a++)(r=n[a].name).indexOf("data-")||(r=y.camelCase(r.slice(5)),F(o,r,s[r]));y._data(o,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){y.data(this,e)}):y.access(this,function(i){if(i===t)return o?F(o,e,y.data(o,e)):null;this.each(function(){y.data(this,e,i)})},null,i,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){y.removeData(this,e)})}}),y.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=y._data(e,t),i&&(!n||y.isArray(i)?n=y._data(e,t,y.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=y.queue(e,t),n=i.length,r=i.shift(),o=y._queueHooks(e,t);"inprogress"===r&&(r=i.shift(),n--),o.cur=r,r&&("fx"===t&&i.unshift("inprogress"),delete o.stop,r.call(e,function(){y.dequeue(e,t)},o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return y._data(e,i)||y._data(e,i,{empty:y.Callbacks("once memory").add(function(){y._removeData(e,t+"queue"),y._removeData(e,i)})})}}),y.fn.extend({queue:function(e,i){var n=2;return"string"!=typeof e&&(i=e,e="fx",n--),arguments.length<n?y.queue(this[0],e):i===t?this:this.each(function(){var t=y.queue(this,e,i);y._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&y.dequeue(this,e)})},dequeue:function(e){return this.each(function(){y.dequeue(this,e)})},delay:function(e,t){return e=y.fx&&y.fx.speeds[e]||e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,r=1,o=y.Deferred(),a=this,s=this.length,l=function(){--r||o.resolveWith(a,[a])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";s--;)(n=y._data(a[s],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(l));return l(),o.promise(i)}});var $,j,z=/[\t\r\n]/g,V=/\r/g,G=/^(?:input|select|textarea|button|object)$/i,W=/^(?:a|area)$/i,q=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,X=/^(?:checked|selected)$/i,Z=y.support.getSetAttribute,Y=y.support.input;y.fn.extend({attr:function(e,t){return y.access(this,y.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){y.removeAttr(this,e)})},prop:function(e,t){return y.access(this,y.prop,e,t,arguments.length>1)},removeProp:function(e){return e=y.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(e){}})},addClass:function(e){var t,i,n,r,o,a=0,s=this.length,l="string"==typeof e&&e;if(y.isFunction(e))return this.each(function(t){y(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(x)||[];a<s;a++)if(n=1===(i=this[a]).nodeType&&(i.className?(" "+i.className+" ").replace(z," "):" ")){for(o=0;r=t[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");i.className=y.trim(n)}return this},removeClass:function(e){var t,i,n,r,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(y.isFunction(e))return this.each(function(t){y(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(x)||[];a<s;a++)if(n=1===(i=this[a]).nodeType&&(i.className?(" "+i.className+" ").replace(z," "):"")){for(o=0;r=t[o++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");i.className=e?y.trim(n):""}return this},toggleClass:function(e,t){var i=typeof e,n="boolean"==typeof t;return y.isFunction(e)?this.each(function(i){y(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var o,a=0,s=y(this),l=t,c=e.match(x)||[];o=c[a++];)s[(l=n?l:!s.hasClass(o))?"addClass":"removeClass"](o);else i!==r&&"boolean"!==i||(this.className&&y._data(this,"__className__",this.className),this.className=this.className||!1===e?"":y._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(z," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,n,r,o=this[0];return arguments.length?(r=y.isFunction(e),this.each(function(i){var o,a=y(this);1===this.nodeType&&(null==(o=r?e.call(this,i,a.val()):e)?o="":"number"==typeof o?o+="":y.isArray(o)&&(o=y.map(o,function(e){return null==e?"":e+""})),(n=y.valHooks[this.type]||y.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&n.set(this,o,"value")!==t||(this.value=o))})):o?(n=y.valHooks[o.type]||y.valHooks[o.nodeName.toLowerCase()])&&"get"in n&&(i=n.get(o,"value"))!==t?i:"string"==typeof(i=o.value)?i.replace(V,""):null==i?"":i:void 0}}),y.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,i,n=e.options,r=e.selectedIndex,o="select-one"===e.type||r<0,a=o?null:[],s=o?r+1:n.length,l=r<0?s:o?r:0;l<s;l++)if(((i=n[l]).selected||l===r)&&(y.support.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!y.nodeName(i.parentNode,"optgroup"))){if(t=y(i).val(),o)return t;a.push(t)}return a},set:function(e,t){var i=y.makeArray(t);return y(e).find("option").each(function(){this.selected=y.inArray(y(this).val(),i)>=0}),i.length||(e.selectedIndex=-1),i}}},attr:function(e,i,n){var o,a,s,l=e.nodeType;if(e&&3!==l&&8!==l&&2!==l)return typeof e.getAttribute===r?y.prop(e,i,n):((a=1!==l||!y.isXMLDoc(e))&&(i=i.toLowerCase(),o=y.attrHooks[i]||(q.test(i)?j:$)),n===t?o&&a&&"get"in o&&null!==(s=o.get(e,i))?s:(typeof e.getAttribute!==r&&(s=e.getAttribute(i)),null==s?t:s):null!==n?o&&a&&"set"in o&&(s=o.set(e,n,i))!==t?s:(e.setAttribute(i,n+""),n):void y.removeAttr(e,i))},removeAttr:function(e,t){var i,n,r=0,o=t&&t.match(x);if(o&&1===e.nodeType)for(;i=o[r++];)n=y.propFix[i]||i,q.test(i)?!Z&&X.test(i)?e[y.camelCase("default-"+i)]=e[n]=!1:e[n]=!1:y.attr(e,i,""),e.removeAttribute(Z?i:n)},attrHooks:{type:{set:function(e,t){if(!y.support.radioValue&&"radio"===t&&y.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,i,n){var r,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return(1!==a||!y.isXMLDoc(e))&&(i=y.propFix[i]||i,o=y.propHooks[i]),n!==t?o&&"set"in o&&(r=o.set(e,n,i))!==t?r:e[i]=n:o&&"get"in o&&null!==(r=o.get(e,i))?r:e[i]},propHooks:{tabIndex:{get:function(e){var i=e.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):G.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),j={get:function(e,i){var n=y.prop(e,i),r="boolean"==typeof n&&e.getAttribute(i),o="boolean"==typeof n?Y&&Z?null!=r:X.test(i)?e[y.camelCase("default-"+i)]:!!r:e.getAttributeNode(i);return o&&!1!==o.value?i.toLowerCase():t},set:function(e,t,i){return!1===t?y.removeAttr(e,i):Y&&Z||!X.test(i)?e.setAttribute(!Z&&y.propFix[i]||i,i):e[y.camelCase("default-"+i)]=e[i]=!0,i}},Y&&Z||(y.attrHooks.value={get:function(e,i){var n=e.getAttributeNode(i);return y.nodeName(e,"input")?e.defaultValue:n&&n.specified?n.value:t},set:function(e,t,i){if(!y.nodeName(e,"input"))return $&&$.set(e,t,i);e.defaultValue=t}}),Z||($=y.valHooks.button={get:function(e,i){var n=e.getAttributeNode(i);return n&&("id"===i||"name"===i||"coords"===i?""!==n.value:n.specified)?n.value:t},set:function(e,i,n){var r=e.getAttributeNode(n);return r||e.setAttributeNode(r=e.ownerDocument.createAttribute(n)),r.value=i+="","value"===n||i===e.getAttribute(n)?i:t}},y.attrHooks.contenteditable={get:$.get,set:function(e,t,i){$.set(e,""!==t&&t,i)}},y.each(["width","height"],function(e,t){y.attrHooks[t]=y.extend(y.attrHooks[t],{set:function(e,i){if(""===i)return e.setAttribute(t,"auto"),i}})})),y.support.hrefNormalized||(y.each(["href","src","width","height"],function(e,i){y.attrHooks[i]=y.extend(y.attrHooks[i],{get:function(e){var n=e.getAttribute(i,2);return null==n?t:n}})}),y.each(["href","src"],function(e,t){y.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),y.support.style||(y.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),y.support.optSelected||(y.propHooks.selected=y.extend(y.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),y.support.enctype||(y.propFix.enctype="encoding"),y.support.checkOn||y.each(["radio","checkbox"],function(){y.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),y.each(["radio","checkbox"],function(){y.valHooks[this]=y.extend(y.valHooks[this],{set:function(e,t){if(y.isArray(t))return e.checked=y.inArray(y(e).val(),t)>=0}})});var J=/^(?:input|select|textarea)$/i,K=/^key/,Q=/^(?:mouse|contextmenu)|click/,ee=/^(?:focusinfocus|focusoutblur)$/,te=/^([^.]*)(?:\.(.+)|)$/;function ie(){return!0}function ne(){return!1}y.event={global:{},add:function(e,i,n,o,a){var s,l,c,u,h,d,p,f,m,g,v,b=y._data(e);if(b){for(n.handler&&(n=(u=n).handler,a=u.selector),n.guid||(n.guid=y.guid++),(l=b.events)||(l=b.events={}),(d=b.handle)||((d=b.handle=function(e){return typeof y===r||e&&y.event.triggered===e.type?t:y.event.dispatch.apply(d.elem,arguments)}).elem=e),c=(i=(i||"").match(x)||[""]).length;c--;)m=v=(s=te.exec(i[c])||[])[1],g=(s[2]||"").split(".").sort(),h=y.event.special[m]||{},m=(a?h.delegateType:h.bindType)||m,h=y.event.special[m]||{},p=y.extend({type:m,origType:v,data:o,handler:n,guid:n.guid,selector:a,needsContext:a&&y.expr.match.needsContext.test(a),namespace:g.join(".")},u),(f=l[m])||((f=l[m]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,o,g,d)||(e.addEventListener?e.addEventListener(m,d,!1):e.attachEvent&&e.attachEvent("on"+m,d))),h.add&&(h.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),a?f.splice(f.delegateCount++,0,p):f.push(p),y.event.global[m]=!0;e=null}},remove:function(e,t,i,n,r){var o,a,s,l,c,u,h,d,p,f,m,g=y.hasData(e)&&y._data(e);if(g&&(u=g.events)){for(c=(t=(t||"").match(x)||[""]).length;c--;)if(p=m=(s=te.exec(t[c])||[])[1],f=(s[2]||"").split(".").sort(),p){for(h=y.event.special[p]||{},d=u[p=(n?h.delegateType:h.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=d.length;o--;)a=d[o],!r&&m!==a.origType||i&&i.guid!==a.guid||s&&!s.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(d.splice(o,1),a.selector&&d.delegateCount--,h.remove&&h.remove.call(e,a));l&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,f,g.handle)||y.removeEvent(e,p,g.handle),delete u[p])}else for(p in u)y.event.remove(e,p+t[c],i,n,!0);y.isEmptyObject(u)&&(delete g.handle,y._removeData(e,"events"))}},trigger:function(i,n,r,a){var s,l,c,u,h,d,p,f=[r||o],m=g.call(i,"type")?i.type:i,v=g.call(i,"namespace")?i.namespace.split("."):[];if(c=d=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!ee.test(m+y.event.triggered)&&(m.indexOf(".")>=0&&(m=(v=m.split(".")).shift(),v.sort()),l=m.indexOf(":")<0&&"on"+m,(i=i[y.expando]?i:new y.Event(m,"object"==typeof i&&i)).isTrigger=!0,i.namespace=v.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=r),n=null==n?[i]:y.makeArray(n,[i]),h=y.event.special[m]||{},a||!h.trigger||!1!==h.trigger.apply(r,n))){if(!a&&!h.noBubble&&!y.isWindow(r)){for(u=h.delegateType||m,ee.test(u+m)||(c=c.parentNode);c;c=c.parentNode)f.push(c),d=c;d===(r.ownerDocument||o)&&f.push(d.defaultView||d.parentWindow||e)}for(p=0;(c=f[p++])&&!i.isPropagationStopped();)i.type=p>1?u:h.bindType||m,(s=(y._data(c,"events")||{})[i.type]&&y._data(c,"handle"))&&s.apply(c,n),(s=l&&c[l])&&y.acceptData(c)&&s.apply&&!1===s.apply(c,n)&&i.preventDefault();if(i.type=m,!a&&!i.isDefaultPrevented()&&(!h._default||!1===h._default.apply(r.ownerDocument,n))&&("click"!==m||!y.nodeName(r,"a"))&&y.acceptData(r)&&l&&r[m]&&!y.isWindow(r)){(d=r[l])&&(r[l]=null),y.event.triggered=m;try{r[m]()}catch(e){}y.event.triggered=t,d&&(r[l]=d)}return i.result}},dispatch:function(e){e=y.event.fix(e);var i,n,r,o,a,s,l=p.call(arguments),c=(y._data(this,"events")||{})[e.type]||[],u=y.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,e)){for(s=y.event.handlers.call(this,e,c),i=0;(o=s[i++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,a=0;(r=o.handlers[a++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(r.namespace)||(e.handleObj=r,e.data=r.data,(n=((y.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,l))!==t&&!1===(e.result=n)&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,i){var n,r,o,a,s=[],l=i.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(!0!==c.disabled||"click"!==e.type)){for(o=[],a=0;a<l;a++)o[n=(r=i[a]).selector+" "]===t&&(o[n]=r.needsContext?y(n,this).index(c)>=0:y.find(n,this,null,[c]).length),o[n]&&o.push(r);o.length&&s.push({elem:c,handlers:o})}return l<i.length&&s.push({elem:this,handlers:i.slice(l)}),s},fix:function(e){if(e[y.expando])return e;var t,i,n,r=e.type,a=e,s=this.fixHooks[r];for(s||(this.fixHooks[r]=s=Q.test(r)?this.mouseHooks:K.test(r)?this.keyHooks:{}),n=s.props?this.props.concat(s.props):this.props,e=new y.Event(a),t=n.length;t--;)e[i=n[t]]=a[i];return e.target||(e.target=a.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,r,a,s=i.button,l=i.fromElement;return null==e.pageX&&null!=i.clientX&&(a=(r=e.target.ownerDocument||o).documentElement,n=r.body,e.pageX=i.clientX+(a&&a.scrollLeft||n&&n.scrollLeft||0)-(a&&a.clientLeft||n&&n.clientLeft||0),e.pageY=i.clientY+(a&&a.scrollTop||n&&n.scrollTop||0)-(a&&a.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&l&&(e.relatedTarget=l===e.target?i.toElement:l),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){if(y.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1}},focus:{trigger:function(){if(this!==o.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===o.activeElement&&this.blur)return this.blur(),!1},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var r=y.extend(new y.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?y.event.trigger(r,null,t):y.event.dispatch.call(t,r),r.isDefaultPrevented()&&i.preventDefault()}},y.removeEvent=o.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===r&&(e[n]=null),e.detachEvent(n,i))},y.Event=function(e,t){if(!(this instanceof y.Event))return new y.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault()?ie:ne):this.type=e,t&&y.extend(this,t),this.timeStamp=e&&e.timeStamp||y.now(),this[y.expando]=!0},y.Event.prototype={isDefaultPrevented:ne,isPropagationStopped:ne,isImmediatePropagationStopped:ne,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=ie,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=ie,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=ie,this.stopPropagation()}},y.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){y.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||y.contains(this,n))||(e.type=r.origType,i=r.handler.apply(this,arguments),e.type=t),i}}}),y.support.submitBubbles||(y.event.special.submit={setup:function(){if(y.nodeName(this,"form"))return!1;y.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,n=y.nodeName(i,"input")||y.nodeName(i,"button")?i.form:t;n&&!y._data(n,"submitBubbles")&&(y.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),y._data(n,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&y.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(y.nodeName(this,"form"))return!1;y.event.remove(this,"._submit")}}),y.support.changeBubbles||(y.event.special.change={setup:function(){if(J.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(y.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),y.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),y.event.simulate("change",this,e,!0)})),!1;y.event.add(this,"beforeactivate._change",function(e){var t=e.target;J.test(t.nodeName)&&!y._data(t,"changeBubbles")&&(y.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||y.event.simulate("change",this.parentNode,e,!0)}),y._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return y.event.remove(this,"._change"),!J.test(this.nodeName)}}),y.support.focusinBubbles||y.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){y.event.simulate(t,e.target,y.event.fix(e),!0)};y.event.special[t]={setup:function(){0==i++&&o.addEventListener(e,n,!0)},teardown:function(){0==--i&&o.removeEventListener(e,n,!0)}}}),y.fn.extend({on:function(e,i,n,r,o){var a,s;if("object"==typeof e){for(a in"string"!=typeof i&&(n=n||i,i=t),e)this.on(a,i,n,e[a],o);return this}if(null==n&&null==r?(r=i,n=i=t):null==r&&("string"==typeof i?(r=n,n=t):(r=n,n=i,i=t)),!1===r)r=ne;else if(!r)return this;return 1===o&&(s=r,(r=function(e){return y().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=y.guid++)),this.each(function(){y.event.add(this,e,r,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,y(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(o in e)this.off(o,i,e[o]);return this}return!1!==i&&"function"!=typeof i||(n=i,i=t),!1===n&&(n=ne),this.each(function(){y.event.remove(this,e,n,i)})},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},trigger:function(e,t){return this.each(function(){y.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return y.event.trigger(e,t,i,!0)}}),function(e,t){var i,n,r,o,a,s,l,c,u,h,d,p,f,m,g,v,b,x="sizzle"+-new Date,_=e.document,w={},E=0,T=0,M=te(),S=te(),C=te(),R=1<<31,A=[],P=A.pop,L=A.push,O=A.slice,I=A.indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(this[t]===e)return t;return-1},k="[\\x20\\t\\r\\n\\f]",D="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=D.replace("w","w#"),H="\\["+k+"*("+D+")"+k+"*(?:([*^$|!~]?=)"+k+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+N+")|)|)"+k+"*\\]",B=":("+D+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+H.replace(3,8)+")*)|.*)\\)|)",F=new RegExp("^"+k+"+|((?:^|[^\\\\])(?:\\\\.)*)"+k+"+$","g"),U=new RegExp("^"+k+"*,"+k+"*"),$=new RegExp("^"+k+"*([\\x20\\t\\r\\n\\f>+~])"+k+"*"),j=new RegExp(B),z=new RegExp("^"+N+"$"),V={ID:new RegExp("^#("+D+")"),CLASS:new RegExp("^\\.("+D+")"),NAME:new RegExp("^\\[name=['\"]?("+D+")['\"]?\\]"),TAG:new RegExp("^("+D.replace("w","w*")+")"),ATTR:new RegExp("^"+H),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+k+"*(even|odd|(([+-]|)(\\d*)n|)"+k+"*(?:([+-]|)"+k+"*(\\d+)|))"+k+"*\\)|)","i"),needsContext:new RegExp("^"+k+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+k+"*((?:-\\d)?\\d*)"+k+"*\\)|)(?=[^-]|$)","i")},G=/[\x20\t\r\n\f]*[+~]/,W=/^[^{]+\{\s*\[native code/,q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,X=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,Y=/'|\\/g,J=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,K=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,Q=function(e,t){var i="0x"+t-65536;return i!=i?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{O.call(_.documentElement.childNodes,0)[0].nodeType}catch(e){O=function(e){for(var t,i=[];t=this[e++];)i.push(t);return i}}function ee(e){return W.test(e+"")}function te(){var e,t=[];return e=function(i,n){return t.push(i+=" ")>r.cacheLength&&delete e[t.shift()],e[i]=n}}function ie(e){return e[x]=!0,e}function ne(e){var t=h.createElement("div");try{return e(t)}catch(e){return!1}finally{t=null}}function re(e,t,i,n){var o,a,l,c,d,m,g,y,b,E;if((t?t.ownerDocument||t:_)!==h&&u(t),t=t||h,i=i||[],!e||"string"!=typeof e)return i;if(1!==(c=t.nodeType)&&9!==c)return[];if(!p&&!n){if(o=q.exec(e))if(l=o[1]){if(9===c){if(!(a=t.getElementById(l))||!a.parentNode)return i;if(a.id===l)return i.push(a),i}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(l))&&v(t,a)&&a.id===l)return i.push(a),i}else{if(o[2])return L.apply(i,O.call(t.getElementsByTagName(e),0)),i;if((l=o[3])&&w.getByClassName&&t.getElementsByClassName)return L.apply(i,O.call(t.getElementsByClassName(l),0)),i}if(w.qsa&&!f.test(e)){if(g=!0,y=x,b=t,E=9===c&&e,1===c&&"object"!==t.nodeName.toLowerCase()){for(m=ce(e),(g=t.getAttribute("id"))?y=g.replace(Y,"\\$&"):t.setAttribute("id",y),y="[id='"+y+"'] ",d=m.length;d--;)m[d]=y+ue(m[d]);b=G.test(e)&&t.parentNode||t,E=m.join(",")}if(E)try{return L.apply(i,O.call(b.querySelectorAll(E),0)),i}catch(e){}finally{g||t.removeAttribute("id")}}}return function(e,t,i,n){var o,a,l,c,u,h=ce(e);if(!n&&1===h.length){if((a=h[0]=h[0].slice(0)).length>2&&"ID"===(l=a[0]).type&&9===t.nodeType&&!p&&r.relative[a[1].type]){if(!(t=r.find.ID(l.matches[0].replace(K,Q),t)[0]))return i;e=e.slice(a.shift().value.length)}for(o=V.needsContext.test(e)?0:a.length;o--&&(l=a[o],!r.relative[c=l.type]);)if((u=r.find[c])&&(n=u(l.matches[0].replace(K,Q),G.test(a[0].type)&&t.parentNode||t))){if(a.splice(o,1),!(e=n.length&&ue(a)))return L.apply(i,O.call(n,0)),i;break}}return s(e,h)(n,t,p,i,G.test(e)),i}(e.replace(F,"$1"),t,i,n)}function oe(e,t){var i=t&&e,n=i&&(~t.sourceIndex||R)-(~e.sourceIndex||R);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function ae(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function se(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function le(e){return ie(function(t){return t=+t,ie(function(i,n){for(var r,o=e([],i.length,t),a=o.length;a--;)i[r=o[a]]&&(i[r]=!(n[r]=i[r]))})})}for(i in a=re.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},u=re.setDocument=function(e){var t=e?e.ownerDocument||e:_;return t!==h&&9===t.nodeType&&t.documentElement?(h=t,d=t.documentElement,p=a(t),w.tagNameNoComments=ne(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),w.attributes=ne(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),w.getByClassName=ne(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!(!e.getElementsByClassName||!e.getElementsByClassName("e").length)&&(e.lastChild.className="e",2===e.getElementsByClassName("e").length)}),w.getByName=ne(function(e){e.id=x+0,e.innerHTML="<a name='"+x+"'></a><div name='"+x+"'></div>",d.insertBefore(e,d.firstChild);var i=t.getElementsByName&&t.getElementsByName(x).length===2+t.getElementsByName(x+0).length;return w.getIdNotName=!t.getElementById(x),d.removeChild(e),i}),r.attrHandle=ne(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&void 0!==e.firstChild.getAttribute&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},w.getIdNotName?(r.find.ID=function(e,t){if(void 0!==t.getElementById&&!p){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},r.filter.ID=function(e){var t=e.replace(K,Q);return function(e){return e.getAttribute("id")===t}}):(r.find.ID=function(e,t){if(void 0!==t.getElementById&&!p){var i=t.getElementById(e);return i?i.id===e||void 0!==i.getAttributeNode&&i.getAttributeNode("id").value===e?[i]:void 0:[]}},r.filter.ID=function(e){var t=e.replace(K,Q);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),r.find.TAG=w.tagNameNoComments?function(e,t){if(void 0!==t.getElementsByTagName)return t.getElementsByTagName(e)}:function(e,t){var i,n=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},r.find.NAME=w.getByName&&function(e,t){if(void 0!==t.getElementsByName)return t.getElementsByName(name)},r.find.CLASS=w.getByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&!p)return t.getElementsByClassName(e)},m=[],f=[":focus"],(w.qsa=ee(t.querySelectorAll))&&(ne(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||f.push("\\["+k+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||f.push(":checked")}),ne(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&f.push("[*^$]="+k+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||f.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),f.push(",.*:")})),(w.matchesSelector=ee(g=d.matchesSelector||d.mozMatchesSelector||d.webkitMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ne(function(e){w.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",B)}),f=new RegExp(f.join("|")),m=new RegExp(m.join("|")),v=ee(d.contains)||d.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},b=d.compareDocumentPosition?function(e,i){var n;return e===i?(l=!0,0):(n=i.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(i))?1&n||e.parentNode&&11===e.parentNode.nodeType?e===t||v(_,e)?-1:i===t||v(_,i)?1:0:4&n?-1:1:e.compareDocumentPosition?-1:1}:function(e,i){var n,r=0,o=e.parentNode,a=i.parentNode,s=[e],c=[i];if(e===i)return l=!0,0;if(!o||!a)return e===t?-1:i===t?1:o?-1:a?1:0;if(o===a)return oe(e,i);for(n=e;n=n.parentNode;)s.unshift(n);for(n=i;n=n.parentNode;)c.unshift(n);for(;s[r]===c[r];)r++;return r?oe(s[r],c[r]):s[r]===_?-1:c[r]===_?1:0},l=!1,[0,0].sort(b),w.detectDuplicates=l,h):h},re.matches=function(e,t){return re(e,null,null,t)},re.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&u(e),t=t.replace(J,"='$1']"),w.matchesSelector&&!p&&(!m||!m.test(t))&&!f.test(t))try{var i=g.call(e,t);if(i||w.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){}return re(t,h,null,[e]).length>0},re.contains=function(e,t){return(e.ownerDocument||e)!==h&&u(e),v(e,t)},re.attr=function(e,t){var i;return(e.ownerDocument||e)!==h&&u(e),p||(t=t.toLowerCase()),(i=r.attrHandle[t])?i(e):p||w.attributes?e.getAttribute(t):((i=e.getAttributeNode(t))||e.getAttribute(t))&&!0===e[t]?t:i&&i.specified?i.value:null},re.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},re.uniqueSort=function(e){var t,i=[],n=1,r=0;if(l=!w.detectDuplicates,e.sort(b),l){for(;t=e[n];n++)t===e[n-1]&&(r=i.push(n));for(;r--;)e.splice(i[r],1)}return e},o=re.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=o(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n];n++)i+=o(t);return i},r=re.selectors={cacheLength:50,createPseudo:ie,match:V,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(K,Q),e[3]=(e[4]||e[5]||"").replace(K,Q),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||re.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&re.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return V.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:i&&j.test(i)&&(t=ce(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(K,Q).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=M[e+" "];return t||(t=new RegExp("(^|"+k+")"+e+"("+k+"|$)"))&&M(e,function(e){return t.test(e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(n){var r=re.attr(n,e);return null==r?"!="===t:!t||(r+="","="===t?r===i:"!="===t?r!==i:"^="===t?i&&0===r.indexOf(i):"*="===t?i&&r.indexOf(i)>-1:"$="===t?i&&r.slice(-i.length)===i:"~="===t?(" "+r+" ").indexOf(i)>-1:"|="===t&&(r===i||r.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,i,n,r){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,i,l){var c,u,h,d,p,f,m=o!==a?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s;if(g){if(o){for(;m;){for(h=t;h=h[m];)if(s?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&y){for(p=(c=(u=g[x]||(g[x]={}))[e]||[])[0]===E&&c[1],d=c[0]===E&&c[2],h=p&&g.childNodes[p];h=++p&&h&&h[m]||(d=p=0)||f.pop();)if(1===h.nodeType&&++d&&h===t){u[e]=[E,p,d];break}}else if(y&&(c=(t[x]||(t[x]={}))[e])&&c[0]===E)d=c[1];else for(;(h=++p&&h&&h[m]||(d=p=0)||f.pop())&&((s?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(y&&((h[x]||(h[x]={}))[e]=[E,d]),h!==t)););return(d-=r)===n||d%n==0&&d/n>=0}}},PSEUDO:function(e,t){var i,n=r.pseudos[e]||r.setFilters[e.toLowerCase()]||re.error("unsupported pseudo: "+e);return n[x]?n(t):n.length>1?(i=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ie(function(e,i){for(var r,o=n(e,t),a=o.length;a--;)e[r=I.call(e,o[a])]=!(i[r]=o[a])}):function(e){return n(e,0,i)}):n}},pseudos:{not:ie(function(e){var t=[],i=[],n=s(e.replace(F,"$1"));return n[x]?ie(function(e,t,i,r){for(var o,a=n(e,null,r,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,r,o){return t[0]=e,n(t,null,o,i),!i.pop()}}),has:ie(function(e){return function(t){return re(e,t).length>0}}),contains:ie(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ie(function(e){return z.test(e||"")||re.error("unsupported lang: "+e),e=e.replace(K,Q).toLowerCase(),function(t){var i;do{if(i=p?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return(i=i.toLowerCase())===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return X.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:le(function(){return[0]}),last:le(function(e,t){return[t-1]}),eq:le(function(e,t,i){return[i<0?i+t:i]}),even:le(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:le(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:le(function(e,t,i){for(var n=i<0?i+t:i;--n>=0;)e.push(n);return e}),gt:le(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}},{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[i]=ae(i);for(i in{submit:!0,reset:!0})r.pseudos[i]=se(i);function ce(e,t){var i,n,o,a,s,l,c,u=S[e+" "];if(u)return t?0:u.slice(0);for(s=e,l=[],c=r.preFilter;s;){for(a in i&&!(n=U.exec(s))||(n&&(s=s.slice(n[0].length)||s),l.push(o=[])),i=!1,(n=$.exec(s))&&(i=n.shift(),o.push({value:i,type:n[0].replace(F," ")}),s=s.slice(i.length)),r.filter)!(n=V[a].exec(s))||c[a]&&!(n=c[a](n))||(i=n.shift(),o.push({value:i,type:a,matches:n}),s=s.slice(i.length));if(!i)break}return t?s.length:s?re.error(e):S(e,l).slice(0)}function ue(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function he(e,t,i){var r=t.dir,o=i&&"parentNode"===r,a=T++;return t.first?function(t,i,n){for(;t=t[r];)if(1===t.nodeType||o)return e(t,i,n)}:function(t,i,s){var l,c,u,h=E+" "+a;if(s){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,i,s))return!0}else for(;t=t[r];)if(1===t.nodeType||o)if((c=(u=t[x]||(t[x]={}))[r])&&c[0]===h){if(!0===(l=c[1])||l===n)return!0===l}else if((c=u[r]=[h])[1]=e(t,i,s)||n,!0===c[1])return!0}}function de(e){return e.length>1?function(t,i,n){for(var r=e.length;r--;)if(!e[r](t,i,n))return!1;return!0}:e[0]}function pe(e,t,i,n,r){for(var o,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(o=e[s])&&(i&&!i(o,n,r)||(a.push(o),c&&t.push(s)));return a}function fe(e,t,i,n,r,o){return n&&!n[x]&&(n=fe(n)),r&&!r[x]&&(r=fe(r,o)),ie(function(o,a,s,l){var c,u,h,d=[],p=[],f=a.length,m=o||function(e,t,i){for(var n=0,r=t.length;n<r;n++)re(e,t[n],i);return i}(t||"*",s.nodeType?[s]:s,[]),g=!e||!o&&t?m:pe(m,d,e,s,l),v=i?r||(o?e:f||n)?[]:a:g;if(i&&i(g,v,s,l),n)for(c=pe(v,p),n(c,[],s,l),u=c.length;u--;)(h=c[u])&&(v[p[u]]=!(g[p[u]]=h));if(o){if(r||e){if(r){for(c=[],u=v.length;u--;)(h=v[u])&&c.push(g[u]=h);r(null,v=[],c,l)}for(u=v.length;u--;)(h=v[u])&&(c=r?I.call(o,h):d[u])>-1&&(o[c]=!(a[c]=h))}}else v=pe(v===a?v.splice(f,v.length):v),r?r(null,a,v,l):L.apply(a,v)})}function me(e){for(var t,i,n,o=e.length,a=r.relative[e[0].type],s=a||r.relative[" "],l=a?1:0,u=he(function(e){return e===t},s,!0),h=he(function(e){return I.call(t,e)>-1},s,!0),d=[function(e,i,n){return!a&&(n||i!==c)||((t=i).nodeType?u(e,i,n):h(e,i,n))}];l<o;l++)if(i=r.relative[e[l].type])d=[he(de(d),i)];else{if((i=r.filter[e[l].type].apply(null,e[l].matches))[x]){for(n=++l;n<o&&!r.relative[e[n].type];n++);return fe(l>1&&de(d),l>1&&ue(e.slice(0,l-1)).replace(F,"$1"),i,l<n&&me(e.slice(l,n)),n<o&&me(e=e.slice(n)),n<o&&ue(e))}d.push(i)}return de(d)}function ge(){}s=re.compile=function(e,t){var i,o=[],a=[],s=C[e+" "];if(!s){for(t||(t=ce(e)),i=t.length;i--;)(s=me(t[i]))[x]?o.push(s):a.push(s);s=C(e,function(e,t){var i=0,o=t.length>0,a=e.length>0,s=function(s,l,u,d,p){var f,m,g,v=[],y=0,b="0",x=s&&[],_=null!=p,w=c,T=s||a&&r.find.TAG("*",p&&l.parentNode||l),M=E+=null==w?1:Math.random()||.1;for(_&&(c=l!==h&&l,n=i);null!=(f=T[b]);b++){if(a&&f){for(m=0;g=e[m++];)if(g(f,l,u)){d.push(f);break}_&&(E=M,n=++i)}o&&((f=!g&&f)&&y--,s&&x.push(f))}if(y+=b,o&&b!==y){for(m=0;g=t[m++];)g(x,v,l,u);if(s){if(y>0)for(;b--;)x[b]||v[b]||(v[b]=P.call(d));v=pe(v)}L.apply(d,v),_&&!s&&v.length>0&&y+t.length>1&&re.uniqueSort(d)}return _&&(E=M,c=w),x};return o?ie(s):s}(a,o))}return s},r.pseudos.nth=r.pseudos.eq,r.filters=ge.prototype=r.pseudos,r.setFilters=new ge,u(),re.attr=y.attr,y.find=re,y.expr=re.selectors,y.expr[":"]=y.expr.pseudos,y.unique=re.uniqueSort,y.text=re.getText,y.isXMLDoc=re.isXML,y.contains=re.contains}(e);var re=/Until$/,oe=/^(?:parents|prev(?:Until|All))/,ae=/^.[^:#\[\.,]*$/,se=y.expr.match.needsContext,le={children:!0,contents:!0,next:!0,prev:!0};function ce(e,t){do{e=e[t]}while(e&&1!==e.nodeType);return e}function ue(e,t,i){if(t=t||0,y.isFunction(t))return y.grep(e,function(e,n){return!!t.call(e,n,e)===i});if(t.nodeType)return y.grep(e,function(e){return e===t===i});if("string"==typeof t){var n=y.grep(e,function(e){return 1===e.nodeType});if(ae.test(t))return y.filter(t,n,!i);t=y.filter(t,n)}return y.grep(e,function(e){return y.inArray(e,t)>=0===i})}function he(e){var t=de.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}y.fn.extend({find:function(e){var t,i,n,r=this.length;if("string"!=typeof e)return n=this,this.pushStack(y(e).filter(function(){for(t=0;t<r;t++)if(y.contains(n[t],this))return!0}));for(i=[],t=0;t<r;t++)y.find(e,this[t],i);return(i=this.pushStack(r>1?y.unique(i):i)).selector=(this.selector?this.selector+" ":"")+e,i},has:function(e){var t,i=y(e,this),n=i.length;return this.filter(function(){for(t=0;t<n;t++)if(y.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(ue(this,e,!1))},filter:function(e){return this.pushStack(ue(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?se.test(e)?y(e,this.context).index(this[0])>=0:y.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var i,n=0,r=this.length,o=[],a=se.test(e)||"string"!=typeof e?y(e,t||this.context):0;n<r;n++)for(i=this[n];i&&i.ownerDocument&&i!==t&&11!==i.nodeType;){if(a?a.index(i)>-1:y.find.matchesSelector(i,e)){o.push(i);break}i=i.parentNode}return this.pushStack(o.length>1?y.unique(o):o)},index:function(e){return e?"string"==typeof e?y.inArray(this[0],y(e)):y.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?y(e,t):y.makeArray(e&&e.nodeType?[e]:e),n=y.merge(this.get(),i);return this.pushStack(y.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),y.fn.andSelf=y.fn.addBack,y.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return y.dir(e,"parentNode")},parentsUntil:function(e,t,i){return y.dir(e,"parentNode",i)},next:function(e){return ce(e,"nextSibling")},prev:function(e){return ce(e,"previousSibling")},nextAll:function(e){return y.dir(e,"nextSibling")},prevAll:function(e){return y.dir(e,"previousSibling")},nextUntil:function(e,t,i){return y.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return y.dir(e,"previousSibling",i)},siblings:function(e){return y.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return y.sibling(e.firstChild)},contents:function(e){return y.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:y.merge([],e.childNodes)}},function(e,t){y.fn[e]=function(i,n){var r=y.map(this,t,i);return re.test(e)||(n=i),n&&"string"==typeof n&&(r=y.filter(n,r)),r=this.length>1&&!le[e]?y.unique(r):r,this.length>1&&oe.test(e)&&(r=r.reverse()),this.pushStack(r)}}),y.extend({filter:function(e,t,i){return i&&(e=":not("+e+")"),1===t.length?y.find.matchesSelector(t[0],e)?[t[0]]:[]:y.find.matches(e,t)},dir:function(e,i,n){for(var r=[],o=e[i];o&&9!==o.nodeType&&(n===t||1!==o.nodeType||!y(o).is(n));)1===o.nodeType&&r.push(o),o=o[i];return r},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var de="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",pe=/ jQuery\d+="(?:null|\d+)"/g,fe=new RegExp("<(?:"+de+")[\\s/>]","i"),me=/^\s+/,ge=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ve=/<([\w:]+)/,ye=/<tbody/i,be=/<|&#?\w+;/,xe=/<(?:script|style|link)/i,_e=/^(?:checkbox|radio)$/i,we=/checked\s*(?:[^=]|=\s*.checked.)/i,Ee=/^$|\/(?:java|ecma)script/i,Te=/^true\/(.*)/,Me=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Se={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:y.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Ce=he(o).appendChild(o.createElement("div"));function Re(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function Ae(e){var t=Te.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Pe(e,t){for(var i,n=0;null!=(i=e[n]);n++)y._data(i,"globalEval",!t||y._data(t[n],"globalEval"))}function Le(e,t){if(1===t.nodeType&&y.hasData(e)){var i,n,r,o=y._data(e),a=y._data(t,o),s=o.events;if(s)for(i in delete a.handle,a.events={},s)for(n=0,r=s[i].length;n<r;n++)y.event.add(t,i,s[i][n]);a.data&&(a.data=y.extend({},a.data))}}function Oe(e,t){var i,n,r;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!y.support.noCloneEvent&&t[y.expando]){for(n in(r=y._data(t)).events)y.removeEvent(t,n,r.handle);t.removeAttribute(y.expando)}"script"===i&&t.text!==e.text?(Re(t).text=e.text,Ae(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),y.support.html5Clone&&e.innerHTML&&!y.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&_e.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}}function Ie(e,i){var n,o,a=0,s=typeof e.getElementsByTagName!==r?e.getElementsByTagName(i||"*"):typeof e.querySelectorAll!==r?e.querySelectorAll(i||"*"):t;if(!s)for(s=[],n=e.childNodes||e;null!=(o=n[a]);a++)!i||y.nodeName(o,i)?s.push(o):y.merge(s,Ie(o,i));return i===t||i&&y.nodeName(e,i)?y.merge([e],s):s}function ke(e){_e.test(e.type)&&(e.defaultChecked=e.checked)}Se.optgroup=Se.option,Se.tbody=Se.tfoot=Se.colgroup=Se.caption=Se.thead,Se.th=Se.td,y.fn.extend({text:function(e){return y.access(this,function(e){return e===t?y.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(y.isFunction(e))return this.each(function(t){y(this).wrapAll(e.call(this,t))});if(this[0]){var t=y(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return y.isFunction(e)?this.each(function(t){y(this).wrapInner(e.call(this,t))}):this.each(function(){var t=y(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=y.isFunction(e);return this.each(function(i){y(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){y.nodeName(this,"body")||y(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=0;null!=(i=this[n]);n++)(!e||y.filter(e,[i]).length>0)&&(t||1!==i.nodeType||y.cleanData(Ie(i)),i.parentNode&&(t&&y.contains(i.ownerDocument,i)&&Pe(Ie(i,"script")),i.parentNode.removeChild(i)));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&y.cleanData(Ie(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&y.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return y.clone(this,e,t)})},html:function(e){return y.access(this,function(e){var i=this[0]||{},n=0,r=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(pe,""):t;if("string"==typeof e&&!xe.test(e)&&(y.support.htmlSerialize||!fe.test(e))&&(y.support.leadingWhitespace||!me.test(e))&&!Se[(ve.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(ge,"<$1></$2>");try{for(;n<r;n++)1===(i=this[n]||{}).nodeType&&(y.cleanData(Ie(i,!1)),i.innerHTML=e);i=0}catch(e){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return y.isFunction(e)||"string"==typeof e||(e=y(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,i=this.parentNode;i&&(y(this).remove(),i.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,i,n){e=h.apply([],e);var r,o,a,s,l,c,u,d,p=0,f=this.length,m=this,g=f-1,v=e[0],b=y.isFunction(v);if(b||!(f<=1||"string"!=typeof v||y.support.checkClone)&&we.test(v))return this.each(function(r){var o=m.eq(r);b&&(e[0]=v.call(this,r,i?o.html():t)),o.domManip(e,i,n)});if(f&&(r=(c=y.buildFragment(e,this[0].ownerDocument,!1,this)).firstChild,1===c.childNodes.length&&(c=r),r)){for(i=i&&y.nodeName(r,"tr"),a=(s=y.map(Ie(c,"script"),Re)).length;p<f;p++)o=c,p!==g&&(o=y.clone(o,!0,!0),a&&y.merge(s,Ie(o,"script"))),n.call(i&&y.nodeName(this[p],"table")?(u=this[p],d="tbody",u.getElementsByTagName(d)[0]||u.appendChild(u.ownerDocument.createElement(d))):this[p],o,p);if(a)for(l=s[s.length-1].ownerDocument,y.map(s,Ae),p=0;p<a;p++)o=s[p],Ee.test(o.type||"")&&!y._data(o,"globalEval")&&y.contains(l,o)&&(o.src?y.ajax({url:o.src,type:"GET",dataType:"script",async:!1,global:!1,throws:!0}):y.globalEval((o.text||o.textContent||o.innerHTML||"").replace(Me,"")));c=r=null}return this}}),y.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){y.fn[e]=function(e){for(var i,n=0,r=[],o=y(e),a=o.length-1;n<=a;n++)i=n===a?this:this.clone(!0),y(o[n])[t](i),d.apply(r,i.get());return this.pushStack(r)}}),y.extend({clone:function(e,t,i){var n,r,o,a,s,l=y.contains(e.ownerDocument,e);if(y.support.html5Clone||y.isXMLDoc(e)||!fe.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Ce.innerHTML=e.outerHTML,Ce.removeChild(o=Ce.firstChild)),!(y.support.noCloneEvent&&y.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||y.isXMLDoc(e)))for(n=Ie(o),s=Ie(e),a=0;null!=(r=s[a]);++a)n[a]&&Oe(r,n[a]);if(t)if(i)for(s=s||Ie(e),n=n||Ie(o),a=0;null!=(r=s[a]);a++)Le(r,n[a]);else Le(e,o);return(n=Ie(o,"script")).length>0&&Pe(n,!l&&Ie(e,"script")),n=s=r=null,o},buildFragment:function(e,t,i,n){for(var r,o,a,s,l,c,u,h=e.length,d=he(t),p=[],f=0;f<h;f++)if((o=e[f])||0===o)if("object"===y.type(o))y.merge(p,o.nodeType?[o]:o);else if(be.test(o)){for(s=s||d.appendChild(t.createElement("div")),l=(ve.exec(o)||["",""])[1].toLowerCase(),u=Se[l]||Se._default,s.innerHTML=u[1]+o.replace(ge,"<$1></$2>")+u[2],r=u[0];r--;)s=s.lastChild;if(!y.support.leadingWhitespace&&me.test(o)&&p.push(t.createTextNode(me.exec(o)[0])),!y.support.tbody)for(r=(o="table"!==l||ye.test(o)?"<table>"!==u[1]||ye.test(o)?0:s:s.firstChild)&&o.childNodes.length;r--;)y.nodeName(c=o.childNodes[r],"tbody")&&!c.childNodes.length&&o.removeChild(c);for(y.merge(p,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=d.lastChild}else p.push(t.createTextNode(o));for(s&&d.removeChild(s),y.support.appendChecked||y.grep(Ie(p,"input"),ke),f=0;o=p[f++];)if((!n||-1===y.inArray(o,n))&&(a=y.contains(o.ownerDocument,o),s=Ie(d.appendChild(o),"script"),a&&Pe(s),i))for(r=0;o=s[r++];)Ee.test(o.type||"")&&i.push(o);return s=null,d},cleanData:function(e,t){for(var i,n,o,a,s=0,l=y.expando,c=y.cache,h=y.support.deleteExpando,d=y.event.special;null!=(i=e[s]);s++)if((t||y.acceptData(i))&&(a=(o=i[l])&&c[o])){if(a.events)for(n in a.events)d[n]?y.event.remove(i,n):y.removeEvent(i,n,a.handle);c[o]&&(delete c[o],h?delete i[l]:typeof i.removeAttribute!==r?i.removeAttribute(l):i[l]=null,u.push(o))}}});var De,Ne,He,Be=/alpha\([^)]*\)/i,Fe=/opacity\s*=\s*([^)]*)/,Ue=/^(top|right|bottom|left)$/,$e=/^(none|table(?!-c[ea]).+)/,je=/^margin/,ze=new RegExp("^("+b+")(.*)$","i"),Ve=new RegExp("^("+b+")(?!px)[a-z%]+$","i"),Ge=new RegExp("^([+-])=("+b+")","i"),We={BODY:"block"},qe={position:"absolute",visibility:"hidden",display:"block"},Xe={letterSpacing:0,fontWeight:400},Ze=["Top","Right","Bottom","Left"],Ye=["Webkit","O","Moz","ms"];function Je(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,r=Ye.length;r--;)if((t=Ye[r]+i)in e)return t;return n}function Ke(e,t){return e=t||e,"none"===y.css(e,"display")||!y.contains(e.ownerDocument,e)}function Qe(e,t){for(var i,n,r,o=[],a=0,s=e.length;a<s;a++)(n=e[a]).style&&(o[a]=y._data(n,"olddisplay"),i=n.style.display,t?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&Ke(n)&&(o[a]=y._data(n,"olddisplay",nt(n.nodeName)))):o[a]||(r=Ke(n),(i&&"none"!==i||!r)&&y._data(n,"olddisplay",r?i:y.css(n,"display"))));for(a=0;a<s;a++)(n=e[a]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[a]||"":"none"));return e}function et(e,t,i){var n=ze.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function tt(e,t,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===i&&(a+=y.css(e,i+Ze[o],!0,r)),n?("content"===i&&(a-=y.css(e,"padding"+Ze[o],!0,r)),"margin"!==i&&(a-=y.css(e,"border"+Ze[o]+"Width",!0,r))):(a+=y.css(e,"padding"+Ze[o],!0,r),"padding"!==i&&(a+=y.css(e,"border"+Ze[o]+"Width",!0,r)));return a}function it(e,t,i){var n=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=Ne(e),a=y.support.boxSizing&&"border-box"===y.css(e,"boxSizing",!1,o);if(r<=0||null==r){if(((r=He(e,t,o))<0||null==r)&&(r=e.style[t]),Ve.test(r))return r;n=a&&(y.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+tt(e,t,i||(a?"border":"content"),n,o)+"px"}function nt(e){var t=o,i=We[e];return i||("none"!==(i=rt(e,t))&&i||((t=((De=(De||y("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement))[0].contentWindow||De[0].contentDocument).document).write("<!doctype html><html><body>"),t.close(),i=rt(e,t),De.detach()),We[e]=i),i}function rt(e,t){var i=y(t.createElement(e)).appendTo(t.body),n=y.css(i[0],"display");return i.remove(),n}y.fn.extend({css:function(e,i){return y.access(this,function(e,i,n){var r,o,a={},s=0;if(y.isArray(i)){for(o=Ne(e),r=i.length;s<r;s++)a[i[s]]=y.css(e,i[s],!1,o);return a}return n!==t?y.style(e,i,n):y.css(e,i)},e,i,arguments.length>1)},show:function(){return Qe(this,!0)},hide:function(){return Qe(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:Ke(this))?y(this).show():y(this).hide()})}}),y.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=He(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:y.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=y.camelCase(i),c=e.style;if(i=y.cssProps[l]||(y.cssProps[l]=Je(c,l)),s=y.cssHooks[i]||y.cssHooks[l],n===t)return s&&"get"in s&&(o=s.get(e,!1,r))!==t?o:c[i];if(!("string"===(a=typeof n)&&(o=Ge.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(y.css(e,i)),a="number"),null==n||"number"===a&&isNaN(n)||("number"!==a||y.cssNumber[l]||(n+="px"),y.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(c[i]="inherit"),s&&"set"in s&&(n=s.set(e,n,r))===t)))try{c[i]=n}catch(e){}}},css:function(e,i,n,r){var o,a,s,l=y.camelCase(i);return i=y.cssProps[l]||(y.cssProps[l]=Je(e.style,l)),(s=y.cssHooks[i]||y.cssHooks[l])&&"get"in s&&(a=s.get(e,!0,n)),a===t&&(a=He(e,i,r)),"normal"===a&&i in Xe&&(a=Xe[i]),""===n||n?(o=parseFloat(a),!0===n||y.isNumeric(o)?o||0:a):a},swap:function(e,t,i,n){var r,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];for(o in r=i.apply(e,n||[]),t)e.style[o]=a[o];return r}}),e.getComputedStyle?(Ne=function(t){return e.getComputedStyle(t,null)},He=function(e,i,n){var r,o,a,s=n||Ne(e),l=s?s.getPropertyValue(i)||s[i]:t,c=e.style;return s&&(""!==l||y.contains(e.ownerDocument,e)||(l=y.style(e,i)),Ve.test(l)&&je.test(i)&&(r=c.width,o=c.minWidth,a=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=s.width,c.width=r,c.minWidth=o,c.maxWidth=a)),l}):o.documentElement.currentStyle&&(Ne=function(e){return e.currentStyle},He=function(e,i,n){var r,o,a,s=n||Ne(e),l=s?s[i]:t,c=e.style;return null==l&&c&&c[i]&&(l=c[i]),Ve.test(l)&&!Ue.test(i)&&(r=c.left,(a=(o=e.runtimeStyle)&&o.left)&&(o.left=e.currentStyle.left),c.left="fontSize"===i?"1em":l,l=c.pixelLeft+"px",c.left=r,a&&(o.left=a)),""===l?"auto":l}),y.each(["height","width"],function(e,t){y.cssHooks[t]={get:function(e,i,n){if(i)return 0===e.offsetWidth&&$e.test(y.css(e,"display"))?y.swap(e,qe,function(){return it(e,t,n)}):it(e,t,n)},set:function(e,i,n){var r=n&&Ne(e);return et(0,i,n?tt(e,t,n,y.support.boxSizing&&"border-box"===y.css(e,"boxSizing",!1,r),r):0)}}}),y.support.opacity||(y.cssHooks.opacity={get:function(e,t){return Fe.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,r=y.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=n&&n.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===y.trim(o.replace(Be,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=Be.test(o)?o.replace(Be,r):o+" "+r)}}),y(function(){y.support.reliableMarginRight||(y.cssHooks.marginRight={get:function(e,t){if(t)return y.swap(e,{display:"inline-block"},He,[e,"marginRight"])}}),!y.support.pixelPosition&&y.fn.position&&y.each(["top","left"],function(e,t){y.cssHooks[t]={get:function(e,i){if(i)return i=He(e,t),Ve.test(i)?y(e).position()[t]+"px":i}}})}),y.expr&&y.expr.filters&&(y.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!y.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||y.css(e,"display"))},y.expr.filters.visible=function(e){return!y.expr.filters.hidden(e)}),y.each({margin:"",padding:"",border:"Width"},function(e,t){y.cssHooks[e+t]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];n<4;n++)r[e+Ze[n]+t]=o[n]||o[n-2]||o[0];return r}},je.test(e)||(y.cssHooks[e+t].set=et)});var ot=/%20/g,at=/\[\]$/,st=/\r?\n/g,lt=/^(?:submit|button|image|reset|file)$/i,ct=/^(?:input|select|textarea|keygen)/i;function ut(e,t,i,n){var r;if(y.isArray(t))y.each(t,function(t,r){i||at.test(e)?n(e,r):ut(e+"["+("object"==typeof r?t:"")+"]",r,i,n)});else if(i||"object"!==y.type(t))n(e,t);else for(r in t)ut(e+"["+r+"]",t[r],i,n)}y.fn.extend({serialize:function(){return y.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=y.prop(this,"elements");return e?y.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!y(this).is(":disabled")&&ct.test(this.nodeName)&&!lt.test(e)&&(this.checked||!_e.test(e))}).map(function(e,t){var i=y(this).val();return null==i?null:y.isArray(i)?y.map(i,function(e){return{name:t.name,value:e.replace(st,"\r\n")}}):{name:t.name,value:i.replace(st,"\r\n")}}).get()}}),y.param=function(e,i){var n,r=[],o=function(e,t){t=y.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=y.ajaxSettings&&y.ajaxSettings.traditional),y.isArray(e)||e.jquery&&!y.isPlainObject(e))y.each(e,function(){o(this.name,this.value)});else for(n in e)ut(n,e[n],i,o);return r.join("&").replace(ot,"+")},y.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){y.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),y.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var ht,dt,pt=y.now(),ft=/\?/,mt=/#.*$/,gt=/([?&])_=[^&]*/,vt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,yt=/^(?:GET|HEAD)$/,bt=/^\/\//,xt=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_t=y.fn.load,wt={},Et={},Tt="*/".concat("*");try{dt=a.href}catch(e){(dt=o.createElement("a")).href="",dt=dt.href}function Mt(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,r=0,o=t.toLowerCase().match(x)||[];if(y.isFunction(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function St(e,t,i,n){var r={},o=e===Et;function a(s){var l;return r[s]=!0,y.each(e[s]||[],function(e,s){var c=s(t,i,n);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),a(c),!1)}),l}return a(t.dataTypes[0])||!r["*"]&&a("*")}function Ct(e,i){var n,r,o=y.ajaxSettings.flatOptions||{};for(r in i)i[r]!==t&&((o[r]?e:n||(n={}))[r]=i[r]);return n&&y.extend(!0,e,n),e}ht=xt.exec(dt.toLowerCase())||[],y.fn.load=function(e,i,n){if("string"!=typeof e&&_t)return _t.apply(this,arguments);var r,o,a,s=this,l=e.indexOf(" ");return l>=0&&(r=e.slice(l,e.length),e=e.slice(0,l)),y.isFunction(i)?(n=i,i=t):i&&"object"==typeof i&&(a="POST"),s.length>0&&y.ajax({url:e,type:a,dataType:"html",data:i}).done(function(e){o=arguments,s.html(r?y("<div>").append(y.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},y.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){y.fn[t]=function(e){return this.on(t,e)}}),y.each(["get","post"],function(e,i){y[i]=function(e,n,r,o){return y.isFunction(n)&&(o=o||r,r=n,n=t),y.ajax({url:e,type:i,dataType:o,data:n,success:r})}}),y.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:dt,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ht[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Tt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":y.parseJSON,"text xml":y.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ct(Ct(e,y.ajaxSettings),t):Ct(y.ajaxSettings,e)},ajaxPrefilter:Mt(wt),ajaxTransport:Mt(Et),ajax:function(e,i){"object"==typeof e&&(i=e,e=t),i=i||{};var n,r,o,a,s,l,c,u,h=y.ajaxSetup({},i),d=h.context||h,p=h.context&&(d.nodeType||d.jquery)?y(d):y.event,f=y.Deferred(),m=y.Callbacks("once memory"),g=h.statusCode||{},v={},b={},_=0,w="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===_){if(!u)for(u={};t=vt.exec(a);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===_?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return _||(e=b[i]=b[i]||e,v[e]=t),this},overrideMimeType:function(e){return _||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(_<2)for(t in e)g[t]=[g[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||w;return c&&c.abort(t),T(0,t),this}};if(f.promise(E).complete=m.add,E.success=E.done,E.error=E.fail,h.url=((e||h.url||dt)+"").replace(mt,"").replace(bt,ht[1]+"//"),h.type=i.method||i.type||h.method||h.type,h.dataTypes=y.trim(h.dataType||"*").toLowerCase().match(x)||[""],null==h.crossDomain&&(n=xt.exec(h.url.toLowerCase()),h.crossDomain=!(!n||n[1]===ht[1]&&n[2]===ht[2]&&(n[3]||("http:"===n[1]?80:443))==(ht[3]||("http:"===ht[1]?80:443)))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=y.param(h.data,h.traditional)),St(wt,h,i,E),2===_)return E;for(r in(l=h.global)&&0==y.active++&&y.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!yt.test(h.type),o=h.url,h.hasContent||(h.data&&(o=h.url+=(ft.test(o)?"&":"?")+h.data,delete h.data),!1===h.cache&&(h.url=gt.test(o)?o.replace(gt,"$1_="+pt++):o+(ft.test(o)?"&":"?")+"_="+pt++)),h.ifModified&&(y.lastModified[o]&&E.setRequestHeader("If-Modified-Since",y.lastModified[o]),y.etag[o]&&E.setRequestHeader("If-None-Match",y.etag[o])),(h.data&&h.hasContent&&!1!==h.contentType||i.contentType)&&E.setRequestHeader("Content-Type",h.contentType),E.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Tt+"; q=0.01":""):h.accepts["*"]),h.headers)E.setRequestHeader(r,h.headers[r]);if(h.beforeSend&&(!1===h.beforeSend.call(d,E,h)||2===_))return E.abort();for(r in w="abort",{success:1,error:1,complete:1})E[r](h[r]);if(c=St(Et,h,i,E)){E.readyState=1,l&&p.trigger("ajaxSend",[E,h]),h.async&&h.timeout>0&&(s=setTimeout(function(){E.abort("timeout")},h.timeout));try{_=1,c.send(v,T)}catch(e){if(!(_<2))throw e;T(-1,e)}}else T(-1,"No Transport");function T(e,i,n,r){var u,v,b,x,w,T=i;2!==_&&(_=2,s&&clearTimeout(s),c=t,a=r||"",E.readyState=e>0?4:0,n&&(x=function(e,i,n){var r,o,a,s,l=e.contents,c=e.dataTypes,u=e.responseFields;for(s in u)s in n&&(i[u[s]]=n[s]);for(;"*"===c[0];)c.shift(),o===t&&(o=e.mimeType||i.getResponseHeader("Content-Type"));if(o)for(s in l)if(l[s]&&l[s].test(o)){c.unshift(s);break}if(c[0]in n)a=c[0];else{for(s in n){if(!c[0]||e.converters[s+" "+c[0]]){a=s;break}r||(r=s)}a=a||r}if(a)return a!==c[0]&&c.unshift(a),n[a]}(h,E,n)),e>=200&&e<300||304===e?(h.ifModified&&((w=E.getResponseHeader("Last-Modified"))&&(y.lastModified[o]=w),(w=E.getResponseHeader("etag"))&&(y.etag[o]=w)),204===e?(u=!0,T="nocontent"):304===e?(u=!0,T="notmodified"):(T=(u=function(e,t){var i,n,r,o,a={},s=0,l=e.dataTypes.slice(),c=l[0];e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(l[1])for(r in e.converters)a[r.toLowerCase()]=e.converters[r];for(;n=l[++s];)if("*"!==n){if("*"!==c&&c!==n){if(!(r=a[c+" "+n]||a["* "+n]))for(i in a)if((o=i.split(" "))[1]===n&&(r=a[c+" "+o[0]]||a["* "+o[0]])){!0===r?r=a[i]:!0!==a[i]&&(n=o[0],l.splice(s--,0,n));break}if(!0!==r)if(r&&e.throws)t=r(t);else try{t=r(t)}catch(e){return{state:"parsererror",error:r?e:"No conversion from "+c+" to "+n}}}c=n}return{state:"success",data:t}}(h,x)).state,v=u.data,u=!(b=u.error))):(b=T,!e&&T||(T="error",e<0&&(e=0))),E.status=e,E.statusText=(i||T)+"",u?f.resolveWith(d,[v,T,E]):f.rejectWith(d,[E,T,b]),E.statusCode(g),g=t,l&&p.trigger(u?"ajaxSuccess":"ajaxError",[E,h,u?v:b]),m.fireWith(d,[E,T]),l&&(p.trigger("ajaxComplete",[E,h]),--y.active||y.event.trigger("ajaxStop")))}return E},getScript:function(e,i){return y.get(e,t,i,"script")},getJSON:function(e,t,i){return y.get(e,t,i,"json")}}),y.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return y.globalEval(e),e}}}),y.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),y.ajaxTransport("script",function(e){if(e.crossDomain){var i,n=o.head||y("head")[0]||o.documentElement;return{send:function(t,r){(i=o.createElement("script")).async=!0,e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,t){(t||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||r(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(t,!0)}}}});var Rt=[],At=/(=)\?(?=&|$)|\?\?/;y.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Rt.pop()||y.expando+"_"+pt++;return this[e]=!0,e}}),y.ajaxPrefilter("json jsonp",function(i,n,r){var o,a,s,l=!1!==i.jsonp&&(At.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&At.test(i.data)&&"data");if(l||"jsonp"===i.dataTypes[0])return o=i.jsonpCallback=y.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(At,"$1"+o):!1!==i.jsonp&&(i.url+=(ft.test(i.url)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return s||y.error(o+" was not called"),s[0]},i.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},r.always(function(){e[o]=a,i[o]&&(i.jsonpCallback=n.jsonpCallback,Rt.push(o)),s&&y.isFunction(a)&&a(s[0]),s=a=t}),"script"});var Pt,Lt,Ot=0,It=e.ActiveXObject&&function(){var e;for(e in Pt)Pt[e](t,!0)};function kt(){try{return new e.XMLHttpRequest}catch(e){}}y.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&kt()||function(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:kt,Lt=y.ajaxSettings.xhr(),y.support.cors=!!Lt&&"withCredentials"in Lt,(Lt=y.support.ajax=!!Lt)&&y.ajaxTransport(function(i){var n;if(!i.crossDomain||y.support.cors)return{send:function(r,o){var a,s,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(s in i.xhrFields)l[s]=i.xhrFields[s];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");try{for(s in r)l.setRequestHeader(s,r[s])}catch(e){}l.send(i.hasContent&&i.data||null),n=function(e,r){var s,c,u,h;try{if(n&&(r||4===l.readyState))if(n=t,a&&(l.onreadystatechange=y.noop,It&&delete Pt[a]),r)4!==l.readyState&&l.abort();else{h={},s=l.status,c=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(h.text=l.responseText);try{u=l.statusText}catch(e){u=""}s||!i.isLocal||i.crossDomain?1223===s&&(s=204):s=h.text?200:404}}catch(e){r||o(-1,e)}h&&o(s,u,h,c)},i.async?4===l.readyState?setTimeout(n):(a=++Ot,It&&(Pt||(Pt={},y(e).unload(It)),Pt[a]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(t,!0)}}});var Dt,Nt,Ht=/^(?:toggle|show|hide)$/,Bt=new RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Ft=/queueHooks$/,Ut=[function(e,t,i){var n,r,o,a,s,l,c,u,h,d=this,p=e.style,f={},m=[],g=e.nodeType&&Ke(e);i.queue||(null==(u=y._queueHooks(e,"fx")).unqueued&&(u.unqueued=0,h=u.empty.fire,u.empty.fire=function(){u.unqueued||h()}),u.unqueued++,d.always(function(){d.always(function(){u.unqueued--,y.queue(e,"fx").length||u.empty.fire()})}));1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===y.css(e,"display")&&"none"===y.css(e,"float")&&(y.support.inlineBlockNeedsLayout&&"inline"!==nt(e.nodeName)?p.zoom=1:p.display="inline-block"));i.overflow&&(p.overflow="hidden",y.support.shrinkWrapBlocks||d.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(r in t)if(a=t[r],Ht.exec(a)){if(delete t[r],l=l||"toggle"===a,a===(g?"hide":"show"))continue;m.push(r)}if(o=m.length){"hidden"in(s=y._data(e,"fxshow")||y._data(e,"fxshow",{}))&&(g=s.hidden),l&&(s.hidden=!g),g?y(e).show():d.done(function(){y(e).hide()}),d.done(function(){var t;for(t in y._removeData(e,"fxshow"),f)y.style(e,t,f[t])});for(r=0;r<o;r++)n=m[r],c=d.createTween(n,g?s[n]:0),f[n]=s[n]||y.style(e,n),n in s||(s[n]=c.start,g&&(c.end=c.start,c.start="width"===n||"height"===n?1:0))}}],$t={"*":[function(e,t){var i,n,r=this.createTween(e,t),o=Bt.exec(t),a=r.cur(),s=+a||0,l=1,c=20;if(o){if(i=+o[2],"px"!==(n=o[3]||(y.cssNumber[e]?"":"px"))&&s){s=y.css(r.elem,e,!0)||i||1;do{s/=l=l||".5",y.style(r.elem,e,s+n)}while(l!==(l=r.cur()/a)&&1!==l&&--c)}r.unit=n,r.start=s,r.end=o[1]?s+(o[1]+1)*i:i}return r}]};function jt(){return setTimeout(function(){Dt=t}),Dt=y.now()}function zt(e,t,i){var n,r,o=0,a=Ut.length,s=y.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=Dt||jt(),i=Math.max(0,c.startTime+c.duration-t),n=1-(i/c.duration||0),o=0,a=c.tweens.length;o<a;o++)c.tweens[o].run(n);return s.notifyWith(e,[c,n,i]),n<1&&a?i:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:y.extend({},t),opts:y.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Dt||jt(),duration:i.duration,tweens:[],createTween:function(t,i){var n=y.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)c.tweens[i].run(1);return t?s.resolveWith(e,[c,t]):s.rejectWith(e,[c,t]),this}}),u=c.props;for(!function(e,t){var i,n,r,o,a;for(r in e)if(n=y.camelCase(r),o=t[n],i=e[r],y.isArray(i)&&(o=i[1],i=e[r]=i[0]),r!==n&&(e[n]=i,delete e[r]),(a=y.cssHooks[n])&&"expand"in a)for(r in i=a.expand(i),delete e[n],i)r in e||(e[r]=i[r],t[r]=o);else t[n]=o}(u,c.opts.specialEasing);o<a;o++)if(n=Ut[o].call(c,e,u,c.opts))return n;return function(e,t){y.each(t,function(t,i){for(var n=($t[t]||[]).concat($t["*"]),r=0,o=n.length;r<o;r++)if(n[r].call(e,t,i))return})}(c,u),y.isFunction(c.opts.start)&&c.opts.start.call(e,c),y.fx.timer(y.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function Vt(e,t,i,n,r){return new Vt.prototype.init(e,t,i,n,r)}function Gt(e,t){var i,n={height:e},r=0;for(t=t?1:0;r<4;r+=2-t)n["margin"+(i=Ze[r])]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function Wt(e){return y.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}y.Animation=y.extend(zt,{tweener:function(e,t){y.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,r=e.length;n<r;n++)i=e[n],$t[i]=$t[i]||[],$t[i].unshift(t)},prefilter:function(e,t){t?Ut.unshift(e):Ut.push(e)}}),y.Tween=Vt,Vt.prototype={constructor:Vt,init:function(e,t,i,n,r,o){this.elem=e,this.prop=i,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(y.cssNumber[i]?"":"px")},cur:function(){var e=Vt.propHooks[this.prop];return e&&e.get?e.get(this):Vt.propHooks._default.get(this)},run:function(e){var t,i=Vt.propHooks[this.prop];return this.options.duration?this.pos=t=y.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Vt.propHooks._default.set(this),this}},Vt.prototype.init.prototype=Vt.prototype,Vt.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=y.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){y.fx.step[e.prop]?y.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[y.cssProps[e.prop]]||y.cssHooks[e.prop])?y.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Vt.propHooks.scrollTop=Vt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},y.each(["toggle","show","hide"],function(e,t){var i=y.fn[t];y.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(Gt(t,!0),e,n,r)}}),y.fn.extend({fadeTo:function(e,t,i,n){return this.filter(Ke).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var r=y.isEmptyObject(e),o=y.speed(t,i,n),a=function(){var t=zt(this,y.extend({},e),o);a.finish=function(){t.stop(!0)},(r||y._data(this,"finish"))&&t.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,i,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=i,i=e,e=t),i&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=y.timers,a=y._data(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&Ft.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||y.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,i=y._data(this),n=i[e+"queue"],r=i[e+"queueHooks"],o=y.timers,a=n?n.length:0;for(i.finish=!0,y.queue(this,e,[]),r&&r.cur&&r.cur.finish&&r.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),y.each({slideDown:Gt("show"),slideUp:Gt("hide"),slideToggle:Gt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){y.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),y.speed=function(e,t,i){var n=e&&"object"==typeof e?y.extend({},e):{complete:i||!i&&t||y.isFunction(e)&&e,duration:e,easing:i&&t||t&&!y.isFunction(t)&&t};return n.duration=y.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in y.fx.speeds?y.fx.speeds[n.duration]:y.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){y.isFunction(n.old)&&n.old.call(this),n.queue&&y.dequeue(this,n.queue)},n},y.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},y.timers=[],y.fx=Vt.prototype.init,y.fx.tick=function(){var e,i=y.timers,n=0;for(Dt=y.now();n<i.length;n++)(e=i[n])()||i[n]!==e||i.splice(n--,1);i.length||y.fx.stop(),Dt=t},y.fx.timer=function(e){e()&&y.timers.push(e)&&y.fx.start()},y.fx.interval=13,y.fx.start=function(){Nt||(Nt=setInterval(y.fx.tick,y.fx.interval))},y.fx.stop=function(){clearInterval(Nt),Nt=null},y.fx.speeds={slow:600,fast:200,_default:400},y.fx.step={},y.expr&&y.expr.filters&&(y.expr.filters.animated=function(e){return y.grep(y.timers,function(t){return e===t.elem}).length}),y.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){y.offset.setOffset(this,e,t)});var i,n,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;return s?(i=s.documentElement,y.contains(i,a)?(typeof a.getBoundingClientRect!==r&&(o=a.getBoundingClientRect()),n=Wt(s),{top:o.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:o.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):o):void 0},y.offset={setOffset:function(e,t,i){var n=y.css(e,"position");"static"===n&&(e.style.position="relative");var r,o,a=y(e),s=a.offset(),l=y.css(e,"top"),c=y.css(e,"left"),u={},h={};("absolute"===n||"fixed"===n)&&y.inArray("auto",[l,c])>-1?(r=(h=a.position()).top,o=h.left):(r=parseFloat(l)||0,o=parseFloat(c)||0),y.isFunction(t)&&(t=t.call(e,i,s)),null!=t.top&&(u.top=t.top-s.top+r),null!=t.left&&(u.left=t.left-s.left+o),"using"in t?t.using.call(e,u):a.css(u)}},y.fn.extend({position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===y.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),y.nodeName(e[0],"html")||(i=e.offset()),i.top+=y.css(e[0],"borderTopWidth",!0),i.left+=y.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-y.css(n,"marginTop",!0),left:t.left-i.left-y.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||o.documentElement;e&&!y.nodeName(e,"html")&&"static"===y.css(e,"position");)e=e.offsetParent;return e||o.documentElement})}}),y.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n=/Y/.test(i);y.fn[e]=function(r){return y.access(this,function(e,r,o){var a=Wt(e);if(o===t)return a?i in a?a[i]:a.document.documentElement[r]:e[r];a?a.scrollTo(n?y(a).scrollLeft():o,n?o:y(a).scrollTop()):e[r]=o},e,r,arguments.length,null)}}),y.each({Height:"height",Width:"width"},function(e,i){y.each({padding:"inner"+e,content:i,"":"outer"+e},function(n,r){y.fn[r]=function(r,o){var a=arguments.length&&(n||"boolean"!=typeof r),s=n||(!0===r||!0===o?"margin":"border");return y.access(this,function(i,n,r){var o;return y.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+e],o["scroll"+e],i.body["offset"+e],o["offset"+e],o["client"+e])):r===t?y.css(i,n,s):y.style(i,n,r,s)},i,a?r:t,a,null)}})}),e.jQuery=e.$=y,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return y})}(window),function(e,t,i){"function"==typeof define&&define.amd?define(["jquery"],function(n){return i(n,e,t),n.mobile}):i(e.jQuery,e,t)}(this,document,function(e,t,i){!function(e){e.mobile={}}(e),function(e){e.extend(e.mobile,{version:"1.4.0",subPageUrlKey:"ui-page",hideUrlBar:!0,keepNative:":jqmData(role='none'), :jqmData(role='nojs')",activePageClass:"ui-page-active",activeBtnClass:"ui-btn-active",focusClass:"ui-focus",ajaxEnabled:!0,hashListeningEnabled:!0,linkBindingEnabled:!0,defaultPageTransition:"fade",maxTransitionWidth:!1,minScrollBack:0,defaultDialogTransition:"pop",pageLoadErrorMessage:"Error Loading Page",pageLoadErrorMessageTheme:"a",phonegapNavigationEnabled:!1,autoInitializePage:!0,pushStateEnabled:!0,ignoreContentEnabled:!1,buttonMarkup:{hoverDelay:200},dynamicBaseEnabled:!0,pageContainer:e(),allowCrossDomainPages:!1,dialogHashKey:"&ui-state=dialog"})}(e),function(e,t,i){var n={},r=e.find,o=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,a=/:jqmData\(([^)]*)\)/g;e.extend(e.mobile,{ns:"",getAttribute:function(t,i){var n;(t=t.jquery?t[0]:t)&&t.getAttribute&&(n=t.getAttribute("data-"+e.mobile.ns+i));try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:o.test(n)?JSON.parse(n):n)}catch(e){}return n},nsNormalizeDict:n,nsNormalize:function(t){return n[t]||(n[t]=e.camelCase(e.mobile.ns+t))},closestPageData:function(e){return e.closest(":jqmData(role='page'), :jqmData(role='dialog')").data("mobile-page")}}),e.fn.jqmData=function(t,i){var n;return void 0!==t&&(t&&(t=e.mobile.nsNormalize(t)),n=arguments.length<2||void 0===i?this.data(t):this.data(t,i)),n},e.jqmData=function(t,i,n){var r;return void 0!==i&&(r=e.data(t,i?e.mobile.nsNormalize(i):i,n)),r},e.fn.jqmRemoveData=function(t){return this.removeData(e.mobile.nsNormalize(t))},e.jqmRemoveData=function(t,i){return e.removeData(t,e.mobile.nsNormalize(i))},e.find=function(t,i,n,o){return t.indexOf(":jqmData")>-1&&(t=t.replace(a,"[data-"+(e.mobile.ns||"")+"$1]")),r.call(this,t,i,n,o)},e.extend(e.find,r)}(e),function(e,t){function n(t,i){var n,o,a,s=t.nodeName.toLowerCase();return"area"===s?(o=(n=t.parentNode).name,!(!t.href||!o||"map"!==n.nodeName.toLowerCase())&&(!!(a=e("img[usemap=#"+o+"]")[0])&&r(a))):(/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s&&t.href||i)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var o=0,a=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"c0ab71056b936627e8a7821f03c044aec6280a40",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(this[0].ownerDocument||i):t},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){a.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(i,n){function r(t,i,n,r){return e.each(o,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),r&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var o="Width"===n?["Left","Right"]:["Top","Bottom"],a=n.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(i){return i===t?s["inner"+n].call(this):this.each(function(){e(this).css(a,r(this,i)+"px")})},e.fn["outer"+n]=function(t,i){return"number"!=typeof t?s["outer"+n].call(this,t):this.each(function(){e(this).css(a,r(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in i.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var r,o,a=e(this[0]);a.length&&a[0]!==i;){if(("absolute"===(r=a.css("position"))||"relative"===r||"fixed"===r)&&(o=parseInt(a.css("zIndex"),10),!isNaN(o)&&0!==o))return o;a=a.parent()}return 0}}),e.ui.plugin={add:function(t,i,n){var r,o=e.ui[t].prototype;for(r in n)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([i,n[r]])},call:function(e,t,i,n){var r,o=e.plugins[t];if(o&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;r<o.length;r++)e.options[o[r][0]]&&o[r][1].apply(e.element,i)}}}(e),function(e,t){e.extend(e.mobile,{window:e(t),document:e(i),keyCode:e.ui.keyCode,behaviors:{},silentScroll:function(i){"number"!==e.type(i)&&(i=e.mobile.defaultHomeScroll),e.event.special.scrollstart.enabled=!1,setTimeout(function(){t.scrollTo(0,i),e.mobile.document.trigger("silentscroll",{x:0,y:i})},20),setTimeout(function(){e.event.special.scrollstart.enabled=!0},150)},getClosestBaseUrl:function(t){var i=e(t).closest(".ui-page").jqmData("url"),n=e.mobile.path.documentBase.hrefNoHash;return e.mobile.dynamicBaseEnabled&&i&&e.mobile.path.isPath(i)||(i=n),e.mobile.path.makeUrlAbsolute(i,n)},removeActiveLinkClass:function(t){!e.mobile.activeClickedLink||e.mobile.activeClickedLink.closest("."+e.mobile.activePageClass).length&&!t||e.mobile.activeClickedLink.removeClass(e.mobile.activeBtnClass),e.mobile.activeClickedLink=null},getInheritedTheme:function(e,t){for(var i,n,r=e[0],o="",a=/ui-(bar|body|overlay)-([a-z])\b/;r&&!((i=r.className||"")&&(n=a.exec(i))&&(o=n[2]));)r=r.parentNode;return o||t||"a"},enhanceable:function(e){return this.haveParents(e,"enhance")},hijackable:function(e){return this.haveParents(e,"ajax")},haveParents:function(t,i){if(!e.mobile.ignoreContentEnabled)return t;var n,r,o,a,s=t.length,l=e();for(a=0;s>a;a++){for(r=t.eq(a),o=!1,n=t[a];n;){if("false"===(n.getAttribute?n.getAttribute("data-"+e.mobile.ns+i):"")){o=!0;break}n=n.parentNode}o||(l=l.add(r))}return l},getScreenHeight:function(){return t.innerHeight||e.mobile.window.height()},resetActivePageHeight:function(t){var i=e("."+e.mobile.activePageClass),n=i.height(),r=i.outerHeight(!0);t="number"==typeof t?t:e.mobile.getScreenHeight(),i.css("min-height",t-(r-n))},loading:function(){var t=this.loading._widget||e(e.mobile.loader.prototype.defaultHtml).loader(),i=t.loader.apply(t,arguments);return this.loading._widget=t,i}}),e.addDependents=function(t,i){var n=e(t),r=n.jqmData("dependents")||e();n.jqmData("dependents",e(r).add(i))},e.fn.extend({removeWithDependents:function(){e.removeWithDependents(this)},enhanceWithin:function(){var t,i={},n=e.mobile.page.prototype.keepNativeSelector(),r=this;for(t in e.mobile.nojs&&e.mobile.nojs(this),e.mobile.links&&e.mobile.links(this),e.mobile.degradeInputsWithin&&e.mobile.degradeInputsWithin(this),e.fn.buttonMarkup&&this.find(e.fn.buttonMarkup.initSelector).not(n).jqmEnhanceable().buttonMarkup(),e.fn.fieldcontain&&this.find(":jqmData(role='fieldcontain')").not(n).jqmEnhanceable().fieldcontain(),e.each(e.mobile.widgets,function(t,o){if(o.initSelector){var a=e.mobile.enhanceable(r.find(o.initSelector));a.length>0&&(a=a.not(n)),a.length>0&&(i[o.prototype.widgetName]=a)}}),i)i[t][t]();return this},addDependents:function(t){e.addDependents(this,t)},getEncodedText:function(){return e("<a>").text(this.text()).html()},jqmEnhanceable:function(){return e.mobile.enhanceable(this)},jqmHijackable:function(){return e.mobile.hijackable(this)}}),e.removeWithDependents=function(t){var i=e(t);(i.jqmData("dependents")||e()).remove(),i.remove()},e.addDependents=function(t,i){var n=e(t),r=n.jqmData("dependents")||e();n.jqmData("dependents",e(r).add(i))},e.find.matches=function(t,i){return e.find(t,null,null,i)},e.find.matchesSelector=function(t,i){return e.find(i,null,null,[t]).length>0}}(e,this),function(e,t){var i=0,n=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var i,n=0;null!=(i=t[n]);n++)try{e(i).triggerHandler("remove")}catch(e){}r(t)},e.widget=function(t,i,n){var r,o,a,s,l={},c=t.split(".")[0];return t=t.split(".")[1],r=c+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[c]=e[c]||{},o=e[c][t],a=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,o,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),(s=new i).options=e.widget.extend({},s.options),e.each(n,function(t,n){return e.isFunction(n)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},r=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=n.apply(this,arguments),this._super=i,this._superApply=o,t}}()):void(l[t]=n)}),a.prototype=e.widget.extend(s,{widgetEventPrefix:o&&s.widgetEventPrefix||t},l,{constructor:a,namespace:c,widgetName:t,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,a,i._proto)}),delete o._childConstructors):i._childConstructors.push(a),e.widget.bridge(t,a),a},e.widget.extend=function(i){for(var r,o,a=n.call(arguments,1),s=0,l=a.length;l>s;s++)for(r in a[s])o=a[s][r],a[s].hasOwnProperty(r)&&o!==t&&(i[r]=e.isPlainObject(o)?e.isPlainObject(i[r])?e.widget.extend({},i[r],o):e.widget.extend({},o):o);return i},e.widget.bridge=function(i,r){var o=r.prototype.widgetFullName||i;e.fn[i]=function(a){var s="string"==typeof a,l=n.call(arguments,1),c=this;return a=!s&&l.length?e.widget.extend.apply(null,[a].concat(l)):a,s?this.each(function(){var n,r=e.data(this,o);return"instance"===a?(c=r,!1):r?e.isFunction(r[a])&&"_"!==a.charAt(0)?(n=r[a].apply(r,l))!==r&&n!==t?(c=n&&n.jquery?c.pushStack(n.get()):n,!1):void 0:e.error("no such method '"+a+"' for "+i+" widget instance"):e.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+a+"'")}):this.each(function(){var t=e.data(this,o);t?t.option(a||{})._init():e.data(this,o,new r(a,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(i,n){var r,o,a,s=i;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof i)if(s={},i=(r=i.split(".")).shift(),r.length){for(o=s[i]=e.widget.extend({},this.options[i]),a=0;a<r.length-1;a++)o[r[a]]=o[r[a]]||{},o=o[r[a]];if(i=r.pop(),n===t)return o[i]===t?null:o[i];o[i]=n}else{if(n===t)return this.options[i]===t?null:this.options[i];s[i]=n}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,n){var r,o=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=r=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,r=this.widget()),e.each(n,function(n,a){function s(){return t||!0!==o.options.disabled&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=n.match(/^(\w+)\s*(.*)$/),c=l[1]+o.eventNamespace,u=l[2];u?r.delegate(u,c,s):i.bind(c,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){var i=this;return setTimeout(function(){return("string"==typeof e?i[e]:e).apply(i,arguments)},t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var r,o,a=this.options[t];if(n=n||{},(i=e.Event(i)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(r in o)r in i||(i[r]=o[r]);return this.element.trigger(i,n),!(e.isFunction(a)&&!1===a.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,r,o){"string"==typeof r&&(r={effect:r});var a,s=r?!0===r||"number"==typeof r?i:r.effect||i:t;"number"==typeof(r=r||{})&&(r={duration:r}),a=!e.isEmptyObject(r),r.complete=o,r.delay&&n.delay(r.delay),a&&e.effects&&e.effects.effect[s]?n[t](r):s!==t&&n[s]?n[s](r.duration,r.easing,o):n.queue(function(i){e(this)[t](),o&&o.call(n[0]),i()})}})}(e),function(e){var t=/[A-Z]/g,i=function(e){return"-"+e.toLowerCase()};e.extend(e.Widget.prototype,{_getCreateOptions:function(){var n,r,o=this.element[0],a={};if(!e.mobile.getAttribute(o,"defaults"))for(n in this.options)null!=(r=e.mobile.getAttribute(o,n.replace(t,i)))&&(a[n]=r);return a}}),e.mobile.widget=e.Widget}(e),function(e){var t="ui-loader",i=e("html");e.widget("mobile.loader",{options:{theme:"a",textVisible:!1,html:"",text:"loading"},defaultHtml:"<div class='"+t+"'><span class='ui-icon-loading'></span><h1></h1></div>",fakeFixLoader:function(){var t=e("."+e.mobile.activeBtnClass).first();this.element.css({top:e.support.scrollTop&&this.window.scrollTop()+this.window.height()/2||t.length&&t.offset().top||100})},checkLoaderPosition:function(){var t=this.element.offset(),i=this.window.scrollTop(),n=e.mobile.getScreenHeight();(t.top<i||t.top-i>n)&&(this.element.addClass("ui-loader-fakefix"),this.fakeFixLoader(),this.window.unbind("scroll",this.checkLoaderPosition).bind("scroll",e.proxy(this.fakeFixLoader,this)))},resetHtml:function(){this.element.html(e(this.defaultHtml).html())},show:function(n,r,o){var a,s,l;this.resetHtml(),"object"===e.type(n)?n=(l=e.extend({},this.options,n)).theme:(l=this.options,n=n||l.theme),s=r||(!1===l.text?"":l.text),i.addClass("ui-loading"),a=l.textVisible,this.element.attr("class",t+" ui-corner-all ui-body-"+n+" ui-loader-"+(a||r||n.text?"verbose":"default")+(l.textonly||o?" ui-loader-textonly":"")),l.html?this.element.html(l.html):this.element.find("h1").text(s),this.element.appendTo(e.mobile.pageContainer),this.checkLoaderPosition(),this.window.bind("scroll",e.proxy(this.checkLoaderPosition,this))},hide:function(){i.removeClass("ui-loading"),this.options.text&&this.element.removeClass("ui-loader-fakefix"),e.mobile.window.unbind("scroll",this.fakeFixLoader),e.mobile.window.unbind("scroll",this.checkLoaderPosition)}})}(e),function(e,t,n){function r(e){return"#"+(e=e||location.href).replace(/^[^#]*#?(.*)$/,"$1")}var o,a="hashchange",s=i,l=e.event.special,c=s.documentMode,u="on"+a in t&&(c===n||c>7);e.fn[a]=function(e){return e?this.bind(a,e):this.trigger(a)},e.fn[a].delay=50,l[a]=e.extend(l[a],{setup:function(){return!u&&void e(o.start)},teardown:function(){return!u&&void e(o.stop)}}),o=function(){function i(){var n=r(),s=p(c);n!==c?(d(c=n,s),e(t).trigger(a)):s!==c&&(location.href=location.href.replace(/#.*/,"")+s),o=setTimeout(i,e.fn[a].delay)}var o,l={},c=r(),h=function(e){return e},d=h,p=h;return l.start=function(){o||i()},l.stop=function(){o&&clearTimeout(o),o=n},t.attachEvent&&!t.addEventListener&&!u&&function(){var t,n;l.start=function(){t||(n=(n=e.fn[a].src)&&n+r(),t=e('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){n||d(r()),i()}).attr("src",n||"javascript:0").insertAfter("body")[0].contentWindow,s.onpropertychange=function(){try{"title"===event.propertyName&&(t.document.title=s.title)}catch(e){}})},l.stop=h,p=function(){return r(t.location.href)},d=function(i,n){var r=t.document,o=e.fn[a].domain;i!==n&&(r.title=s.title,r.open(),o&&r.write('<script>document.domain="'+o+'"<\/script>'),r.close(),t.location.hash=i)}}(),l}()}(e,this),function(e){t.matchMedia=t.matchMedia||function(e){var t,i=e.documentElement,n=i.firstElementChild||i.firstChild,r=e.createElement("body"),o=e.createElement("div");return o.id="mq-test-1",o.style.cssText="position:absolute;top:-100em",r.style.background="none",r.appendChild(o),function(e){return o.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',i.insertBefore(r,n),t=42===o.offsetWidth,i.removeChild(r),{matches:t,media:e}}}(i),e.mobile.media=function(e){return t.matchMedia(e).matches}}(e),function(e){var t={touch:"ontouchend"in i};e.mobile.support=e.mobile.support||{},e.extend(e.support,t),e.extend(e.mobile.support,t)}(e),function(e){e.extend(e.support,{orientation:"orientation"in t&&"onorientationchange"in t})}(e),function(e,n){function r(e){var t,i=e.charAt(0).toUpperCase()+e.substr(1),r=(e+" "+l.join(i+" ")+i).split(" ");for(t in r)if(s[r[t]]!==n)return!0}var o,a=e("<body>").prependTo("html"),s=a[0].style,l=["Webkit","Moz","O"],c="palmGetResource"in t,u=t.opera,h=t.operamini&&"[object OperaMini]"==={}.toString.call(t.operamini),d=t.blackberry&&!r("-webkit-transform");e.extend(e.mobile,{browser:{}}),e.mobile.browser.oldIE=function(){var e=3,t=i.createElement("div"),n=t.all||[];do{t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><br><![endif]--\x3e"}while(n[0]);return e>4?e:!e}(),e.extend(e.support,{cssTransitions:"WebKitTransitionEvent"in t||function(e,t,n){var r,o,a=i.createElement("div"),s=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},c=function(i){var n=function(e){return""===e?"":"-"+e.charAt(0).toLowerCase()+e.substr(1)+"-"}(i)+e+": "+t+";",r=s(i),l=r+(""===r?e:s(e));a.setAttribute("style",n),a.style[l]&&(o=!0)},u=n||l;for(r=0;r<u.length;r++)c(u[r]);return!!o}("transition","height 100ms linear",["Webkit","Moz",""])&&!e.mobile.browser.oldIE&&!u,pushState:"pushState"in history&&"replaceState"in history&&!(t.navigator.userAgent.indexOf("Firefox")>=0&&t.top!==t)&&-1===t.navigator.userAgent.search(/CriOS/),mediaquery:e.mobile.media("only all"),cssPseudoElement:!!r("content"),touchOverflow:!!r("overflowScrolling"),cssTransform3d:function(){var r,o,s,c="transform-3d",u=e.mobile.media("(-"+l.join("-"+c+"),(-")+"-"+c+"),("+c+")");if(u)return!!u;for(s in r=i.createElement("div"),o={MozTransform:"-moz-transform",transform:"transform"},a.append(r),o)r.style[s]!==n&&(r.style[s]="translate3d( 100px, 1px, 1px )",u=t.getComputedStyle(r).getPropertyValue(o[s]));return!!u&&"none"!==u}(),cssAnimations:!!r("animationName"),boxShadow:!!r("boxShadow")&&!d,fixedPosition:function(){var e=t,i=navigator.userAgent,n=navigator.platform,r=i.match(/AppleWebKit\/([0-9]+)/),o=!!r&&r[1],a=i.match(/Fennec\/([0-9]+)/),s=!!a&&a[1],l=i.match(/Opera Mobi\/([0-9]+)/),c=!!l&&l[1];return!((n.indexOf("iPhone")>-1||n.indexOf("iPad")>-1||n.indexOf("iPod")>-1)&&o&&534>o||e.operamini&&"[object OperaMini]"==={}.toString.call(e.operamini)||l&&7458>c||i.indexOf("Android")>-1&&o&&533>o||s&&6>s||"palmGetResource"in t&&o&&534>o||i.indexOf("MeeGo")>-1&&i.indexOf("NokiaBrowser/8.5.0")>-1)}(),scrollTop:("pageXOffset"in t||"scrollTop"in i.documentElement||"scrollTop"in a[0])&&!c&&!h,dynamicBaseTag:function(){var t,i=location.protocol+"//"+location.host+location.pathname+"ui-dir/",n=e("head base"),r=null,o="";return n.length?o=n.attr("href"):n=r=e("<base>",{href:i}).appendTo("head"),t=e("<a href='testurl' />").prependTo(a)[0].href,n[0].href=o||location.pathname,r&&r.remove(),0===t.indexOf(i)}(),cssPointerEvents:function(){var e,n=i.createElement("x"),r=i.documentElement,o=t.getComputedStyle;return"pointerEvents"in n.style&&(n.style.pointerEvents="auto",n.style.pointerEvents="x",r.appendChild(n),e=o&&"auto"===o(n,"").pointerEvents,r.removeChild(n),!!e)}(),boundingRect:void 0!==i.createElement("div").getBoundingClientRect,inlineSVG:function(){var i=t,n=!(!i.document.createElementNS||!i.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||i.opera&&-1===navigator.userAgent.indexOf("Chrome")),r=function(t){t&&n||e("html").addClass("ui-nosvg")},o=new i.Image;o.onerror=function(){r(!1)},o.onload=function(){r(1===o.width&&1===o.height)},o.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}}),a.remove(),o=function(){var e=t.navigator.userAgent;return e.indexOf("Nokia")>-1&&(e.indexOf("Symbian/3")>-1||e.indexOf("Series60/5")>-1)&&e.indexOf("AppleWebKit")>-1&&e.match(/(BrowserNG|NokiaBrowser)\/7\.[0-3]/)}(),e.mobile.gradeA=function(){return(e.support.mediaquery&&e.support.cssPseudoElement||e.mobile.browser.oldIE&&e.mobile.browser.oldIE>=8)&&(e.support.boundingRect||null!==e.fn.jquery.match(/1\.[0-7+]\.[0-9+]?/))},e.mobile.ajaxBlacklist=t.blackberry&&!t.WebKitPoint||h||o,o&&e(function(){e("head link[rel='stylesheet']").attr("rel","alternate stylesheet").attr("rel","stylesheet")}),e.support.boxShadow||e("html").addClass("ui-noboxshadow")}(e),function(e,t){var i,n=e.mobile.window,r=function(){};e.event.special.beforenavigate={setup:function(){n.on("navigate",r)},teardown:function(){n.off("navigate",r)}},e.event.special.navigate=i={bound:!1,pushStateEnabled:!0,originalEventName:void 0,isPushStateEnabled:function(){return e.support.pushState&&!0===e.mobile.pushStateEnabled&&this.isHashChangeEnabled()},isHashChangeEnabled:function(){return!0===e.mobile.hashListeningEnabled},popstate:function(t){var i=new e.Event("navigate"),r=new e.Event("beforenavigate"),o=t.originalEvent.state||{};r.originalEvent=t,n.trigger(r),r.isDefaultPrevented()||(t.historyState&&e.extend(o,t.historyState),i.originalEvent=t,setTimeout(function(){n.trigger(i,{state:o})},0))},hashchange:function(t){var i=new e.Event("navigate"),r=new e.Event("beforenavigate");r.originalEvent=t,n.trigger(r),r.isDefaultPrevented()||(i.originalEvent=t,n.trigger(i,{state:t.hashchangeState||{}}))},setup:function(){i.bound||(i.bound=!0,i.isPushStateEnabled()?(i.originalEventName="popstate",n.bind("popstate.navigate",i.popstate)):i.isHashChangeEnabled()&&(i.originalEventName="hashchange",n.bind("hashchange.navigate",i.hashchange)))}}}(e),function(e,i){var n,r,o="&ui-state=dialog";e.mobile.path=n={uiStateKey:"&ui-state",urlParseRE:/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,getLocation:function(e){var t=e?this.parseUrl(e):location,i=this.parseUrl(e||location.href).hash;return i="#"===i?"":i,t.protocol+"//"+t.host+t.pathname+t.search+i},getDocumentUrl:function(t){return t?e.extend({},n.documentUrl):n.documentUrl.href},parseLocation:function(){return this.parseUrl(this.getLocation())},parseUrl:function(t){if("object"===e.type(t))return t;var i=n.urlParseRE.exec(t||"")||[];return{href:i[0]||"",hrefNoHash:i[1]||"",hrefNoSearch:i[2]||"",domain:i[3]||"",protocol:i[4]||"",doubleSlash:i[5]||"",authority:i[6]||"",username:i[8]||"",password:i[9]||"",host:i[10]||"",hostname:i[11]||"",port:i[12]||"",pathname:i[13]||"",directory:i[14]||"",filename:i[15]||"",search:i[16]||"",hash:i[17]||""}},makePathAbsolute:function(e,t){var i,n,r,o;if(e&&"/"===e.charAt(0))return e;for(e=e||"",i=(t=t?t.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"")?t.split("/"):[],n=e.split("/"),r=0;r<n.length;r++)switch(o=n[r]){case".":break;case"..":i.length&&i.pop();break;default:i.push(o)}return"/"+i.join("/")},isSameDomain:function(e,t){return n.parseUrl(e).domain===n.parseUrl(t).domain},isRelativeUrl:function(e){return""===n.parseUrl(e).protocol},isAbsoluteUrl:function(e){return""!==n.parseUrl(e).protocol},makeUrlAbsolute:function(e,t){if(!n.isRelativeUrl(e))return e;t===i&&(t=this.documentBase);var r=n.parseUrl(e),o=n.parseUrl(t),a=r.protocol||o.protocol,s=r.protocol?r.doubleSlash:r.doubleSlash||o.doubleSlash,l=r.authority||o.authority,c=""!==r.pathname;return a+s+l+n.makePathAbsolute(r.pathname||o.filename,o.pathname)+(r.search||!c&&o.search||"")+r.hash},addSearchParams:function(t,i){var r=n.parseUrl(t),o="object"==typeof i?e.param(i):i,a=r.search||"?";return r.hrefNoSearch+a+("?"!==a.charAt(a.length-1)?"&":"")+o+(r.hash||"")},convertUrlToDataUrl:function(e){var i=n.parseUrl(e);return n.isEmbeddedPage(i)?i.hash.split(o)[0].replace(/^#/,"").replace(/\?.*$/,""):n.isSameDomain(i,this.documentBase)?i.hrefNoHash.replace(this.documentBase.domain,"").split(o)[0]:t.decodeURIComponent(e)},get:function(e){return e===i&&(e=n.parseLocation().hash),n.stripHash(e).replace(/[^\/]*\.[^\/*]+$/,"")},set:function(e){location.hash=e},isPath:function(e){return/\//.test(e)},clean:function(e){return e.replace(this.documentBase.domain,"")},stripHash:function(e){return e.replace(/^#/,"")},stripQueryParams:function(e){return e.replace(/\?.*$/,"")},cleanHash:function(e){return n.stripHash(e.replace(/\?.*$/,"").replace(o,""))},isHashValid:function(e){return/^#[^#]+$/.test(e)},isExternal:function(e){var t=n.parseUrl(e);return!(!t.protocol||t.domain===this.documentUrl.domain)},hasProtocol:function(e){return/^(:?\w+:)/.test(e)},isEmbeddedPage:function(e){var t=n.parseUrl(e);return""!==t.protocol?!this.isPath(t.hash)&&t.hash&&(t.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&t.hrefNoHash===this.documentBase.hrefNoHash):/^#/.test(t.href)},squash:function(e,t){var i,r,o,a,s=this.isPath(e),l=this.parseUrl(e),c=l.hash,u="";return t=t||(n.isPath(e)?n.getLocation():n.getDocumentUrl()),r=s?n.stripHash(e):e,(a=(r=n.isPath(l.hash)?n.stripHash(l.hash):r).indexOf(this.uiStateKey))>-1&&(u=r.slice(a),r=r.slice(0,a)),i=n.makeUrlAbsolute(r,t),o=this.parseUrl(i).search,s?((n.isPath(c)||0===c.replace("#","").indexOf(this.uiStateKey))&&(c=""),u&&-1===c.indexOf(this.uiStateKey)&&(c+=u),-1===c.indexOf("#")&&""!==c&&(c="#"+c),i=(i=n.parseUrl(i)).protocol+"//"+i.host+i.pathname+o+c):i+=i.indexOf("#")>-1?u:"#"+u,i},isPreservableHash:function(e){return 0===e.replace("#","").indexOf(this.uiStateKey)},hashToSelector:function(e){var t="#"===e.substring(0,1);return t&&(e=e.substring(1)),(t?"#":"")+e.replace(/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1")},getFilePath:function(t){var i="&"+e.mobile.subPageUrlKey;return t&&t.split(i)[0].split(o)[0]},isFirstPageUrl:function(t){var r=n.parseUrl(n.makeUrlAbsolute(t,this.documentBase)),o=r.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&r.hrefNoHash===this.documentBase.hrefNoHash,a=e.mobile.firstPage,s=a&&a[0]?a[0].id:i;return o&&(!r.hash||"#"===r.hash||s&&r.hash.replace(/^#/,"")===s)},isPermittedCrossDomainRequest:function(t,i){return e.mobile.allowCrossDomainPages&&("file:"===t.protocol||"content:"===t.protocol)&&-1!==i.search(/^https?:/)}},n.documentUrl=n.parseLocation(),r=e("head").find("base"),n.documentBase=r.length?n.parseUrl(n.makeUrlAbsolute(r.attr("href"),n.documentUrl.href)):n.documentUrl,n.documentBaseDiffers=n.documentUrl.hrefNoHash!==n.documentBase.hrefNoHash,n.getDocumentBase=function(t){return t?e.extend({},n.documentBase):n.documentBase.href},e.extend(e.mobile,{getDocumentUrl:n.getDocumentUrl,getDocumentBase:n.getDocumentBase})}(e),function(e,t){e.mobile.History=function(e,t){this.stack=e||[],this.activeIndex=t||0},e.extend(e.mobile.History.prototype,{getActive:function(){return this.stack[this.activeIndex]},getLast:function(){return this.stack[this.previousIndex]},getNext:function(){return this.stack[this.activeIndex+1]},getPrev:function(){return this.stack[this.activeIndex-1]},add:function(e,t){t=t||{},this.getNext()&&this.clearForward(),t.hash&&-1===t.hash.indexOf("#")&&(t.hash="#"+t.hash),t.url=e,this.stack.push(t),this.activeIndex=this.stack.length-1},clearForward:function(){this.stack=this.stack.slice(0,this.activeIndex+1)},find:function(e,t,i){var n,r,o,a=(t=t||this.stack).length;for(r=0;a>r;r++)if(n=t[r],(decodeURIComponent(e)===decodeURIComponent(n.url)||decodeURIComponent(e)===decodeURIComponent(n.hash))&&(o=r,i))return o;return o},closest:function(e){var i,n=this.activeIndex;return(i=this.find(e,this.stack.slice(0,n)))===t&&(i=(i=this.find(e,this.stack.slice(n),!0))===t?i:i+n),i},direct:function(i){var n=this.closest(i.url),r=this.activeIndex;n!==t&&(this.activeIndex=n,this.previousIndex=r),r>n?(i.present||i.back||e.noop)(this.getActive(),"back"):n>r?(i.present||i.forward||e.noop)(this.getActive(),"forward"):n===t&&i.missing&&i.missing(this.getActive())}})}(e),function(e){var n=e.mobile.path,r=location.href;e.mobile.Navigator=function(t){this.history=t,this.ignoreInitialHashChange=!0,e.mobile.window.bind({"popstate.history":e.proxy(this.popstate,this),"hashchange.history":e.proxy(this.hashchange,this)})},e.extend(e.mobile.Navigator.prototype,{squash:function(r,o){var a,s,l=n.isPath(r)?n.stripHash(r):r;return s=n.squash(r),a=e.extend({hash:l,url:s},o),t.history.replaceState(a,a.title||i.title,s),a},hash:function(e,t){var i,r,o,a;return i=n.parseUrl(e),(r=n.parseLocation()).pathname+r.search===i.pathname+i.search?o=i.hash?i.hash:i.pathname+i.search:n.isPath(e)?o=(a=n.parseUrl(t)).pathname+a.search+(n.isPreservableHash(a.hash)?a.hash.replace("#",""):""):o=e,o},go:function(r,o,a){var s,l,c,u,h=e.event.special.navigate.isPushStateEnabled();l=n.squash(r),c=this.hash(r,l),a&&c!==n.stripHash(n.parseLocation().hash)&&(this.preventNextHashChange=a),this.preventHashAssignPopState=!0,t.location.hash=c,this.preventHashAssignPopState=!1,s=e.extend({url:l,hash:c,title:i.title},o),h&&((u=new e.Event("popstate")).originalEvent={type:"popstate",state:null},this.squash(r,s),a||(this.ignorePopState=!0,e.mobile.window.trigger(u))),this.history.add(s.url,s)},popstate:function(t){var i,o;if(e.event.special.navigate.isPushStateEnabled())return this.preventHashAssignPopState?(this.preventHashAssignPopState=!1,void t.stopImmediatePropagation()):this.ignorePopState?void(this.ignorePopState=!1):!t.originalEvent.state&&1===this.history.stack.length&&this.ignoreInitialHashChange&&(this.ignoreInitialHashChange=!1,location.href===r)?void t.preventDefault():(i=n.parseLocation().hash,!t.originalEvent.state&&i?(o=this.squash(i),this.history.add(o.url,o),void(t.historyState=o)):void this.history.direct({url:(t.originalEvent.state||{}).url||i,present:function(i,n){t.historyState=e.extend({},i),t.historyState.direction=n}}))},hashchange:function(t){var r,o;if(e.event.special.navigate.isHashChangeEnabled()&&!e.event.special.navigate.isPushStateEnabled()){if(this.preventNextHashChange)return this.preventNextHashChange=!1,void t.stopImmediatePropagation();r=this.history,o=n.parseLocation().hash,this.history.direct({url:o,present:function(i,n){t.hashchangeState=e.extend({},i),t.hashchangeState.direction=n},missing:function(){r.add(o,{hash:o,title:i.title})}})}}})}(e),function(e){e.mobile.navigate=function(t,i,n){e.mobile.navigate.navigator.go(t,i,n)},e.mobile.navigate.history=new e.mobile.History,e.mobile.navigate.navigator=new e.mobile.Navigator(e.mobile.navigate.history);var t=e.mobile.path.parseLocation();e.mobile.navigate.history.add(t.href,{hash:t.hash})}(e),function(e,t,i,n){function r(e){for(;e&&void 0!==e.originalEvent;)e=e.originalEvent;return e}function o(t,i){var o,a,s,l,c,u,h,d,p,f=t.type;if((t=e.Event(t)).type=i,o=t.originalEvent,a=e.event.props,f.search(/^(mouse|click)/)>-1&&(a=C),o)for(h=a.length;h;)t[l=a[--h]]=o[l];if(f.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==f.search(/^touch/)&&(f=(s=r(o)).touches,c=s.changedTouches,u=f&&f.length?f[0]:c&&c.length?c[0]:n))for(d=0,p=M.length;p>d;d++)t[l=M[d]]=u[l];return t}function a(t){for(var i,n,r={};t;){for(n in i=e.data(t,w))i[n]&&(r[n]=r.hasVirtualBinding=!0);t=t.parentNode}return r}function s(){D=!0}function l(){D=!1}function c(){u(),A=setTimeout(function(){A=0,F=0,I.length=0,k=!1,s()},e.vmouse.resetTimerDuration)}function u(){A&&(clearTimeout(A),A=0)}function h(t,i,n){var r;return(n&&n[t]||!n&&function(t,i){for(var n;t;){if((n=e.data(t,w))&&(!i||n[i]))return t;t=t.parentNode}return null}(i.target,t))&&(r=o(i,t),e(i.target).trigger(r)),r}function d(t){var i,n=e.data(t.target,E);k||F&&F===n||(i=h("v"+t.type,t))&&(i.isDefaultPrevented()&&t.preventDefault(),i.isPropagationStopped()&&t.stopPropagation(),i.isImmediatePropagationStopped()&&t.stopImmediatePropagation())}function p(t){var i,n,o,s=r(t).touches;s&&1===s.length&&((n=a(i=t.target)).hasVirtualBinding&&(F=B++,e.data(i,E,F),u(),l(),O=!1,o=r(t).touches[0],P=o.pageX,L=o.pageY,h("vmouseover",t,n),h("vmousedown",t,n)))}function f(e){D||(O||h("vmousecancel",e,a(e.target)),O=!0,c())}function m(t){if(!D){var i=r(t).touches[0],n=O,o=e.vmouse.moveDistanceThreshold,s=a(t.target);(O=O||Math.abs(i.pageX-P)>o||Math.abs(i.pageY-L)>o)&&!n&&h("vmousecancel",t,s),h("vmousemove",t,s),c()}}function g(e){if(!D){s();var t,i,n=a(e.target);h("vmouseup",e,n),O||(t=h("vclick",e,n))&&t.isDefaultPrevented()&&(i=r(e).changedTouches[0],I.push({touchID:F,x:i.clientX,y:i.clientY}),k=!0),h("vmouseout",e,n),O=!1,c()}}function v(t){var i,n=e.data(t,w);if(n)for(i in n)if(n[i])return!0;return!1}function y(){}function b(t){var i=t.substr(1);return{setup:function(){v(this)||e.data(this,w,{}),e.data(this,w)[t]=!0,R[t]=(R[t]||0)+1,1===R[t]&&H.bind(i,d),e(this).bind(i,y),N&&(R.touchstart=(R.touchstart||0)+1,1===R.touchstart&&H.bind("touchstart",p).bind("touchend",g).bind("touchmove",m).bind("scroll",f))},teardown:function(){--R[t],R[t]||H.unbind(i,d),N&&(--R.touchstart,R.touchstart||H.unbind("touchstart",p).unbind("touchmove",m).unbind("touchend",g).unbind("scroll",f));var n=e(this),r=e.data(this,w);r&&(r[t]=!1),n.unbind(i,y),v(this)||n.removeData(w)}}}var x,_,w="virtualMouseBindings",E="virtualTouchID",T="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),M="clientX clientY pageX pageY screenX screenY".split(" "),S=e.event.mouseHooks?e.event.mouseHooks.props:[],C=e.event.props.concat(S),R={},A=0,P=0,L=0,O=!1,I=[],k=!1,D=!1,N="addEventListener"in i,H=e(i),B=1,F=0;for(e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},_=0;_<T.length;_++)e.event.special[T[_]]=b(T[_]);N&&i.addEventListener("click",function(t){var i,n,r,o,a,s=I.length,l=t.target;if(s)for(i=t.clientX,n=t.clientY,x=e.vmouse.clickDistanceThreshold,r=l;r;){for(o=0;s>o;o++)if(a=I[o],0,r===l&&Math.abs(a.x-i)<x&&Math.abs(a.y-n)<x||e.data(r,E)===a.touchID)return t.preventDefault(),void t.stopPropagation();r=r.parentNode}},!0)}(e,0,i),function(e){function t(t,i,n){var r=n.type;n.type=i,e.event.dispatch.call(t,n),n.type=r}var n=e(i),r=e.mobile.support.touch,o="touchmove scroll",a=r?"touchstart":"mousedown",s=r?"touchend":"mouseup",l=r?"touchmove":"mousemove";e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,i){e.fn[i]=function(e){return e?this.bind(i,e):this.trigger(i)},e.attrFn&&(e.attrFn[i]=!0)}),e.event.special.scrollstart={enabled:!0,setup:function(){function i(e,i){t(a,(n=i)?"scrollstart":"scrollstop",e)}var n,r,a=this;e(a).bind(o,function(t){e.event.special.scrollstart.enabled&&(n||i(t,!0),clearTimeout(r),r=setTimeout(function(){i(t,!1)},50))})},teardown:function(){e(this).unbind(o)}},e.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var i=this,r=e(i),o=!1;r.bind("vmousedown",function(a){function s(){clearTimeout(u)}function l(){s(),r.unbind("vclick",c).unbind("vmouseup",s),n.unbind("vmousecancel",l)}function c(e){l(),o||h!==e.target?o&&e.stopPropagation():t(i,"tap",e)}if(o=!1,a.which&&1!==a.which)return!1;var u,h=a.target;r.bind("vmouseup",s).bind("vclick",c),n.bind("vmousecancel",l),u=setTimeout(function(){e.event.special.tap.emitTapOnTaphold||(o=!0),t(i,"taphold",e.Event("taphold",{target:h}))},e.event.special.tap.tapholdThreshold)})},teardown:function(){e(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),n.unbind("vmousecancel")}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,start:function(t){var i=t.originalEvent.touches?t.originalEvent.touches[0]:t;return{time:(new Date).getTime(),coords:[i.pageX,i.pageY],origin:e(t.target)}},stop:function(e){var t=e.originalEvent.touches?e.originalEvent.touches[0]:e;return{time:(new Date).getTime(),coords:[t.pageX,t.pageY]}},handleSwipe:function(i,n,r,o){if(n.time-i.time<e.event.special.swipe.durationThreshold&&Math.abs(i.coords[0]-n.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(i.coords[1]-n.coords[1])<e.event.special.swipe.verticalDistanceThreshold){var a=i.coords[0]>n.coords[0]?"swipeleft":"swiperight";return t(r,"swipe",e.Event("swipe",{target:o,swipestart:i,swipestop:n})),t(r,a,e.Event(a,{target:o,swipestart:i,swipestop:n})),!0}return!1},setup:function(){var t=this,i=e(t);i.bind(a,function(n){function r(i){a&&(o=e.event.special.swipe.stop(i),u||(u=e.event.special.swipe.handleSwipe(a,o,t,c)),Math.abs(a.coords[0]-o.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&i.preventDefault())}var o,a=e.event.special.swipe.start(n),c=n.target,u=!1;i.bind(l,r).one(s,function(){u=!0,i.unbind(l,r)})})},teardown:function(){e(this).unbind(a).unbind(l).unbind(s)}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe",swiperight:"swipe"},function(t,i){e.event.special[t]={setup:function(){e(this).bind(i,e.noop)},teardown:function(){e(this).unbind(i)}}})}(e),function(e){e.event.special.throttledresize={setup:function(){e(this).bind("resize",r)},teardown:function(){e(this).unbind("resize",r)}};var t,i,n,r=function(){i=(new Date).getTime(),(n=i-o)>=250?(o=i,e(this).trigger("throttledresize")):(t&&clearTimeout(t),t=setTimeout(r,250-n))},o=0}(e),function(e,t){function n(){var e=r();e!==o&&(o=e,u.trigger(h))}var r,o,a,s,l,c,u=e(t),h="orientationchange",d={0:!0,180:!0};e.support.orientation&&(a=(l=t.innerWidth||u.width())>(c=t.innerHeight||u.height())&&l-c>50,s=d[t.orientation],(a&&s||!a&&!s)&&(d={"-90":!0,90:!0})),e.event.special.orientationchange=e.extend({},e.event.special.orientationchange,{setup:function(){return!(e.support.orientation&&!e.event.special.orientationchange.disabled)&&(o=r(),void u.bind("throttledresize",n))},teardown:function(){return!(e.support.orientation&&!e.event.special.orientationchange.disabled)&&void u.unbind("throttledresize",n)},add:function(e){var t=e.handler;e.handler=function(e){return e.orientation=r(),t.apply(this,arguments)}}}),e.event.special.orientationchange.orientation=r=function(){var n=i.documentElement;return(e.support.orientation?d[t.orientation]:n&&n.clientWidth/n.clientHeight<1.1)?"portrait":"landscape"},e.fn[h]=function(e){return e?this.bind(h,e):this.trigger(h)},e.attrFn&&(e.attrFn[h]=!0)}(e,this),function(e){var t=e("head").children("base"),i={element:t.length?t:e("<base>",{href:e.mobile.path.documentBase.hrefNoHash}).prependTo(e("head")),linkSelector:"[src], link[href], a[rel='external'], :jqmData(ajax='false'), a[target]",set:function(t){e.mobile.dynamicBaseEnabled&&e.support.dynamicBaseTag&&i.element.attr("href",e.mobile.path.makeUrlAbsolute(t,e.mobile.path.documentBase))},rewrite:function(t,n){var r=e.mobile.path.get(t);n.find(i.linkSelector).each(function(t,i){var n=e(i).is("[href]")?"href":e(i).is("[src]")?"src":"action",o=e(i).attr(n);o=o.replace(location.protocol+"//"+location.host+location.pathname,""),/^(\w+:|#|\/)/.test(o)||e(i).attr(n,r+o)})},reset:function(){i.element.attr("href",e.mobile.path.documentBase.hrefNoSearch)}};e.mobile.base=i}(e),function(e,t){e.mobile.widgets={};var i=e.widget,n=e.mobile.keepNative;e.widget=function(i){return function(){var n=i.apply(this,arguments),r=n.prototype.widgetName;return n.initSelector=n.prototype.initSelector!==t?n.prototype.initSelector:":jqmData(role='"+r+"')",e.mobile.widgets[r]=n,n}}(e.widget),e.extend(e.widget,i),e.mobile.document.on("create",function(t){e(t.target).enhanceWithin()}),e.widget("mobile.page",{options:{theme:"a",domCache:!1,keepNativeDefault:e.mobile.keepNative,contentTheme:null,enhanced:!1},_createWidget:function(){e.Widget.prototype._createWidget.apply(this,arguments),this._trigger("init")},_create:function(){return!1!==this._trigger("beforecreate")&&(this.options.enhanced||this._enhance(),this._on(this.element,{pagebeforehide:"removeContainerBackground",pagebeforeshow:"_handlePageBeforeShow"}),this.element.enhanceWithin(),void("dialog"===e.mobile.getAttribute(this.element[0],"role")&&e.mobile.dialog&&this.element.dialog()))},_enhance:function(){var i="data-"+e.mobile.ns,n=this;this.options.role&&this.element.attr("data-"+e.mobile.ns+"role",this.options.role),this.element.attr("tabindex","0").addClass("ui-page ui-page-theme-"+this.options.theme),this.element.find("["+i+"role='content']").each(function(){var r=e(this),o=this.getAttribute(i+"theme")||t;n.options.contentTheme=o||n.options.contentTheme||n.options.dialog&&n.options.theme||"dialog"===n.element.jqmData("role")&&n.options.theme,r.addClass("ui-content"),n.options.contentTheme&&r.addClass("ui-body-"+n.options.contentTheme),r.attr("role","main").addClass("ui-content")})},bindRemove:function(t){var i=this.element;!i.data("mobile-page").options.domCache&&i.is(":jqmData(external-page='true')")&&i.bind("pagehide.remove",t||function(t,i){if(!i.samePage){var n=e(this),r=new e.Event("pageremove");n.trigger(r),r.isDefaultPrevented()||n.removeWithDependents()}})},_setOptions:function(i){i.theme!==t&&this.element.removeClass("ui-body-"+this.options.theme).addClass("ui-body-"+i.theme),i.contentTheme!==t&&this.element.find("[data-"+e.mobile.ns+"='content']").removeClass("ui-body-"+this.options.contentTheme).addClass("ui-body-"+i.contentTheme)},_handlePageBeforeShow:function(){this.setContainerBackground()},removeContainerBackground:function(){this.element.closest(":mobile-pagecontainer").pagecontainer({theme:"none"})},setContainerBackground:function(e){this.element.parent().pagecontainer({theme:e||this.options.theme})},keepNativeSelector:function(){var t=this.options,i=e.trim(t.keepNative||""),r=e.trim(e.mobile.keepNative),o=e.trim(t.keepNativeDefault),a=n===r?"":r,s=""===a?o:"";return(i?[i]:[]).concat(a?[a]:[]).concat(s?[s]:[]).join(", ")}})}(e),function(e,n){e.widget("mobile.pagecontainer",{options:{theme:"a"},initSelector:!1,_create:function(){this.setLastScrollEnabled=!0,this._on(this.window,{navigate:"_filterNavigateEvents"}),this._on(this.window,{navigate:"_disableRecordScroll",scrollstop:"_delayedRecordScroll"}),this._on({pagechange:"_afterContentChange"}),this.window.one("navigate",e.proxy(function(){this.setLastScrollEnabled=!0},this))},_setOptions:function(e){e.theme!==n&&"none"!==e.theme?this.element.removeClass("ui-overlay-"+this.options.theme).addClass("ui-overlay-"+e.theme):e.theme!==n&&this.element.removeClass("ui-overlay-"+this.options.theme),this._super(e)},_disableRecordScroll:function(){this.setLastScrollEnabled=!1},_enableRecordScroll:function(){this.setLastScrollEnabled=!0},_afterContentChange:function(){this.setLastScrollEnabled=!0,this._off(this.window,"scrollstop"),this._on(this.window,{scrollstop:"_delayedRecordScroll"})},_recordScroll:function(){if(this.setLastScrollEnabled){var e,t,i,n=this._getActiveHistory();n&&(e=this._getScroll(),t=this._getMinScroll(),i=this._getDefaultScroll(),n.lastScroll=t>e?i:e)}},_delayedRecordScroll:function(){setTimeout(e.proxy(this,"_recordScroll"),100)},_getScroll:function(){return this.window.scrollTop()},_getMinScroll:function(){return e.mobile.minScrollBack},_getDefaultScroll:function(){return e.mobile.defaultHomeScroll},_filterNavigateEvents:function(t,i){var n;t.originalEvent&&t.originalEvent.isDefaultPrevented()||((n=t.originalEvent.type.indexOf("hashchange")>-1?i.state.hash:i.state.url)||(n=this._getHash()),n&&"#"!==n&&0!==n.indexOf("#"+e.mobile.path.uiStateKey)||(n=location.href),this._handleNavigate(n,i.state))},_getHash:function(){return e.mobile.path.parseLocation().hash},getActivePage:function(){return this.activePage},_getInitialContent:function(){return e.mobile.firstPage},_getHistory:function(){return e.mobile.navigate.history},_getActiveHistory:function(){return e.mobile.navigate.history.getActive()},_getDocumentBase:function(){return e.mobile.path.documentBase},back:function(){this.go(-1)},forward:function(){this.go(1)},go:function(i){if(e.mobile.hashListeningEnabled)t.history.go(i);else{var n=e.mobile.navigate.history.activeIndex,r=n+parseInt(i,10),o=e.mobile.navigate.history.stack[r].url,a=i>=1?"forward":"back";e.mobile.navigate.history.activeIndex=r,e.mobile.navigate.history.previousIndex=n,this.change(o,{direction:a,changeHash:!1,fromHashChange:!0})}},_handleDestination:function(t){var i;return"string"===e.type(t)&&(t=e.mobile.path.stripHash(t)),t&&(i=this._getHistory(),(t=e.mobile.path.isPath(t)?t:e.mobile.path.makeUrlAbsolute("#"+t,this._getDocumentBase()))===e.mobile.path.makeUrlAbsolute("#"+i.initialDst,this._getDocumentBase())&&i.stack.length&&i.stack[0].url!==i.initialDst.replace(e.mobile.dialogHashKey,"")&&(t=this._getInitialContent())),t||this._getInitialContent()},_handleDialog:function(t,i){var n,r,o=this.getActivePage();return o&&!o.hasClass("ui-dialog")?("back"===i.direction?this.back():this.forward(),!1):(n=i.pageUrl,r=this._getActiveHistory(),e.extend(t,{role:r.role,transition:r.transition,reverse:"back"===i.direction}),n)},_handleNavigate:function(t,i){var r=e.mobile.path.stripHash(t),o=this._getHistory(),a=0===o.stack.length?"none":n,s={changeHash:!1,fromHashChange:!0,reverse:"back"===i.direction};e.extend(s,i,{transition:(o.getLast()||{}).transition||a}),o.activeIndex>0&&r.indexOf(e.mobile.dialogHashKey)>-1&&o.initialDst!==r&&!1===(r=this._handleDialog(s,i))||this._changeContent(this._handleDestination(r),s)},_changeContent:function(t,i){e.mobile.changePage(t,i)},_getBase:function(){return e.mobile.base},_getNs:function(){return e.mobile.ns},_enhance:function(e,t){return e.page({role:t})},_include:function(e,t){e.appendTo(this.element),this._enhance(e,t.role),e.page("bindRemove")},_find:function(t){var i,n=this._createFileUrl(t),r=this._createDataUrl(t),o=this._getInitialContent();return 0===(i=this.element.children("[data-"+this._getNs()+"url='"+r+"']")).length&&r&&!e.mobile.path.isPath(r)&&(i=this.element.children(e.mobile.path.hashToSelector("#"+r)).attr("data-"+this._getNs()+"url",r).jqmData("url",r)),0===i.length&&e.mobile.path.isFirstPageUrl(n)&&o&&o.parent().length&&(i=e(o)),i},_getLoader:function(){return e.mobile.loading()},_showLoading:function(t,i,n,r){this._loadMsg||(this._loadMsg=setTimeout(e.proxy(function(){this._getLoader().loader("show",i,n,r),this._loadMsg=0},this),t))},_hideLoading:function(){clearTimeout(this._loadMsg),this._loadMsg=0,this._getLoader().loader("hide")},_showError:function(){this._hideLoading(),this._showLoading(0,e.mobile.pageLoadErrorMessageTheme,e.mobile.pageLoadErrorMessage,!0),setTimeout(e.proxy(this,"_hideLoading"),1500)},_parse:function(t,i){var n,r=e("<div></div>");return r.get(0).innerHTML=t,(n=r.find(":jqmData(role='page'), :jqmData(role='dialog')").first()).length||(n=e("<div data-"+this._getNs()+"role='page'>"+(t.split(/<\/?body[^>]*>/gim)[1]||"")+"</div>")),n.attr("data-"+this._getNs()+"url",e.mobile.path.convertUrlToDataUrl(i)).attr("data-"+this._getNs()+"external-page",!0),n},_setLoadedTitle:function(t,i){var n=i.match(/<title[^>]*>([^<]*)/)&&RegExp.$1;n&&!t.jqmData("title")&&(n=e("<div>"+n+"</div>").text(),t.jqmData("title",n))},_isRewritableBaseTag:function(){return e.mobile.dynamicBaseEnabled&&!e.support.dynamicBaseTag},_createDataUrl:function(t){return e.mobile.path.convertUrlToDataUrl(t)},_createFileUrl:function(t){return e.mobile.path.getFilePath(t)},_triggerWithDeprecated:function(t,i,n){var r=e.Event("page"+t),o=e.Event(this.widgetName+t);return(n||this.element).trigger(r,i),this.element.trigger(o,i),{deprecatedEvent:r,event:o}},_loadSuccess:function(t,i,r,o){var a=this._createFileUrl(t),s=this._createDataUrl(t);return e.proxy(function(l,c,u){var h,d=new RegExp("(<[^>]+\\bdata-"+this._getNs()+"role=[\"']?page[\"']?[^>]*>)"),p=new RegExp("\\bdata-"+this._getNs()+"url=[\"']?([^\"'>]*)[\"']?");d.test(l)&&RegExp.$1&&p.test(RegExp.$1)&&RegExp.$1&&(a=e.mobile.path.getFilePath(e("<div>"+RegExp.$1+"</div>").text())),r.prefetch===n&&this._getBase().set(a),h=this._parse(l,a),this._setLoadedTitle(h,l),i.xhr=u,i.textStatus=c,i.page=h,i.content=h,this._trigger("load",n,i)&&(this._isRewritableBaseTag()&&h&&this._getBase().rewrite(a,h),this._include(h,r),t.indexOf("&"+e.mobile.subPageUrlKey)>-1&&(h=this.element.children("[data-"+this._getNs()+"url='"+s+"']")),r.showLoadMsg&&this._hideLoading(),this.element.trigger("pageload"),o.resolve(t,r,h))},this)},_loadDefaults:{type:"get",data:n,reloadPage:!1,reload:!1,role:n,showLoadMsg:!1,loadMsgDelay:50},load:function(t,i){var r,o,a,s,l,c=i&&i.deferred||e.Deferred(),u=e.extend({},this._loadDefaults,i),h=e.mobile.path.makeUrlAbsolute(t,this._findBaseWithDefault());return u.reload=u.reloadPage,u.data&&"get"===u.type&&(h=e.mobile.path.addSearchParams(h,u.data),u.data=n),u.data&&"post"===u.type&&(u.reload=!0),r=this._createFileUrl(h),o=this._createDataUrl(h),0===(l=this._find(h)).length&&e.mobile.path.isEmbeddedPage(r)&&!e.mobile.path.isFirstPageUrl(r)?void c.reject(h,u):(this._getBase().reset(),l.length&&!u.reload?(this._enhance(l,u.role),c.resolve(h,u,l),void(u.prefetch||this._getBase().set(t))):(s={url:t,absUrl:h,dataUrl:o,deferred:c,options:u},(a=this._triggerWithDeprecated("beforeload",s)).deprecatedEvent.isDefaultPrevented()||a.event.isDefaultPrevented()?void 0:(u.showLoadMsg&&this._showLoading(u.loadMsgDelay),u.prefetch===n&&this._getBase().reset(),e.mobile.allowCrossDomainPages||e.mobile.path.isSameDomain(e.mobile.path.documentUrl,h)?void e.ajax({url:r,type:u.type,data:u.data,contentType:u.contentType,dataType:"html",success:this._loadSuccess(h,s,u,c),error:this._loadError(h,s,u,c)}):void c.reject(h,u))))},_loadError:function(t,i,n,r){return e.proxy(function(o,a,s){this._getBase().set(e.mobile.path.get()),i.xhr=o,i.textStatus=a,i.errorThrown=s;var l=this._triggerWithDeprecated("loadfailed",i);l.deprecatedEvent.isDefaultPrevented()||l.event.isDefaultPrevented()||(n.showLoadMsg&&this._showError(),r.reject(t,n))},this)},_getTransitionHandler:function(t){return t=e.mobile._maybeDegradeTransition(t),e.mobile.transitionHandlers[t]||e.mobile.defaultTransitionHandler},_triggerCssTransitionEvents:function(t,i,n){var r=!1;n=n||"",i&&(t[0]===i[0]&&(r=!0),this._triggerWithDeprecated(n+"hide",{nextPage:t,samePage:r},i)),this._triggerWithDeprecated(n+"show",{prevPage:i||e("")},t)},_cssTransition:function(t,i,n){var r,o=n.transition,a=n.reverse,s=n.deferred;this._triggerCssTransitionEvents(t,i,"before"),this._hideLoading(),(r=new(this._getTransitionHandler(o))(o,a,t,i).transition()).done(function(){s.resolve.apply(s,arguments)}),r.done(e.proxy(function(){this._triggerCssTransitionEvents(t,i)},this))},_releaseTransitionLock:function(){o=!1,r.length>0&&e.mobile.changePage.apply(null,r.pop())},_removeActiveLinkClass:function(t){e.mobile.removeActiveLinkClass(t)},_loadUrl:function(t,i,n){n.target=t,n.deferred=e.Deferred(),this.load(t,n),n.deferred.done(e.proxy(function(e,t,n){o=!1,t.absUrl=i.absUrl,this.transition(n,i,t)},this)),n.deferred.fail(e.proxy(function(){this._removeActiveLinkClass(!0),this._releaseTransitionLock(),this._triggerWithDeprecated("changefailed",i)},this))},_triggerPageBeforeChange:function(t,i,n){var r=new e.Event("pagebeforechange");return e.extend(i,{toPage:t,options:n}),i.absUrl="string"===e.type(t)?e.mobile.path.makeUrlAbsolute(t,this._findBaseWithDefault()):n.absUrl,this.element.trigger(r,i),!r.isDefaultPrevented()},change:function(t,i){if(o)r.unshift(arguments);else{var n=e.extend({},e.mobile.changePage.defaults,i),a={};n.fromPage=n.fromPage||this.activePage,this._triggerPageBeforeChange(t,a,n)&&(t=a.toPage,"string"===e.type(t)?(o=!0,this._loadUrl(t,a,n)):this.transition(t,a,n))}},transition:function(t,a,s){var l,c,u,h,d,p,f,m,g,v,y,b,x;if(o)r.unshift([t,s]);else if(this._triggerPageBeforeChange(t,a,s)&&(!(x=this._triggerWithDeprecated("beforetransition",a)).deprecatedEvent.isDefaultPrevented()&&!x.event.isDefaultPrevented())){if(o=!0,t[0]!==e.mobile.firstPage[0]||s.dataUrl||(s.dataUrl=e.mobile.path.documentUrl.hrefNoHash),l=s.fromPage,u=c=s.dataUrl&&e.mobile.path.convertUrlToDataUrl(s.dataUrl)||t.jqmData("url"),e.mobile.path.getFilePath(c),h=e.mobile.navigate.history.getActive(),d=0===e.mobile.navigate.history.activeIndex,p=0,f=i.title,m=("dialog"===s.role||"dialog"===t.jqmData("role"))&&!0!==t.jqmData("dialog"),l&&l[0]===t[0]&&!s.allowSamePageTransition)return o=!1,this._triggerWithDeprecated("transition",a),this.element.trigger("pagechange",a),void(s.fromHashChange&&e.mobile.navigate.history.direct({url:c}));t.page({role:s.role}),s.fromHashChange&&(p="back"===s.direction?-1:1);try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()?e(i.activeElement).blur():e("input:focus, textarea:focus, select:focus").blur()}catch(e){}g=!1,m&&h&&(h.url&&h.url.indexOf(e.mobile.dialogHashKey)>-1&&this.activePage&&!this.activePage.hasClass("ui-dialog")&&e.mobile.navigate.history.activeIndex>0&&(s.changeHash=!1,g=!0),c=h.url||"",c+=!g&&c.indexOf("#")>-1?e.mobile.dialogHashKey:"#"+e.mobile.dialogHashKey,0===e.mobile.navigate.history.activeIndex&&c===e.mobile.navigate.history.initialDst&&(c+=e.mobile.dialogHashKey)),(v=h?t.jqmData("title")||t.children(":jqmData(role='header')").find(".ui-title").text():f)&&f===i.title&&(f=v),t.jqmData("title")||t.jqmData("title",f),s.transition=s.transition||(p&&!d?h.transition:n)||(m?e.mobile.defaultDialogTransition:e.mobile.defaultPageTransition),!p&&g&&(e.mobile.navigate.history.getActive().pageUrl=u),c&&!s.fromHashChange&&(!e.mobile.path.isPath(c)&&c.indexOf("#")<0&&(c="#"+c),y={transition:s.transition,title:f,pageUrl:u,role:s.role},!1!==s.changeHash&&e.mobile.hashListeningEnabled?e.mobile.navigate(c,y,!0):t[0]!==e.mobile.firstPage[0]&&e.mobile.navigate.history.add(c,y)),i.title=f,e.mobile.activePage=t,this.activePage=t,s.reverse=s.reverse||0>p,b=e.Deferred(),this._cssTransition(t,l,{transition:s.transition,reverse:s.reverse,deferred:b}),b.done(e.proxy(function(i,n,r,o,l){e.mobile.removeActiveLinkClass(),s.duplicateCachedPage&&s.duplicateCachedPage.remove(),l||e.mobile.focusPage(t),this._releaseTransitionLock(),this.element.trigger("pagechange",a),this._triggerWithDeprecated("transition",a)},this))}},_findBaseWithDefault:function(){return this.activePage&&e.mobile.getClosestBaseUrl(this.activePage)||e.mobile.path.documentBase.hrefNoHash}}),e.mobile.navreadyDeferred=e.Deferred();var r=[],o=!1}(e),function(e,i){function n(e){for(;e&&("string"!=typeof e.nodeName||"a"!==e.nodeName.toLowerCase());)e=e.parentNode;return e}var r=e.Deferred(),o=e.mobile.path.documentUrl,a=null;e.mobile.loadPage=function(t,i){var n;return n=(i=i||{}).pageContainer||e.mobile.pageContainer,i.deferred=e.Deferred(),n.pagecontainer("load",t,i),i.deferred.promise()},e.mobile.back=function(){var i=t.navigator;this.phonegapNavigationEnabled&&i&&i.app&&i.app.backHistory?i.app.backHistory():e.mobile.pageContainer.pagecontainer("back")},e.mobile.focusPage=function(e){var t=e.find("[autofocus]"),i=e.find(".ui-title:eq(0)");return t.length?void t.focus():void(i.length?i.focus():e.focus())},e.mobile._maybeDegradeTransition=e.mobile._maybeDegradeTransition||function(e){return e},e.fn.animationComplete=function(t){return e.support.cssTransitions?e(this).one("webkitAnimationEnd animationend",t):(setTimeout(t,0),e(this))},e.mobile.changePage=function(t,i){e.mobile.pageContainer.pagecontainer("change",t,i)},e.mobile.changePage.defaults={transition:i,reverse:!1,changeHash:!0,fromHashChange:!1,role:i,duplicateCachedPage:i,pageContainer:i,showLoadMsg:!0,dataUrl:i,fromPage:i,allowSamePageTransition:!1},e.mobile._registerInternalEvents=function(){var r=function(t,i){var n,r,s,l,c=!0;return!(!e.mobile.ajaxEnabled||t.is(":jqmData(ajax='false')")||!t.jqmHijackable().length||t.attr("target"))&&(n=a&&a.attr("formaction")||t.attr("action"),l=(t.attr("method")||"get").toLowerCase(),n||(n=e.mobile.getClosestBaseUrl(t),"get"===l&&(n=e.mobile.path.parseUrl(n).hrefNoSearch),n===e.mobile.path.documentBase.hrefNoHash&&(n=o.hrefNoSearch)),n=e.mobile.path.makeUrlAbsolute(n,e.mobile.getClosestBaseUrl(t)),!(e.mobile.path.isExternal(n)&&!e.mobile.path.isPermittedCrossDomainRequest(o,n))&&(i||(r=t.serializeArray(),a&&a[0].form===t[0]&&((s=a.attr("name"))&&(e.each(r,function(e,t){return t.name===s?(s="",!1):void 0}),s&&r.push({name:s,value:a.attr("value")}))),c={url:n,options:{type:l,data:e.param(r),transition:t.jqmData("transition"),reverse:"reverse"===t.jqmData("direction"),reloadPage:!0}}),c))};e.mobile.document.delegate("form","submit",function(t){var i;t.isDefaultPrevented()||(i=r(e(this)))&&(e.mobile.changePage(i.url,i.options),t.preventDefault())}),e.mobile.document.bind("vclick",function(t){var i,o,s=t.target,l=!1;if(!(t.which>1)&&e.mobile.linkBindingEnabled){if(a=e(s),e.data(s,"mobile-button")){if(!r(e(s).closest("form"),!0))return;s.parentNode&&(s=s.parentNode)}else{if(!(s=n(s))||"#"===e.mobile.path.parseUrl(s.getAttribute("href")||"#").hash)return;if(!e(s).jqmHijackable().length)return}~s.className.indexOf("ui-link-inherit")?s.parentNode&&(o=e.data(s.parentNode,"buttonElements")):o=e.data(s,"buttonElements"),o?s=o.outer:l=!0,i=e(s),l&&(i=i.closest(".ui-btn")),i.length>0&&!i.hasClass("ui-state-disabled")&&(e.mobile.removeActiveLinkClass(!0),e.mobile.activeClickedLink=i,e.mobile.activeClickedLink.addClass(e.mobile.activeBtnClass))}}),e.mobile.document.bind("click",function(r){if(e.mobile.linkBindingEnabled&&!r.isDefaultPrevented()){var a,s,l,c,u,h=n(r.target),d=e(h),p=function(){t.setTimeout(function(){e.mobile.removeActiveLinkClass(!0)},200)};if(e.mobile.activeClickedLink&&e.mobile.activeClickedLink[0]===r.target.parentNode&&p(),h&&!(r.which>1)&&d.jqmHijackable().length){if(d.is(":jqmData(rel='back')"))return e.mobile.back(),!1;if(a=e.mobile.getClosestBaseUrl(d),s=e.mobile.path.makeUrlAbsolute(d.attr("href")||"#",a),!e.mobile.ajaxEnabled&&!e.mobile.path.isEmbeddedPage(s))return void p();if(-1!==s.search("#")){if(!(s=s.replace(/[^#]*#/,"")))return void r.preventDefault();s=e.mobile.path.isPath(s)?e.mobile.path.makeUrlAbsolute(s,a):e.mobile.path.makeUrlAbsolute("#"+s,o.hrefNoHash)}if(d.is("[rel='external']")||d.is(":jqmData(ajax='false')")||d.is("[target]")||e.mobile.path.isExternal(s)&&!e.mobile.path.isPermittedCrossDomainRequest(o,s))return void p();l=d.jqmData("transition"),c="reverse"===d.jqmData("direction")||d.jqmData("back"),u=d.attr("data-"+e.mobile.ns+"rel")||i,e.mobile.changePage(s,{transition:l,reverse:c,role:u,link:d}),r.preventDefault()}}}),e.mobile.document.delegate(".ui-page","pageshow.prefetch",function(){var t=[];e(this).find("a:jqmData(prefetch)").each(function(){var i=e(this),n=i.attr("href");n&&-1===e.inArray(n,t)&&(t.push(n),e.mobile.loadPage(n,{role:i.attr("data-"+e.mobile.ns+"rel"),prefetch:!0}))})}),e.mobile.pageContainer.pagecontainer(),e.mobile.document.bind("pageshow",e.mobile.resetActivePageHeight),e.mobile.window.bind("throttledresize",e.mobile.resetActivePageHeight)},e(function(){r.resolve()}),e.when(r,e.mobile.navreadyDeferred).done(function(){e.mobile._registerInternalEvents()})}(e),function(e,t){e.mobile.Transition=function(){this.init.apply(this,arguments)},e.extend(e.mobile.Transition.prototype,{toPreClass:" ui-page-pre-in",init:function(t,i,n,r){e.extend(this,{name:t,reverse:i,$to:n,$from:r,deferred:new e.Deferred})},cleanFrom:function(){this.$from.removeClass(e.mobile.activePageClass+" out in reverse "+this.name).height("")},beforeDoneIn:function(){},beforeDoneOut:function(){},beforeStartOut:function(){},doneIn:function(){this.beforeDoneIn(),this.$to.removeClass("out in reverse "+this.name).height(""),this.toggleViewportClass(),e.mobile.window.scrollTop()!==this.toScroll&&this.scrollPage(),this.sequential||this.$to.addClass(e.mobile.activePageClass),this.deferred.resolve(this.name,this.reverse,this.$to,this.$from,!0)},doneOut:function(e,t,i,n){this.beforeDoneOut(),this.startIn(e,t,i,n)},hideIn:function(e){this.$to.css("z-index",-10),e.call(this),this.$to.css("z-index","")},scrollPage:function(){e.event.special.scrollstart.enabled=!1,(e.mobile.hideUrlBar||this.toScroll!==e.mobile.defaultHomeScroll)&&t.scrollTo(0,this.toScroll),setTimeout(function(){e.event.special.scrollstart.enabled=!0},150)},startIn:function(t,i,n,r){this.hideIn(function(){this.$to.addClass(e.mobile.activePageClass+this.toPreClass),r||e.mobile.focusPage(this.$to),this.$to.height(t+this.toScroll),n||this.scrollPage()}),n||this.$to.animationComplete(e.proxy(function(){this.doneIn()},this)),this.$to.removeClass(this.toPreClass).addClass(this.name+" in "+i),n&&this.doneIn()},startOut:function(t,i,n){this.beforeStartOut(t,i,n),this.$from.height(t+e.mobile.window.scrollTop()).addClass(this.name+" out"+i)},toggleViewportClass:function(){e.mobile.pageContainer.toggleClass("ui-mobile-viewport-transitioning viewport-"+this.name)},transition:function(){var t=this.reverse?" reverse":"",i=e.mobile.getScreenHeight(),n=!1!==e.mobile.maxTransitionWidth&&e.mobile.window.width()>e.mobile.maxTransitionWidth,r=!e.support.cssTransitions||!e.support.cssAnimations||n||!this.name||"none"===this.name||Math.max(e.mobile.window.scrollTop(),this.toScroll)>e.mobile.getMaxScrollForTransition();return this.toScroll=e.mobile.navigate.history.getActive().lastScroll||e.mobile.defaultHomeScroll,this.toggleViewportClass(),this.$from&&!r?this.startOut(i,t,r):this.doneOut(i,t,r,!0),this.deferred.promise()}})}(e,this),function(e){e.mobile.SerialTransition=function(){this.init.apply(this,arguments)},e.extend(e.mobile.SerialTransition.prototype,e.mobile.Transition.prototype,{sequential:!0,beforeDoneOut:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(t,i,n){this.$from.animationComplete(e.proxy(function(){this.doneOut(t,i,n)},this))}})}(e),function(e){e.mobile.ConcurrentTransition=function(){this.init.apply(this,arguments)},e.extend(e.mobile.ConcurrentTransition.prototype,e.mobile.Transition.prototype,{sequential:!1,beforeDoneIn:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(e,t,i){this.doneOut(e,t,i)}})}(e),function(e){e.mobile.transitionHandlers={sequential:e.mobile.SerialTransition,simultaneous:e.mobile.ConcurrentTransition},e.mobile.defaultTransitionHandler=e.mobile.transitionHandlers.sequential,e.mobile.transitionFallbacks={},e.mobile._maybeDegradeTransition=function(t){return t&&!e.support.cssTransform3d&&e.mobile.transitionFallbacks[t]&&(t=e.mobile.transitionFallbacks[t]),t},e.mobile.getMaxScrollForTransition=e.mobile.getMaxScrollForTransition||function(){return 3*e.mobile.getScreenHeight()}}(e),function(e){e.mobile.transitionFallbacks.flip="fade"}(e),function(e){e.mobile.transitionFallbacks.flow="fade"}(e),function(e){e.mobile.transitionFallbacks.pop="fade"}(e),function(e){e.mobile.transitionHandlers.slide=e.mobile.transitionHandlers.simultaneous,e.mobile.transitionFallbacks.slide="fade"}(e),function(e){e.mobile.transitionFallbacks.slidedown="fade"}(e),function(e){e.mobile.transitionFallbacks.slidefade="fade"}(e),function(e){e.mobile.transitionFallbacks.slideup="fade"}(e),function(e){e.mobile.transitionFallbacks.turn="fade"}(e),function(e){e.mobile.degradeInputs={color:!1,date:!1,datetime:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:"number",search:"text",tel:!1,time:!1,url:!1,week:!1},e.mobile.page.prototype.options.degradeInputs=e.mobile.degradeInputs,e.mobile.degradeInputsWithin=function(t){(t=e(t)).find("input").not(e.mobile.page.prototype.keepNativeSelector()).each(function(){var t,i,n,r,o=e(this),a=this.getAttribute("type"),s=e.mobile.degradeInputs[a]||"text";e.mobile.degradeInputs[a]&&(n=(i=(t=e("<div>").html(o.clone()).html()).indexOf(" type=")>-1)?/\s+type=["']?\w+['"]?/:/\/?>/,r=' type="'+s+'" data-'+e.mobile.ns+'type="'+a+'"'+(i?"":">"),o.replaceWith(t.replace(n,r)))})}}(e),function(e,t,i){e.widget("mobile.page",e.mobile.page,{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0,dialog:!1},_create:function(){this._super(),this.options.dialog&&(e.extend(this,{_inner:this.element.children(),_headerCloseButton:null}),this.options.enhanced||this._setCloseBtn(this.options.closeBtn))},_enhance:function(){this._super(),this.options.dialog&&this.element.addClass("ui-dialog").wrapInner(e("<div/>",{role:"dialog",class:"ui-dialog-contain ui-overlay-shadow"+(this.options.corners?" ui-corner-all":"")}))},_setOptions:function(t){var n,r,o=this.options;t.corners!==i&&this._inner.toggleClass("ui-corner-all",!!t.corners),t.overlayTheme!==i&&e.mobile.activePage[0]===this.element[0]&&(o.overlayTheme=t.overlayTheme,this._handlePageBeforeShow()),t.closeBtnText!==i&&(n=o.closeBtn,r=t.closeBtnText),t.closeBtn!==i&&(n=t.closeBtn),n&&this._setCloseBtn(n,r),this._super(t)},_handlePageBeforeShow:function(){this.options.overlayTheme&&this.options.dialog?(this.removeContainerBackground(),this.setContainerBackground(this.options.overlayTheme)):this._super()},_setCloseBtn:function(t,i){var n,r=this._headerCloseButton;"none"===(t="left"===t?"left":"right"===t?"right":"none")?r&&(r.remove(),r=null):r?(r.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+t),i&&r.text(i)):(n=this._inner.find(":jqmData(role='header')").first(),r=e("<a></a>",{href:"#",class:"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+t}).attr("data-"+e.mobile.ns+"rel","back").text(i||this.options.closeBtnText||"").prependTo(n),this._on(r,{click:"close"})),this._headerCloseButton=r}})}(e),function(e,t,i){e.widget("mobile.dialog",{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0},_handlePageBeforeShow:function(){this._isCloseable=!0,this.options.overlayTheme&&this.element.page("removeContainerBackground").page("setContainerBackground",this.options.overlayTheme)},_handlePageBeforeHide:function(){this._isCloseable=!1},_handleVClickSubmit:function(t){var i,n=e(t.target).closest("vclick"===t.type?"a":"form");n.length&&!n.jqmData("transition")&&((i={})["data-"+e.mobile.ns+"transition"]=(e.mobile.navigate.history.getActive()||{}).transition||e.mobile.defaultDialogTransition,i["data-"+e.mobile.ns+"direction"]="reverse",n.attr(i))},_create:function(){var t=this.element,i=this.options;t.addClass("ui-dialog").wrapInner(e("<div/>",{role:"dialog",class:"ui-dialog-contain ui-overlay-shadow"+(i.corners?" ui-corner-all":"")})),e.extend(this,{_isCloseable:!1,_inner:t.children(),_headerCloseButton:null}),this._on(t,{vclick:"_handleVClickSubmit",submit:"_handleVClickSubmit",pagebeforeshow:"_handlePageBeforeShow",pagebeforehide:"_handlePageBeforeHide"}),this._setCloseBtn(i.closeBtn)},_setOptions:function(t){var n,r,o=this.options;t.corners!==i&&this._inner.toggleClass("ui-corner-all",!!t.corners),t.overlayTheme!==i&&e.mobile.activePage[0]===this.element[0]&&(o.overlayTheme=t.overlayTheme,this._handlePageBeforeShow()),t.closeBtnText!==i&&(n=o.closeBtn,r=t.closeBtnText),t.closeBtn!==i&&(n=t.closeBtn),n&&this._setCloseBtn(n,r),this._super(t)},_setCloseBtn:function(t,i){var n,r=this._headerCloseButton;"none"===(t="left"===t?"left":"right"===t?"right":"none")?r&&(r.remove(),r=null):r?(r.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+t),i&&r.text(i)):(n=this._inner.find(":jqmData(role='header')").first(),r=e("<a></a>",{role:"button",href:"#",class:"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+t}).text(i||this.options.closeBtnText||"").prependTo(n),this._on(r,{click:"close"})),this._headerCloseButton=r},close:function(){var t=e.mobile.navigate.history;this._isCloseable&&(this._isCloseable=!1,e.mobile.hashListeningEnabled&&t.activeIndex>0?e.mobile.back():e.mobile.pageContainer.pagecontainer("back"))}})}(e),function(e,t){var i=/([A-Z])/g;e.widget("mobile.collapsible",{options:{enhanced:!1,expandCueText:null,collapseCueText:null,collapsed:!0,heading:"h1,h2,h3,h4,h5,h6,legend",collapsedIcon:null,expandedIcon:null,iconpos:null,theme:null,contentTheme:null,inset:null,corners:null,mini:null},_create:function(){var t=this.element,i={accordion:t.closest(":jqmData(role='collapsible-set')"+(e.mobile.collapsibleset?", :mobile-collapsibleset":"")).addClass("ui-collapsible-set")};e.extend(this,{_ui:i}),this.options.enhanced?(i.heading=e(".ui-collapsible-heading",this.element[0]),i.content=i.heading.next(),i.anchor=e("a",i.heading[0]).first(),i.status=i.anchor.children(".ui-collapsible-heading-status")):this._enhance(t,i),this._on(i.heading,{tap:function(){i.heading.find("a").first().addClass(e.mobile.activeBtnClass)},click:function(e){this._handleExpandCollapse(!i.heading.hasClass("ui-collapsible-heading-collapsed")),e.preventDefault(),e.stopPropagation()}})},_getOptions:function(t){var n,r=this._ui.accordion,o=this._ui.accordionWidget;for(n in t=e.extend({},t),r.length&&!o&&(this._ui.accordionWidget=o=r.data("mobile-collapsibleset")),t)t[n]=null!=t[n]?t[n]:o?o.options[n]:r.length?e.mobile.getAttribute(r[0],n.replace(i,"-$1").toLowerCase()):null,null==t[n]&&(t[n]=e.mobile.collapsible.defaults[n]);return t},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:""},_enhance:function(t,i){var n,r=this._getOptions(this.options),o=this._themeClassFromOption("ui-body-",r.contentTheme);return t.addClass("ui-collapsible "+(r.inset?"ui-collapsible-inset ":"")+(r.inset&&r.corners?"ui-corner-all ":"")+(o?"ui-collapsible-themed-content ":"")),i.originalHeading=t.children(this.options.heading).first(),i.content=t.wrapInner("<div class='ui-collapsible-content "+o+"'></div>").children(".ui-collapsible-content"),i.heading=i.originalHeading,i.heading.is("legend")&&(i.heading=e("<div role='heading'>"+i.heading.html()+"</div>"),i.placeholder=e("<div>\x3c!-- placeholder for legend --\x3e</div>").insertBefore(i.originalHeading),i.originalHeading.remove()),n=r.collapsed?r.collapsedIcon?"ui-icon-"+r.collapsedIcon:"":r.expandedIcon?"ui-icon-"+r.expandedIcon:"",i.status=e("<span class='ui-collapsible-heading-status'></span>"),i.anchor=i.heading.detach().addClass("ui-collapsible-heading").append(i.status).wrapInner("<a href='#' class='ui-collapsible-heading-toggle'></a>").find("a").first().addClass("ui-btn "+(n?n+" ":"")+(n?"ui-btn-icon-"+("right"===r.iconpos?"right":"left")+" ":"")+this._themeClassFromOption("ui-btn-",r.theme)+" "+(r.mini?"ui-mini ":"")),i.heading.insertBefore(i.content),this._handleExpandCollapse(this.options.collapsed),i},refresh:function(){var t,i={};for(t in e.mobile.collapsible.defaults)i[t]=this.options[t];this._setOptions(i)},_setOptions:function(e){var i,n,r,o=this.element,a=this._getOptions(this.options),s=this._ui,l=s.anchor,c=s.status,u=this._getOptions(e);e.collapsed!==t&&this._handleExpandCollapse(e.collapsed),o.hasClass("ui-collapsible-collapsed")?(u.expandCueText!==t&&c.text(u.expandCueText),u.collapsedIcon!==t&&(a.collapsedIcon&&l.removeClass("ui-icon-"+a.collapsedIcon),u.collapsedIcon&&l.addClass("ui-icon-"+u.collapsedIcon))):(u.collapseCueText!==t&&c.text(u.collapseCueText),u.expandedIcon!==t&&(a.expandedIcon&&l.removeClass("ui-icon-"+a.expandedIcon),u.expandedIcon&&l.addClass("ui-icon-"+u.expandedIcon))),u.iconpos!==t&&(l.removeClass("ui-btn-icon-"+("right"===a.iconPos?"right":"left")),l.addClass("ui-btn-icon-"+("right"===u.iconPos?"right":"left"))),u.theme!==t&&(n=this._themeClassFromOption("ui-btn-",a.theme),i=this._themeClassFromOption("ui-btn-",u.theme),l.removeClass(n).addClass(i)),u.contentTheme!==t&&(n=this._themeClassFromOption("ui-body-",a.theme),i=this._themeClassFromOption("ui-body-",u.theme),s.content.removeClass(n).addClass(i)),u.inset!==t&&(o.toggleClass("ui-collapsible-inset",u.inset),r=!(!u.inset||!u.corners&&!a.corners)),u.corners!==t&&(r=!(!u.corners||!u.inset&&!a.inset)),r!==t&&o.toggleClass("ui-corner-all",r),u.mini!==t&&l.toggleClass("ui-mini",u.mini),this._super(e)},_handleExpandCollapse:function(t){var i=this._getOptions(this.options),n=this._ui;n.status.text(t?i.expandCueText:i.collapseCueText),n.heading.toggleClass("ui-collapsible-heading-collapsed",t).find("a").first().toggleClass("ui-icon-"+i.expandedIcon,!t).toggleClass("ui-icon-"+i.collapsedIcon,t||i.expandedIcon===i.collapsedIcon).removeClass(e.mobile.activeBtnClass),this.element.toggleClass("ui-collapsible-collapsed",t),n.content.toggleClass("ui-collapsible-content-collapsed",t).attr("aria-hidden",t).trigger("updatelayout"),this.options.collapsed=t,this._trigger(t?"collapse":"expand")},expand:function(){this._handleExpandCollapse(!1)},collapse:function(){this._handleExpandCollapse(!0)},_destroy:function(){var e=this._ui;this.options.enhanced||(e.placeholder?(e.originalHeading.insertBefore(e.placeholder),e.placeholder.remove(),e.heading.remove()):(e.status.remove(),e.heading.removeClass("ui-collapsible-heading ui-collapsible-heading-collapsed").children().contents().unwrap()),e.anchor.contents().unwrap(),e.content.contents().unwrap(),this.element.removeClass("ui-collapsible ui-collapsible-collapsed ui-collapsible-themed-content ui-collapsible-inset ui-corner-all"))}}),e.mobile.collapsible.defaults={expandCueText:" click to expand contents",collapseCueText:" click to collapse contents",collapsedIcon:"plus",contentTheme:"inherit",expandedIcon:"minus",iconpos:"left",inset:!0,corners:!0,theme:"inherit",mini:!1}}(e),function(e){e.mobile.behaviors.addFirstLastClasses={_getVisibles:function(e,t){var i;return t?i=e.not(".ui-screen-hidden"):0===(i=e.filter(":visible")).length&&(i=e.not(".ui-screen-hidden")),i},_addFirstLastClasses:function(e,t,i){e.removeClass("ui-first-child ui-last-child"),t.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child"),i||this.element.trigger("updatelayout")},_removeFirstLastClasses:function(e){e.removeClass("ui-first-child ui-last-child")}}}(e),function(e,t){var i=":mobile-collapsible, "+e.mobile.collapsible.initSelector;e.widget("mobile.collapsibleset",e.extend({initSelector:":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')",options:e.extend({enhanced:!1},e.mobile.collapsible.defaults),_handleCollapsibleExpand:function(t){var i=e(t.target).closest(".ui-collapsible");i.parent().is(":mobile-collapsibleset, :jqmData(role='collapsible-set')")&&i.siblings(".ui-collapsible:not(.ui-collapsible-collapsed)").collapsible("collapse")},_create:function(){var t=this.element,i=this.options;e.extend(this,{_classes:""}),i.enhanced||(t.addClass("ui-collapsible-set "+this._themeClassFromOption("ui-group-theme-",i.theme)+" "+(i.corners&&i.inset?"ui-corner-all ":"")),this.element.find(e.mobile.collapsible.initSelector).collapsible()),this._on(t,{collapsibleexpand:"_handleCollapsibleExpand"})},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:""},_init:function(){this._refresh(!0),this.element.children(i).filter(":jqmData(collapsed='false')").collapsible("expand")},_setOptions:function(e){var i,n,r=this.element,o=this._themeClassFromOption("ui-group-theme-",e.theme);return o&&r.removeClass(this._themeClassFromOption("ui-group-theme-",this.options.theme)).addClass(o),e.inset!==t&&(n=!(!e.inset||!e.corners&&!this.options.corners)),e.corners!==t&&(n=!(!e.corners||!e.inset&&!this.options.inset)),n!==t&&r.toggleClass("ui-corner-all",n),i=this._super(e),this.element.children(":mobile-collapsible").collapsible("refresh"),i},_destroy:function(){var e=this.element;this._removeFirstLastClasses(e.children(i)),e.removeClass("ui-collapsible-set ui-corner-all "+this._themeClassFromOption("ui-group-theme-",this.options.theme)).children(":mobile-collapsible").collapsible("destroy")},_refresh:function(t){var n=this.element.children(i);this.element.find(e.mobile.collapsible.initSelector).not(".ui-collapsible").collapsible(),this._addFirstLastClasses(n,this._getVisibles(n,t),t)},refresh:function(){this._refresh(!1)}},e.mobile.behaviors.addFirstLastClasses))}(e),function(e){e.fn.fieldcontain=function(){return this.addClass("ui-field-contain")}}(e),function(e){e.fn.grid=function(t){return this.each(function(){var i,n,r=e(this),o=e.extend({grid:null},t),a=r.children(),s={solo:1,a:2,b:3,c:4,d:5},l=o.grid;if(!l)if(a.length<=5)for(n in s)s[n]===a.length&&(l=n);else l="a",r.addClass("ui-grid-duo");i=s[l],r.addClass("ui-grid-"+l),a.filter(":nth-child("+i+"n+1)").addClass("ui-block-a"),i>1&&a.filter(":nth-child("+i+"n+2)").addClass("ui-block-b"),i>2&&a.filter(":nth-child("+i+"n+3)").addClass("ui-block-c"),i>3&&a.filter(":nth-child("+i+"n+4)").addClass("ui-block-d"),i>4&&a.filter(":nth-child("+i+"n+5)").addClass("ui-block-e")})}}(e),function(e,t){e.widget("mobile.navbar",{options:{iconpos:"top",grid:null},_create:function(){var t=this.element,n=t.find("a"),r=n.filter(":jqmData(icon)").length?this.options.iconpos:void 0;t.addClass("ui-navbar").attr("role","navigation").find("ul").jqmEnhanceable().grid({grid:this.options.grid}),n.each(function(){var t=e.mobile.getAttribute(this,"icon"),i=e.mobile.getAttribute(this,"theme"),n="ui-btn";i&&(n+=" ui-btn-"+i),t&&(n+=" ui-icon-"+t+" ui-btn-icon-"+r),e(this).addClass(n)}),t.delegate("a","vclick",function(){var t=e(this);t.hasClass("ui-state-disabled")||t.hasClass("ui-disabled")||t.hasClass(e.mobile.activeBtnClass)||(n.removeClass(e.mobile.activeBtnClass),t.addClass(e.mobile.activeBtnClass),e(i).one("pagehide",function(){t.removeClass(e.mobile.activeBtnClass)}))}),t.closest(".ui-page").bind("pagebeforeshow",function(){n.filter(".ui-state-persist").addClass(e.mobile.activeBtnClass)})}})}(e),function(e){var t=e.mobile.getAttribute;e.widget("mobile.listview",e.extend({options:{theme:null,countTheme:null,dividerTheme:null,icon:"carat-r",splitIcon:"carat-r",splitTheme:null,corners:!0,shadow:!0,inset:!1},_create:function(){var e=this,t="";t+=e.options.inset?" ui-listview-inset":"",e.options.inset&&(t+=e.options.corners?" ui-corner-all":"",t+=e.options.shadow?" ui-shadow":""),e.element.addClass(" ui-listview"+t),e.refresh(!0)},_findFirstElementByTagName:function(e,t,i,n){var r={};for(r[i]=r[n]=!0;e;){if(r[e.nodeName])return e;e=e[t]}return null},_addThumbClasses:function(t){var i,n,r=t.length;for(i=0;r>i;i++)(n=e(this._findFirstElementByTagName(t[i].firstChild,"nextSibling","img","IMG"))).length&&e(this._findFirstElementByTagName(n[0].parentNode,"parentNode","li","LI")).addClass(n.hasClass("ui-li-icon")?"ui-li-has-icon":"ui-li-has-thumb")},_getChildrenByTagName:function(t,i,n){var r=[],o={};for(o[i]=o[n]=!0,t=t.firstChild;t;)o[t.nodeName]&&r.push(t),t=t.nextSibling;return e(r)},_beforeListviewRefresh:e.noop,_afterListviewRefresh:e.noop,refresh:function(i){var n,r,o,a,s,l,c,u,h,d,p,f,m,g,v,y,b,x,_=this.options,w=this.element,E=!!e.nodeName(w[0],"ol"),T=w.attr("start"),M={},S=w.find(".ui-li-count"),C=t(w[0],"counttheme")||this.options.countTheme,R=C?"ui-body-"+C:"ui-body-inherit";for(_.theme&&w.addClass("ui-group-theme-"+_.theme),E&&(T||0===T)&&(p=parseInt(T,10)-1,w.css("counter-reset","listnumbering "+p)),this._beforeListviewRefresh(),r=0,o=(x=this._getChildrenByTagName(w[0],"li","LI")).length;o>r;r++)a=x.eq(r),s="",(i||a[0].className.search(/\bui-li-static\b|\bui-li-divider\b/)<0)&&(h=this._getChildrenByTagName(a[0],"a","A"),d="list-divider"===t(a[0],"role"),m=a.attr("value"),l=t(a[0],"theme"),h.length&&h[0].className.search(/\bui-btn\b/)<0&&!d?(u=!1!==(c=t(a[0],"icon"))&&(c||_.icon),h.removeClass("ui-link"),n="ui-btn",l&&(n+=" ui-btn-"+l),h.length>1?(s="ui-li-has-alt",g=h.last(),y=(v=t(g[0],"theme")||_.splitTheme||t(a[0],"theme",!0))?" ui-btn-"+v:"",b="ui-btn ui-btn-icon-notext ui-icon-"+(t(g[0],"icon")||t(a[0],"icon")||_.splitIcon)+y,g.attr("title",e.trim(g.getEncodedText())).addClass(b).empty()):u&&(n+=" ui-btn-icon-right ui-icon-"+u),h.first().addClass(n)):d?(s="ui-li-divider ui-bar-"+(t(a[0],"theme")||_.dividerTheme||_.theme||"inherit"),a.attr("role","heading")):h.length<=0&&(s="ui-li-static ui-body-"+(l||"inherit")),E&&m&&(f=parseInt(m,10)-1,a.css("counter-reset","listnumbering "+f))),M[s]||(M[s]=[]),M[s].push(a[0]);for(s in M)e(M[s]).addClass(s);S.each(function(){e(this).closest("li").addClass("ui-li-has-count")}),R&&S.addClass(R),this._addThumbClasses(x),this._addThumbClasses(x.find(".ui-btn")),this._afterListviewRefresh(),this._addFirstLastClasses(x,this._getVisibles(x,i),i)}},e.mobile.behaviors.addFirstLastClasses))}(e),function(e){e.widget("mobile.listview",e.mobile.listview,{options:{autodividers:!1,autodividersSelector:function(t){var i=e.trim(t.text())||null;return i?i=i.slice(0,1).toUpperCase():null}},_beforeListviewRefresh:function(){this.options.autodividers&&(this._replaceDividers(),this._superApply(arguments))},_replaceDividers:function(){var t,n,r,o,a,s=null,l=this.element;for(l.children("li:jqmData(role='list-divider')").remove(),n=l.children("li"),t=0;t<n.length;t++)r=n[t],(o=this.options.autodividersSelector(e(r)))&&s!==o&&((a=i.createElement("li")).appendChild(i.createTextNode(o)),a.setAttribute("data-"+e.mobile.ns+"role","list-divider"),r.parentNode.insertBefore(a,r)),s=o}})}(e),function(e){var t=/(^|\s)ui-li-divider($|\s)/,i=/(^|\s)ui-screen-hidden($|\s)/;e.widget("mobile.listview",e.mobile.listview,{options:{hideDividers:!1},_afterListviewRefresh:function(){var e,n,r,o=!0;if(this._superApply(arguments),this.options.hideDividers)for(n=(e=this._getChildrenByTagName(this.element[0],"li","LI")).length-1;n>-1;n--)(r=e[n]).className.match(t)?(o&&(r.className=r.className+" ui-screen-hidden"),o=!0):r.className.match(i)||(o=!1)}})}(e),function(e){e.mobile.nojs=function(t){e(":jqmData(role='nojs')",t).addClass("ui-nojs")}}(e),function(e){e.mobile.behaviors.formReset={_handleFormReset:function(){this._on(this.element.closest("form"),{reset:function(){this._delay("_reset")}})}}}(e),function(e,t){e.widget("mobile.checkboxradio",e.extend({initSelector:"input:not( :jqmData(role='flipswitch' ) )[type='checkbox'],input[type='radio']:not( :jqmData(role='flipswitch' ))",options:{theme:"inherit",mini:!1,wrapperClass:null,enhanced:!1,iconpos:"left"},_create:function(){var t=this.element,i=this.options,n=function(e,t){return e.jqmData(t)||e.closest("form, fieldset").jqmData(t)},r=t.closest("label"),o=r.length?r:t.closest("form, fieldset, :jqmData(role='page'), :jqmData(role='dialog')").find("label").filter("[for='"+e.mobile.path.hashToSelector(t[0].id)+"']").first(),a=t[0].type,s="ui-"+a+"-on",l="ui-"+a+"-off";("checkbox"===a||"radio"===a)&&(this.element[0].disabled&&(this.options.disabled=!0),i.iconpos=n(t,"iconpos")||o.attr("data-"+e.mobile.ns+"iconpos")||i.iconpos,i.mini=n(t,"mini")||i.mini,e.extend(this,{input:t,label:o,parentLabel:r,inputtype:a,checkedClass:s,uncheckedClass:l}),this.options.enhanced||this._enhance(),this._on(o,{vmouseover:"_handleLabelVMouseOver",vclick:"_handleLabelVClick"}),this._on(t,{vmousedown:"_cacheVals",vclick:"_handleInputVClick",focus:"_handleInputFocus",blur:"_handleInputBlur"}),this._handleFormReset(),this.refresh())},_enhance:function(){this.label.addClass("ui-btn ui-corner-all"),this.parentLabel.length>0?this.input.add(this.label).wrapAll(this._wrapper()):(this.element.wrap(this._wrapper()),this.element.parent().prepend(this.label)),this._setOptions({theme:this.options.theme,iconpos:this.options.iconpos,mini:this.options.mini})},_wrapper:function(){return e("<div class='"+(this.options.wrapperClass?this.options.wrapperClass:"")+" ui-"+this.inputtype+(this.options.disabled?" ui-state-disabled":"")+"' >")},_handleInputFocus:function(){this.label.addClass(e.mobile.focusClass)},_handleInputBlur:function(){this.label.removeClass(e.mobile.focusClass)},_handleInputVClick:function(){var e=this.element;e.is(":checked")?(e.prop("checked",!0),this._getInputSet().not(e).prop("checked",!1)):e.prop("checked",!1),this._updateAll()},_handleLabelVMouseOver:function(e){this.label.parent().hasClass("ui-state-disabled")&&e.stopPropagation()},_handleLabelVClick:function(e){var t=this.element;return t.is(":disabled")?void e.preventDefault():(this._cacheVals(),t.prop("checked","radio"===this.inputtype||!t.prop("checked")),t.triggerHandler("click"),this._getInputSet().not(t).prop("checked",!1),this._updateAll(),!1)},_cacheVals:function(){this._getInputSet().each(function(){e(this).attr("data-"+e.mobile.ns+"cacheVal",this.checked)})},_getInputSet:function(){return"checkbox"===this.inputtype?this.element:this.element.closest("form, :jqmData(role='page'), :jqmData(role='dialog')").find("input[name='"+this.element[0].name+"'][type='"+this.inputtype+"']")},_updateAll:function(){var t=this;this._getInputSet().each(function(){var i=e(this);(this.checked||"checkbox"===t.inputtype)&&i.trigger("change")}).checkboxradio("refresh")},_reset:function(){this.refresh()},_hasIcon:function(){var t,i,n=e.mobile.controlgroup;return!(n&&(t=this.element.closest(":mobile-controlgroup,"+n.prototype.initSelector),t.length>0))||"horizontal"!==((i=e.data(t[0],"mobile-controlgroup"))?i.options.type:t.attr("data-"+e.mobile.ns+"type"))},refresh:function(){var t=this._hasIcon(),i=this.element[0].checked,n=e.mobile.activeBtnClass,r="ui-btn-icon-"+this.options.iconpos,o=[],a=[];t?(a.push(n),o.push(r)):(a.push(r),(i?o:a).push(n)),i?(o.push(this.checkedClass),a.push(this.uncheckedClass)):(o.push(this.uncheckedClass),a.push(this.checkedClass)),this.label.addClass(o.join(" ")).removeClass(a.join(" "))},widget:function(){return this.label.parent()},_setOptions:function(e){var i=this.label,n=this.options,r=this.widget(),o=this._hasIcon();e.disabled!==t&&(this.input.prop("disabled",!!e.disabled),r.toggleClass("ui-state-disabled",!!e.disabled)),e.mini!==t&&r.toggleClass("ui-mini",!!e.mini),e.theme!==t&&i.removeClass("ui-btn-"+n.theme).addClass("ui-btn-"+e.theme),e.wrapperClass!==t&&r.removeClass(n.wrapperClass).addClass(e.wrapperClass),e.iconpos!==t&&o?i.removeClass("ui-btn-icon-"+n.iconpos).addClass("ui-btn-icon-"+e.iconpos):o||i.removeClass("ui-btn-icon-"+n.iconpos),this._super(e)}},e.mobile.behaviors.formReset))}(e),function(e,t){e.widget("mobile.button",{initSelector:"input[type='button'], input[type='submit'], input[type='reset']",options:{theme:null,icon:null,iconpos:"left",iconshadow:!1,corners:!0,shadow:!0,inline:null,mini:null,wrapperClass:null,enhanced:!1},_create:function(){this.element.is(":disabled")&&(this.options.disabled=!0),this.options.enhanced||this._enhance(),e.extend(this,{wrapper:this.element.parent()}),this._on({focus:function(){this.widget().addClass(e.mobile.focusClass)},blur:function(){this.widget().removeClass(e.mobile.focusClass)}}),this.refresh(!0)},_enhance:function(){this.element.wrap(this._button())},_button:function(){var t=this.options,i=this._getIconClasses(this.options);return e("<div class='ui-btn ui-input-btn"+(t.wrapperClass?" "+t.wrapperClass:"")+(t.theme?" ui-btn-"+t.theme:"")+(t.corners?" ui-corner-all":"")+(t.shadow?" ui-shadow":"")+(t.inline?" ui-btn-inline":"")+(t.mini?" ui-mini":"")+(t.disabled?" ui-state-disabled":"")+(i?" "+i:"")+"' >"+this.element.val()+"</div>")},widget:function(){return this.wrapper},_destroy:function(){this.element.insertBefore(this.button),this.button.remove()},_getIconClasses:function(e){return e.icon?"ui-icon-"+e.icon+(e.iconshadow?" ui-shadow-icon":"")+" ui-btn-icon-"+e.iconpos:""},_setOptions:function(i){var n=this.widget();i.theme!==t&&n.removeClass(this.options.theme).addClass("ui-btn-"+i.theme),i.corners!==t&&n.toggleClass("ui-corner-all",i.corners),i.shadow!==t&&n.toggleClass("ui-shadow",i.shadow),i.inline!==t&&n.toggleClass("ui-btn-inline",i.inline),i.mini!==t&&n.toggleClass("ui-mini",i.mini),i.disabled!==t&&(this.element.prop("disabled",i.disabled),n.toggleClass("ui-state-disabled",i.disabled)),(i.icon!==t||i.iconshadow!==t||i.iconpos!==t)&&n.removeClass(this._getIconClasses(this.options)).addClass(this._getIconClasses(e.extend({},this.options,i))),this._super(i)},refresh:function(t){if(this.options.icon&&"notext"===this.options.iconpos&&this.element.attr("title")&&this.element.attr("title",this.element.val()),!t){var i=this.element.detach();e(this.wrapper).text(this.element.val()).append(i)}}})}(e),function(e){var t=e("meta[name=viewport]"),i=t.attr("content"),n=i+",maximum-scale=1, user-scalable=no",r=i+",maximum-scale=10, user-scalable=yes",o=/(user-scalable[\s]*=[\s]*no)|(maximum-scale[\s]*=[\s]*1)[$,\s]/.test(i);e.mobile.zoom=e.extend({},{enabled:!o,locked:!1,disable:function(i){o||e.mobile.zoom.locked||(t.attr("content",n),e.mobile.zoom.enabled=!1,e.mobile.zoom.locked=i||!1)},enable:function(i){o||e.mobile.zoom.locked&&!0!==i||(t.attr("content",r),e.mobile.zoom.enabled=!0,e.mobile.zoom.locked=!1)},restore:function(){o||(t.attr("content",i),e.mobile.zoom.enabled=!0)}})}(e),function(e,t){e.widget("mobile.textinput",{initSelector:"input[type='text'],input[type='search'],:jqmData(type='search'),input[type='number'],:jqmData(type='number'),input[type='password'],input[type='email'],input[type='url'],input[type='tel'],textarea,input[type='time'],input[type='date'],input[type='month'],input[type='week'],input[type='datetime'],input[type='datetime-local'],input[type='color'],input:not([type]),input[type='file']",options:{theme:null,corners:!0,mini:!1,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,wrapperClass:"",enhanced:!1},_create:function(){var t=this.options,i=this.element.is("[type='search'], :jqmData(type='search')"),n="TEXTAREA"===this.element[0].tagName,r=this.element.is("[data-"+(e.mobile.ns||"")+"type='range']"),o=(this.element.is("input")||this.element.is("[data-"+(e.mobile.ns||"")+"type='search']"))&&!r;this.element.prop("disabled")&&(t.disabled=!0),e.extend(this,{classes:this._classesFromOptions(),isSearch:i,isTextarea:n,isRange:r,inputNeedsWrap:o}),this._autoCorrect(),t.enhanced||this._enhance(),this._on({focus:"_handleFocus",blur:"_handleBlur"})},refresh:function(){this.setOptions({disabled:this.element.is(":disabled")})},_enhance:function(){var e=[];this.isTextarea&&e.push("ui-input-text"),(this.isTextarea||this.isRange)&&e.push("ui-shadow-inset"),this.inputNeedsWrap?this.element.wrap(this._wrap()):e=e.concat(this.classes),this.element.addClass(e.join(" "))},widget:function(){return this.inputNeedsWrap?this.element.parent():this.element},_classesFromOptions:function(){var e=this.options,t=[];return t.push("ui-body-"+(null===e.theme?"inherit":e.theme)),e.corners&&t.push("ui-corner-all"),e.mini&&t.push("ui-mini"),e.disabled&&t.push("ui-state-disabled"),e.wrapperClass&&t.push(e.wrapperClass),t},_wrap:function(){return e("<div class='"+(this.isSearch?"ui-input-search ":"ui-input-text ")+this.classes.join(" ")+" ui-shadow-inset'></div>")},_autoCorrect:function(){void 0===this.element[0].autocorrect||e.support.touchOverflow||(this.element[0].setAttribute("autocorrect","off"),this.element[0].setAttribute("autocomplete","off"))},_handleBlur:function(){this.widget().removeClass(e.mobile.focusClass),this.options.preventFocusZoom&&e.mobile.zoom.enable(!0)},_handleFocus:function(){this.options.preventFocusZoom&&e.mobile.zoom.disable(!0),this.widget().addClass(e.mobile.focusClass)},_setOptions:function(e){var i=this.widget();this._super(e),(e.disabled!==t||e.mini!==t||e.corners!==t||e.theme!==t||e.wrapperClass!==t)&&(i.removeClass(this.classes.join(" ")),this.classes=this._classesFromOptions(),i.addClass(this.classes.join(" "))),e.disabled!==t&&this.element.prop("disabled",!!e.disabled)},_destroy:function(){this.options.enhanced||(this.inputNeedsWrap&&this.element.unwrap(),this.element.removeClass("ui-input-text "+this.classes.join(" ")))}})}(e),function(e,n){e.widget("mobile.slider",e.extend({initSelector:"input[type='range'], :jqmData(type='range'), :jqmData(role='slider')",widgetEventPrefix:"slide",options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!1},_create:function(){var r,o,a,s,l,c,u,h,d,p,f=this.element,m=this.options.trackTheme||e.mobile.getAttribute(f[0],"theme"),g=m?" ui-bar-"+m:" ui-bar-inherit",v=this.options.corners||f.jqmData("corners")?" ui-corner-all":"",y=this.options.mini||f.jqmData("mini")?" ui-mini":"",b=f[0].nodeName.toLowerCase(),x="select"===b,_=f.parent().is(":jqmData(role='rangeslider')"),w=x?"ui-slider-switch":"",E=f.attr("id"),T=e("[for='"+E+"']"),M=T.attr("id")||E+"-label",S=x?0:parseFloat(f.attr("min")),C=x?f.find("option").length-1:parseFloat(f.attr("max")),R=t.parseFloat(f.attr("step")||1),A=i.createElement("a"),P=e(A),L=i.createElement("div"),O=e(L),I=!(!this.options.highlight||x)&&function(){var t=i.createElement("div");return t.className="ui-slider-bg "+e.mobile.activeBtnClass,e(t).prependTo(O)}();if(T.attr("id",M),this.isToggleSwitch=x,A.setAttribute("href","#"),L.setAttribute("role","application"),L.className=[this.isToggleSwitch?"ui-slider ui-slider-track ui-shadow-inset ":"ui-slider-track ui-shadow-inset ",w,g,v,y].join(""),A.className="ui-slider-handle",L.appendChild(A),P.attr({role:"slider","aria-valuemin":S,"aria-valuemax":C,"aria-valuenow":this._value(),"aria-valuetext":this._value(),title:this._value(),"aria-labelledby":M}),e.extend(this,{slider:O,handle:P,control:f,type:b,step:R,max:C,min:S,valuebg:I,isRangeslider:_,dragging:!1,beforeStart:null,userModified:!1,mouseMoved:!1}),x){for((u=f.attr("tabindex"))&&P.attr("tabindex",u),f.attr("tabindex","-1").focus(function(){e(this).blur(),P.focus()}),(o=i.createElement("div")).className="ui-slider-inneroffset",a=0,s=L.childNodes.length;s>a;a++)o.appendChild(L.childNodes[a]);for(L.appendChild(o),P.addClass("ui-slider-handle-snapping"),l=0,c=(r=f.find("option")).length;c>l;l++)h=l?"a":"b",d=l?" "+e.mobile.activeBtnClass:"",(p=i.createElement("span")).className=["ui-slider-label ui-slider-label-",h,d].join(""),p.setAttribute("role","img"),p.appendChild(i.createTextNode(r[l].innerHTML)),e(p).prependTo(O);this._labels=e(".ui-slider-label",O)}f.addClass(x?"ui-slider-switch":"ui-slider-input"),this._on(f,{change:"_controlChange",keyup:"_controlKeyup",blur:"_controlBlur",vmouseup:"_controlVMouseUp"}),O.bind("vmousedown",e.proxy(this._sliderVMouseDown,this)).bind("vclick",!1),this._on(i,{vmousemove:"_preventDocumentDrag"}),this._on(O.add(i),{vmouseup:"_sliderVMouseUp"}),O.insertAfter(f),x||_||(o=this.options.mini?"<div class='ui-slider ui-mini'>":"<div class='ui-slider'>",f.add(O).wrapAll(o)),this._on(this.handle,{vmousedown:"_handleVMouseDown",keydown:"_handleKeydown",keyup:"_handleKeyup"}),this.handle.bind("vclick",!1),this._handleFormReset(),this.refresh(n,n,!0)},_setOptions:function(e){e.theme!==n&&this._setTheme(e.theme),e.trackTheme!==n&&this._setTrackTheme(e.trackTheme),e.corners!==n&&this._setCorners(e.corners),e.mini!==n&&this._setMini(e.mini),e.highlight!==n&&this._setHighlight(e.highlight),e.disabled!==n&&this._setDisabled(e.disabled),this._super(e)},_controlChange:function(e){return!1!==this._trigger("controlchange",e)&&void(this.mouseMoved||this.refresh(this._value(),!0))},_controlKeyup:function(){this.refresh(this._value(),!0,!0)},_controlBlur:function(){this.refresh(this._value(),!0)},_controlVMouseUp:function(){this._checkedRefresh()},_handleVMouseDown:function(){this.handle.focus()},_handleKeydown:function(t){var i=this._value();if(!this.options.disabled){switch(t.keyCode){case e.mobile.keyCode.HOME:case e.mobile.keyCode.END:case e.mobile.keyCode.PAGE_UP:case e.mobile.keyCode.PAGE_DOWN:case e.mobile.keyCode.UP:case e.mobile.keyCode.RIGHT:case e.mobile.keyCode.DOWN:case e.mobile.keyCode.LEFT:t.preventDefault(),this._keySliding||(this._keySliding=!0,this.handle.addClass("ui-state-active"))}switch(t.keyCode){case e.mobile.keyCode.HOME:this.refresh(this.min);break;case e.mobile.keyCode.END:this.refresh(this.max);break;case e.mobile.keyCode.PAGE_UP:case e.mobile.keyCode.UP:case e.mobile.keyCode.RIGHT:this.refresh(i+this.step);break;case e.mobile.keyCode.PAGE_DOWN:case e.mobile.keyCode.DOWN:case e.mobile.keyCode.LEFT:this.refresh(i-this.step)}}},_handleKeyup:function(){this._keySliding&&(this._keySliding=!1,this.handle.removeClass("ui-state-active"))},_sliderVMouseDown:function(e){return!(this.options.disabled||1!==e.which&&0!==e.which&&e.which!==n)&&(!1!==this._trigger("beforestart",e)&&(this.dragging=!0,this.userModified=!1,this.mouseMoved=!1,this.isToggleSwitch&&(this.beforeStart=this.element[0].selectedIndex),this.refresh(e),this._trigger("start"),!1))},_sliderVMouseUp:function(){return this.dragging?(this.dragging=!1,this.isToggleSwitch&&(this.handle.addClass("ui-slider-handle-snapping"),this.mouseMoved?this.userModified?this.refresh(0===this.beforeStart?1:0):this.refresh(this.beforeStart):this.refresh(0===this.beforeStart?1:0)),this.mouseMoved=!1,this._trigger("stop"),!1):void 0},_preventDocumentDrag:function(e){return!1!==this._trigger("drag",e)&&(this.dragging&&!this.options.disabled?(this.mouseMoved=!0,this.isToggleSwitch&&this.handle.removeClass("ui-slider-handle-snapping"),this.refresh(e),this.userModified=this.beforeStart!==this.element[0].selectedIndex,!1):void 0)},_checkedRefresh:function(){this.value!==this._value()&&this.refresh(this._value())},_value:function(){return this.isToggleSwitch?this.element[0].selectedIndex:parseFloat(this.element.val())},_reset:function(){this.refresh(n,!1,!0)},refresh:function(t,n,r){var o,a,s,l,c,u,h,d,p,f,m,g,v,y,b,x,_,w,E,T,M=this,S=e.mobile.getAttribute(this.element[0],"theme"),C=this.options.theme||S,R=C?" ui-btn-"+C:"",A=this.options.trackTheme||S,P=A?" ui-bar-"+A:" ui-bar-inherit",L=this.options.corners?" ui-corner-all":"",O=this.options.mini?" ui-mini":"";if(M.slider[0].className=[this.isToggleSwitch?"ui-slider ui-slider-switch ui-slider-track ui-shadow-inset":"ui-slider-track ui-shadow-inset",P,L,O].join(""),(this.options.disabled||this.element.prop("disabled"))&&this.disable(),this.value=this._value(),this.options.highlight&&!this.isToggleSwitch&&0===this.slider.find(".ui-slider-bg").length&&(this.valuebg=function(){var t=i.createElement("div");return t.className="ui-slider-bg "+e.mobile.activeBtnClass,e(t).prependTo(M.slider)}()),this.handle.addClass("ui-btn"+R+" ui-shadow"),h=this.element,p=(d=!this.isToggleSwitch)?[]:h.find("option"),f=d?parseFloat(h.attr("min")):0,m=d?parseFloat(h.attr("max")):p.length-1,g=d&&parseFloat(h.attr("step"))>0?parseFloat(h.attr("step")):1,"object"==typeof t){if(s=t,l=8,o=this.slider.offset().left,c=(a=this.slider.width())/((m-f)/g),!this.dragging||s.pageX<o-l||s.pageX>o+a+l)return;u=c>1?(s.pageX-o)/a*100:Math.round((s.pageX-o)/a*100)}else null==t&&(t=d?parseFloat(h.val()||0):h[0].selectedIndex),u=(parseFloat(t)-f)/(m-f)*100;if(!isNaN(u)&&(b=(v=u/100*(m-f)+f)-(y=(v-f)%g),2*Math.abs(y)>=g&&(b+=y>0?g:-g),x=100/((m-f)/g),v=parseFloat(b.toFixed(5)),void 0===c&&(c=a/((m-f)/g)),c>1&&d&&(u=(v-f)*x*(1/g)),0>u&&(u=0),u>100&&(u=100),f>v&&(v=f),v>m&&(v=m),this.handle.css("left",u+"%"),this.handle[0].setAttribute("aria-valuenow",d?v:p.eq(v).attr("value")),this.handle[0].setAttribute("aria-valuetext",d?v:p.eq(v).getEncodedText()),this.handle[0].setAttribute("title",d?v:p.eq(v).getEncodedText()),this.valuebg&&this.valuebg.css("width",u+"%"),this._labels&&(_=this.handle.width()/this.slider.width()*100,w=u&&_+(100-_)*u/100,E=100===u?0:Math.min(_+100-w,100),this._labels.each(function(){var t=e(this).hasClass("ui-slider-label-a");e(this).width((t?w:E)+"%")})),!r)){if(T=!1,d?(T=h.val()!==v,h.val(v)):(T=h[0].selectedIndex!==v,h[0].selectedIndex=v),!1===this._trigger("beforechange",t))return!1;!n&&T&&h.trigger("change")}},_setHighlight:function(e){(e=!!e)?(this.options.highlight=!!e,this.refresh()):this.valuebg&&(this.valuebg.remove(),this.valuebg=!1)},_setTheme:function(e){this.handle.removeClass("ui-btn-"+this.options.theme).addClass("ui-btn-"+e);var t=this.options.theme?this.options.theme:"inherit",i=e||"inherit";this.control.removeClass("ui-body-"+t).addClass("ui-body-"+i)},_setTrackTheme:function(e){var t=this.options.trackTheme?this.options.trackTheme:"inherit",i=e||"inherit";this.slider.removeClass("ui-body-"+t).addClass("ui-body-"+i)},_setMini:function(e){e=!!e,this.isToggleSwitch||this.isRangeslider||(this.slider.parent().toggleClass("ui-mini",e),this.element.toggleClass("ui-mini",e)),this.slider.toggleClass("ui-mini",e)},_setCorners:function(e){this.slider.toggleClass("ui-corner-all",e),this.isToggleSwitch||this.control.toggleClass("ui-corner-all",e)},_setDisabled:function(e){e=!!e,this.element.prop("disabled",e),this.slider.toggleClass("ui-state-disabled").attr("aria-disabled",e)}},e.mobile.behaviors.formReset))}(e),function(e){function t(){return i||(i=e("<div></div>",{class:"ui-slider-popup ui-shadow ui-corner-all"})),i.clone()}var i;e.widget("mobile.slider",e.mobile.slider,{options:{popupEnabled:!1,showValue:!1},_create:function(){this._super(),e.extend(this,{_currentValue:null,_popup:null,_popupVisible:!1}),this._setOption("popupEnabled",this.options.popupEnabled),this._on(this.handle,{vmousedown:"_showPopup"}),this._on(this.slider.add(this.document),{vmouseup:"_hidePopup"}),this._refresh()},_positionPopup:function(){var e=this.handle.offset();this._popup.offset({left:e.left+(this.handle.width()-this._popup.width())/2,top:e.top-this._popup.outerHeight()-5})},_setOption:function(e,i){this._super(e,i),"showValue"===e?this.handle.html(i&&!this.options.mini?this._value():""):"popupEnabled"===e&&i&&!this._popup&&(this._popup=t().addClass("ui-body-"+(this.options.theme||"a")).insertBefore(this.element))},refresh:function(){this._super.apply(this,arguments),this._refresh()},_refresh:function(){var e,t=this.options;t.popupEnabled&&this.handle.removeAttr("title"),(e=this._value())!==this._currentValue&&(this._currentValue=e,t.popupEnabled&&this._popup?(this._positionPopup(),this._popup.html(e)):t.showValue&&!this.options.mini&&this.handle.html(e))},_showPopup:function(){this.options.popupEnabled&&!this._popupVisible&&(this.handle.html(""),this._popup.show(),this._positionPopup(),this._popupVisible=!0)},_hidePopup:function(){var e=this.options;e.popupEnabled&&this._popupVisible&&(e.showValue&&!e.mini&&this.handle.html(this._value()),this._popup.hide(),this._popupVisible=!1)}})}(e),function(e,t){e.widget("mobile.flipswitch",e.extend({options:{onText:"On",offText:"Off",theme:null,enhanced:!1,wrapperClass:null,corners:!0,mini:!1},_create:function(){this.options.enhanced?e.extend(this,{flipswitch:this.element.parent(),on:this.element.find(".ui-flipswitch-on").eq(0),off:this.element.find(".ui-flipswitch-off").eq(0),type:this.element.get(0).tagName}):this._enhance(),this._handleFormReset(),this.element.is(":disabled")&&this._setOptions({disabled:!0}),this._on(this.flipswitch,{click:"_toggle",swipeleft:"_left",swiperight:"_right"}),this._on(this.on,{keydown:"_keydown"}),this._on({change:"refresh"})},widget:function(){return this.flipswitch},_left:function(){this.flipswitch.removeClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=0:this.element.prop("checked",!1),this.element.trigger("change")},_right:function(){this.flipswitch.addClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=1:this.element.prop("checked",!0),this.element.trigger("change")},_enhance:function(){var t=e("<div>"),i=this.options,n=this.element,r=i.theme?i.theme:"inherit",o=e("<span></span>",{tabindex:1}),a=e("<span></span>"),s=n.get(0).tagName,l="INPUT"===s?i.onText:n.find("option").eq(1).text(),c="INPUT"===s?i.offText:n.find("option").eq(0).text();o.addClass("ui-flipswitch-on ui-btn ui-shadow ui-btn-inherit").text(l),a.addClass("ui-flipswitch-off").text(c),t.addClass("ui-flipswitch ui-shadow-inset ui-bar-"+r+" "+(i.wrapperClass?i.wrapperClass:"")+" "+(n.is(":checked")||n.find("option").eq(1).is(":selected")?"ui-flipswitch-active":"")+(n.is(":disabled")?" ui-state-disabled":"")+(i.corners?" ui-corner-all":"")+(i.mini?" ui-mini":"")).append(o,a),n.addClass("ui-flipswitch-input").after(t).appendTo(t),e.extend(this,{flipswitch:t,on:o,off:a,type:s})},_reset:function(){this.refresh()},refresh:function(){var e,t=this.flipswitch.hasClass("ui-flipswitch-active")?"_right":"_left";(e="SELECT"===this.type?this.element.get(0).selectedIndex>0?"_right":"_left":this.element.prop("checked")?"_right":"_left")!==t&&this[e]()},_toggle:function(){this[this.flipswitch.hasClass("ui-flipswitch-active")?"_left":"_right"]()},_keydown:function(t){t.which===e.mobile.keyCode.LEFT?this._left():t.which===e.mobile.keyCode.RIGHT?this._right():t.which===e.mobile.keyCode.SPACE&&(this._toggle(),t.preventDefault())},_setOptions:function(e){if(e.theme!==t){var i=e.theme?e.theme:"inherit",n=e.theme?e.theme:"inherit";this.widget().removeClass("ui-bar-"+i).addClass("ui-bar-"+n)}e.onText!==t&&this.on.text(e.onText),e.offText!==t&&this.off.text(e.offText),e.disabled!==t&&this.widget().toggleClass("ui-state-disabled",e.disabled),e.mini!==t&&this.widget().toggleClass("ui-mini",e.mini),e.corners!==t&&this.widget().toggleClass("ui-corner-all",e.corners),this._super(e)},_destroy:function(){this.options.enhanced||(this.on.remove(),this.off.remove(),this.element.unwrap(),this.flipswitch.remove(),this.removeClass("ui-flipswitch-input"))}},e.mobile.behaviors.formReset))}(e),function(e,t){e.widget("mobile.rangeslider",e.extend({options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!0},_create:function(){var t=this.element,i=this.options.mini?"ui-rangeslider ui-mini":"ui-rangeslider",n=t.find("input").first(),r=t.find("input").last(),o=t.find("label").first(),a=e.data(n.get(0),"mobile-slider")||e.data(n.slider().get(0),"mobile-slider"),s=e.data(r.get(0),"mobile-slider")||e.data(r.slider().get(0),"mobile-slider"),l=a.slider,c=s.slider,u=a.handle,h=e("<div class='ui-rangeslider-sliders' />").appendTo(t);n.addClass("ui-rangeslider-first"),r.addClass("ui-rangeslider-last"),t.addClass(i),l.appendTo(h),c.appendTo(h),o.insertBefore(t),u.prependTo(c),e.extend(this,{_inputFirst:n,_inputLast:r,_sliderFirst:l,_sliderLast:c,_label:o,_targetVal:null,_sliderTarget:!1,_sliders:h,_proxy:!1}),this.refresh(),this._on(this.element.find("input.ui-slider-input"),{slidebeforestart:"_slidebeforestart",slidestop:"_slidestop",slidedrag:"_slidedrag",slidebeforechange:"_change",blur:"_change",keyup:"_change"}),this._on({mousedown:"_change"}),this._on(this.element.closest("form"),{reset:"_handleReset"}),this._on(u,{vmousedown:"_dragFirstHandle"})},_handleReset:function(){var e=this;setTimeout(function(){e._updateHighlight()},0)},_dragFirstHandle:function(t){return e.data(this._inputFirst.get(0),"mobile-slider").dragging=!0,e.data(this._inputFirst.get(0),"mobile-slider").refresh(t),!1},_slidedrag:function(t){var i=e(t.target).is(this._inputFirst),n=i?this._inputLast:this._inputFirst;return this._sliderTarget=!1,"first"===this._proxy&&i||"last"===this._proxy&&!i?(e.data(n.get(0),"mobile-slider").dragging=!0,e.data(n.get(0),"mobile-slider").refresh(t),!1):void 0},_slidestop:function(t){var i=e(t.target).is(this._inputFirst);this._proxy=!1,this.element.find("input").trigger("vmouseup"),this._sliderFirst.css("z-index",i?1:"")},_slidebeforestart:function(t){this._sliderTarget=!1,e(t.originalEvent.target).hasClass("ui-slider-track")&&(this._sliderTarget=!0,this._targetVal=e(t.target).val())},_setOptions:function(e){e.theme!==t&&this._setTheme(e.theme),e.trackTheme!==t&&this._setTrackTheme(e.trackTheme),e.mini!==t&&this._setMini(e.mini),e.highlight!==t&&this._setHighlight(e.highlight),this._super(e),this.refresh()},refresh:function(){var e=this.element,t=this.options;(this._inputFirst.is(":disabled")||this._inputLast.is(":disabled"))&&(this.options.disabled=!0),e.find("input").slider({theme:t.theme,trackTheme:t.trackTheme,disabled:t.disabled,corners:t.corners,mini:t.mini,highlight:t.highlight}).slider("refresh"),this._updateHighlight()},_change:function(t){if("keyup"===t.type)return this._updateHighlight(),!1;var i=this,n=parseFloat(this._inputFirst.val(),10),r=parseFloat(this._inputLast.val(),10),o=e(t.target).hasClass("ui-rangeslider-first"),a=o?this._inputFirst:this._inputLast,s=o?this._inputLast:this._inputFirst;if(this._inputFirst.val()>this._inputLast.val()&&"mousedown"===t.type&&!e(t.target).hasClass("ui-slider-handle"))a.blur();else if("mousedown"===t.type)return;return n>r&&!this._sliderTarget?(a.val(o?r:n).slider("refresh"),this._trigger("normalize")):n>r&&(a.val(this._targetVal).slider("refresh"),setTimeout(function(){s.val(o?n:r).slider("refresh"),e.data(s.get(0),"mobile-slider").handle.focus(),i._sliderFirst.css("z-index",o?"":1),i._trigger("normalize")},0),this._proxy=o?"first":"last"),n===r?(e.data(a.get(0),"mobile-slider").handle.css("z-index",1),e.data(s.get(0),"mobile-slider").handle.css("z-index",0)):(e.data(s.get(0),"mobile-slider").handle.css("z-index",""),e.data(a.get(0),"mobile-slider").handle.css("z-index","")),this._updateHighlight(),!(n>=r)&&void 0},_updateHighlight:function(){var t=parseInt(e.data(this._inputFirst.get(0),"mobile-slider").handle.get(0).style.left,10),i=parseInt(e.data(this._inputLast.get(0),"mobile-slider").handle.get(0).style.left,10)-t;this.element.find(".ui-slider-bg").css({"margin-left":t+"%",width:i+"%"})},_setTheme:function(e){this._inputFirst.slider("option","theme",e),this._inputLast.slider("option","theme",e)},_setTrackTheme:function(e){this._inputFirst.slider("option","trackTheme",e),this._inputLast.slider("option","trackTheme",e)},_setMini:function(e){this._inputFirst.slider("option","mini",e),this._inputLast.slider("option","mini",e),this.element.toggleClass("ui-mini",!!e)},_setHighlight:function(e){this._inputFirst.slider("option","highlight",e),this._inputLast.slider("option","highlight",e)},_destroy:function(){this._label.prependTo(this.element),this.element.removeClass("ui-rangeslider ui-mini"),this._inputFirst.after(this._sliderFirst),this._inputLast.after(this._sliderLast),this._sliders.remove(),this.element.find("input").removeClass("ui-rangeslider-first ui-rangeslider-last").slider("destroy")}},e.mobile.behaviors.formReset))}(e),function(e,t){e.widget("mobile.textinput",e.mobile.textinput,{options:{clearBtn:!1,clearBtnText:"Clear text"},_create:function(){this._super(),(this.options.clearBtn||this.isSearch)&&this._addClearBtn()},clearButton:function(){return e("<a href='#' class='ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all' title='"+this.options.clearBtnText+"'>"+this.options.clearBtnText+"</a>")},_clearBtnClick:function(e){this.element.val("").focus().trigger("change"),this._clearBtn.addClass("ui-input-clear-hidden"),e.preventDefault()},_addClearBtn:function(){this.options.enhanced||this._enhanceClear(),e.extend(this,{_clearBtn:this.widget().find("a.ui-input-clear")}),this._bindClearEvents(),this._toggleClear()},_enhanceClear:function(){this.clearButton().appendTo(this.widget()),this.widget().addClass("ui-input-has-clear")},_bindClearEvents:function(){this._on(this._clearBtn,{click:"_clearBtnClick"}),this._on({keyup:"_toggleClear",change:"_toggleClear",input:"_toggleClear",focus:"_toggleClear",blur:"_toggleClear",cut:"_toggleClear",paste:"_toggleClear"})},_unbindClear:function(){this._off(this._clearBtn,"click"),this._off(this.element,"keyup change input focus blur cut paste")},_setOptions:function(e){this._super(e),e.clearbtn===t||this.element.is("textarea, :jqmData(type='range')")||(e.clearBtn?this._addClearBtn():this._destroyClear()),e.clearBtnText!==t&&this._clearBtn!==t&&this._clearBtn.text(e.clearBtnText)},_toggleClear:function(){this._delay("_toggleClearClass",0)},_toggleClearClass:function(){this._clearBtn.toggleClass("ui-input-clear-hidden",!this.element.val())},_destroyClear:function(){this.element.removeClass("ui-input-has-clear"),this._unbindClear()._clearBtn.remove()},_destroy:function(){this._super(),this._destroyClear()}})}(e),function(e,t){e.widget("mobile.textinput",e.mobile.textinput,{options:{autogrow:!0,keyupTimeoutBuffer:100},_create:function(){this._super(),this.options.autogrow&&this.isTextarea&&this._autogrow()},_autogrow:function(){this._on({keyup:"_timeout",change:"_timeout",input:"_timeout",paste:"_timeout"}),this._on(!0,this.document,{pageshow:"_handleShow",popupbeforeposition:"_handleShow",updatelayout:"_handleShow",panelopen:"_handleShow"})},_handleShow:function(t){e.contains(t.target,this.element[0])&&this.element.is(":visible")&&("popupbeforeposition"!==t.type&&this.element.addClass("ui-textinput-autogrow-resize").one("transitionend webkitTransitionEnd oTransitionEnd",e.proxy(function(){this.element.removeClass("ui-textinput-autogrow-resize")},this)),this._prepareHeightUpdate())},_unbindAutogrow:function(){this._off(this.element,"keyup change input paste"),this._off(this.document,"pageshow popupbeforeposition updatelayout panelopen")},keyupTimeout:null,_prepareHeightUpdate:function(e){this.keyupTimeout&&clearTimeout(this.keyupTimeout),e===t?this._updateHeight():this.keyupTimeout=this._delay("_updateHeight",e)},_timeout:function(){this._prepareHeightUpdate(this.options.keyupTimeoutBuffer)},_updateHeight:function(){this.keyupTimeout=0,this.element.css({height:0,"min-height":0,"max-height":0});var e=this.element[0].scrollHeight,t=this.element[0].clientHeight,i=e+(parseFloat(this.element.css("border-top-width"))+parseFloat(this.element.css("border-bottom-width")))+15;0===t&&(i+=parseFloat(this.element.css("padding-top"))+parseFloat(this.element.css("padding-bottom"))),this.element.css({height:i,"min-height":"","max-height":""})},refresh:function(){this.options.autogrow&&this.isTextarea&&this._updateHeight()},_setOptions:function(e){this._super(e),e.autogrow!==t&&this.isTextarea&&(e.autogrow?this._autogrow():this._unbindAutogrow())}})}(e),function(e){e.widget("mobile.selectmenu",e.extend({initSelector:"select:not( :jqmData(role='slider')):not( :jqmData(role='flipswitch') )",options:{theme:null,icon:"carat-d",iconpos:"right",inline:!1,corners:!0,shadow:!0,iconshadow:!1,overlayTheme:null,dividerTheme:null,hidePlaceholderMenuItems:!0,closeText:"Close",nativeMenu:!0,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,mini:!1},_button:function(){return e("<div/>")},_setDisabled:function(e){return this.element.attr("disabled",e),this.button.attr("aria-disabled",e),this._setOption("disabled",e)},_focusButton:function(){var e=this;setTimeout(function(){e.button.focus()},40)},_selectOptions:function(){return this.select.find("option")},_preExtension:function(){var t=this.options.inline||this.element.jqmData("inline"),i=this.options.mini||this.element.jqmData("mini"),n="";~this.element[0].className.indexOf("ui-btn-left")&&(n=" ui-btn-left"),~this.element[0].className.indexOf("ui-btn-right")&&(n=" ui-btn-right"),t&&(n+=" ui-btn-inline"),i&&(n+=" ui-mini"),this.select=this.element.removeClass("ui-btn-left ui-btn-right").wrap("<div class='ui-select"+n+"'>"),this.selectId=this.select.attr("id")||"select-"+this.uuid,this.buttonId=this.selectId+"-button",this.label=e("label[for='"+this.selectId+"']"),this.isMultiple=this.select[0].multiple},_destroy:function(){var e=this.element.parents(".ui-select");e.length>0&&(e.is(".ui-btn-left, .ui-btn-right")&&this.element.addClass(e.hasClass("ui-btn-left")?"ui-btn-left":"ui-btn-right"),this.element.insertAfter(e),e.remove())},_create:function(){this._preExtension(),this.button=this._button();var i=this,n=this.options,r=!!n.icon&&(n.iconpos||this.select.jqmData("iconpos")),o=this.button.insertBefore(this.select).attr("id",this.buttonId).addClass("ui-btn"+(n.icon?" ui-icon-"+n.icon+" ui-btn-icon-"+r+(n.iconshadow?" ui-shadow-icon":""):"")+(n.theme?" ui-btn-"+n.theme:"")+(n.corners?" ui-corner-all":"")+(n.shadow?" ui-shadow":""));this.setButtonText(),n.nativeMenu&&t.opera&&t.opera.version&&o.addClass("ui-select-nativeonly"),this.isMultiple&&(this.buttonCount=e("<span>").addClass("ui-li-count ui-body-inherit").hide().appendTo(o.addClass("ui-li-has-count"))),(n.disabled||this.element.attr("disabled"))&&this.disable(),this.select.change(function(){i.refresh(),n.nativeMenu&&this.blur()}),this._handleFormReset(),this._on(this.button,{keydown:"_handleKeydown"}),this.build()},build:function(){var t=this;this.select.appendTo(t.button).bind("vmousedown",function(){t.button.addClass(e.mobile.activeBtnClass)}).bind("focus",function(){t.button.addClass(e.mobile.focusClass)}).bind("blur",function(){t.button.removeClass(e.mobile.focusClass)}).bind("focus vmouseover",function(){t.button.trigger("vmouseover")}).bind("vmousemove",function(){t.button.removeClass(e.mobile.activeBtnClass)}).bind("change blur vmouseout",function(){t.button.trigger("vmouseout").removeClass(e.mobile.activeBtnClass)}),t.button.bind("vmousedown",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.label.bind("click focus",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.select.bind("focus",function(){t.options.preventFocusZoom&&e.mobile.zoom.disable(!0)}),t.button.bind("mouseup",function(){t.options.preventFocusZoom&&setTimeout(function(){e.mobile.zoom.enable(!0)},0)}),t.select.bind("blur",function(){t.options.preventFocusZoom&&e.mobile.zoom.enable(!0)})},selected:function(){return this._selectOptions().filter(":selected")},selectedIndices:function(){var e=this;return this.selected().map(function(){return e._selectOptions().index(this)}).get()},setButtonText:function(){var t=this,n=this.selected(),r=this.placeholder,o=e(i.createElement("span"));this.button.children("span").not(".ui-li-count").remove().end().end().prepend(((r=n.length?n.map(function(){return e(this).text()}).get().join(", "):t.placeholder)?o.text(r):o.html("&nbsp;"),o.addClass(t.select.attr("class")).addClass(n.attr("class")).removeClass("ui-screen-hidden")))},setButtonCount:function(){var e=this.selected();this.isMultiple&&this.buttonCount[e.length>1?"show":"hide"]().text(e.length)},_handleKeydown:function(){this._delay("_refreshButton")},_reset:function(){this.refresh()},_refreshButton:function(){this.setButtonText(),this.setButtonCount()},refresh:function(){this._refreshButton()},open:e.noop,close:e.noop,disable:function(){this._setDisabled(!0),this.button.addClass("ui-state-disabled")},enable:function(){this._setDisabled(!1),this.button.removeClass("ui-state-disabled")}},e.mobile.behaviors.formReset))}(e),function(e){e.mobile.links=function(t){e(t).find("a").jqmEnhanceable().filter(":jqmData(rel='popup')[href][href!='']").each(function(){var e=this,t=e.getAttribute("href").substring(1);t&&(e.setAttribute("aria-haspopup",!0),e.setAttribute("aria-owns",t),e.setAttribute("aria-expanded",!1))}).end().not(".ui-btn, :jqmData(role='none'), :jqmData(role='nojs')").addClass("ui-link")}}(e),function(e,i){function n(e,t,i,n){return t>e?i+(e-t)/2:Math.min(Math.max(i,n-t/2),i+e-t)}function r(e){return{x:e.scrollLeft(),y:e.scrollTop(),cx:e[0].innerWidth||e.width(),cy:e[0].innerHeight||e.height()}}e.widget("mobile.popup",{options:{wrapperClass:null,theme:null,overlayTheme:null,shadow:!0,corners:!0,transition:"none",positionTo:"origin",tolerance:null,closeLinkSelector:"a:jqmData(rel='back')",closeLinkEvents:"click.popup",navigateEvents:"navigate.popup",closeEvents:"navigate.popup pagebeforechange.popup",dismissible:!0,enhanced:!1,history:!e.mobile.browser.oldIE},_create:function(){var t=this.element,i=t.attr("id"),n=this.options;n.history=n.history&&e.mobile.ajaxEnabled&&e.mobile.hashListeningEnabled,e.extend(this,{_scrollTop:0,_page:t.closest(".ui-page"),_ui:null,_fallbackTransition:"",_currentTransition:!1,_prerequisites:null,_isOpen:!1,_tolerance:null,_resizeData:null,_ignoreResizeTo:0,_orientationchangeInProgress:!1}),0===this._page.length&&(this._page=e("body")),n.enhanced?this._ui={container:t.parent(),screen:t.parent().prev(),placeholder:e(this.document[0].getElementById(i+"-placeholder"))}:(this._ui=this._enhance(t,i),this._applyTransition(n.transition)),this._setTolerance(n.tolerance)._ui.focusElement=this._ui.container,this._on(this._ui.screen,{vclick:"_eatEventAndClose"}),this._on(this.window,{orientationchange:e.proxy(this,"_handleWindowOrientationchange"),resize:e.proxy(this,"_handleWindowResize"),keyup:e.proxy(this,"_handleWindowKeyUp")}),this._on(this.document,{focusin:"_handleDocumentFocusIn"})},_enhance:function(t,i){var n=this.options,r=n.wrapperClass,o={screen:e("<div class='ui-screen-hidden ui-popup-screen "+this._themeClassFromOption("ui-overlay-",n.overlayTheme)+"'></div>"),placeholder:e("<div style='display: none;'>\x3c!-- placeholder --\x3e</div>"),container:e("<div class='ui-popup-container ui-popup-hidden ui-popup-truncate"+(r?" "+r:"")+"'></div>")},a=this.document[0].createDocumentFragment();return a.appendChild(o.screen[0]),a.appendChild(o.container[0]),i&&(o.screen.attr("id",i+"-screen"),o.container.attr("id",i+"-popup"),o.placeholder.attr("id",i+"-placeholder").html("\x3c!-- placeholder for "+i+" --\x3e")),this._page[0].appendChild(a),o.placeholder.insertAfter(t),t.detach().addClass("ui-popup "+this._themeClassFromOption("ui-body-",n.theme)+" "+(n.shadow?"ui-overlay-shadow ":"")+(n.corners?"ui-corner-all ":"")).appendTo(o.container),o},_eatEventAndClose:function(e){return e.preventDefault(),e.stopImmediatePropagation(),this.options.dismissible&&this.close(),!1},_resizeScreen:function(){var e=this._ui.screen,t=this._ui.container.outerHeight(!0),i=e.removeAttr("style").height(),n=this.document.height()-1;n>i?e.height(n):t>i&&e.height(t)},_handleWindowKeyUp:function(t){return this._isOpen&&t.keyCode===e.mobile.keyCode.ESCAPE?this._eatEventAndClose(t):void 0},_expectResizeEvent:function(){var e=r(this.window);if(this._resizeData){if(e.x===this._resizeData.windowCoordinates.x&&e.y===this._resizeData.windowCoordinates.y&&e.cx===this._resizeData.windowCoordinates.cx&&e.cy===this._resizeData.windowCoordinates.cy)return!1;clearTimeout(this._resizeData.timeoutId)}return this._resizeData={timeoutId:this._delay("_resizeTimeout",200),windowCoordinates:e},!0},_resizeTimeout:function(){this._isOpen?this._expectResizeEvent()||(this._ui.container.hasClass("ui-popup-hidden")&&(this._ui.container.removeClass("ui-popup-hidden ui-popup-truncate"),this.reposition({positionTo:"window"}),this._ignoreResizeEvents()),this._resizeScreen(),this._resizeData=null,this._orientationchangeInProgress=!1):(this._resizeData=null,this._orientationchangeInProgress=!1)},_stopIgnoringResizeEvents:function(){this._ignoreResizeTo=0},_ignoreResizeEvents:function(){this._ignoreResizeTo&&clearTimeout(this._ignoreResizeTo),this._ignoreResizeTo=this._delay("_stopIgnoringResizeEvents",1e3)},_handleWindowResize:function(){this._isOpen&&0===this._ignoreResizeTo&&(!this._expectResizeEvent()&&!this._orientationchangeInProgress||this._ui.container.hasClass("ui-popup-hidden")||this._ui.container.addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style"))},_handleWindowOrientationchange:function(){!this._orientationchangeInProgress&&this._isOpen&&0===this._ignoreResizeTo&&(this._expectResizeEvent(),this._orientationchangeInProgress=!0)},_handleDocumentFocusIn:function(t){var i,n=t.target,r=this._ui;if(this._isOpen){if(n!==r.container[0]){if(0===(i=e(n)).parents().filter(r.container[0]).length)return e(this.document[0].activeElement).one("focus",function(){i.blur()}),r.focusElement.focus(),t.preventDefault(),t.stopImmediatePropagation(),!1;r.focusElement[0]===r.container[0]&&(r.focusElement=i)}this._ignoreResizeEvents()}},_themeClassFromOption:function(e,t){return t?"none"===t?"":e+t:e+"inherit"},_applyTransition:function(t){return t&&(this._ui.container.removeClass(this._fallbackTransition),"none"!==t&&(this._fallbackTransition=e.mobile._maybeDegradeTransition(t),"none"===this._fallbackTransition&&(this._fallbackTransition=""),this._ui.container.addClass(this._fallbackTransition))),this},_setOptions:function(e){var t=this.options,n=this.element,r=this._ui.screen;return e.wrapperClass!==i&&this._ui.container.removeClass(t.wrapperClass).addClass(e.wrapperClass),e.theme!==i&&n.removeClass(this._themeClassFromOption("ui-body-",t.theme)).addClass(this._themeClassFromOption("ui-body-",e.theme)),e.overlayTheme!==i&&(r.removeClass(this._themeClassFromOption("ui-overlay-",t.overlayTheme)).addClass(this._themeClassFromOption("ui-overlay-",e.overlayTheme)),this._isOpen&&r.addClass("in")),e.shadow!==i&&n.toggleClass("ui-overlay-shadow",e.shadow),e.corners!==i&&n.toggleClass("ui-corner-all",e.corners),e.transition!==i&&(this._currentTransition||this._applyTransition(e.transition)),e.tolerance!==i&&this._setTolerance(e.tolerance),e.disabled!==i&&e.disabled&&this.close(),this._super(e)},_setTolerance:function(t){var n,r={t:30,r:15,b:30,l:15};if(t!==i)switch(n=String(t).split(","),e.each(n,function(e,t){n[e]=parseInt(t,10)}),n.length){case 1:isNaN(n[0])||(r.t=r.r=r.b=r.l=n[0]);break;case 2:isNaN(n[0])||(r.t=r.b=n[0]),isNaN(n[1])||(r.l=r.r=n[1]);break;case 4:isNaN(n[0])||(r.t=n[0]),isNaN(n[1])||(r.r=n[1]),isNaN(n[2])||(r.b=n[2]),isNaN(n[3])||(r.l=n[3])}return this._tolerance=r,this},_clampPopupWidth:function(e){var t=r(this.window),i={x:this._tolerance.l,y:t.y+this._tolerance.t,cx:t.cx-this._tolerance.l-this._tolerance.r,cy:t.cy-this._tolerance.t-this._tolerance.b};return e||this._ui.container.css("max-width",i.cx),{rc:i,menuSize:{cx:this._ui.container.outerWidth(!0),cy:this._ui.container.outerHeight(!0)}}},_calculateFinalLocation:function(e,t){var i,r=t.rc,o=t.menuSize;return(i={left:n(r.cx,o.cx,r.x,e.x),top:n(r.cy,o.cy,r.y,e.y)}).top=Math.max(0,i.top),i.top-=Math.min(i.top,Math.max(0,i.top+o.cy-this.document.height())),i},_placementCoords:function(e){return this._calculateFinalLocation(e,this._clampPopupWidth())},_createPrerequisites:function(t,i,n){var r,o=this;(r={screen:e.Deferred(),container:e.Deferred()}).screen.then(function(){r===o._prerequisites&&t()}),r.container.then(function(){r===o._prerequisites&&i()}),e.when(r.screen,r.container).done(function(){r===o._prerequisites&&(o._prerequisites=null,n())}),o._prerequisites=r},_animate:function(t){return this._ui.screen.removeClass(t.classToRemove).addClass(t.screenClassToAdd),t.prerequisites.screen.resolve(),t.transition&&"none"!==t.transition&&(t.applyTransition&&this._applyTransition(t.transition),this._fallbackTransition)?void this._ui.container.animationComplete(e.proxy(t.prerequisites.container,"resolve")).addClass(t.containerClassToAdd).removeClass(t.classToRemove):(this._ui.container.removeClass(t.classToRemove),void t.prerequisites.container.resolve())},_desiredCoords:function(t){var i,n=null,o=r(this.window),a=t.x,s=t.y,l=t.positionTo;if(l&&"origin"!==l)if("window"===l)a=o.cx/2+o.x,s=o.cy/2+o.y;else{try{n=e(l)}catch(e){n=null}n&&(n.filter(":visible"),0===n.length&&(n=null))}return n&&(a=(i=n.offset()).left+n.outerWidth()/2,s=i.top+n.outerHeight()/2),("number"!==e.type(a)||isNaN(a))&&(a=o.cx/2+o.x),("number"!==e.type(s)||isNaN(s))&&(s=o.cy/2+o.y),{x:a,y:s}},_reposition:function(e){e={x:e.x,y:e.y,positionTo:e.positionTo},this._trigger("beforeposition",i,e),this._ui.container.offset(this._placementCoords(this._desiredCoords(e)))},reposition:function(e){this._isOpen&&this._reposition(e)},_openPrerequisitesComplete:function(){var e=this.element.attr("id");this._ui.container.addClass("ui-popup-active"),this._isOpen=!0,this._resizeScreen(),this._ui.container.attr("tabindex","0").focus(),this._ignoreResizeEvents(),e&&this.document.find("[aria-haspopup='true'][aria-owns='"+e+"']").attr("aria-expanded",!0),this._trigger("afteropen")},_open:function(t){var i=e.extend({},this.options,t),n=function(){var e=navigator.userAgent,t=e.match(/AppleWebKit\/([0-9\.]+)/),i=!!t&&t[1],n=e.match(/Android (\d+(?:\.\d+))/),r=!!n&&n[1],o=e.indexOf("Chrome")>-1;return!(!(null!==n&&"4.0"===r&&i&&i>534.13)||o)}();this._createPrerequisites(e.noop,e.noop,e.proxy(this,"_openPrerequisitesComplete")),this._currentTransition=i.transition,this._applyTransition(i.transition),this._ui.screen.removeClass("ui-screen-hidden"),this._ui.container.removeClass("ui-popup-truncate"),this._reposition(i),this._ui.container.removeClass("ui-popup-hidden"),this.options.overlayTheme&&n&&this.element.closest(".ui-page").addClass("ui-popup-open"),this._animate({additionalCondition:!0,transition:i.transition,classToRemove:"",screenClassToAdd:"in",containerClassToAdd:"in",applyTransition:!1,prerequisites:this._prerequisites})},_closePrerequisiteScreen:function(){this._ui.screen.removeClass("out").addClass("ui-screen-hidden")},_closePrerequisiteContainer:function(){this._ui.container.removeClass("reverse out").addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style")},_closePrerequisitesDone:function(){var t=this._ui.container,n=this.element.attr("id");t.removeAttr("tabindex"),e.mobile.popup.active=i,e(":focus",t[0]).add(t[0]).blur(),n&&this.document.find("[aria-haspopup='true'][aria-owns='"+n+"']").attr("aria-expanded",!1),this._trigger("afterclose")},_close:function(t){this._ui.container.removeClass("ui-popup-active"),this._page.removeClass("ui-popup-open"),this._isOpen=!1,this._createPrerequisites(e.proxy(this,"_closePrerequisiteScreen"),e.proxy(this,"_closePrerequisiteContainer"),e.proxy(this,"_closePrerequisitesDone")),this._animate({additionalCondition:this._ui.screen.hasClass("in"),transition:t?"none":this._currentTransition,classToRemove:"in",screenClassToAdd:"out",containerClassToAdd:"reverse out",applyTransition:!0,prerequisites:this._prerequisites})},_unenhance:function(){this.options.enhanced||(this._setOptions({theme:e.mobile.popup.prototype.options.theme}),this.element.detach().insertAfter(this._ui.placeholder).removeClass("ui-popup ui-overlay-shadow ui-corner-all ui-body-inherit"),this._ui.screen.remove(),this._ui.container.remove(),this._ui.placeholder.remove())},_destroy:function(){return e.mobile.popup.active===this?(this.element.one("popupafterclose",e.proxy(this,"_unenhance")),this.close()):this._unenhance(),this},_closePopup:function(i,n){var r,o,a=this.options,s=!1;i&&i.isDefaultPrevented()||e.mobile.popup.active!==this||(t.scrollTo(0,this._scrollTop),i&&"pagebeforechange"===i.type&&n&&(r="string"==typeof n.toPage?n.toPage:n.toPage.jqmData("url"),o=(r=e.mobile.path.parseUrl(r)).pathname+r.search+r.hash,this._myUrl!==e.mobile.path.makeUrlAbsolute(o)?s=!0:i.preventDefault()),this.window.off(a.closeEvents),this.element.undelegate(a.closeLinkSelector,a.closeLinkEvents),this._close(s))},_bindContainerClose:function(){this.window.on(this.options.closeEvents,e.proxy(this,"_closePopup"))},widget:function(){return this._ui.container},open:function(t){var i,n,r,o,a,s=this,l=this.options;return e.mobile.popup.active||l.disabled?this:(e.mobile.popup.active=this,this._scrollTop=this.window.scrollTop(),l.history?(a=e.mobile.navigate.history,n=e.mobile.dialogHashKey,o=!!(r=e.mobile.activePage)&&r.hasClass("ui-dialog"),this._myUrl=i=a.getActive().url,i.indexOf(n)>-1&&!o&&a.activeIndex>0?(s._open(t),s._bindContainerClose(),this):(-1!==i.indexOf(n)||o?i=e.mobile.path.parseLocation().hash+n:i+=i.indexOf("#")>-1?n:"#"+n,0===a.activeIndex&&i===a.initialDst&&(i+=n),this.window.one("beforenavigate",function(e){e.preventDefault(),s._open(t),s._bindContainerClose()}),this.urlAltered=!0,e.mobile.navigate(i,{role:"dialog"}),this)):(s._open(t),s._bindContainerClose(),s.element.delegate(l.closeLinkSelector,l.closeLinkEvents,function(e){s.close(),e.preventDefault()}),this))},close:function(){return e.mobile.popup.active!==this?this:(this._scrollTop=this.window.scrollTop(),this.options.history&&this.urlAltered?(e.mobile.back(),this.urlAltered=!1):this._closePopup(),this)}}),e.mobile.popup.handleLink=function(t){var i,n=e.mobile.path,r=e(n.hashToSelector(n.parseUrl(t.attr("href")).hash)).first();r.length>0&&r.data("mobile-popup")&&(i=t.offset(),r.popup("open",{x:i.left+t.outerWidth()/2,y:i.top+t.outerHeight()/2,transition:t.jqmData("transition"),positionTo:t.jqmData("position-to")})),setTimeout(function(){t.removeClass(e.mobile.activeBtnClass)},300)},e.mobile.document.on("pagebeforechange",function(t,i){"popup"===i.options.role&&(e.mobile.popup.handleLink(i.options.link),t.preventDefault())})}(e),function(e,t){var n=".ui-disabled,.ui-state-disabled,.ui-li-divider,.ui-screen-hidden,:jqmData(role='placeholder')",r=function(e,t,i){var r=e[i+"All"]().not(n).first();r.length&&(t.blur().attr("tabindex","-1"),r.find("a").first().focus())};e.widget("mobile.selectmenu",e.mobile.selectmenu,{_create:function(){var e=this.options;return e.nativeMenu=e.nativeMenu||this.element.parents(":jqmData(role='popup'),:mobile-popup").length>0,this._super()},_handleSelectFocus:function(){this.element.blur(),this.button.focus()},_handleKeydown:function(e){this._super(e),this._handleButtonVclickKeydown(e)},_handleButtonVclickKeydown:function(t){this.options.disabled||this.isOpen||("vclick"===t.type||t.keyCode&&(t.keyCode===e.mobile.keyCode.ENTER||t.keyCode===e.mobile.keyCode.SPACE))&&(this._decideFormat(),"overlay"===this.menuType?this.button.attr("href","#"+this.popupId).attr("data-"+(e.mobile.ns||"")+"rel","popup"):this.button.attr("href","#"+this.dialogId).attr("data-"+(e.mobile.ns||"")+"rel","dialog"),this.isOpen=!0)},_handleListFocus:function(t){var i="focusin"===t.type?{tabindex:"0",event:"vmouseover"}:{tabindex:"-1",event:"vmouseout"};e(t.target).attr("tabindex",i.tabindex).trigger(i.event)},_handleListKeydown:function(t){var i=e(t.target),n=i.closest("li");switch(t.keyCode){case 38:return r(n,i,"prev"),!1;case 40:return r(n,i,"next"),!1;case 13:case 32:return i.trigger("click"),!1}},_handleMenuPageHide:function(){this.thisPage.page("bindRemove")},_handleHeaderCloseClick:function(){return"overlay"===this.menuType?(this.close(),!1):void 0},build:function(){var i,n,r,o,a,s,l,c,u,h,d,p,f,m,g,v,y,b=this.options;return b.nativeMenu?this._super():(y=this,n=(i=this.selectId)+"-listbox",r=i+"-dialog",o=this.label,a=this.element.closest(".ui-page"),s=this.element[0].multiple,l=i+"-menu",c=b.theme?" data-"+e.mobile.ns+"theme='"+b.theme+"'":"",u=b.overlayTheme?" data-"+e.mobile.ns+"theme='"+b.overlayTheme+"'":"",h=b.dividerTheme&&s?" data-"+e.mobile.ns+"divider-theme='"+b.dividerTheme+"'":"",d=e("<div data-"+e.mobile.ns+"role='dialog' class='ui-selectmenu' id='"+r+"'"+c+u+"><div data-"+e.mobile.ns+"role='header'><div class='ui-title'>"+o.getEncodedText()+"</div></div><div data-"+e.mobile.ns+"role='content'></div></div>"),p=e("<div id='"+n+"' class='ui-selectmenu'>").insertAfter(this.select).popup({theme:b.overlayTheme}),f=e("<ul class='ui-selectmenu-list' id='"+l+"' role='listbox' aria-labelledby='"+this.buttonId+"'"+c+h+">").appendTo(p),m=e("<div class='ui-header ui-bar-"+(b.theme?b.theme:"inherit")+"'>").prependTo(p),g=e("<h1 class='ui-title'>").appendTo(m),this.isMultiple&&(v=e("<a>",{role:"button",text:b.closeText,href:"#",class:"ui-btn ui-corner-all ui-btn-left ui-btn-icon-notext ui-icon-delete"}).appendTo(m)),e.extend(this,{selectId:i,menuId:l,popupId:n,dialogId:r,thisPage:a,menuPage:d,label:o,isMultiple:s,theme:b.theme,listbox:p,list:f,header:m,headerTitle:g,headerClose:v,menuPageContent:void 0,menuPageClose:void 0,placeholder:""}),this.refresh(),this._origTabIndex===t&&(this._origTabIndex=null!==this.select[0].getAttribute("tabindex")&&this.select.attr("tabindex")),this.select.attr("tabindex","-1"),this._on(this.select,{focus:"_handleSelectFocus"}),this._on(this.button,{vclick:"_handleButtonVclickKeydown"}),this.list.attr("role","listbox"),this._on(this.list,{focusin:"_handleListFocus",focusout:"_handleListFocus",keydown:"_handleListKeydown"}),this.list.delegate("li:not(.ui-disabled,.ui-state-disabled,.ui-li-divider)","click",function(t){var i=y.select[0].selectedIndex,n=e.mobile.getAttribute(this,"option-index"),r=y._selectOptions().eq(n)[0];r.selected=!y.isMultiple||!r.selected,y.isMultiple&&e(this).find("a").toggleClass("ui-checkbox-on",r.selected).toggleClass("ui-checkbox-off",!r.selected),(y.isMultiple||i!==n)&&y.select.trigger("change"),y.isMultiple?y.list.find("li:not(.ui-li-divider)").eq(n).find("a").first().focus():y.close(),t.preventDefault()}),this._on(this.menuPage,{pagehide:"_handleMenuPageHide"}),this._on(this.listbox,{popupafterclose:"close"}),this.isMultiple&&this._on(this.headerClose,{click:"_handleHeaderCloseClick"}),this)},_isRebuildRequired:function(){var e=this.list.find("li");return this._selectOptions().not(".ui-screen-hidden").text()!==e.text()},selected:function(){return this._selectOptions().filter(":selected:not( :jqmData(placeholder='true') )")},refresh:function(t){var i,n;return this.options.nativeMenu?this._super(t):(i=this,(t||this._isRebuildRequired())&&i._buildList(),n=this.selectedIndices(),i.setButtonText(),i.setButtonCount(),void i.list.find("li:not(.ui-li-divider)").find("a").removeClass(e.mobile.activeBtnClass).end().attr("aria-selected",!1).each(function(t){if(e.inArray(t,n)>-1){var r=e(this);r.attr("aria-selected",!0),i.isMultiple?r.find("a").removeClass("ui-checkbox-off").addClass("ui-checkbox-on"):r.hasClass("ui-screen-hidden")?r.next().find("a").addClass(e.mobile.activeBtnClass):r.find("a").addClass(e.mobile.activeBtnClass)}}))},close:function(){if(!this.options.disabled&&this.isOpen){var e=this;"page"===e.menuType?(e.menuPage.dialog("close"),e.list.appendTo(e.listbox)):e.listbox.popup("close"),e._focusButton(),e.isOpen=!1}},open:function(){this.button.click()},_focusMenuItem:function(){var t=this.list.find("a."+e.mobile.activeBtnClass);0===t.length&&(t=this.list.find("li:not("+n+") a.ui-btn")),t.first().focus()},_decideFormat:function(){var t=this,i=this.window,n=t.list.parent().outerHeight(),r=i.scrollTop(),o=t.button.offset().top,a=i.height();n>a-80||!e.support.scrollTop?(t.menuPage.appendTo(e.mobile.pageContainer).page(),t.menuPageContent=t.menuPage.find(".ui-content"),t.menuPageClose=t.menuPage.find(".ui-header a"),t.thisPage.unbind("pagehide.remove"),0===r&&o>a&&t.thisPage.one("pagehide",function(){e(this).jqmData("lastScroll",o)}),t.menuPage.one({pageshow:e.proxy(this,"_focusMenuItem"),pagehide:e.proxy(this,"close")}),t.menuType="page",t.menuPageContent.append(t.list),t.menuPage.find("div .ui-title").text(t.label.text())):(t.menuType="overlay",t.listbox.one({popupafteropen:e.proxy(this,"_focusMenuItem")}))},_buildList:function(){var t,n,r,o,a,s,l,c,u,h,d,p,f,m,g=this,v=this.options,y=this.placeholder,b=!0,x="data-"+e.mobile.ns,_=x+"option-index",w=x+"icon",E=x+"role",T=x+"placeholder",M=i.createDocumentFragment(),S=!1;for(g.list.empty().filter(".ui-listview").listview("destroy"),n=(t=this._selectOptions()).length,r=this.select[0],a=0;n>a;a++,S=!1)s=t[a],(l=e(s)).hasClass("ui-screen-hidden")||(c=s.parentNode,u=l.text(),d=[],(h=i.createElement("a")).setAttribute("href","#"),h.appendChild(i.createTextNode(u)),c!==r&&"optgroup"===c.nodeName.toLowerCase()&&((p=c.getAttribute("label"))!==o&&((f=i.createElement("li")).setAttribute(E,"list-divider"),f.setAttribute("role","option"),f.setAttribute("tabindex","-1"),f.appendChild(i.createTextNode(p)),M.appendChild(f),o=p)),!b||s.getAttribute("value")&&0!==u.length&&!l.jqmData("placeholder")||(b=!1,S=!0,null===s.getAttribute(T)&&(this._removePlaceholderAttr=!0),s.setAttribute(T,!0),v.hidePlaceholderMenuItems&&d.push("ui-screen-hidden"),y!==u&&(y=g.placeholder=u)),m=i.createElement("li"),s.disabled&&(d.push("ui-state-disabled"),m.setAttribute("aria-disabled",!0)),m.setAttribute(_,a),m.setAttribute(w,"false"),S&&m.setAttribute(T,!0),m.className=d.join(" "),m.setAttribute("role","option"),h.setAttribute("tabindex","-1"),this.isMultiple&&e(h).addClass("ui-btn ui-checkbox-off ui-btn-icon-right"),m.appendChild(h),M.appendChild(m));g.list[0].appendChild(M),this.isMultiple||y.length?this.headerTitle.text(this.placeholder):this.header.addClass("ui-screen-hidden"),g.list.listview()},_button:function(){return this.options.nativeMenu?this._super():e("<a>",{href:"#",role:"button",id:this.buttonId,"aria-haspopup":"true","aria-owns":this.menuId})},_destroy:function(){this.options.nativeMenu||(this.close(),this._origTabIndex!==t&&(!1!==this._origTabIndex?this.select.attr("tabindex",this._origTabIndex):this.select.removeAttr("tabindex")),this._removePlaceholderAttr&&this._selectOptions().removeAttr("data-"+e.mobile.ns+"placeholder"),this.listbox.remove(),this.menuPage.remove()),this._super()}})}(e),function(e,t){function i(e,t){var i=t||[];return i.push("ui-btn"),e.theme&&i.push("ui-btn-"+e.theme),e.icon&&(i=i.concat(["ui-icon-"+e.icon,"ui-btn-icon-"+e.iconpos]),e.iconshadow&&i.push("ui-shadow-icon")),e.inline&&i.push("ui-btn-inline"),e.shadow&&i.push("ui-shadow"),e.corners&&i.push("ui-corner-all"),e.mini&&i.push("ui-mini"),i}function n(e){var i,n,r,a=!1,s=!0,l={icon:"",inline:!1,shadow:!1,corners:!1,iconshadow:!1,mini:!1},c=[];for(e=e.split(" "),i=0;i<e.length;i++)r=!0,(n=o[e[i]])!==t?(r=!1,l[n]=!0):0===e[i].indexOf("ui-btn-icon-")?(r=!1,s=!1,l.iconpos=e[i].substring(12)):0===e[i].indexOf("ui-icon-")?(r=!1,l.icon=e[i].substring(8)):0===e[i].indexOf("ui-btn-")&&8===e[i].length?(r=!1,l.theme=e[i].substring(7)):"ui-btn"===e[i]&&(r=!1,a=!0),r&&c.push(e[i]);return s&&(l.icon=""),{options:l,unknownClasses:c,alreadyEnhanced:a}}function r(e){return"-"+e.toLowerCase()}var o={"ui-shadow":"shadow","ui-corner-all":"corners","ui-btn-inline":"inline","ui-shadow-icon":"iconshadow","ui-mini":"mini"},a=function(){var i=e.mobile.getAttribute.apply(this,arguments);return null==i?t:i},s=/[A-Z]/g;e.fn.buttonMarkup=function(o,l){var c,u,h,d,p,f=e.fn.buttonMarkup.defaults;for(c=0;c<this.length;c++){if(h=this[c],u=l?{alreadyEnhanced:!1,unknownClasses:[]}:n(h.className),d=e.extend({},u.alreadyEnhanced?u.options:{},o),!u.alreadyEnhanced)for(p in f)d[p]===t&&(d[p]=a(h,p.replace(s,r)));h.className=i(e.extend({},f,d),u.unknownClasses).join(" "),"button"!==h.tagName.toLowerCase()&&h.setAttribute("role","button")}return this},e.fn.buttonMarkup.defaults={icon:"",iconpos:"left",theme:null,inline:!1,shadow:!0,corners:!0,iconshadow:!1,mini:!1},e.extend(e.fn.buttonMarkup,{initSelector:"a:jqmData(role='button'), .ui-bar > a, .ui-bar > :jqmData(role='controlgroup') > a, button"})}(e),function(e,t){e.widget("mobile.controlgroup",e.extend({options:{enhanced:!1,theme:null,shadow:!1,corners:!0,excludeInvisible:!0,type:"vertical",mini:!1},_create:function(){var t=this.element,i=this.options;e.fn.buttonMarkup&&this.element.find(e.fn.buttonMarkup.initSelector).buttonMarkup(),e.each(this._childWidgets,e.proxy(function(t,i){e.mobile[i]&&this.element.find(e.mobile[i].initSelector).not(e.mobile.page.prototype.keepNativeSelector())[i]()},this)),e.extend(this,{_ui:null,_initialRefresh:!0}),this._ui=i.enhanced?{groupLegend:t.children(".ui-controlgroup-label").children(),childWrapper:t.children(".ui-controlgroup-controls")}:this._enhance()},_childWidgets:["checkboxradio","selectmenu","button"],_themeClassFromOption:function(e){return e?"none"===e?"":"ui-group-theme-"+e:""},_enhance:function(){var t=this.element,i=this.options,n={groupLegend:t.children("legend"),childWrapper:t.addClass("ui-controlgroup ui-controlgroup-"+("horizontal"===i.type?"horizontal":"vertical")+" "+this._themeClassFromOption(i.theme)+" "+(i.corners?"ui-corner-all ":"")+(i.mini?"ui-mini ":"")).wrapInner("<div class='ui-controlgroup-controls "+(!0===i.shadow?"ui-shadow":"")+"'></div>").children()};return n.groupLegend.length>0&&e("<div role='heading' class='ui-controlgroup-label'></div>").append(n.groupLegend).prependTo(t),n},_init:function(){this.refresh()},_setOptions:function(e){var i,n,r=this.element;return e.type!==t&&(r.removeClass("ui-controlgroup-horizontal ui-controlgroup-vertical").addClass("ui-controlgroup-"+("horizontal"===e.type?"horizontal":"vertical")),i=!0),e.theme!==t&&r.removeClass(this._themeClassFromOption(this.options.theme)).addClass(this._themeClassFromOption(e.theme)),e.corners!==t&&r.toggleClass("ui-corner-all",e.corners),e.mini!==t&&r.toggleClass("ui-mini",e.mini),e.shadow!==t&&this._ui.childWrapper.toggleClass("ui-shadow",e.shadow),e.excludeInvisible!==t&&(this.options.excludeInvisible=e.excludeInvisible,i=!0),n=this._super(e),i&&this.refresh(),n},container:function(){return this._ui.childWrapper},refresh:function(){var t=this.container(),i=t.find(".ui-btn").not(".ui-slider-handle"),n=this._initialRefresh;e.mobile.checkboxradio&&t.find(":mobile-checkboxradio").checkboxradio("refresh"),this._addFirstLastClasses(i,this.options.excludeInvisible?this._getVisibles(i,n):i,n),this._initialRefresh=!1},_destroy:function(){var e,t,i=this.options;return i.enhanced?this:(e=this._ui,t=this.element.removeClass("ui-controlgroup ui-controlgroup-horizontal ui-controlgroup-vertical ui-corner-all ui-mini "+this._themeClassFromOption(i.theme)).find(".ui-btn").not(".ui-slider-handle"),this._removeFirstLastClasses(t),e.groupLegend.unwrap(),void e.childWrapper.children().unwrap())}},e.mobile.behaviors.addFirstLastClasses))}(e),function(e,t){e.widget("mobile.toolbar",{initSelector:":jqmData(role='footer'), :jqmData(role='header')",options:{theme:null,addBackBtn:!1,backBtnTheme:null,backBtnText:"Back"},_create:function(){var t=this.element.is(":jqmData(role='header')")?"header":"footer",i=this.element.closest(".ui-page");0===i.length&&(i=!1,this._on(this.document,{pageshow:"refresh"})),e.extend(this,{role:t,page:i,leftbtn:void 0,rightbtn:void 0,backBtn:null}),this.element.attr("role","header"===t?"banner":"contentinfo").addClass("ui-"+t),this.refresh(),this._setOptions(this.options)},_setOptions:function(i){if(i.addBackBtn!==t&&(this.options.addBackBtn&&"header"===this.role&&e(".ui-page").length>1&&this.page[0].getAttribute("data-"+e.mobile.ns+"url")!==e.mobile.path.stripHash(location.hash)&&!this.leftbtn?this._addBackButton():this.element.find(".ui-toolbar-back-btn").remove()),null!=i.backBtnTheme&&this.element.find(".ui-toolbar-back-btn").addClass("ui-btn ui-btn-"+i.backBtnTheme),i.backBtnText!==t&&this.element.find(".ui-toolbar-back-btn .ui-btn-text").text(i.backBtnText),i.theme!==t){var n=this.options.theme?this.options.theme:"inherit",r=i.theme?i.theme:"inherit";this.element.removeClass("ui-bar-"+n).addClass("ui-bar-"+r)}this._super(i)},refresh:function(){"header"===this.role&&this._addHeaderButtonClasses(),this.page||(this._setRelative(),"footer"===this.role&&this.element.appendTo("body")),this._addHeadingClasses(),this._btnMarkup()},_setRelative:function(){e("[data-"+e.mobile.ns+"role='page']").css({position:"relative"})},_btnMarkup:function(){this.element.children("a").attr("data-"+e.mobile.ns+"role","button"),this.element.trigger("create")},_addHeaderButtonClasses:function(){var e=this.element.children("a, button");this.leftbtn=e.hasClass("ui-btn-left"),this.rightbtn=e.hasClass("ui-btn-right"),this.leftbtn=this.leftbtn||e.eq(0).not(".ui-btn-right").addClass("ui-btn-left").length,this.rightbtn=this.rightbtn||e.eq(1).addClass("ui-btn-right").length},_addBackButton:function(){var t,i=this.options;this.backBtn||(t=i.backBtnTheme||i.theme,this.backBtn=e("<a role='button' href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left "+(t?"ui-btn-"+t+" ":"")+"ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-"+e.mobile.ns+"rel='back'>"+i.backBtnText+"</a>").prependTo(this.element))},_addHeadingClasses:function(){this.element.children("h1, h2, h3, h4, h5, h6").addClass("ui-title").attr({role:"heading","aria-level":"1"})}})}(e),function(e,t){e.widget("mobile.toolbar",e.mobile.toolbar,{options:{position:null,visibleOnPageShow:!0,disablePageZoom:!0,transition:"slide",fullscreen:!1,tapToggle:!0,tapToggleBlacklist:"a, button, input, select, textarea, .ui-header-fixed, .ui-footer-fixed, .ui-flipswitch, .ui-popup, .ui-panel, .ui-panel-dismiss-open",hideDuringFocus:"input, textarea, select",updatePagePadding:!0,trackPersistentToolbars:!0,supportBlacklist:function(){return!e.support.fixedPosition}},_create:function(){this._super(),"fixed"!==this.options.position||this.options.supportBlacklist()||this._makeFixed()},_makeFixed:function(){this.element.addClass("ui-"+this.role+"-fixed"),this.updatePagePadding(),this._addTransitionClass(),this._bindPageEvents(),this._bindToggleHandlers(),this._setOptions(this.options)},_setOptions:function(i){if("fixed"===i.position&&"fixed"!==this.options.position&&this._makeFixed(),"fixed"===this.options.position&&!this.options.supportBlacklist()){var n=this.page?this.page:e(".ui-page-active").length>0?e(".ui-page-active"):e(".ui-page").eq(0);i.fullscreen!==t&&(i.fullscreen?(this.element.addClass("ui-"+this.role+"-fullscreen"),n.addClass("ui-page-"+this.role+"-fullscreen")):(this.element.removeClass("ui-"+this.role+"-fullscreen"),n.removeClass("ui-page-"+this.role+"-fullscreen").addClass("ui-page-"+this.role+"-fixed")))}this._super(i)},_addTransitionClass:function(){var e=this.options.transition;e&&"none"!==e&&("slide"===e&&(e=this.element.hasClass("ui-header")?"slidedown":"slideup"),this.element.addClass(e))},_bindPageEvents:function(){var e=this.page?this.element.closest(".ui-page"):this.document;this._on(e,{pagebeforeshow:"_handlePageBeforeShow",webkitAnimationStart:"_handleAnimationStart",animationstart:"_handleAnimationStart",updatelayout:"_handleAnimationStart",pageshow:"_handlePageShow",pagebeforehide:"_handlePageBeforeHide"})},_handlePageBeforeShow:function(){var t=this.options;t.disablePageZoom&&e.mobile.zoom.disable(!0),t.visibleOnPageShow||this.hide(!0)},_handleAnimationStart:function(){this.options.updatePagePadding&&this.updatePagePadding(this.page?this.page:".ui-page-active")},_handlePageShow:function(){this.updatePagePadding(this.page?this.page:".ui-page-active"),this.options.updatePagePadding&&this._on(this.window,{throttledresize:"updatePagePadding"})},_handlePageBeforeHide:function(t,i){var n,r,o,a,s=this.options;s.disablePageZoom&&e.mobile.zoom.enable(!0),s.updatePagePadding&&this._off(this.window,"throttledresize"),s.trackPersistentToolbars&&(n=e(".ui-footer-fixed:jqmData(id)",this.page),r=e(".ui-header-fixed:jqmData(id)",this.page),o=n.length&&i.nextPage&&e(".ui-footer-fixed:jqmData(id='"+n.jqmData("id")+"')",i.nextPage)||e(),a=r.length&&i.nextPage&&e(".ui-header-fixed:jqmData(id='"+r.jqmData("id")+"')",i.nextPage)||e(),(o.length||a.length)&&(o.add(a).appendTo(e.mobile.pageContainer),i.nextPage.one("pageshow",function(){a.prependTo(this),o.appendTo(this)})))},_visible:!0,updatePagePadding:function(i){var n=this.element,r="header"===this.role,o=parseFloat(n.css(r?"top":"bottom"));this.options.fullscreen||(i=i&&i.type===t&&i||this.page||n.closest(".ui-page"),i=this.page?this.page:".ui-page-active",e(i).css("padding-"+(r?"top":"bottom"),n.outerHeight()+o))},_useTransition:function(t){var i=this.window,n=this.element,r=i.scrollTop(),o=n.height(),a=this.page?n.closest(".ui-page").height():e(".ui-page-active").height(),s=e.mobile.getScreenHeight();return!t&&(this.options.transition&&"none"!==this.options.transition&&("header"===this.role&&!this.options.fullscreen&&r>o||"footer"===this.role&&!this.options.fullscreen&&a-o>r+s)||this.options.fullscreen)},show:function(e){var t="ui-fixed-hidden",i=this.element;this._useTransition(e)?i.removeClass("out "+t).addClass("in").animationComplete(function(){i.removeClass("in")}):i.removeClass(t),this._visible=!0},hide:function(e){var t="ui-fixed-hidden",i=this.element,n="out"+("slide"===this.options.transition?" reverse":"");this._useTransition(e)?i.addClass(n).removeClass("in").animationComplete(function(){i.addClass(t).removeClass(n)}):i.addClass(t).removeClass(n),this._visible=!1},toggle:function(){this[this._visible?"hide":"show"]()},_bindToggleHandlers:function(){var t,i,n=this,r=n.options,o=!0;(this.page?this.page:e(".ui-page")).bind("vclick",function(t){r.tapToggle&&!e(t.target).closest(r.tapToggleBlacklist).length&&n.toggle()}).bind("focusin focusout",function(a){screen.width<1025&&e(a.target).is(r.hideDuringFocus)&&!e(a.target).closest(".ui-header-fixed, .ui-footer-fixed").length&&("focusout"!==a.type||o?"focusin"===a.type&&o&&(clearTimeout(t),o=!1,i=setTimeout(function(){n.hide()},0)):(o=!0,clearTimeout(i),t=setTimeout(function(){n.show()},0)))})},_setRelative:function(){"fixed"!==this.options.position&&e("[data-"+e.mobile.ns+"role='page']").css({position:"relative"})},_destroy:function(){var e=this.element,t=e.hasClass("ui-header");e.closest(".ui-page").css("padding-"+(t?"top":"bottom"),""),e.removeClass("ui-header-fixed ui-footer-fixed ui-header-fullscreen ui-footer-fullscreen in out fade slidedown slideup ui-fixed-hidden"),e.closest(".ui-page").removeClass("ui-page-header-fixed ui-page-footer-fixed ui-page-header-fullscreen ui-page-footer-fullscreen")}})}(e),function(e){e.widget("mobile.toolbar",e.mobile.toolbar,{_makeFixed:function(){this._super(),this._workarounds()},_workarounds:function(){var e=navigator.userAgent,t=navigator.platform,i=e.match(/AppleWebKit\/([0-9]+)/),n=!!i&&i[1],r=null,o=this;if(t.indexOf("iPhone")>-1||t.indexOf("iPad")>-1||t.indexOf("iPod")>-1)r="ios";else{if(!(e.indexOf("Android")>-1))return;r="android"}if("ios"===r)o._bindScrollWorkaround();else{if(!("android"===r&&n&&534>n))return;o._bindScrollWorkaround(),o._bindListThumbWorkaround()}},_viewportOffset:function(){var e=this.element,t=e.hasClass("ui-header"),i=Math.abs(e.offset().top-this.window.scrollTop());return t||(i=Math.round(i-this.window.height()+e.outerHeight())-60),i},_bindScrollWorkaround:function(){var e=this;this._on(this.window,{scrollstop:function(){e._viewportOffset()>2&&e._visible&&e._triggerRedraw()}})},_bindListThumbWorkaround:function(){this.element.closest(".ui-page").addClass("ui-android-2x-fixed")},_triggerRedraw:function(){var t=parseFloat(e(".ui-page-active").css("padding-bottom"));e(".ui-page-active").css("padding-bottom",t+1+"px"),setTimeout(function(){e(".ui-page-active").css("padding-bottom",t+"px")},0)},destroy:function(){this._super(),this.element.closest(".ui-page-active").removeClass("ui-android-2x-fix")}})}(e),function(e,t){var i=e.mobile.browser.oldIE&&e.mobile.browser.oldIE<=8,n=e("<div class='ui-popup-arrow-guide'></div><div class='ui-popup-arrow-container"+(i?" ie":"")+"'><div class='ui-popup-arrow'><div class='ui-popup-arrow-background'></div></div></div>"),r=Math.sqrt(2)/2;e.widget("mobile.popup",e.mobile.popup,{options:{arrow:""},_create:function(){var e=this._super();return this.options.arrow&&(this._ui.arrow=this._addArrow()),e},_addArrow:function(){var e,t=this.options,i=function(){var e=n.clone(),t=e.eq(0),i=e.eq(1),r=i.children(),o=r.children();return{arEls:i.add(t),gd:t,ct:i,ar:r,bg:o}}();return e=this._themeClassFromOption("ui-body-",t.theme),i.ar.addClass(e+(t.shadow?" ui-overlay-shadow":"")),i.bg.addClass(e),i.arEls.hide().appendTo(this.element),i},_unenhance:function(){var e=this._ui.arrow;return e&&e.arEls.remove(),this._super()},_tryAnArrow:function(e,t,i,n,r){var o,a,s,l={},c={};return n.arFull[e.dimKey]>n.guideDims[e.dimKey]?r:(l[e.fst]=i[e.fst]+(n.arHalf[e.oDimKey]+n.menuHalf[e.oDimKey])*e.offsetFactor-n.contentBox[e.fst]+(n.clampInfo.menuSize[e.oDimKey]-n.contentBox[e.oDimKey])*e.arrowOffsetFactor,l[e.snd]=i[e.snd],a={x:(o=n.result||this._calculateFinalLocation(l,n.clampInfo)).left,y:o.top},c[e.fst]=a[e.fst]+n.contentBox[e.fst]+e.tipOffset,c[e.snd]=Math.max(o[e.prop]+n.guideOffset[e.prop]+n.arHalf[e.dimKey],Math.min(o[e.prop]+n.guideOffset[e.prop]+n.guideDims[e.dimKey]-n.arHalf[e.dimKey],i[e.snd])),s=Math.abs(i.x-c.x)+Math.abs(i.y-c.y),(!r||s<r.diff)&&(c[e.snd]-=n.arHalf[e.dimKey]+o[e.prop]+n.contentBox[e.snd],r={dir:t,diff:s,result:o,posProp:e.prop,posVal:c[e.snd]}),r)},_getPlacementState:function(e){var t,i,n=this._ui.arrow,r={clampInfo:this._clampPopupWidth(!e),arFull:{cx:n.ct.width(),cy:n.ct.height()},guideDims:{cx:n.gd.width(),cy:n.gd.height()},guideOffset:n.gd.offset()};return t=this.element.offset(),n.gd.css({left:0,top:0,right:0,bottom:0}),i=n.gd.offset(),r.contentBox={x:i.left-t.left,y:i.top-t.top,cx:n.gd.width(),cy:n.gd.height()},n.gd.removeAttr("style"),r.guideOffset={left:r.guideOffset.left-t.left,top:r.guideOffset.top-t.top},r.arHalf={cx:r.arFull.cx/2,cy:r.arFull.cy/2},r.menuHalf={cx:r.clampInfo.menuSize.cx/2,cy:r.clampInfo.menuSize.cy/2},r},_placementCoords:function(t){var n,o,a,s,l,c,u,h=this.options.arrow,d=this._ui.arrow;return d?(d.arEls.show(),u={},n=this._getPlacementState(!0),a={l:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:1,tipOffset:-n.arHalf.cx,arrowOffsetFactor:0},r:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:-1,tipOffset:n.arHalf.cx+n.contentBox.cx,arrowOffsetFactor:1},b:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:-1,tipOffset:n.arHalf.cy+n.contentBox.cy,arrowOffsetFactor:1},t:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:1,tipOffset:-n.arHalf.cy,arrowOffsetFactor:0}},e.each((!0===h?"l,t,r,b":h).split(","),e.proxy(function(e,i){o=this._tryAnArrow(a[i],i,t,n,o)},this)),o?(d.ct.removeClass("ui-popup-arrow-l ui-popup-arrow-t ui-popup-arrow-r ui-popup-arrow-b").addClass("ui-popup-arrow-"+o.dir).removeAttr("style").css(o.posProp,o.posVal).show(),i||(l=this.element.offset(),u[a[o.dir].fst]=d.ct.offset(),u[a[o.dir].snd]={left:l.left+n.contentBox.x,top:l.top+n.contentBox.y},s=d.bg.removeAttr("style").css("cx"===a[o.dir].dimKey?"width":"height",n.contentBox[a[o.dir].dimKey]).offset(),c={dx:u.x.left-s.left,dy:u.y.top-s.top},d.bg.css({left:r*c.dy+r*c.dx,top:r*c.dy-r*c.dx})),o.result):(d.arEls.hide(),this._super(t))):this._super(t)},_setOptions:function(e){var i,n=this.options.theme,r=this._ui.arrow,o=this._super(e);if(e.arrow!==t){if(!r&&e.arrow)return void(this._ui.arrow=this._addArrow());r&&!e.arrow&&(r.arEls.remove(),this._ui.arrow=null)}return(r=this._ui.arrow)&&(e.theme!==t&&(n=this._themeClassFromOption("ui-body-",n),i=this._themeClassFromOption("ui-body-",e.theme),r.ar.removeClass(n).addClass(i),r.bg.removeClass(n).addClass(i)),e.shadow!==t&&r.ar.toggleClass("ui-overlay-shadow",e.shadow)),o},_destroy:function(){var e=this._ui.arrow;return e&&e.arEls.remove(),this._super()}})}(e),function(e,i){e.widget("mobile.panel",{options:{classes:{panel:"ui-panel",panelOpen:"ui-panel-open",panelClosed:"ui-panel-closed",panelFixed:"ui-panel-fixed",panelInner:"ui-panel-inner",modal:"ui-panel-dismiss",modalOpen:"ui-panel-dismiss-open",pageContainer:"ui-panel-page-container",pageWrapper:"ui-panel-wrapper",pageFixedToolbar:"ui-panel-fixed-toolbar",pageContentPrefix:"ui-panel-page-content",animate:"ui-panel-animate"},animate:!0,theme:null,position:"left",dismissible:!0,display:"reveal",swipeClose:!0,positionFixed:!1},_panelID:null,_closeLink:null,_parentPage:null,_page:null,_modal:null,_panelInner:null,_wrapper:null,_fixedToolbars:null,_create:function(){var t=this.element,i=t.closest(":jqmData(role='page')");e.extend(this,{_panelID:t.attr("id"),_closeLink:t.find(":jqmData(rel='close')"),_parentPage:i.length>0&&i,_page:this._getPage,_panelInner:this._getPanelInner(),_wrapper:this._getWrapper,_fixedToolbars:this._getFixedToolbars}),this._addPanelClasses(),e.support.cssTransform3d&&this.options.animate&&this.element.addClass(this.options.classes.animate),this._bindUpdateLayout(),this._bindCloseEvents(),this._bindLinkListeners(),this._bindPageEvents(),this.options.dismissible&&this._createModal(),this._bindSwipeEvents()},_getPanelInner:function(){var e=this.element.find("."+this.options.classes.panelInner);return 0===e.length&&(e=this.element.children().wrapAll("<div class='"+this.options.classes.panelInner+"' />").parent()),e},_createModal:function(){var t=this,i=t._parentPage?t._parentPage.parent():t.element.parent();t._modal=e("<div class='"+t.options.classes.modal+"' data-panelid='"+t._panelID+"'></div>").on("mousedown",function(){t.close()}).appendTo(i)},_getPage:function(){return this._parentPage?this._parentPage:e("."+e.mobile.activePageClass)},_getWrapper:function(){var e=this._page().find("."+this.options.classes.pageWrapper);return 0===e.length&&(e=this._page().children(".ui-header:not(.ui-header-fixed), .ui-content:not(.ui-popup), .ui-footer:not(.ui-footer-fixed)").wrapAll("<div class='"+this.options.classes.pageWrapper+"'></div>").parent()),e},_getFixedToolbars:function(){var t=e("body").children(".ui-header-fixed, .ui-footer-fixed"),i=this._page().find(".ui-header-fixed, .ui-footer-fixed");return t.add(i).addClass(this.options.classes.pageFixedToolbar)},_getPosDisplayClasses:function(e){return e+"-position-"+this.options.position+" "+e+"-display-"+this.options.display},_getPanelClasses:function(){var e=this.options.classes.panel+" "+this._getPosDisplayClasses(this.options.classes.panel)+" "+this.options.classes.panelClosed+" ui-body-"+(this.options.theme?this.options.theme:"inherit");return this.options.positionFixed&&(e+=" "+this.options.classes.panelFixed),e},_addPanelClasses:function(){this.element.addClass(this._getPanelClasses())},_bindCloseEvents:function(){var e=this;e._closeLink.on("click.panel",function(t){return t.preventDefault(),e.close(),!1}),e.element.on("click.panel","a:jqmData(ajax='false')",function(){e.close()})},_positionPanel:function(){var i=this,n=i._panelInner.outerHeight(),r=n>e.mobile.getScreenHeight();r||!i.options.positionFixed?(r&&(i._unfixPanel(),e.mobile.resetActivePageHeight(n)),t.scrollTo(0,e.mobile.defaultHomeScroll)):i._fixPanel()},_bindFixListener:function(){this._on(e(t),{throttledresize:"_positionPanel"})},_unbindFixListener:function(){this._off(e(t),"throttledresize")},_unfixPanel:function(){this.options.positionFixed&&e.support.fixedPosition&&this.element.removeClass(this.options.classes.panelFixed)},_fixPanel:function(){this.options.positionFixed&&e.support.fixedPosition&&this.element.addClass(this.options.classes.panelFixed)},_bindUpdateLayout:function(){var e=this;e.element.on("updatelayout",function(){e._open&&e._positionPanel()})},_bindLinkListeners:function(){this._on("body",{"click a":"_handleClick"})},_handleClick:function(t){if(t.currentTarget.href.split("#")[1]===this._panelID&&void 0!==this._panelID){t.preventDefault();var i=e(t.target);return i.hasClass("ui-btn")&&(i.addClass(e.mobile.activeBtnClass),this.element.one("panelopen panelclose",function(){i.removeClass(e.mobile.activeBtnClass)})),this.toggle(),!1}},_bindSwipeEvents:function(){var e=this,t=e._modal?e.element.add(e._modal):e.element;e.options.swipeClose&&("left"===e.options.position?t.on("swipeleft.panel",function(){e.close()}):t.on("swiperight.panel",function(){e.close()}))},_bindPageEvents:function(){var e=this;this.document.on("panelbeforeopen",function(t){e._open&&t.target!==e.element[0]&&e.close()}).on("keyup.panel",function(t){27===t.keyCode&&e._open&&e.close()}),e._parentPage?this.document.on("pagehide",":jqmData(role='page')",function(){e._open&&e.close(!0)}):this.document.on("pagebeforehide",function(){e._open&&e.close(!0)})},_open:!1,_pageContentOpenClasses:null,_modalOpenClasses:null,open:function(t){if(!this._open){var i=this,n=i.options,r=function(){i.document.off("panelclose"),i._page().jqmData("panel","open"),e.support.cssTransform3d&&n.animate&&"overlay"!==n.display&&(i._wrapper().addClass(n.classes.animate),i._fixedToolbars().addClass(n.classes.animate)),!t&&e.support.cssTransform3d&&n.animate?i.document.on(i._transitionEndEvents,o):setTimeout(o,0),n.theme&&"overlay"!==n.display&&i._page().parent().addClass(n.classes.pageContainer+"-themed "+n.classes.pageContainer+"-"+n.theme),i.element.removeClass(n.classes.panelClosed).addClass(n.classes.panelOpen),i._positionPanel(),i._pageContentOpenClasses=i._getPosDisplayClasses(n.classes.pageContentPrefix),"overlay"!==n.display&&(i._page().parent().addClass(n.classes.pageContainer),i._wrapper().addClass(i._pageContentOpenClasses),i._fixedToolbars().addClass(i._pageContentOpenClasses)),i._modalOpenClasses=i._getPosDisplayClasses(n.classes.modal)+" "+n.classes.modalOpen,i._modal&&i._modal.addClass(i._modalOpenClasses).height(Math.max(i._modal.height(),i.document.height()))},o=function(){i.document.off(i._transitionEndEvents,o),"overlay"!==n.display&&(i._wrapper().addClass(n.classes.pageContentPrefix+"-open"),i._fixedToolbars().addClass(n.classes.pageContentPrefix+"-open")),i._bindFixListener(),i._trigger("open")};i._trigger("beforeopen"),"open"===i._page().jqmData("panel")?i.document.on("panelclose",function(){r()}):r(),i._open=!0}},close:function(t){if(this._open){var i=this,n=this.options,r=function(){i.document.off(i._transitionEndEvents,r),n.theme&&"overlay"!==n.display&&i._page().parent().removeClass(n.classes.pageContainer+"-themed "+n.classes.pageContainer+"-"+n.theme),i.element.addClass(n.classes.panelClosed),"overlay"!==n.display&&(i._page().parent().removeClass(n.classes.pageContainer),i._wrapper().removeClass(n.classes.pageContentPrefix+"-open"),i._fixedToolbars().removeClass(n.classes.pageContentPrefix+"-open")),e.support.cssTransform3d&&n.animate&&"overlay"!==n.display&&(i._wrapper().removeClass(n.classes.animate),i._fixedToolbars().removeClass(n.classes.animate)),i._fixPanel(),i._unbindFixListener(),e.mobile.resetActivePageHeight(),i._page().jqmRemoveData("panel"),i._trigger("close")};i._trigger("beforeclose"),!t&&e.support.cssTransform3d&&n.animate?i.document.on(i._transitionEndEvents,r):setTimeout(r,0),i.element.removeClass(n.classes.panelOpen),"overlay"!==n.display&&(i._wrapper().removeClass(i._pageContentOpenClasses),i._fixedToolbars().removeClass(i._pageContentOpenClasses)),i._modal&&i._modal.removeClass(i._modalOpenClasses),i._open=!1}},toggle:function(){this[this._open?"close":"open"]()},_transitionEndEvents:"webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",_destroy:function(){var t=this.options,i=e("body > :mobile-panel").length+e.mobile.activePage.find(":mobile-panel").length>1;"overlay"!==t.display&&(0===e("body > :mobile-panel").add(e.mobile.activePage.find(":mobile-panel")).not(".ui-panel-display-overlay").not(this.element).length&&this._wrapper().children().unwrap(),this._open&&(this._fixedToolbars().removeClass(t.classes.pageContentPrefix+"-open"),e.support.cssTransform3d&&t.animate&&this._fixedToolbars().removeClass(t.classes.animate),this._page().parent().removeClass(t.classes.pageContainer),t.theme&&this._page().parent().removeClass(t.classes.pageContainer+"-themed "+t.classes.pageContainer+"-"+t.theme))),i||(this.document.off("panelopen panelclose"),this._open&&(this.document.off(this._transitionEndEvents),e.mobile.resetActivePageHeight())),this._open&&this._page().jqmRemoveData("panel"),this._panelInner.children().unwrap(),this.element.removeClass([this._getPanelClasses(),t.classes.panelOpen,t.classes.animate].join(" ")).off("swipeleft.panel swiperight.panel").off("panelbeforeopen").off("panelhide").off("keyup.panel").off("updatelayout").off(this._transitionEndEvents),this._closeLink.off("click.panel"),this._modal&&this._modal.remove()}})}(e),function(e,t){e.widget("mobile.table",{options:{classes:{table:"ui-table"},enhanced:!1},_create:function(){this.options.enhanced||this.element.addClass(this.options.classes.table),e.extend(this,{headers:t,allHeaders:t}),this._refresh(!0)},_setHeaders:function(){var e=this.element.find("thead tr");this.headers=this.element.find("tr:eq(0)").children(),this.allHeaders=this.headers.add(e.children())},refresh:function(){this._refresh()},rebuild:e.noop,_refresh:function(){var t=this.element,i=t.find("thead tr");this._setHeaders(),i.each(function(){var n=0;e(this).children().each(function(){var r,o=parseInt(this.getAttribute("colspan"),10),a=":nth-child("+(n+1)+")";if(this.setAttribute("data-"+e.mobile.ns+"colstart",n+1),o)for(r=0;o-1>r;r++)a+=", :nth-child("+(++n+1)+")";e(this).jqmData("cells",t.find("tr").not(i.eq(0)).not(this).children(a)),n++})})}})}(e),function(e){e.widget("mobile.table",e.mobile.table,{options:{mode:"columntoggle",columnBtnTheme:null,columnPopupTheme:null,columnBtnText:"Columns...",classes:e.extend(e.mobile.table.prototype.options.classes,{popup:"ui-table-columntoggle-popup",columnBtn:"ui-table-columntoggle-btn",priorityPrefix:"ui-table-priority-",columnToggleTable:"ui-table-columntoggle"})},_create:function(){this._super(),"columntoggle"===this.options.mode&&(e.extend(this,{_menu:null}),this.options.enhanced?(this._menu=e(this.document[0].getElementById(this._id()+"-popup")).children().first(),this._addToggles(this._menu,!0),this._bindToggles(this._menu)):(this._menu=this._enhanceColToggle(),this.element.addClass(this.options.classes.columnToggleTable)),this._setupEvents(),this._setToggleState())},_id:function(){return this.element.attr("id")||this.widgetName+this.uuid},_setupEvents:function(){this._on(this.window,{throttledresize:"_setToggleState"})},_bindToggles:function(e){var t=e.find("input");this._on(t,{change:"_menuInputChange"})},_addToggles:function(t,i){var n,r=0,o=this.options,a=t.controlgroup("container");i?n=t.find("input"):a.empty(),this.headers.not("td").each(function(){var t=e(this),s=e.mobile.getAttribute(this,"priority"),l=t.add(t.jqmData("cells"));s&&(l.addClass(o.classes.priorityPrefix+s),(i?n.eq(r++):e("<label><input type='checkbox' checked />"+(t.children("abbr").first().attr("title")||t.text())+"</label>").appendTo(a).children(0).checkboxradio({theme:o.columnPopupTheme})).jqmData("cells",l))}),i||(t.controlgroup("refresh"),this._bindToggles(t))},_menuInputChange:function(t){var i=e(t.target),n=i[0].checked;i.jqmData("cells").toggleClass("ui-table-cell-hidden",!n).toggleClass("ui-table-cell-visible",n),i[0].getAttribute("locked")?(i.removeAttr("locked"),this._unlockCells(i.jqmData("cells"))):i.attr("locked",!0)},_unlockCells:function(e){e.removeClass("ui-table-cell-hidden ui-table-cell-visible")},_enhanceColToggle:function(){var t,i,n,r,o=this.element,a=this.options,s=e.mobile.ns,l=this.document[0].createDocumentFragment();return t=this._id()+"-popup",i=e("<a href='#"+t+"' class='"+a.classes.columnBtn+" ui-btn ui-btn-"+(a.columnBtnTheme||"a")+" ui-corner-all ui-shadow ui-mini' data-"+s+"rel='popup'>"+a.columnBtnText+"</a>"),n=e("<div class='"+a.classes.popup+"' id='"+t+"'></div>"),r=e("<fieldset></fieldset>").controlgroup(),this._addToggles(r,!1),r.appendTo(n),l.appendChild(n[0]),l.appendChild(i[0]),o.before(l),n.popup(),r},rebuild:function(){this._super(),"columntoggle"===this.options.mode&&this._refresh(!1)},_refresh:function(e){this._super(e),e||"columntoggle"!==this.options.mode||(this._unlockCells(this.allHeaders),this._addToggles(this._menu,e),this._setToggleState())},_setToggleState:function(){this._menu.find("input").each(function(){var t=e(this);this.checked="table-cell"===t.jqmData("cells").eq(0).css("display"),t.checkboxradio("refresh")})},_destroy:function(){this._super()}})}(e),function(e){e.widget("mobile.table",e.mobile.table,{options:{mode:"reflow",classes:e.extend(e.mobile.table.prototype.options.classes,{reflowTable:"ui-table-reflow",cellLabels:"ui-table-cell-label"})},_create:function(){this._super(),"reflow"===this.options.mode&&(this.options.enhanced||(this.element.addClass(this.options.classes.reflowTable),this._updateReflow()))},rebuild:function(){this._super(),"reflow"===this.options.mode&&this._refresh(!1)},_refresh:function(e){this._super(e),e||"reflow"!==this.options.mode||this._updateReflow()},_updateReflow:function(){var t=this,i=this.options;e(t.allHeaders.get().reverse()).each(function(){var n,r,o=e(this).jqmData("cells"),a=e.mobile.getAttribute(this,"colstart"),s=o.not(this).filter("thead th").length&&" ui-table-cell-label-top",l=e(this).text();""!==l&&(s?(r="",(n=parseInt(this.getAttribute("colspan"),10))&&(r="td:nth-child("+n+"n + "+a+")"),t._addLabels(o.filter(r),i.classes.cellLabels+s,l)):t._addLabels(o,i.classes.cellLabels,l))})},_addLabels:function(e,t,i){e.not(":has(b."+t+")").prepend("<b class='"+t+"'>"+i+"</b>")}})}(e),function(e,i){var n=function(t,i){return-1===(""+(e.mobile.getAttribute(this,"filtertext")||e(this).text())).toLowerCase().indexOf(i)};e.widget("mobile.filterable",{initSelector:":jqmData(filter='true')",options:{filterReveal:!1,filterCallback:n,enhanced:!1,input:null,children:"> li, > option, > optgroup option, > tbody tr, > .ui-controlgroup-controls > .ui-btn, > .ui-controlgroup-controls > .ui-checkbox, > .ui-controlgroup-controls > .ui-radio"},_create:function(){var t=this.options;e.extend(this,{_search:null,_timer:0}),this._setInput(t.input),t.enhanced||this._filterItems((this._search&&this._search.val()||"").toLowerCase())},_onKeyUp:function(){var i,n,r=this._search;if(r){if(i=r.val().toLowerCase(),(n=e.mobile.getAttribute(r[0],"lastval")+"")&&n===i)return;this._timer&&(t.clearTimeout(this._timer),this._timer=0),this._timer=this._delay(function(){this._trigger("beforefilter","beforefilter",{input:r}),r[0].setAttribute("data-"+e.mobile.ns+"lastval",i),this._filterItems(i),this._timer=0},250)}},_getFilterableItems:function(){var t=this.element,i=this.options.children,n=i?e.isFunction(i)?i():i.nodeName?e(i):i.jquery?i:this.element.find(i):{length:0};return 0===n.length&&(n=t.children()),n},_filterItems:function(t){var i,r,o,a=[],s=[],l=this.options,c=this._getFilterableItems();if(null!=t)for(r=l.filterCallback||n,o=c.length,i=0;o>i;i++)(r.call(c[i],i,t)?s:a).push(c[i]);0===s.length?c[l.filterReveal?"addClass":"removeClass"]("ui-screen-hidden"):(e(s).addClass("ui-screen-hidden"),e(a).removeClass("ui-screen-hidden")),this._refreshChildWidget()},_refreshChildWidget:function(){var t,i,n=["collapsibleset","selectmenu","controlgroup","listview"];for(i=n.length-1;i>-1;i--)t=n[i],e.mobile[t]&&((t=this.element.data("mobile-"+t))&&e.isFunction(t.refresh)&&t.refresh())},_setInput:function(i){var n=this._search;this._timer&&(t.clearTimeout(this._timer),this._timer=0),n&&(this._off(n,"keyup change input"),n=null),i&&(n=i.jquery?i:i.nodeName?e(i):this.document.find(i),this._on(n,{keyup:"_onKeyUp",change:"_onKeyUp",input:"_onKeyUp"})),this._search=n},_setOptions:function(e){var t=!(e.filterReveal===i&&e.filterCallback===i&&e.children===i);this._super(e),e.input!==i&&(this._setInput(e.input),t=!0),t&&this.refresh()},_destroy:function(){var e=this.options,t=this._getFilterableItems();e.enhanced?t.toggleClass("ui-screen-hidden",e.filterReveal):t.removeClass("ui-screen-hidden")},refresh:function(){this._timer&&(t.clearTimeout(this._timer),this._timer=0),this._filterItems((this._search&&this._search.val()||"").toLowerCase())}})}(e),function(e,t){var i=/(^|\s)ui-li-divider(\s|$)/,n=e.mobile.filterable.prototype.options.filterCallback;e.mobile.filterable.prototype.options.filterCallback=function(e,t){return!this.className.match(i)&&n.call(this,e,t)},e.widget("mobile.filterable",e.mobile.filterable,{options:{filterPlaceholder:"Filter items...",filterTheme:null},_create:function(){var t,i,n=this.element,r=["collapsibleset","selectmenu","controlgroup","listview"],o={};for(this._super(),e.extend(this,{_widget:null}),t=r.length-1;t>-1;t--)if(i=r[t],e.mobile[i]){if(this._setWidget(n.data("mobile-"+i)))break;o[i+"create"]="_handleCreate"}this._widget||this._on(n,o)},_handleCreate:function(e){this._setWidget(this.element.data("mobile-"+e.type.substring(0,e.type.length-6)))},_setWidget:function(e){return!this._widget&&e&&(this._widget=e,this._widget._setOptions=function(e,t){return function(i){t.call(this,i),e._syncTextInputOptions(i)}}(this,this._widget._setOptions)),this._widget&&(this._syncTextInputOptions(this._widget.options),"listview"===this._widget.widgetName&&(this._widget.options.hidedividers=!0,this._widget.element.listview("refresh"))),!!this._widget},_isSearchInternal:function(){return this._search&&this._search.jqmData("ui-filterable-"+this.uuid+"-internal")},_setInput:function(t){var i=this.options,n=!0,r={};if(!t){if(this._isSearchInternal())return;n=!1,t=e("<input data-"+e.mobile.ns+"type='search' placeholder='"+i.filterPlaceholder+"'></input>").jqmData("ui-filterable-"+this.uuid+"-internal",!0),e("<form class='ui-filterable'></form>").append(t).submit(function(e){e.preventDefault(),t.blur()}).insertBefore(this.element),e.mobile.textinput&&(null!=this.options.filterTheme&&(r.theme=i.filterTheme),t.textinput(r))}this._super(t),this._isSearchInternal()&&n&&this._search.attr("placeholder",this.options.filterPlaceholder)},_setOptions:function(i){var n=this._super(i);return i.filterPlaceholder!==t&&this._isSearchInternal()&&this._search.attr("placeholder",i.filterPlaceholder),i.filterTheme!==t&&this._search&&e.mobile.textinput&&this._search.textinput("option","theme",i.filterTheme),n},_destroy:function(){this._isSearchInternal()&&this._search.remove(),this._super()},_syncTextInputOptions:function(i){var n,r={};if(this._isSearchInternal()&&e.mobile.textinput){for(n in e.mobile.textinput.prototype.options)i[n]!==t&&(r[n]="theme"===n&&null!=this.options.filterTheme?this.options.filterTheme:i[n]);this._search.textinput("option",r)}}})}(e),function(e,t){function i(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(r,""))===decodeURIComponent(location.href.replace(r,""))}var n=0,r=/#.*$/;e.widget("ui.tabs",{version:"fadf2b312a05040436451c64bbfaf4814bc62c56",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===t&&(n&&this.tabs.each(function(i,r){return e(r).attr("aria-controls")===n?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=!!this.tabs.length&&0)),!1!==t&&(-1===(t=this.tabs.index(this.tabs.eq(t)))&&(t=!i&&0)),!i&&!1===t&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),n=this.tabs.index(i),r=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:n++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:r=!1,n--;break;case e.ui.keyCode.END:n=this.anchors.length-1;break;case e.ui.keyCode.HOME:n=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(n);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(n!==this.options.active&&n);default:return}t.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,r),t.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){for(var n=this.tabs.length-1;-1!==e.inArray((t>n&&(t=0),0>t&&(t=n),t),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||!1!==this.options.active||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+ ++n},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),!1!==t.active&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,r){var o,a,s,l=e(r).uniqueId().attr("id"),c=e(r).closest("li"),u=c.attr("aria-controls");i(r)?(o=r.hash,a=t.element.find(t._sanitizeSelector(o))):(o="#"+(s=t._tabId(c)),(a=t.element.find(o)).length||(a=t._createPanel(s)).insertAfter(t.panels[n-1]||t.tablist),a.attr("aria-live","polite")),a.length&&(t.panels=t.panels.add(a)),u&&c.data("ui-tabs-aria-controls",u),c.attr({"aria-controls":o.substring(1),"aria-labelledby":l}),a.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,n=0;i=this.tabs[n];n++)!0===t||-1!==e.inArray(n,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,n=this.element.parent();"fill"===t?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),n=t.css("position");"absolute"!==n&&"fixed"!==n&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,n=this.active,r=e(t.currentTarget).closest("li"),o=r[0]===n[0],a=o&&i.collapsible,s=a?e():this._getPanelForTab(r),l=n.length?this._getPanelForTab(n):e(),c={oldTab:n,oldPanel:l,newTab:a?e():r,newPanel:s};t.preventDefault(),r.hasClass("ui-state-disabled")||r.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||!1===this._trigger("beforeActivate",t,c)||(i.active=!a&&this.tabs.index(r),this.active=o?e():r,this.xhr&&this.xhr.abort(),l.length||s.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),s.length&&this.load(this.tabs.index(r),t),this._toggle(t,c))},_toggle:function(t,i){function n(){o.running=!1,o._trigger("activate",t,i)}function r(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),a.length&&o.options.show?o._show(a,o.options.show,n):(a.show(),n())}var o=this,a=i.newPanel,s=i.oldPanel;this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),r()),s.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),a.length&&s.length?i.oldTab.attr("tabIndex",-1):a.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),a.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var i,n=this._findActive(t);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return!1===t?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var n=this.options.disabled;!1!==n&&(i===t?n=!1:(i=this._getIndex(i),n=e.isArray(n)?e.map(n,function(e){return e!==i?e:null}):e.map(this.tabs,function(e,t){return t!==i?t:null})),this._setupDisabled(n))},disable:function(i){var n=this.options.disabled;if(!0!==n){if(i===t)n=!0;else{if(i=this._getIndex(i),-1!==e.inArray(i,n))return;n=e.isArray(n)?e.merge([i],n).sort():[i]}this._setupDisabled(n)}},load:function(t,n){t=this._getIndex(t);var r=this,o=this.tabs.eq(t),a=o.find(".ui-tabs-anchor"),s=this._getPanelForTab(o),l={tab:o,panel:s};i(a[0])||(this.xhr=e.ajax(this._ajaxSettings(a,n,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(o.addClass("ui-tabs-loading"),s.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){s.html(e),r._trigger("load",n,l)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&r.panels.stop(!1,!0),o.removeClass("ui-tabs-loading"),s.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr},1)})))},_ajaxSettings:function(t,i,n){var r=this;return{url:t.attr("href"),beforeSend:function(t,o){return r._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:o},n))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(e),function(e,t){function i(e){r=e.originalEvent,l=r.accelerationIncludingGravity,o=Math.abs(l.x),a=Math.abs(l.y),s=Math.abs(l.z),!t.orientation&&(o>7||(s>6&&8>a||8>s&&a>6)&&o>5)?n.enabled&&n.disable():n.enabled||n.enable()}e.mobile.iosorientationfixEnabled=!0;var n,r,o,a,s,l,c=navigator.userAgent;/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(c)&&c.indexOf("AppleWebKit")>-1?(n=e.mobile.zoom,e.mobile.document.on("mobileinit",function(){e.mobile.iosorientationfixEnabled&&e.mobile.window.bind("orientationchange.iosorientationfix",n.enable).bind("devicemotion.iosorientationfix",i)})):e.mobile.iosorientationfixEnabled=!1}(e,this),function(e,t){function n(){r.removeClass("ui-mobile-rendering")}var r=e("html"),o=e.mobile.window;e(t.document).trigger("mobileinit"),e.mobile.gradeA()&&(e.mobile.ajaxBlacklist&&(e.mobile.ajaxEnabled=!1),r.addClass("ui-mobile ui-mobile-rendering"),setTimeout(n,5e3),e.extend(e.mobile,{initializePage:function(){var t=e.mobile.path,r=e(":jqmData(role='page'), :jqmData(role='dialog')"),a=t.stripHash(t.stripQueryParams(t.parseLocation().hash)),s=i.getElementById(a);r.length||(r=e("body").wrapInner("<div data-"+e.mobile.ns+"role='page'></div>").children(0)),r.each(function(){var t=e(this);t[0].getAttribute("data-"+e.mobile.ns+"url")||t.attr("data-"+e.mobile.ns+"url",t.attr("id")||location.pathname+location.search)}),e.mobile.firstPage=r.first(),e.mobile.pageContainer=e.mobile.firstPage.parent().addClass("ui-mobile-viewport").pagecontainer(),e.mobile.navreadyDeferred.resolve(),o.trigger("pagecontainercreate"),e.mobile.loading("show"),n(),e.mobile.hashListeningEnabled&&e.mobile.path.isHashValid(location.hash)&&(e(s).is(":jqmData(role='page')")||e.mobile.path.isPath(a)||a===e.mobile.dialogHashKey)?e.event.special.navigate.isPushStateEnabled()?(e.mobile.navigate.history.stack=[],e.mobile.navigate(e.mobile.path.isPath(location.hash)?location.hash:location.href)):o.trigger("hashchange",[!0]):(e.mobile.path.isHashValid(location.hash)&&(e.mobile.navigate.history.initialDst=a.replace("#","")),e.event.special.navigate.isPushStateEnabled()&&e.mobile.navigate.navigator.squash(t.parseLocation().href),e.mobile.changePage(e.mobile.firstPage,{transition:"none",reverse:!0,changeHash:!1,fromHashChange:!0}))}}),e(function(){e.support.inlineSVG(),e.mobile.hideUrlBar&&t.scrollTo(0,1),e.mobile.defaultHomeScroll=e.support.scrollTop&&1!==e.mobile.window.scrollTop()?1:0,e.mobile.autoInitializePage&&e.mobile.initializePage(),e.mobile.hideUrlBar&&o.load(e.mobile.silentScroll),e.support.cssPointerEvents||e.mobile.document.delegate(".ui-state-disabled,.ui-disabled","vclick",function(e){e.preventDefault(),e.stopImmediatePropagation()})}))}(e,this)}),function(){var e,t=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",n="Expected a function",r="__lodash_hash_undefined__",o=500,a="__lodash_placeholder__",s=1,l=2,c=4,u=1,h=2,d=1,p=2,f=4,m=8,g=16,v=32,y=64,b=128,x=256,_=512,w=30,E="...",T=800,M=16,S=1,C=2,R=1/0,A=9007199254740991,P=1.7976931348623157e308,L=NaN,O=4294967295,I=O-1,k=O>>>1,D=[["ary",b],["bind",d],["bindKey",p],["curry",m],["curryRight",g],["flip",_],["partial",v],["partialRight",y],["rearg",x]],N="[object Arguments]",H="[object Array]",B="[object AsyncFunction]",F="[object Boolean]",U="[object Date]",$="[object DOMException]",j="[object Error]",z="[object Function]",V="[object GeneratorFunction]",G="[object Map]",W="[object Number]",q="[object Null]",X="[object Object]",Z="[object Proxy]",Y="[object RegExp]",J="[object Set]",K="[object String]",Q="[object Symbol]",ee="[object Undefined]",te="[object WeakMap]",ie="[object WeakSet]",ne="[object ArrayBuffer]",re="[object DataView]",oe="[object Float32Array]",ae="[object Float64Array]",se="[object Int8Array]",le="[object Int16Array]",ce="[object Int32Array]",ue="[object Uint8Array]",he="[object Uint8ClampedArray]",de="[object Uint16Array]",pe="[object Uint32Array]",fe=/\b__p \+= '';/g,me=/\b(__p \+=) '' \+/g,ge=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ve=/&(?:amp|lt|gt|quot|#39);/g,ye=/[&<>"']/g,be=RegExp(ve.source),xe=RegExp(ye.source),_e=/<%-([\s\S]+?)%>/g,we=/<%([\s\S]+?)%>/g,Ee=/<%=([\s\S]+?)%>/g,Te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Me=/^\w*$/,Se=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ce=/[\\^$.*+?()[\]{}|]/g,Re=RegExp(Ce.source),Ae=/^\s+|\s+$/g,Pe=/^\s+/,Le=/\s+$/,Oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ie=/\{\n\/\* \[wrapped with (.+)\] \*/,ke=/,? & /,De=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ne=/\\(\\)?/g,He=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Be=/\w*$/,Fe=/^[-+]0x[0-9a-f]+$/i,Ue=/^0b[01]+$/i,$e=/^\[object .+?Constructor\]$/,je=/^0o[0-7]+$/i,ze=/^(?:0|[1-9]\d*)$/,Ve=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ge=/($^)/,We=/['\n\r\u2028\u2029\\]/g,qe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Xe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ze="[\\ud800-\\udfff]",Ye="["+Xe+"]",Je="["+qe+"]",Ke="\\d+",Qe="[\\u2700-\\u27bf]",et="[a-z\\xdf-\\xf6\\xf8-\\xff]",tt="[^\\ud800-\\udfff"+Xe+Ke+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",it="\\ud83c[\\udffb-\\udfff]",nt="[^\\ud800-\\udfff]",rt="(?:\\ud83c[\\udde6-\\uddff]){2}",ot="[\\ud800-\\udbff][\\udc00-\\udfff]",at="[A-Z\\xc0-\\xd6\\xd8-\\xde]",st="(?:"+et+"|"+tt+")",lt="(?:"+at+"|"+tt+")",ct="(?:"+Je+"|"+it+")"+"?",ut="[\\ufe0e\\ufe0f]?"+ct+("(?:\\u200d(?:"+[nt,rt,ot].join("|")+")[\\ufe0e\\ufe0f]?"+ct+")*"),ht="(?:"+[Qe,rt,ot].join("|")+")"+ut,dt="(?:"+[nt+Je+"?",Je,rt,ot,Ze].join("|")+")",pt=RegExp("[']","g"),ft=RegExp(Je,"g"),mt=RegExp(it+"(?="+it+")|"+dt+ut,"g"),gt=RegExp([at+"?"+et+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[Ye,at,"$"].join("|")+")",lt+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[Ye,at+st,"$"].join("|")+")",at+"?"+st+"+(?:['](?:d|ll|m|re|s|t|ve))?",at+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ke,ht].join("|"),"g"),vt=RegExp("[\\u200d\\ud800-\\udfff"+qe+"\\ufe0e\\ufe0f]"),yt=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,bt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],xt=-1,_t={};_t[oe]=_t[ae]=_t[se]=_t[le]=_t[ce]=_t[ue]=_t[he]=_t[de]=_t[pe]=!0,_t[N]=_t[H]=_t[ne]=_t[F]=_t[re]=_t[U]=_t[j]=_t[z]=_t[G]=_t[W]=_t[X]=_t[Y]=_t[J]=_t[K]=_t[te]=!1;var wt={};wt[N]=wt[H]=wt[ne]=wt[re]=wt[F]=wt[U]=wt[oe]=wt[ae]=wt[se]=wt[le]=wt[ce]=wt[G]=wt[W]=wt[X]=wt[Y]=wt[J]=wt[K]=wt[Q]=wt[ue]=wt[he]=wt[de]=wt[pe]=!0,wt[j]=wt[z]=wt[te]=!1;var Et={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Tt=parseFloat,Mt=parseInt,St="object"==typeof global&&global&&global.Object===Object&&global,Ct="object"==typeof self&&self&&self.Object===Object&&self,Rt=St||Ct||Function("return this")(),At="object"==typeof exports&&exports&&!exports.nodeType&&exports,Pt=At&&"object"==typeof module&&module&&!module.nodeType&&module,Lt=Pt&&Pt.exports===At,Ot=Lt&&St.process,It=function(){try{var e=Pt&&Pt.require&&Pt.require("util").types;return e||Ot&&Ot.binding&&Ot.binding("util")}catch(e){}}(),kt=It&&It.isArrayBuffer,Dt=It&&It.isDate,Nt=It&&It.isMap,Ht=It&&It.isRegExp,Bt=It&&It.isSet,Ft=It&&It.isTypedArray;function Ut(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function $t(e,t,i,n){for(var r=-1,o=null==e?0:e.length;++r<o;){var a=e[r];t(n,a,i(a),e)}return n}function jt(e,t){for(var i=-1,n=null==e?0:e.length;++i<n&&!1!==t(e[i],i,e););return e}function zt(e,t){for(var i=null==e?0:e.length;i--&&!1!==t(e[i],i,e););return e}function Vt(e,t){for(var i=-1,n=null==e?0:e.length;++i<n;)if(!t(e[i],i,e))return!1;return!0}function Gt(e,t){for(var i=-1,n=null==e?0:e.length,r=0,o=[];++i<n;){var a=e[i];t(a,i,e)&&(o[r++]=a)}return o}function Wt(e,t){return!!(null==e?0:e.length)&&ii(e,t,0)>-1}function qt(e,t,i){for(var n=-1,r=null==e?0:e.length;++n<r;)if(i(t,e[n]))return!0;return!1}function Xt(e,t){for(var i=-1,n=null==e?0:e.length,r=Array(n);++i<n;)r[i]=t(e[i],i,e);return r}function Zt(e,t){for(var i=-1,n=t.length,r=e.length;++i<n;)e[r+i]=t[i];return e}function Yt(e,t,i,n){var r=-1,o=null==e?0:e.length;for(n&&o&&(i=e[++r]);++r<o;)i=t(i,e[r],r,e);return i}function Jt(e,t,i,n){var r=null==e?0:e.length;for(n&&r&&(i=e[--r]);r--;)i=t(i,e[r],r,e);return i}function Kt(e,t){for(var i=-1,n=null==e?0:e.length;++i<n;)if(t(e[i],i,e))return!0;return!1}var Qt=ai("length");function ei(e,t,i){var n;return i(e,function(e,i,r){if(t(e,i,r))return n=i,!1}),n}function ti(e,t,i,n){for(var r=e.length,o=i+(n?1:-1);n?o--:++o<r;)if(t(e[o],o,e))return o;return-1}function ii(e,t,i){return t==t?function(e,t,i){var n=i-1,r=e.length;for(;++n<r;)if(e[n]===t)return n;return-1}(e,t,i):ti(e,ri,i)}function ni(e,t,i,n){for(var r=i-1,o=e.length;++r<o;)if(n(e[r],t))return r;return-1}function ri(e){return e!=e}function oi(e,t){var i=null==e?0:e.length;return i?ci(e,t)/i:L}function ai(t){return function(i){return null==i?e:i[t]}}function si(t){return function(i){return null==t?e:t[i]}}function li(e,t,i,n,r){return r(e,function(e,r,o){i=n?(n=!1,e):t(i,e,r,o)}),i}function ci(t,i){for(var n,r=-1,o=t.length;++r<o;){var a=i(t[r]);a!==e&&(n=n===e?a:n+a)}return n}function ui(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}function hi(e){return function(t){return e(t)}}function di(e,t){return Xt(t,function(t){return e[t]})}function pi(e,t){return e.has(t)}function fi(e,t){for(var i=-1,n=e.length;++i<n&&ii(t,e[i],0)>-1;);return i}function mi(e,t){for(var i=e.length;i--&&ii(t,e[i],0)>-1;);return i}var gi=si({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),vi=si({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function yi(e){return"\\"+Et[e]}function bi(e){return vt.test(e)}function xi(e){var t=-1,i=Array(e.size);return e.forEach(function(e,n){i[++t]=[n,e]}),i}function _i(e,t){return function(i){return e(t(i))}}function wi(e,t){for(var i=-1,n=e.length,r=0,o=[];++i<n;){var s=e[i];s!==t&&s!==a||(e[i]=a,o[r++]=i)}return o}function Ei(t,i){return"__proto__"==i?e:t[i]}function Ti(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=e}),i}function Mi(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=[e,e]}),i}function Si(e){return bi(e)?function(e){var t=mt.lastIndex=0;for(;mt.test(e);)++t;return t}(e):Qt(e)}function Ci(e){return bi(e)?function(e){return e.match(mt)||[]}(e):function(e){return e.split("")}(e)}var Ri=si({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Ai=function qe(Xe){var Ze,Ye=(Xe=null==Xe?Rt:Ai.defaults(Rt.Object(),Xe,Ai.pick(Rt,bt))).Array,Je=Xe.Date,Ke=Xe.Error,Qe=Xe.Function,et=Xe.Math,tt=Xe.Object,it=Xe.RegExp,nt=Xe.String,rt=Xe.TypeError,ot=Ye.prototype,at=Qe.prototype,st=tt.prototype,lt=Xe["__core-js_shared__"],ct=at.toString,ut=st.hasOwnProperty,ht=0,dt=(Ze=/[^.]+$/.exec(lt&&lt.keys&&lt.keys.IE_PROTO||""))?"Symbol(src)_1."+Ze:"",mt=st.toString,vt=ct.call(tt),Et=Rt._,St=it("^"+ct.call(ut).replace(Ce,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ct=Lt?Xe.Buffer:e,At=Xe.Symbol,Pt=Xe.Uint8Array,Ot=Ct?Ct.allocUnsafe:e,It=_i(tt.getPrototypeOf,tt),Qt=tt.create,si=st.propertyIsEnumerable,Pi=ot.splice,Li=At?At.isConcatSpreadable:e,Oi=At?At.iterator:e,Ii=At?At.toStringTag:e,ki=function(){try{var e=Uo(tt,"defineProperty");return e({},"",{}),e}catch(e){}}(),Di=Xe.clearTimeout!==Rt.clearTimeout&&Xe.clearTimeout,Ni=Je&&Je.now!==Rt.Date.now&&Je.now,Hi=Xe.setTimeout!==Rt.setTimeout&&Xe.setTimeout,Bi=et.ceil,Fi=et.floor,Ui=tt.getOwnPropertySymbols,$i=Ct?Ct.isBuffer:e,ji=Xe.isFinite,zi=ot.join,Vi=_i(tt.keys,tt),Gi=et.max,Wi=et.min,qi=Je.now,Xi=Xe.parseInt,Zi=et.random,Yi=ot.reverse,Ji=Uo(Xe,"DataView"),Ki=Uo(Xe,"Map"),Qi=Uo(Xe,"Promise"),en=Uo(Xe,"Set"),tn=Uo(Xe,"WeakMap"),nn=Uo(tt,"create"),rn=tn&&new tn,on={},an=ha(Ji),sn=ha(Ki),ln=ha(Qi),cn=ha(en),un=ha(tn),hn=At?At.prototype:e,dn=hn?hn.valueOf:e,pn=hn?hn.toString:e;function fn(e){if(Rs(e)&&!vs(e)&&!(e instanceof yn)){if(e instanceof vn)return e;if(ut.call(e,"__wrapped__"))return da(e)}return new vn(e)}var mn=function(){function t(){}return function(i){if(!Cs(i))return{};if(Qt)return Qt(i);t.prototype=i;var n=new t;return t.prototype=e,n}}();function gn(){}function vn(t,i){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=e}function yn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=O,this.__views__=[]}function bn(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function xn(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function _n(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}function wn(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new _n;++t<i;)this.add(e[t])}function En(e){var t=this.__data__=new xn(e);this.size=t.size}function Tn(e,t){var i=vs(e),n=!i&&gs(e),r=!i&&!n&&_s(e),o=!i&&!n&&!r&&Ns(e),a=i||n||r||o,s=a?ui(e.length,nt):[],l=s.length;for(var c in e)!t&&!ut.call(e,c)||a&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||qo(c,l))||s.push(c);return s}function Mn(t){var i=t.length;return i?t[wr(0,i-1)]:e}function Sn(e,t){return la(no(e),Dn(t,0,e.length))}function Cn(e){return la(no(e))}function Rn(t,i,n){(n===e||ps(t[i],n))&&(n!==e||i in t)||In(t,i,n)}function An(t,i,n){var r=t[i];ut.call(t,i)&&ps(r,n)&&(n!==e||i in t)||In(t,i,n)}function Pn(e,t){for(var i=e.length;i--;)if(ps(e[i][0],t))return i;return-1}function Ln(e,t,i,n){return Un(e,function(e,r,o){t(n,e,i(e),o)}),n}function On(e,t){return e&&ro(t,rl(t),e)}function In(e,t,i){"__proto__"==t&&ki?ki(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function kn(t,i){for(var n=-1,r=i.length,o=Ye(r),a=null==t;++n<r;)o[n]=a?e:Qs(t,i[n]);return o}function Dn(t,i,n){return t==t&&(n!==e&&(t=t<=n?t:n),i!==e&&(t=t>=i?t:i)),t}function Nn(t,i,n,r,o,a){var u,h=i&s,d=i&l,p=i&c;if(n&&(u=o?n(t,r,o,a):n(t)),u!==e)return u;if(!Cs(t))return t;var f=vs(t);if(f){if(u=function(e){var t=e.length,i=new e.constructor(t);return t&&"string"==typeof e[0]&&ut.call(e,"index")&&(i.index=e.index,i.input=e.input),i}(t),!h)return no(t,u)}else{var m=zo(t),g=m==z||m==V;if(_s(t))return Jr(t,h);if(m==X||m==N||g&&!o){if(u=d||g?{}:Go(t),!h)return d?function(e,t){return ro(e,jo(e),t)}(t,function(e,t){return e&&ro(t,ol(t),e)}(u,t)):function(e,t){return ro(e,$o(e),t)}(t,On(u,t))}else{if(!wt[m])return o?t:{};u=function(e,t,i){var n,r,o,a=e.constructor;switch(t){case ne:return Kr(e);case F:case U:return new a(+e);case re:return function(e,t){var i=t?Kr(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}(e,i);case oe:case ae:case se:case le:case ce:case ue:case he:case de:case pe:return Qr(e,i);case G:return new a;case W:case K:return new a(e);case Y:return(o=new(r=e).constructor(r.source,Be.exec(r))).lastIndex=r.lastIndex,o;case J:return new a;case Q:return n=e,dn?tt(dn.call(n)):{}}}(t,m,h)}}a||(a=new En);var v=a.get(t);if(v)return v;if(a.set(t,u),Is(t))return t.forEach(function(e){u.add(Nn(e,i,n,e,t,a))}),u;if(As(t))return t.forEach(function(e,r){u.set(r,Nn(e,i,n,r,t,a))}),u;var y=f?e:(p?d?Io:Oo:d?ol:rl)(t);return jt(y||t,function(e,r){y&&(e=t[r=e]),An(u,r,Nn(e,i,n,r,t,a))}),u}function Hn(t,i,n){var r=n.length;if(null==t)return!r;for(t=tt(t);r--;){var o=n[r],a=i[o],s=t[o];if(s===e&&!(o in t)||!a(s))return!1}return!0}function Bn(t,i,r){if("function"!=typeof t)throw new rt(n);return ra(function(){t.apply(e,r)},i)}function Fn(e,i,n,r){var o=-1,a=Wt,s=!0,l=e.length,c=[],u=i.length;if(!l)return c;n&&(i=Xt(i,hi(n))),r?(a=qt,s=!1):i.length>=t&&(a=pi,s=!1,i=new wn(i));e:for(;++o<l;){var h=e[o],d=null==n?h:n(h);if(h=r||0!==h?h:0,s&&d==d){for(var p=u;p--;)if(i[p]===d)continue e;c.push(h)}else a(i,d,r)||c.push(h)}return c}fn.templateSettings={escape:_e,evaluate:we,interpolate:Ee,variable:"",imports:{_:fn}},fn.prototype=gn.prototype,fn.prototype.constructor=fn,vn.prototype=mn(gn.prototype),vn.prototype.constructor=vn,yn.prototype=mn(gn.prototype),yn.prototype.constructor=yn,bn.prototype.clear=function(){this.__data__=nn?nn(null):{},this.size=0},bn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},bn.prototype.get=function(t){var i=this.__data__;if(nn){var n=i[t];return n===r?e:n}return ut.call(i,t)?i[t]:e},bn.prototype.has=function(t){var i=this.__data__;return nn?i[t]!==e:ut.call(i,t)},bn.prototype.set=function(t,i){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=nn&&i===e?r:i,this},xn.prototype.clear=function(){this.__data__=[],this.size=0},xn.prototype.delete=function(e){var t=this.__data__,i=Pn(t,e);return!(i<0||(i==t.length-1?t.pop():Pi.call(t,i,1),--this.size,0))},xn.prototype.get=function(t){var i=this.__data__,n=Pn(i,t);return n<0?e:i[n][1]},xn.prototype.has=function(e){return Pn(this.__data__,e)>-1},xn.prototype.set=function(e,t){var i=this.__data__,n=Pn(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this},_n.prototype.clear=function(){this.size=0,this.__data__={hash:new bn,map:new(Ki||xn),string:new bn}},_n.prototype.delete=function(e){var t=Bo(this,e).delete(e);return this.size-=t?1:0,t},_n.prototype.get=function(e){return Bo(this,e).get(e)},_n.prototype.has=function(e){return Bo(this,e).has(e)},_n.prototype.set=function(e,t){var i=Bo(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this},wn.prototype.add=wn.prototype.push=function(e){return this.__data__.set(e,r),this},wn.prototype.has=function(e){return this.__data__.has(e)},En.prototype.clear=function(){this.__data__=new xn,this.size=0},En.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},En.prototype.get=function(e){return this.__data__.get(e)},En.prototype.has=function(e){return this.__data__.has(e)},En.prototype.set=function(e,i){var n=this.__data__;if(n instanceof xn){var r=n.__data__;if(!Ki||r.length<t-1)return r.push([e,i]),this.size=++n.size,this;n=this.__data__=new _n(r)}return n.set(e,i),this.size=n.size,this};var Un=so(Xn),$n=so(Zn,!0);function jn(e,t){var i=!0;return Un(e,function(e,n,r){return i=!!t(e,n,r)}),i}function zn(t,i,n){for(var r=-1,o=t.length;++r<o;){var a=t[r],s=i(a);if(null!=s&&(l===e?s==s&&!Ds(s):n(s,l)))var l=s,c=a}return c}function Vn(e,t){var i=[];return Un(e,function(e,n,r){t(e,n,r)&&i.push(e)}),i}function Gn(e,t,i,n,r){var o=-1,a=e.length;for(i||(i=Wo),r||(r=[]);++o<a;){var s=e[o];t>0&&i(s)?t>1?Gn(s,t-1,i,n,r):Zt(r,s):n||(r[r.length]=s)}return r}var Wn=lo(),qn=lo(!0);function Xn(e,t){return e&&Wn(e,t,rl)}function Zn(e,t){return e&&qn(e,t,rl)}function Yn(e,t){return Gt(t,function(t){return Ts(e[t])})}function Jn(t,i){for(var n=0,r=(i=qr(i,t)).length;null!=t&&n<r;)t=t[ua(i[n++])];return n&&n==r?t:e}function Kn(e,t,i){var n=t(e);return vs(e)?n:Zt(n,i(e))}function Qn(t){return null==t?t===e?ee:q:Ii&&Ii in tt(t)?function(t){var i=ut.call(t,Ii),n=t[Ii];try{t[Ii]=e;var r=!0}catch(e){}var o=mt.call(t);return r&&(i?t[Ii]=n:delete t[Ii]),o}(t):function(e){return mt.call(e)}(t)}function er(e,t){return e>t}function tr(e,t){return null!=e&&ut.call(e,t)}function ir(e,t){return null!=e&&t in tt(e)}function nr(t,i,n){for(var r=n?qt:Wt,o=t[0].length,a=t.length,s=a,l=Ye(a),c=1/0,u=[];s--;){var h=t[s];s&&i&&(h=Xt(h,hi(i))),c=Wi(h.length,c),l[s]=!n&&(i||o>=120&&h.length>=120)?new wn(s&&h):e}h=t[0];var d=-1,p=l[0];e:for(;++d<o&&u.length<c;){var f=h[d],m=i?i(f):f;if(f=n||0!==f?f:0,!(p?pi(p,m):r(u,m,n))){for(s=a;--s;){var g=l[s];if(!(g?pi(g,m):r(t[s],m,n)))continue e}p&&p.push(m),u.push(f)}}return u}function rr(t,i,n){var r=null==(t=ia(t,i=qr(i,t)))?t:t[ua(Ea(i))];return null==r?e:Ut(r,t,n)}function or(e){return Rs(e)&&Qn(e)==N}function ar(t,i,n,r,o){return t===i||(null==t||null==i||!Rs(t)&&!Rs(i)?t!=t&&i!=i:function(t,i,n,r,o,a){var s=vs(t),l=vs(i),c=s?H:zo(t),d=l?H:zo(i),p=(c=c==N?X:c)==X,f=(d=d==N?X:d)==X,m=c==d;if(m&&_s(t)){if(!_s(i))return!1;s=!0,p=!1}if(m&&!p)return a||(a=new En),s||Ns(t)?Po(t,i,n,r,o,a):function(e,t,i,n,r,o,a){switch(i){case re:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ne:return!(e.byteLength!=t.byteLength||!o(new Pt(e),new Pt(t)));case F:case U:case W:return ps(+e,+t);case j:return e.name==t.name&&e.message==t.message;case Y:case K:return e==t+"";case G:var s=xi;case J:var l=n&u;if(s||(s=Ti),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=h,a.set(e,t);var d=Po(s(e),s(t),n,r,o,a);return a.delete(e),d;case Q:if(dn)return dn.call(e)==dn.call(t)}return!1}(t,i,c,n,r,o,a);if(!(n&u)){var g=p&&ut.call(t,"__wrapped__"),v=f&&ut.call(i,"__wrapped__");if(g||v){var y=g?t.value():t,b=v?i.value():i;return a||(a=new En),o(y,b,n,r,a)}}return!!m&&(a||(a=new En),function(t,i,n,r,o,a){var s=n&u,l=Oo(t),c=l.length,h=Oo(i).length;if(c!=h&&!s)return!1;for(var d=c;d--;){var p=l[d];if(!(s?p in i:ut.call(i,p)))return!1}var f=a.get(t);if(f&&a.get(i))return f==i;var m=!0;a.set(t,i),a.set(i,t);for(var g=s;++d<c;){p=l[d];var v=t[p],y=i[p];if(r)var b=s?r(y,v,p,i,t,a):r(v,y,p,t,i,a);if(!(b===e?v===y||o(v,y,n,r,a):b)){m=!1;break}g||(g="constructor"==p)}if(m&&!g){var x=t.constructor,_=i.constructor;x!=_&&"constructor"in t&&"constructor"in i&&!("function"==typeof x&&x instanceof x&&"function"==typeof _&&_ instanceof _)&&(m=!1)}return a.delete(t),a.delete(i),m}(t,i,n,r,o,a))}(t,i,n,r,ar,o))}function sr(t,i,n,r){var o=n.length,a=o,s=!r;if(null==t)return!a;for(t=tt(t);o--;){var l=n[o];if(s&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++o<a;){var c=(l=n[o])[0],d=t[c],p=l[1];if(s&&l[2]){if(d===e&&!(c in t))return!1}else{var f=new En;if(r)var m=r(d,p,c,t,i,f);if(!(m===e?ar(p,d,u|h,r,f):m))return!1}}return!0}function lr(e){return!(!Cs(e)||dt&&dt in e)&&(Ts(e)?St:$e).test(ha(e))}function cr(e){return"function"==typeof e?e:null==e?Pl:"object"==typeof e?vs(e)?mr(e[0],e[1]):fr(e):Fl(e)}function ur(e){if(!Ko(e))return Vi(e);var t=[];for(var i in tt(e))ut.call(e,i)&&"constructor"!=i&&t.push(i);return t}function hr(e){if(!Cs(e))return function(e){var t=[];if(null!=e)for(var i in tt(e))t.push(i);return t}(e);var t=Ko(e),i=[];for(var n in e)("constructor"!=n||!t&&ut.call(e,n))&&i.push(n);return i}function dr(e,t){return e<t}function pr(e,t){var i=-1,n=bs(e)?Ye(e.length):[];return Un(e,function(e,r,o){n[++i]=t(e,r,o)}),n}function fr(e){var t=Fo(e);return 1==t.length&&t[0][2]?ea(t[0][0],t[0][1]):function(i){return i===e||sr(i,e,t)}}function mr(t,i){return Zo(t)&&Qo(i)?ea(ua(t),i):function(n){var r=Qs(n,t);return r===e&&r===i?el(n,t):ar(i,r,u|h)}}function gr(t,i,n,r,o){t!==i&&Wn(i,function(a,s){if(Cs(a))o||(o=new En),function(t,i,n,r,o,a,s){var l=Ei(t,n),c=Ei(i,n),u=s.get(c);if(u)Rn(t,n,u);else{var h=a?a(l,c,n+"",t,i,s):e,d=h===e;if(d){var p=vs(c),f=!p&&_s(c),m=!p&&!f&&Ns(c);h=c,p||f||m?vs(l)?h=l:xs(l)?h=no(l):f?(d=!1,h=Jr(c,!0)):m?(d=!1,h=Qr(c,!0)):h=[]:Ls(c)||gs(c)?(h=l,gs(l)?h=Vs(l):(!Cs(l)||r&&Ts(l))&&(h=Go(c))):d=!1}d&&(s.set(c,h),o(h,c,r,a,s),s.delete(c)),Rn(t,n,h)}}(t,i,s,n,gr,r,o);else{var l=r?r(Ei(t,s),a,s+"",t,i,o):e;l===e&&(l=a),Rn(t,s,l)}},ol)}function vr(t,i){var n=t.length;if(n)return qo(i+=i<0?n:0,n)?t[i]:e}function yr(e,t,i){var n=-1;return t=Xt(t.length?t:[Pl],hi(Ho())),function(e,t){var i=e.length;for(e.sort(t);i--;)e[i]=e[i].value;return e}(pr(e,function(e,i,r){return{criteria:Xt(t,function(t){return t(e)}),index:++n,value:e}}),function(e,t){return function(e,t,i){for(var n=-1,r=e.criteria,o=t.criteria,a=r.length,s=i.length;++n<a;){var l=eo(r[n],o[n]);if(l){if(n>=s)return l;var c=i[n];return l*("desc"==c?-1:1)}}return e.index-t.index}(e,t,i)})}function br(e,t,i){for(var n=-1,r=t.length,o={};++n<r;){var a=t[n],s=Jn(e,a);i(s,a)&&Cr(o,qr(a,e),s)}return o}function xr(e,t,i,n){var r=n?ni:ii,o=-1,a=t.length,s=e;for(e===t&&(t=no(t)),i&&(s=Xt(e,hi(i)));++o<a;)for(var l=0,c=t[o],u=i?i(c):c;(l=r(s,u,l,n))>-1;)s!==e&&Pi.call(s,l,1),Pi.call(e,l,1);return e}function _r(e,t){for(var i=e?t.length:0,n=i-1;i--;){var r=t[i];if(i==n||r!==o){var o=r;qo(r)?Pi.call(e,r,1):Fr(e,r)}}return e}function wr(e,t){return e+Fi(Zi()*(t-e+1))}function Er(e,t){var i="";if(!e||t<1||t>A)return i;do{t%2&&(i+=e),(t=Fi(t/2))&&(e+=e)}while(t);return i}function Tr(e,t){return oa(ta(e,t,Pl),e+"")}function Mr(e){return Mn(pl(e))}function Sr(e,t){var i=pl(e);return la(i,Dn(t,0,i.length))}function Cr(t,i,n,r){if(!Cs(t))return t;for(var o=-1,a=(i=qr(i,t)).length,s=a-1,l=t;null!=l&&++o<a;){var c=ua(i[o]),u=n;if(o!=s){var h=l[c];(u=r?r(h,c,l):e)===e&&(u=Cs(h)?h:qo(i[o+1])?[]:{})}An(l,c,u),l=l[c]}return t}var Rr=rn?function(e,t){return rn.set(e,t),e}:Pl,Ar=ki?function(e,t){return ki(e,"toString",{configurable:!0,enumerable:!1,value:Cl(t),writable:!0})}:Pl;function Pr(e){return la(pl(e))}function Lr(e,t,i){var n=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(i=i>r?r:i)<0&&(i+=r),r=t>i?0:i-t>>>0,t>>>=0;for(var o=Ye(r);++n<r;)o[n]=e[n+t];return o}function Or(e,t){var i;return Un(e,function(e,n,r){return!(i=t(e,n,r))}),!!i}function Ir(e,t,i){var n=0,r=null==e?n:e.length;if("number"==typeof t&&t==t&&r<=k){for(;n<r;){var o=n+r>>>1,a=e[o];null!==a&&!Ds(a)&&(i?a<=t:a<t)?n=o+1:r=o}return r}return kr(e,t,Pl,i)}function kr(t,i,n,r){i=n(i);for(var o=0,a=null==t?0:t.length,s=i!=i,l=null===i,c=Ds(i),u=i===e;o<a;){var h=Fi((o+a)/2),d=n(t[h]),p=d!==e,f=null===d,m=d==d,g=Ds(d);if(s)var v=r||m;else v=u?m&&(r||p):l?m&&p&&(r||!f):c?m&&p&&!f&&(r||!g):!f&&!g&&(r?d<=i:d<i);v?o=h+1:a=h}return Wi(a,I)}function Dr(e,t){for(var i=-1,n=e.length,r=0,o=[];++i<n;){var a=e[i],s=t?t(a):a;if(!i||!ps(s,l)){var l=s;o[r++]=0===a?0:a}}return o}function Nr(e){return"number"==typeof e?e:Ds(e)?L:+e}function Hr(e){if("string"==typeof e)return e;if(vs(e))return Xt(e,Hr)+"";if(Ds(e))return pn?pn.call(e):"";var t=e+"";return"0"==t&&1/e==-R?"-0":t}function Br(e,i,n){var r=-1,o=Wt,a=e.length,s=!0,l=[],c=l;if(n)s=!1,o=qt;else if(a>=t){var u=i?null:To(e);if(u)return Ti(u);s=!1,o=pi,c=new wn}else c=i?[]:l;e:for(;++r<a;){var h=e[r],d=i?i(h):h;if(h=n||0!==h?h:0,s&&d==d){for(var p=c.length;p--;)if(c[p]===d)continue e;i&&c.push(d),l.push(h)}else o(c,d,n)||(c!==l&&c.push(d),l.push(h))}return l}function Fr(e,t){return null==(e=ia(e,t=qr(t,e)))||delete e[ua(Ea(t))]}function Ur(e,t,i,n){return Cr(e,t,i(Jn(e,t)),n)}function $r(e,t,i,n){for(var r=e.length,o=n?r:-1;(n?o--:++o<r)&&t(e[o],o,e););return i?Lr(e,n?0:o,n?o+1:r):Lr(e,n?o+1:0,n?r:o)}function jr(e,t){var i=e;return i instanceof yn&&(i=i.value()),Yt(t,function(e,t){return t.func.apply(t.thisArg,Zt([e],t.args))},i)}function zr(e,t,i){var n=e.length;if(n<2)return n?Br(e[0]):[];for(var r=-1,o=Ye(n);++r<n;)for(var a=e[r],s=-1;++s<n;)s!=r&&(o[r]=Fn(o[r]||a,e[s],t,i));return Br(Gn(o,1),t,i)}function Vr(t,i,n){for(var r=-1,o=t.length,a=i.length,s={};++r<o;){var l=r<a?i[r]:e;n(s,t[r],l)}return s}function Gr(e){return xs(e)?e:[]}function Wr(e){return"function"==typeof e?e:Pl}function qr(e,t){return vs(e)?e:Zo(e,t)?[e]:ca(Gs(e))}var Xr=Tr;function Zr(t,i,n){var r=t.length;return n=n===e?r:n,!i&&n>=r?t:Lr(t,i,n)}var Yr=Di||function(e){return Rt.clearTimeout(e)};function Jr(e,t){if(t)return e.slice();var i=e.length,n=Ot?Ot(i):new e.constructor(i);return e.copy(n),n}function Kr(e){var t=new e.constructor(e.byteLength);return new Pt(t).set(new Pt(e)),t}function Qr(e,t){var i=t?Kr(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function eo(t,i){if(t!==i){var n=t!==e,r=null===t,o=t==t,a=Ds(t),s=i!==e,l=null===i,c=i==i,u=Ds(i);if(!l&&!u&&!a&&t>i||a&&s&&c&&!l&&!u||r&&s&&c||!n&&c||!o)return 1;if(!r&&!a&&!u&&t<i||u&&n&&o&&!r&&!a||l&&n&&o||!s&&o||!c)return-1}return 0}function to(e,t,i,n){for(var r=-1,o=e.length,a=i.length,s=-1,l=t.length,c=Gi(o-a,0),u=Ye(l+c),h=!n;++s<l;)u[s]=t[s];for(;++r<a;)(h||r<o)&&(u[i[r]]=e[r]);for(;c--;)u[s++]=e[r++];return u}function io(e,t,i,n){for(var r=-1,o=e.length,a=-1,s=i.length,l=-1,c=t.length,u=Gi(o-s,0),h=Ye(u+c),d=!n;++r<u;)h[r]=e[r];for(var p=r;++l<c;)h[p+l]=t[l];for(;++a<s;)(d||r<o)&&(h[p+i[a]]=e[r++]);return h}function no(e,t){var i=-1,n=e.length;for(t||(t=Ye(n));++i<n;)t[i]=e[i];return t}function ro(t,i,n,r){var o=!n;n||(n={});for(var a=-1,s=i.length;++a<s;){var l=i[a],c=r?r(n[l],t[l],l,n,t):e;c===e&&(c=t[l]),o?In(n,l,c):An(n,l,c)}return n}function oo(e,t){return function(i,n){var r=vs(i)?$t:Ln,o=t?t():{};return r(i,e,Ho(n,2),o)}}function ao(t){return Tr(function(i,n){var r=-1,o=n.length,a=o>1?n[o-1]:e,s=o>2?n[2]:e;for(a=t.length>3&&"function"==typeof a?(o--,a):e,s&&Xo(n[0],n[1],s)&&(a=o<3?e:a,o=1),i=tt(i);++r<o;){var l=n[r];l&&t(i,l,r,a)}return i})}function so(e,t){return function(i,n){if(null==i)return i;if(!bs(i))return e(i,n);for(var r=i.length,o=t?r:-1,a=tt(i);(t?o--:++o<r)&&!1!==n(a[o],o,a););return i}}function lo(e){return function(t,i,n){for(var r=-1,o=tt(t),a=n(t),s=a.length;s--;){var l=a[e?s:++r];if(!1===i(o[l],l,o))break}return t}}function co(t){return function(i){var n=bi(i=Gs(i))?Ci(i):e,r=n?n[0]:i.charAt(0),o=n?Zr(n,1).join(""):i.slice(1);return r[t]()+o}}function uo(e){return function(t){return Yt(Tl(gl(t).replace(pt,"")),e,"")}}function ho(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var i=mn(e.prototype),n=e.apply(i,t);return Cs(n)?n:i}}function po(t){return function(i,n,r){var o=tt(i);if(!bs(i)){var a=Ho(n,3);i=rl(i),n=function(e){return a(o[e],e,o)}}var s=t(i,n,r);return s>-1?o[a?i[s]:s]:e}}function fo(t){return Lo(function(i){var r=i.length,o=r,a=vn.prototype.thru;for(t&&i.reverse();o--;){var s=i[o];if("function"!=typeof s)throw new rt(n);if(a&&!l&&"wrapper"==Do(s))var l=new vn([],!0)}for(o=l?o:r;++o<r;){var c=Do(s=i[o]),u="wrapper"==c?ko(s):e;l=u&&Yo(u[0])&&u[1]==(b|m|v|x)&&!u[4].length&&1==u[9]?l[Do(u[0])].apply(l,u[3]):1==s.length&&Yo(s)?l[c]():l.thru(s)}return function(){var e=arguments,t=e[0];if(l&&1==e.length&&vs(t))return l.plant(t).value();for(var n=0,o=r?i[n].apply(this,e):t;++n<r;)o=i[n].call(this,o);return o}})}function mo(t,i,n,r,o,a,s,l,c,u){var h=i&b,f=i&d,v=i&p,y=i&(m|g),x=i&_,w=v?e:ho(t);return function d(){for(var p=arguments.length,m=Ye(p),g=p;g--;)m[g]=arguments[g];if(y)var b=No(d),_=function(e,t){for(var i=e.length,n=0;i--;)e[i]===t&&++n;return n}(m,b);if(r&&(m=to(m,r,o,y)),a&&(m=io(m,a,s,y)),p-=_,y&&p<u){var E=wi(m,b);return wo(t,i,mo,d.placeholder,n,m,E,l,c,u-p)}var T=f?n:this,M=v?T[t]:t;return p=m.length,l?m=function(t,i){for(var n=t.length,r=Wi(i.length,n),o=no(t);r--;){var a=i[r];t[r]=qo(a,n)?o[a]:e}return t}(m,l):x&&p>1&&m.reverse(),h&&c<p&&(m.length=c),this&&this!==Rt&&this instanceof d&&(M=w||ho(M)),M.apply(T,m)}}function go(e,t){return function(i,n){return function(e,t,i,n){return Xn(e,function(e,r,o){t(n,i(e),r,o)}),n}(i,e,t(n),{})}}function vo(t,i){return function(n,r){var o;if(n===e&&r===e)return i;if(n!==e&&(o=n),r!==e){if(o===e)return r;"string"==typeof n||"string"==typeof r?(n=Hr(n),r=Hr(r)):(n=Nr(n),r=Nr(r)),o=t(n,r)}return o}}function yo(e){return Lo(function(t){return t=Xt(t,hi(Ho())),Tr(function(i){var n=this;return e(t,function(e){return Ut(e,n,i)})})})}function bo(t,i){var n=(i=i===e?" ":Hr(i)).length;if(n<2)return n?Er(i,t):i;var r=Er(i,Bi(t/Si(i)));return bi(i)?Zr(Ci(r),0,t).join(""):r.slice(0,t)}function xo(t){return function(i,n,r){return r&&"number"!=typeof r&&Xo(i,n,r)&&(n=r=e),i=Us(i),n===e?(n=i,i=0):n=Us(n),function(e,t,i,n){for(var r=-1,o=Gi(Bi((t-e)/(i||1)),0),a=Ye(o);o--;)a[n?o:++r]=e,e+=i;return a}(i,n,r=r===e?i<n?1:-1:Us(r),t)}}function _o(e){return function(t,i){return"string"==typeof t&&"string"==typeof i||(t=zs(t),i=zs(i)),e(t,i)}}function wo(t,i,n,r,o,a,s,l,c,u){var h=i&m;i|=h?v:y,(i&=~(h?y:v))&f||(i&=~(d|p));var g=[t,i,o,h?a:e,h?s:e,h?e:a,h?e:s,l,c,u],b=n.apply(e,g);return Yo(t)&&na(b,g),b.placeholder=r,aa(b,t,i)}function Eo(e){var t=et[e];return function(e,i){if(e=zs(e),i=null==i?0:Wi($s(i),292)){var n=(Gs(e)+"e").split("e");return+((n=(Gs(t(n[0]+"e"+(+n[1]+i)))+"e").split("e"))[0]+"e"+(+n[1]-i))}return t(e)}}var To=en&&1/Ti(new en([,-0]))[1]==R?function(e){return new en(e)}:Dl;function Mo(e){return function(t){var i=zo(t);return i==G?xi(t):i==J?Mi(t):function(e,t){return Xt(t,function(t){return[t,e[t]]})}(t,e(t))}}function So(t,i,r,o,s,l,c,u){var h=i&p;if(!h&&"function"!=typeof t)throw new rt(n);var _=o?o.length:0;if(_||(i&=~(v|y),o=s=e),c=c===e?c:Gi($s(c),0),u=u===e?u:$s(u),_-=s?s.length:0,i&y){var w=o,E=s;o=s=e}var T=h?e:ko(t),M=[t,i,r,o,s,w,E,l,c,u];if(T&&function(e,t){var i=e[1],n=t[1],r=i|n,o=r<(d|p|b),s=n==b&&i==m||n==b&&i==x&&e[7].length<=t[8]||n==(b|x)&&t[7].length<=t[8]&&i==m;if(!o&&!s)return e;n&d&&(e[2]=t[2],r|=i&d?0:f);var l=t[3];if(l){var c=e[3];e[3]=c?to(c,l,t[4]):l,e[4]=c?wi(e[3],a):t[4]}(l=t[5])&&(c=e[5],e[5]=c?io(c,l,t[6]):l,e[6]=c?wi(e[5],a):t[6]),(l=t[7])&&(e[7]=l),n&b&&(e[8]=null==e[8]?t[8]:Wi(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r}(M,T),t=M[0],i=M[1],r=M[2],o=M[3],s=M[4],!(u=M[9]=M[9]===e?h?0:t.length:Gi(M[9]-_,0))&&i&(m|g)&&(i&=~(m|g)),i&&i!=d)S=i==m||i==g?function(t,i,n){var r=ho(t);return function o(){for(var a=arguments.length,s=Ye(a),l=a,c=No(o);l--;)s[l]=arguments[l];var u=a<3&&s[0]!==c&&s[a-1]!==c?[]:wi(s,c);return(a-=u.length)<n?wo(t,i,mo,o.placeholder,e,s,u,e,e,n-a):Ut(this&&this!==Rt&&this instanceof o?r:t,this,s)}}(t,i,u):i!=v&&i!=(d|v)||s.length?mo.apply(e,M):function(e,t,i,n){var r=t&d,o=ho(e);return function t(){for(var a=-1,s=arguments.length,l=-1,c=n.length,u=Ye(c+s),h=this&&this!==Rt&&this instanceof t?o:e;++l<c;)u[l]=n[l];for(;s--;)u[l++]=arguments[++a];return Ut(h,r?i:this,u)}}(t,i,r,o);else var S=function(e,t,i){var n=t&d,r=ho(e);return function t(){return(this&&this!==Rt&&this instanceof t?r:e).apply(n?i:this,arguments)}}(t,i,r);return aa((T?Rr:na)(S,M),t,i)}function Co(t,i,n,r){return t===e||ps(t,st[n])&&!ut.call(r,n)?i:t}function Ro(t,i,n,r,o,a){return Cs(t)&&Cs(i)&&(a.set(i,t),gr(t,i,e,Ro,a),a.delete(i)),t}function Ao(t){return Ls(t)?e:t}function Po(t,i,n,r,o,a){var s=n&u,l=t.length,c=i.length;if(l!=c&&!(s&&c>l))return!1;var d=a.get(t);if(d&&a.get(i))return d==i;var p=-1,f=!0,m=n&h?new wn:e;for(a.set(t,i),a.set(i,t);++p<l;){var g=t[p],v=i[p];if(r)var y=s?r(v,g,p,i,t,a):r(g,v,p,t,i,a);if(y!==e){if(y)continue;f=!1;break}if(m){if(!Kt(i,function(e,t){if(!pi(m,t)&&(g===e||o(g,e,n,r,a)))return m.push(t)})){f=!1;break}}else if(g!==v&&!o(g,v,n,r,a)){f=!1;break}}return a.delete(t),a.delete(i),f}function Lo(t){return oa(ta(t,e,ya),t+"")}function Oo(e){return Kn(e,rl,$o)}function Io(e){return Kn(e,ol,jo)}var ko=rn?function(e){return rn.get(e)}:Dl;function Do(e){for(var t=e.name+"",i=on[t],n=ut.call(on,t)?i.length:0;n--;){var r=i[n],o=r.func;if(null==o||o==e)return r.name}return t}function No(e){return(ut.call(fn,"placeholder")?fn:e).placeholder}function Ho(){var e=fn.iteratee||Ll;return e=e===Ll?cr:e,arguments.length?e(arguments[0],arguments[1]):e}function Bo(e,t){var i,n,r=e.__data__;return("string"==(n=typeof(i=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?r["string"==typeof t?"string":"hash"]:r.map}function Fo(e){for(var t=rl(e),i=t.length;i--;){var n=t[i],r=e[n];t[i]=[n,r,Qo(r)]}return t}function Uo(t,i){var n=function(t,i){return null==t?e:t[i]}(t,i);return lr(n)?n:e}var $o=Ui?function(e){return null==e?[]:(e=tt(e),Gt(Ui(e),function(t){return si.call(e,t)}))}:jl,jo=Ui?function(e){for(var t=[];e;)Zt(t,$o(e)),e=It(e);return t}:jl,zo=Qn;function Vo(e,t,i){for(var n=-1,r=(t=qr(t,e)).length,o=!1;++n<r;){var a=ua(t[n]);if(!(o=null!=e&&i(e,a)))break;e=e[a]}return o||++n!=r?o:!!(r=null==e?0:e.length)&&Ss(r)&&qo(a,r)&&(vs(e)||gs(e))}function Go(e){return"function"!=typeof e.constructor||Ko(e)?{}:mn(It(e))}function Wo(e){return vs(e)||gs(e)||!!(Li&&e&&e[Li])}function qo(e,t){var i=typeof e;return!!(t=null==t?A:t)&&("number"==i||"symbol"!=i&&ze.test(e))&&e>-1&&e%1==0&&e<t}function Xo(e,t,i){if(!Cs(i))return!1;var n=typeof t;return!!("number"==n?bs(i)&&qo(t,i.length):"string"==n&&t in i)&&ps(i[t],e)}function Zo(e,t){if(vs(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!Ds(e))||Me.test(e)||!Te.test(e)||null!=t&&e in tt(t)}function Yo(e){var t=Do(e),i=fn[t];if("function"!=typeof i||!(t in yn.prototype))return!1;if(e===i)return!0;var n=ko(i);return!!n&&e===n[0]}(Ji&&zo(new Ji(new ArrayBuffer(1)))!=re||Ki&&zo(new Ki)!=G||Qi&&"[object Promise]"!=zo(Qi.resolve())||en&&zo(new en)!=J||tn&&zo(new tn)!=te)&&(zo=function(t){var i=Qn(t),n=i==X?t.constructor:e,r=n?ha(n):"";if(r)switch(r){case an:return re;case sn:return G;case ln:return"[object Promise]";case cn:return J;case un:return te}return i});var Jo=lt?Ts:zl;function Ko(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||st)}function Qo(e){return e==e&&!Cs(e)}function ea(t,i){return function(n){return null!=n&&n[t]===i&&(i!==e||t in tt(n))}}function ta(t,i,n){return i=Gi(i===e?t.length-1:i,0),function(){for(var e=arguments,r=-1,o=Gi(e.length-i,0),a=Ye(o);++r<o;)a[r]=e[i+r];r=-1;for(var s=Ye(i+1);++r<i;)s[r]=e[r];return s[i]=n(a),Ut(t,this,s)}}function ia(e,t){return t.length<2?e:Jn(e,Lr(t,0,-1))}var na=sa(Rr),ra=Hi||function(e,t){return Rt.setTimeout(e,t)},oa=sa(Ar);function aa(e,t,i){var n=t+"";return oa(e,function(e,t){var i=t.length;if(!i)return e;var n=i-1;return t[n]=(i>1?"& ":"")+t[n],t=t.join(i>2?", ":" "),e.replace(Oe,"{\n/* [wrapped with "+t+"] */\n")}(n,function(e,t){return jt(D,function(i){var n="_."+i[0];t&i[1]&&!Wt(e,n)&&e.push(n)}),e.sort()}(function(e){var t=e.match(Ie);return t?t[1].split(ke):[]}(n),i)))}function sa(t){var i=0,n=0;return function(){var r=qi(),o=M-(r-n);if(n=r,o>0){if(++i>=T)return arguments[0]}else i=0;return t.apply(e,arguments)}}function la(t,i){var n=-1,r=t.length,o=r-1;for(i=i===e?r:i;++n<i;){var a=wr(n,o),s=t[a];t[a]=t[n],t[n]=s}return t.length=i,t}var ca=function(e){var t=ss(e,function(e){return i.size===o&&i.clear(),e}),i=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Se,function(e,i,n,r){t.push(n?r.replace(Ne,"$1"):i||e)}),t});function ua(e){if("string"==typeof e||Ds(e))return e;var t=e+"";return"0"==t&&1/e==-R?"-0":t}function ha(e){if(null!=e){try{return ct.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function da(e){if(e instanceof yn)return e.clone();var t=new vn(e.__wrapped__,e.__chain__);return t.__actions__=no(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var pa=Tr(function(e,t){return xs(e)?Fn(e,Gn(t,1,xs,!0)):[]}),fa=Tr(function(t,i){var n=Ea(i);return xs(n)&&(n=e),xs(t)?Fn(t,Gn(i,1,xs,!0),Ho(n,2)):[]}),ma=Tr(function(t,i){var n=Ea(i);return xs(n)&&(n=e),xs(t)?Fn(t,Gn(i,1,xs,!0),e,n):[]});function ga(e,t,i){var n=null==e?0:e.length;if(!n)return-1;var r=null==i?0:$s(i);return r<0&&(r=Gi(n+r,0)),ti(e,Ho(t,3),r)}function va(t,i,n){var r=null==t?0:t.length;if(!r)return-1;var o=r-1;return n!==e&&(o=$s(n),o=n<0?Gi(r+o,0):Wi(o,r-1)),ti(t,Ho(i,3),o,!0)}function ya(e){return null!=e&&e.length?Gn(e,1):[]}function ba(t){return t&&t.length?t[0]:e}var xa=Tr(function(e){var t=Xt(e,Gr);return t.length&&t[0]===e[0]?nr(t):[]}),_a=Tr(function(t){var i=Ea(t),n=Xt(t,Gr);return i===Ea(n)?i=e:n.pop(),n.length&&n[0]===t[0]?nr(n,Ho(i,2)):[]}),wa=Tr(function(t){var i=Ea(t),n=Xt(t,Gr);return(i="function"==typeof i?i:e)&&n.pop(),n.length&&n[0]===t[0]?nr(n,e,i):[]});function Ea(t){var i=null==t?0:t.length;return i?t[i-1]:e}var Ta=Tr(Ma);function Ma(e,t){return e&&e.length&&t&&t.length?xr(e,t):e}var Sa=Lo(function(e,t){var i=null==e?0:e.length,n=kn(e,t);return _r(e,Xt(t,function(e){return qo(e,i)?+e:e}).sort(eo)),n});function Ca(e){return null==e?e:Yi.call(e)}var Ra=Tr(function(e){return Br(Gn(e,1,xs,!0))}),Aa=Tr(function(t){var i=Ea(t);return xs(i)&&(i=e),Br(Gn(t,1,xs,!0),Ho(i,2))}),Pa=Tr(function(t){var i=Ea(t);return i="function"==typeof i?i:e,Br(Gn(t,1,xs,!0),e,i)});function La(e){if(!e||!e.length)return[];var t=0;return e=Gt(e,function(e){if(xs(e))return t=Gi(e.length,t),!0}),ui(t,function(t){return Xt(e,ai(t))})}function Oa(t,i){if(!t||!t.length)return[];var n=La(t);return null==i?n:Xt(n,function(t){return Ut(i,e,t)})}var Ia=Tr(function(e,t){return xs(e)?Fn(e,t):[]}),ka=Tr(function(e){return zr(Gt(e,xs))}),Da=Tr(function(t){var i=Ea(t);return xs(i)&&(i=e),zr(Gt(t,xs),Ho(i,2))}),Na=Tr(function(t){var i=Ea(t);return i="function"==typeof i?i:e,zr(Gt(t,xs),e,i)}),Ha=Tr(La);var Ba=Tr(function(t){var i=t.length,n=i>1?t[i-1]:e;return Oa(t,n="function"==typeof n?(t.pop(),n):e)});function Fa(e){var t=fn(e);return t.__chain__=!0,t}function Ua(e,t){return t(e)}var $a=Lo(function(t){var i=t.length,n=i?t[0]:0,r=this.__wrapped__,o=function(e){return kn(e,t)};return!(i>1||this.__actions__.length)&&r instanceof yn&&qo(n)?((r=r.slice(n,+n+(i?1:0))).__actions__.push({func:Ua,args:[o],thisArg:e}),new vn(r,this.__chain__).thru(function(t){return i&&!t.length&&t.push(e),t})):this.thru(o)});var ja=oo(function(e,t,i){ut.call(e,i)?++e[i]:In(e,i,1)});var za=po(ga),Va=po(va);function Ga(e,t){return(vs(e)?jt:Un)(e,Ho(t,3))}function Wa(e,t){return(vs(e)?zt:$n)(e,Ho(t,3))}var qa=oo(function(e,t,i){ut.call(e,i)?e[i].push(t):In(e,i,[t])});var Xa=Tr(function(e,t,i){var n=-1,r="function"==typeof t,o=bs(e)?Ye(e.length):[];return Un(e,function(e){o[++n]=r?Ut(t,e,i):rr(e,t,i)}),o}),Za=oo(function(e,t,i){In(e,i,t)});function Ya(e,t){return(vs(e)?Xt:pr)(e,Ho(t,3))}var Ja=oo(function(e,t,i){e[i?0:1].push(t)},function(){return[[],[]]});var Ka=Tr(function(e,t){if(null==e)return[];var i=t.length;return i>1&&Xo(e,t[0],t[1])?t=[]:i>2&&Xo(t[0],t[1],t[2])&&(t=[t[0]]),yr(e,Gn(t,1),[])}),Qa=Ni||function(){return Rt.Date.now()};function es(t,i,n){return i=n?e:i,i=t&&null==i?t.length:i,So(t,b,e,e,e,e,i)}function ts(t,i){var r;if("function"!=typeof i)throw new rt(n);return t=$s(t),function(){return--t>0&&(r=i.apply(this,arguments)),t<=1&&(i=e),r}}var is=Tr(function(e,t,i){var n=d;if(i.length){var r=wi(i,No(is));n|=v}return So(e,n,t,i,r)}),ns=Tr(function(e,t,i){var n=d|p;if(i.length){var r=wi(i,No(ns));n|=v}return So(t,n,e,i,r)});function rs(t,i,r){var o,a,s,l,c,u,h=0,d=!1,p=!1,f=!0;if("function"!=typeof t)throw new rt(n);function m(i){var n=o,r=a;return o=a=e,h=i,l=t.apply(r,n)}function g(t){var n=t-u;return u===e||n>=i||n<0||p&&t-h>=s}function v(){var e=Qa();if(g(e))return y(e);c=ra(v,function(e){var t=i-(e-u);return p?Wi(t,s-(e-h)):t}(e))}function y(t){return c=e,f&&o?m(t):(o=a=e,l)}function b(){var t=Qa(),n=g(t);if(o=arguments,a=this,u=t,n){if(c===e)return function(e){return h=e,c=ra(v,i),d?m(e):l}(u);if(p)return c=ra(v,i),m(u)}return c===e&&(c=ra(v,i)),l}return i=zs(i)||0,Cs(r)&&(d=!!r.leading,s=(p="maxWait"in r)?Gi(zs(r.maxWait)||0,i):s,f="trailing"in r?!!r.trailing:f),b.cancel=function(){c!==e&&Yr(c),h=0,o=u=a=c=e},b.flush=function(){return c===e?l:y(Qa())},b}var os=Tr(function(e,t){return Bn(e,1,t)}),as=Tr(function(e,t,i){return Bn(e,zs(t)||0,i)});function ss(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new rt(n);var i=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=i.cache;if(o.has(r))return o.get(r);var a=e.apply(this,n);return i.cache=o.set(r,a)||o,a};return i.cache=new(ss.Cache||_n),i}function ls(e){if("function"!=typeof e)throw new rt(n);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}ss.Cache=_n;var cs=Xr(function(e,t){var i=(t=1==t.length&&vs(t[0])?Xt(t[0],hi(Ho())):Xt(Gn(t,1),hi(Ho()))).length;return Tr(function(n){for(var r=-1,o=Wi(n.length,i);++r<o;)n[r]=t[r].call(this,n[r]);return Ut(e,this,n)})}),us=Tr(function(t,i){var n=wi(i,No(us));return So(t,v,e,i,n)}),hs=Tr(function(t,i){var n=wi(i,No(hs));return So(t,y,e,i,n)}),ds=Lo(function(t,i){return So(t,x,e,e,e,i)});function ps(e,t){return e===t||e!=e&&t!=t}var fs=_o(er),ms=_o(function(e,t){return e>=t}),gs=or(function(){return arguments}())?or:function(e){return Rs(e)&&ut.call(e,"callee")&&!si.call(e,"callee")},vs=Ye.isArray,ys=kt?hi(kt):function(e){return Rs(e)&&Qn(e)==ne};function bs(e){return null!=e&&Ss(e.length)&&!Ts(e)}function xs(e){return Rs(e)&&bs(e)}var _s=$i||zl,ws=Dt?hi(Dt):function(e){return Rs(e)&&Qn(e)==U};function Es(e){if(!Rs(e))return!1;var t=Qn(e);return t==j||t==$||"string"==typeof e.message&&"string"==typeof e.name&&!Ls(e)}function Ts(e){if(!Cs(e))return!1;var t=Qn(e);return t==z||t==V||t==B||t==Z}function Ms(e){return"number"==typeof e&&e==$s(e)}function Ss(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=A}function Cs(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Rs(e){return null!=e&&"object"==typeof e}var As=Nt?hi(Nt):function(e){return Rs(e)&&zo(e)==G};function Ps(e){return"number"==typeof e||Rs(e)&&Qn(e)==W}function Ls(e){if(!Rs(e)||Qn(e)!=X)return!1;var t=It(e);if(null===t)return!0;var i=ut.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&ct.call(i)==vt}var Os=Ht?hi(Ht):function(e){return Rs(e)&&Qn(e)==Y};var Is=Bt?hi(Bt):function(e){return Rs(e)&&zo(e)==J};function ks(e){return"string"==typeof e||!vs(e)&&Rs(e)&&Qn(e)==K}function Ds(e){return"symbol"==typeof e||Rs(e)&&Qn(e)==Q}var Ns=Ft?hi(Ft):function(e){return Rs(e)&&Ss(e.length)&&!!_t[Qn(e)]};var Hs=_o(dr),Bs=_o(function(e,t){return e<=t});function Fs(e){if(!e)return[];if(bs(e))return ks(e)?Ci(e):no(e);if(Oi&&e[Oi])return function(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i}(e[Oi]());var t=zo(e);return(t==G?xi:t==J?Ti:pl)(e)}function Us(e){return e?(e=zs(e))===R||e===-R?(e<0?-1:1)*P:e==e?e:0:0===e?e:0}function $s(e){var t=Us(e),i=t%1;return t==t?i?t-i:t:0}function js(e){return e?Dn($s(e),0,O):0}function zs(e){if("number"==typeof e)return e;if(Ds(e))return L;if(Cs(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Cs(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Ae,"");var i=Ue.test(e);return i||je.test(e)?Mt(e.slice(2),i?2:8):Fe.test(e)?L:+e}function Vs(e){return ro(e,ol(e))}function Gs(e){return null==e?"":Hr(e)}var Ws=ao(function(e,t){if(Ko(t)||bs(t))ro(t,rl(t),e);else for(var i in t)ut.call(t,i)&&An(e,i,t[i])}),qs=ao(function(e,t){ro(t,ol(t),e)}),Xs=ao(function(e,t,i,n){ro(t,ol(t),e,n)}),Zs=ao(function(e,t,i,n){ro(t,rl(t),e,n)}),Ys=Lo(kn);var Js=Tr(function(t,i){t=tt(t);var n=-1,r=i.length,o=r>2?i[2]:e;for(o&&Xo(i[0],i[1],o)&&(r=1);++n<r;)for(var a=i[n],s=ol(a),l=-1,c=s.length;++l<c;){var u=s[l],h=t[u];(h===e||ps(h,st[u])&&!ut.call(t,u))&&(t[u]=a[u])}return t}),Ks=Tr(function(t){return t.push(e,Ro),Ut(sl,e,t)});function Qs(t,i,n){var r=null==t?e:Jn(t,i);return r===e?n:r}function el(e,t){return null!=e&&Vo(e,t,ir)}var tl=go(function(e,t,i){null!=t&&"function"!=typeof t.toString&&(t=mt.call(t)),e[t]=i},Cl(Pl)),il=go(function(e,t,i){null!=t&&"function"!=typeof t.toString&&(t=mt.call(t)),ut.call(e,t)?e[t].push(i):e[t]=[i]},Ho),nl=Tr(rr);function rl(e){return bs(e)?Tn(e):ur(e)}function ol(e){return bs(e)?Tn(e,!0):hr(e)}var al=ao(function(e,t,i){gr(e,t,i)}),sl=ao(function(e,t,i,n){gr(e,t,i,n)}),ll=Lo(function(e,t){var i={};if(null==e)return i;var n=!1;t=Xt(t,function(t){return t=qr(t,e),n||(n=t.length>1),t}),ro(e,Io(e),i),n&&(i=Nn(i,s|l|c,Ao));for(var r=t.length;r--;)Fr(i,t[r]);return i});var cl=Lo(function(e,t){return null==e?{}:function(e,t){return br(e,t,function(t,i){return el(e,i)})}(e,t)});function ul(e,t){if(null==e)return{};var i=Xt(Io(e),function(e){return[e]});return t=Ho(t),br(e,i,function(e,i){return t(e,i[0])})}var hl=Mo(rl),dl=Mo(ol);function pl(e){return null==e?[]:di(e,rl(e))}var fl=uo(function(e,t,i){return t=t.toLowerCase(),e+(i?ml(t):t)});function ml(e){return El(Gs(e).toLowerCase())}function gl(e){return(e=Gs(e))&&e.replace(Ve,gi).replace(ft,"")}var vl=uo(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()}),yl=uo(function(e,t,i){return e+(i?" ":"")+t.toLowerCase()}),bl=co("toLowerCase");var xl=uo(function(e,t,i){return e+(i?"_":"")+t.toLowerCase()});var _l=uo(function(e,t,i){return e+(i?" ":"")+El(t)});var wl=uo(function(e,t,i){return e+(i?" ":"")+t.toUpperCase()}),El=co("toUpperCase");function Tl(t,i,n){return t=Gs(t),(i=n?e:i)===e?function(e){return yt.test(e)}(t)?function(e){return e.match(gt)||[]}(t):function(e){return e.match(De)||[]}(t):t.match(i)||[]}var Ml=Tr(function(t,i){try{return Ut(t,e,i)}catch(e){return Es(e)?e:new Ke(e)}}),Sl=Lo(function(e,t){return jt(t,function(t){t=ua(t),In(e,t,is(e[t],e))}),e});function Cl(e){return function(){return e}}var Rl=fo(),Al=fo(!0);function Pl(e){return e}function Ll(e){return cr("function"==typeof e?e:Nn(e,s))}var Ol=Tr(function(e,t){return function(i){return rr(i,e,t)}}),Il=Tr(function(e,t){return function(i){return rr(e,i,t)}});function kl(e,t,i){var n=rl(t),r=Yn(t,n);null!=i||Cs(t)&&(r.length||!n.length)||(i=t,t=e,e=this,r=Yn(t,rl(t)));var o=!(Cs(i)&&"chain"in i&&!i.chain),a=Ts(e);return jt(r,function(i){var n=t[i];e[i]=n,a&&(e.prototype[i]=function(){var t=this.__chain__;if(o||t){var i=e(this.__wrapped__);return(i.__actions__=no(this.__actions__)).push({func:n,args:arguments,thisArg:e}),i.__chain__=t,i}return n.apply(e,Zt([this.value()],arguments))})}),e}function Dl(){}var Nl=yo(Xt),Hl=yo(Vt),Bl=yo(Kt);function Fl(e){return Zo(e)?ai(ua(e)):function(e){return function(t){return Jn(t,e)}}(e)}var Ul=xo(),$l=xo(!0);function jl(){return[]}function zl(){return!1}var Vl=vo(function(e,t){return e+t},0),Gl=Eo("ceil"),Wl=vo(function(e,t){return e/t},1),ql=Eo("floor");var Xl,Zl=vo(function(e,t){return e*t},1),Yl=Eo("round"),Jl=vo(function(e,t){return e-t},0);return fn.after=function(e,t){if("function"!=typeof t)throw new rt(n);return e=$s(e),function(){if(--e<1)return t.apply(this,arguments)}},fn.ary=es,fn.assign=Ws,fn.assignIn=qs,fn.assignInWith=Xs,fn.assignWith=Zs,fn.at=Ys,fn.before=ts,fn.bind=is,fn.bindAll=Sl,fn.bindKey=ns,fn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return vs(e)?e:[e]},fn.chain=Fa,fn.chunk=function(t,i,n){i=(n?Xo(t,i,n):i===e)?1:Gi($s(i),0);var r=null==t?0:t.length;if(!r||i<1)return[];for(var o=0,a=0,s=Ye(Bi(r/i));o<r;)s[a++]=Lr(t,o,o+=i);return s},fn.compact=function(e){for(var t=-1,i=null==e?0:e.length,n=0,r=[];++t<i;){var o=e[t];o&&(r[n++]=o)}return r},fn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=Ye(e-1),i=arguments[0],n=e;n--;)t[n-1]=arguments[n];return Zt(vs(i)?no(i):[i],Gn(t,1))},fn.cond=function(e){var t=null==e?0:e.length,i=Ho();return e=t?Xt(e,function(e){if("function"!=typeof e[1])throw new rt(n);return[i(e[0]),e[1]]}):[],Tr(function(i){for(var n=-1;++n<t;){var r=e[n];if(Ut(r[0],this,i))return Ut(r[1],this,i)}})},fn.conforms=function(e){return function(e){var t=rl(e);return function(i){return Hn(i,e,t)}}(Nn(e,s))},fn.constant=Cl,fn.countBy=ja,fn.create=function(e,t){var i=mn(e);return null==t?i:On(i,t)},fn.curry=function t(i,n,r){var o=So(i,m,e,e,e,e,e,n=r?e:n);return o.placeholder=t.placeholder,o},fn.curryRight=function t(i,n,r){var o=So(i,g,e,e,e,e,e,n=r?e:n);return o.placeholder=t.placeholder,o},fn.debounce=rs,fn.defaults=Js,fn.defaultsDeep=Ks,fn.defer=os,fn.delay=as,fn.difference=pa,fn.differenceBy=fa,fn.differenceWith=ma,fn.drop=function(t,i,n){var r=null==t?0:t.length;return r?Lr(t,(i=n||i===e?1:$s(i))<0?0:i,r):[]},fn.dropRight=function(t,i,n){var r=null==t?0:t.length;return r?Lr(t,0,(i=r-(i=n||i===e?1:$s(i)))<0?0:i):[]},fn.dropRightWhile=function(e,t){return e&&e.length?$r(e,Ho(t,3),!0,!0):[]},fn.dropWhile=function(e,t){return e&&e.length?$r(e,Ho(t,3),!0):[]},fn.fill=function(t,i,n,r){var o=null==t?0:t.length;return o?(n&&"number"!=typeof n&&Xo(t,i,n)&&(n=0,r=o),function(t,i,n,r){var o=t.length;for((n=$s(n))<0&&(n=-n>o?0:o+n),(r=r===e||r>o?o:$s(r))<0&&(r+=o),r=n>r?0:js(r);n<r;)t[n++]=i;return t}(t,i,n,r)):[]},fn.filter=function(e,t){return(vs(e)?Gt:Vn)(e,Ho(t,3))},fn.flatMap=function(e,t){return Gn(Ya(e,t),1)},fn.flatMapDeep=function(e,t){return Gn(Ya(e,t),R)},fn.flatMapDepth=function(t,i,n){return n=n===e?1:$s(n),Gn(Ya(t,i),n)},fn.flatten=ya,fn.flattenDeep=function(e){return null!=e&&e.length?Gn(e,R):[]},fn.flattenDepth=function(t,i){return null!=t&&t.length?Gn(t,i=i===e?1:$s(i)):[]},fn.flip=function(e){return So(e,_)},fn.flow=Rl,fn.flowRight=Al,fn.fromPairs=function(e){for(var t=-1,i=null==e?0:e.length,n={};++t<i;){var r=e[t];n[r[0]]=r[1]}return n},fn.functions=function(e){return null==e?[]:Yn(e,rl(e))},fn.functionsIn=function(e){return null==e?[]:Yn(e,ol(e))},fn.groupBy=qa,fn.initial=function(e){return null!=e&&e.length?Lr(e,0,-1):[]},fn.intersection=xa,fn.intersectionBy=_a,fn.intersectionWith=wa,fn.invert=tl,fn.invertBy=il,fn.invokeMap=Xa,fn.iteratee=Ll,fn.keyBy=Za,fn.keys=rl,fn.keysIn=ol,fn.map=Ya,fn.mapKeys=function(e,t){var i={};return t=Ho(t,3),Xn(e,function(e,n,r){In(i,t(e,n,r),e)}),i},fn.mapValues=function(e,t){var i={};return t=Ho(t,3),Xn(e,function(e,n,r){In(i,n,t(e,n,r))}),i},fn.matches=function(e){return fr(Nn(e,s))},fn.matchesProperty=function(e,t){return mr(e,Nn(t,s))},fn.memoize=ss,fn.merge=al,fn.mergeWith=sl,fn.method=Ol,fn.methodOf=Il,fn.mixin=kl,fn.negate=ls,fn.nthArg=function(e){return e=$s(e),Tr(function(t){return vr(t,e)})},fn.omit=ll,fn.omitBy=function(e,t){return ul(e,ls(Ho(t)))},fn.once=function(e){return ts(2,e)},fn.orderBy=function(t,i,n,r){return null==t?[]:(vs(i)||(i=null==i?[]:[i]),vs(n=r?e:n)||(n=null==n?[]:[n]),yr(t,i,n))},fn.over=Nl,fn.overArgs=cs,fn.overEvery=Hl,fn.overSome=Bl,fn.partial=us,fn.partialRight=hs,fn.partition=Ja,fn.pick=cl,fn.pickBy=ul,fn.property=Fl,fn.propertyOf=function(t){return function(i){return null==t?e:Jn(t,i)}},fn.pull=Ta,fn.pullAll=Ma,fn.pullAllBy=function(e,t,i){return e&&e.length&&t&&t.length?xr(e,t,Ho(i,2)):e},fn.pullAllWith=function(t,i,n){return t&&t.length&&i&&i.length?xr(t,i,e,n):t},fn.pullAt=Sa,fn.range=Ul,fn.rangeRight=$l,fn.rearg=ds,fn.reject=function(e,t){return(vs(e)?Gt:Vn)(e,ls(Ho(t,3)))},fn.remove=function(e,t){var i=[];if(!e||!e.length)return i;var n=-1,r=[],o=e.length;for(t=Ho(t,3);++n<o;){var a=e[n];t(a,n,e)&&(i.push(a),r.push(n))}return _r(e,r),i},fn.rest=function(t,i){if("function"!=typeof t)throw new rt(n);return Tr(t,i=i===e?i:$s(i))},fn.reverse=Ca,fn.sampleSize=function(t,i,n){return i=(n?Xo(t,i,n):i===e)?1:$s(i),(vs(t)?Sn:Sr)(t,i)},fn.set=function(e,t,i){return null==e?e:Cr(e,t,i)},fn.setWith=function(t,i,n,r){return r="function"==typeof r?r:e,null==t?t:Cr(t,i,n,r)},fn.shuffle=function(e){return(vs(e)?Cn:Pr)(e)},fn.slice=function(t,i,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&Xo(t,i,n)?(i=0,n=r):(i=null==i?0:$s(i),n=n===e?r:$s(n)),Lr(t,i,n)):[]},fn.sortBy=Ka,fn.sortedUniq=function(e){return e&&e.length?Dr(e):[]},fn.sortedUniqBy=function(e,t){return e&&e.length?Dr(e,Ho(t,2)):[]},fn.split=function(t,i,n){return n&&"number"!=typeof n&&Xo(t,i,n)&&(i=n=e),(n=n===e?O:n>>>0)?(t=Gs(t))&&("string"==typeof i||null!=i&&!Os(i))&&!(i=Hr(i))&&bi(t)?Zr(Ci(t),0,n):t.split(i,n):[]},fn.spread=function(e,t){if("function"!=typeof e)throw new rt(n);return t=null==t?0:Gi($s(t),0),Tr(function(i){var n=i[t],r=Zr(i,0,t);return n&&Zt(r,n),Ut(e,this,r)})},fn.tail=function(e){var t=null==e?0:e.length;return t?Lr(e,1,t):[]},fn.take=function(t,i,n){return t&&t.length?Lr(t,0,(i=n||i===e?1:$s(i))<0?0:i):[]},fn.takeRight=function(t,i,n){var r=null==t?0:t.length;return r?Lr(t,(i=r-(i=n||i===e?1:$s(i)))<0?0:i,r):[]},fn.takeRightWhile=function(e,t){return e&&e.length?$r(e,Ho(t,3),!1,!0):[]},fn.takeWhile=function(e,t){return e&&e.length?$r(e,Ho(t,3)):[]},fn.tap=function(e,t){return t(e),e},fn.throttle=function(e,t,i){var r=!0,o=!0;if("function"!=typeof e)throw new rt(n);return Cs(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),rs(e,t,{leading:r,maxWait:t,trailing:o})},fn.thru=Ua,fn.toArray=Fs,fn.toPairs=hl,fn.toPairsIn=dl,fn.toPath=function(e){return vs(e)?Xt(e,ua):Ds(e)?[e]:no(ca(Gs(e)))},fn.toPlainObject=Vs,fn.transform=function(e,t,i){var n=vs(e),r=n||_s(e)||Ns(e);if(t=Ho(t,4),null==i){var o=e&&e.constructor;i=r?n?new o:[]:Cs(e)&&Ts(o)?mn(It(e)):{}}return(r?jt:Xn)(e,function(e,n,r){return t(i,e,n,r)}),i},fn.unary=function(e){return es(e,1)},fn.union=Ra,fn.unionBy=Aa,fn.unionWith=Pa,fn.uniq=function(e){return e&&e.length?Br(e):[]},fn.uniqBy=function(e,t){return e&&e.length?Br(e,Ho(t,2)):[]},fn.uniqWith=function(t,i){return i="function"==typeof i?i:e,t&&t.length?Br(t,e,i):[]},fn.unset=function(e,t){return null==e||Fr(e,t)},fn.unzip=La,fn.unzipWith=Oa,fn.update=function(e,t,i){return null==e?e:Ur(e,t,Wr(i))},fn.updateWith=function(t,i,n,r){return r="function"==typeof r?r:e,null==t?t:Ur(t,i,Wr(n),r)},fn.values=pl,fn.valuesIn=function(e){return null==e?[]:di(e,ol(e))},fn.without=Ia,fn.words=Tl,fn.wrap=function(e,t){return us(Wr(t),e)},fn.xor=ka,fn.xorBy=Da,fn.xorWith=Na,fn.zip=Ha,fn.zipObject=function(e,t){return Vr(e||[],t||[],An)},fn.zipObjectDeep=function(e,t){return Vr(e||[],t||[],Cr)},fn.zipWith=Ba,fn.entries=hl,fn.entriesIn=dl,fn.extend=qs,fn.extendWith=Xs,kl(fn,fn),fn.add=Vl,fn.attempt=Ml,fn.camelCase=fl,fn.capitalize=ml,fn.ceil=Gl,fn.clamp=function(t,i,n){return n===e&&(n=i,i=e),n!==e&&(n=(n=zs(n))==n?n:0),i!==e&&(i=(i=zs(i))==i?i:0),Dn(zs(t),i,n)},fn.clone=function(e){return Nn(e,c)},fn.cloneDeep=function(e){return Nn(e,s|c)},fn.cloneDeepWith=function(t,i){return Nn(t,s|c,i="function"==typeof i?i:e)},fn.cloneWith=function(t,i){return Nn(t,c,i="function"==typeof i?i:e)},fn.conformsTo=function(e,t){return null==t||Hn(e,t,rl(t))},fn.deburr=gl,fn.defaultTo=function(e,t){return null==e||e!=e?t:e},fn.divide=Wl,fn.endsWith=function(t,i,n){t=Gs(t),i=Hr(i);var r=t.length,o=n=n===e?r:Dn($s(n),0,r);return(n-=i.length)>=0&&t.slice(n,o)==i},fn.eq=ps,fn.escape=function(e){return(e=Gs(e))&&xe.test(e)?e.replace(ye,vi):e},fn.escapeRegExp=function(e){return(e=Gs(e))&&Re.test(e)?e.replace(Ce,"\\$&"):e},fn.every=function(t,i,n){var r=vs(t)?Vt:jn;return n&&Xo(t,i,n)&&(i=e),r(t,Ho(i,3))},fn.find=za,fn.findIndex=ga,fn.findKey=function(e,t){return ei(e,Ho(t,3),Xn)},fn.findLast=Va,fn.findLastIndex=va,fn.findLastKey=function(e,t){return ei(e,Ho(t,3),Zn)},fn.floor=ql,fn.forEach=Ga,fn.forEachRight=Wa,fn.forIn=function(e,t){return null==e?e:Wn(e,Ho(t,3),ol)},fn.forInRight=function(e,t){return null==e?e:qn(e,Ho(t,3),ol)},fn.forOwn=function(e,t){return e&&Xn(e,Ho(t,3))},fn.forOwnRight=function(e,t){return e&&Zn(e,Ho(t,3))},fn.get=Qs,fn.gt=fs,fn.gte=ms,fn.has=function(e,t){return null!=e&&Vo(e,t,tr)},fn.hasIn=el,fn.head=ba,fn.identity=Pl,fn.includes=function(e,t,i,n){e=bs(e)?e:pl(e),i=i&&!n?$s(i):0;var r=e.length;return i<0&&(i=Gi(r+i,0)),ks(e)?i<=r&&e.indexOf(t,i)>-1:!!r&&ii(e,t,i)>-1},fn.indexOf=function(e,t,i){var n=null==e?0:e.length;if(!n)return-1;var r=null==i?0:$s(i);return r<0&&(r=Gi(n+r,0)),ii(e,t,r)},fn.inRange=function(t,i,n){return i=Us(i),n===e?(n=i,i=0):n=Us(n),function(e,t,i){return e>=Wi(t,i)&&e<Gi(t,i)}(t=zs(t),i,n)},fn.invoke=nl,fn.isArguments=gs,fn.isArray=vs,fn.isArrayBuffer=ys,fn.isArrayLike=bs,fn.isArrayLikeObject=xs,fn.isBoolean=function(e){return!0===e||!1===e||Rs(e)&&Qn(e)==F},fn.isBuffer=_s,fn.isDate=ws,fn.isElement=function(e){return Rs(e)&&1===e.nodeType&&!Ls(e)},fn.isEmpty=function(e){if(null==e)return!0;if(bs(e)&&(vs(e)||"string"==typeof e||"function"==typeof e.splice||_s(e)||Ns(e)||gs(e)))return!e.length;var t=zo(e);if(t==G||t==J)return!e.size;if(Ko(e))return!ur(e).length;for(var i in e)if(ut.call(e,i))return!1;return!0},fn.isEqual=function(e,t){return ar(e,t)},fn.isEqualWith=function(t,i,n){var r=(n="function"==typeof n?n:e)?n(t,i):e;return r===e?ar(t,i,e,n):!!r},fn.isError=Es,fn.isFinite=function(e){return"number"==typeof e&&ji(e)},fn.isFunction=Ts,fn.isInteger=Ms,fn.isLength=Ss,fn.isMap=As,fn.isMatch=function(e,t){return e===t||sr(e,t,Fo(t))},fn.isMatchWith=function(t,i,n){return n="function"==typeof n?n:e,sr(t,i,Fo(i),n)},fn.isNaN=function(e){return Ps(e)&&e!=+e},fn.isNative=function(e){if(Jo(e))throw new Ke(i);return lr(e)},fn.isNil=function(e){return null==e},fn.isNull=function(e){return null===e},fn.isNumber=Ps,fn.isObject=Cs,fn.isObjectLike=Rs,fn.isPlainObject=Ls,fn.isRegExp=Os,fn.isSafeInteger=function(e){return Ms(e)&&e>=-A&&e<=A},fn.isSet=Is,fn.isString=ks,fn.isSymbol=Ds,fn.isTypedArray=Ns,fn.isUndefined=function(t){return t===e},fn.isWeakMap=function(e){return Rs(e)&&zo(e)==te},fn.isWeakSet=function(e){return Rs(e)&&Qn(e)==ie},fn.join=function(e,t){return null==e?"":zi.call(e,t)},fn.kebabCase=vl,fn.last=Ea,fn.lastIndexOf=function(t,i,n){var r=null==t?0:t.length;if(!r)return-1;var o=r;return n!==e&&(o=(o=$s(n))<0?Gi(r+o,0):Wi(o,r-1)),i==i?function(e,t,i){for(var n=i+1;n--;)if(e[n]===t)return n;return n}(t,i,o):ti(t,ri,o,!0)},fn.lowerCase=yl,fn.lowerFirst=bl,fn.lt=Hs,fn.lte=Bs,fn.max=function(t){return t&&t.length?zn(t,Pl,er):e},fn.maxBy=function(t,i){return t&&t.length?zn(t,Ho(i,2),er):e},fn.mean=function(e){return oi(e,Pl)},fn.meanBy=function(e,t){return oi(e,Ho(t,2))},fn.min=function(t){return t&&t.length?zn(t,Pl,dr):e},fn.minBy=function(t,i){return t&&t.length?zn(t,Ho(i,2),dr):e},fn.stubArray=jl,fn.stubFalse=zl,fn.stubObject=function(){return{}},fn.stubString=function(){return""},fn.stubTrue=function(){return!0},fn.multiply=Zl,fn.nth=function(t,i){return t&&t.length?vr(t,$s(i)):e},fn.noConflict=function(){return Rt._===this&&(Rt._=Et),this},fn.noop=Dl,fn.now=Qa,fn.pad=function(e,t,i){e=Gs(e);var n=(t=$s(t))?Si(e):0;if(!t||n>=t)return e;var r=(t-n)/2;return bo(Fi(r),i)+e+bo(Bi(r),i)},fn.padEnd=function(e,t,i){e=Gs(e);var n=(t=$s(t))?Si(e):0;return t&&n<t?e+bo(t-n,i):e},fn.padStart=function(e,t,i){e=Gs(e);var n=(t=$s(t))?Si(e):0;return t&&n<t?bo(t-n,i)+e:e},fn.parseInt=function(e,t,i){return i||null==t?t=0:t&&(t=+t),Xi(Gs(e).replace(Pe,""),t||0)},fn.random=function(t,i,n){if(n&&"boolean"!=typeof n&&Xo(t,i,n)&&(i=n=e),n===e&&("boolean"==typeof i?(n=i,i=e):"boolean"==typeof t&&(n=t,t=e)),t===e&&i===e?(t=0,i=1):(t=Us(t),i===e?(i=t,t=0):i=Us(i)),t>i){var r=t;t=i,i=r}if(n||t%1||i%1){var o=Zi();return Wi(t+o*(i-t+Tt("1e-"+((o+"").length-1))),i)}return wr(t,i)},fn.reduce=function(e,t,i){var n=vs(e)?Yt:li,r=arguments.length<3;return n(e,Ho(t,4),i,r,Un)},fn.reduceRight=function(e,t,i){var n=vs(e)?Jt:li,r=arguments.length<3;return n(e,Ho(t,4),i,r,$n)},fn.repeat=function(t,i,n){return i=(n?Xo(t,i,n):i===e)?1:$s(i),Er(Gs(t),i)},fn.replace=function(){var e=arguments,t=Gs(e[0]);return e.length<3?t:t.replace(e[1],e[2])},fn.result=function(t,i,n){var r=-1,o=(i=qr(i,t)).length;for(o||(o=1,t=e);++r<o;){var a=null==t?e:t[ua(i[r])];a===e&&(r=o,a=n),t=Ts(a)?a.call(t):a}return t},fn.round=Yl,fn.runInContext=qe,fn.sample=function(e){return(vs(e)?Mn:Mr)(e)},fn.size=function(e){if(null==e)return 0;if(bs(e))return ks(e)?Si(e):e.length;var t=zo(e);return t==G||t==J?e.size:ur(e).length},fn.snakeCase=xl,fn.some=function(t,i,n){var r=vs(t)?Kt:Or;return n&&Xo(t,i,n)&&(i=e),r(t,Ho(i,3))},fn.sortedIndex=function(e,t){return Ir(e,t)},fn.sortedIndexBy=function(e,t,i){return kr(e,t,Ho(i,2))},fn.sortedIndexOf=function(e,t){var i=null==e?0:e.length;if(i){var n=Ir(e,t);if(n<i&&ps(e[n],t))return n}return-1},fn.sortedLastIndex=function(e,t){return Ir(e,t,!0)},fn.sortedLastIndexBy=function(e,t,i){return kr(e,t,Ho(i,2),!0)},fn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var i=Ir(e,t,!0)-1;if(ps(e[i],t))return i}return-1},fn.startCase=_l,fn.startsWith=function(e,t,i){return e=Gs(e),i=null==i?0:Dn($s(i),0,e.length),t=Hr(t),e.slice(i,i+t.length)==t},fn.subtract=Jl,fn.sum=function(e){return e&&e.length?ci(e,Pl):0},fn.sumBy=function(e,t){return e&&e.length?ci(e,Ho(t,2)):0},fn.template=function(t,i,n){var r=fn.templateSettings;n&&Xo(t,i,n)&&(i=e),t=Gs(t),i=Xs({},i,r,Co);var o,a,s=Xs({},i.imports,r.imports,Co),l=rl(s),c=di(s,l),u=0,h=i.interpolate||Ge,d="__p += '",p=it((i.escape||Ge).source+"|"+h.source+"|"+(h===Ee?He:Ge).source+"|"+(i.evaluate||Ge).source+"|$","g"),f="//# sourceURL="+("sourceURL"in i?i.sourceURL:"lodash.templateSources["+ ++xt+"]")+"\n";t.replace(p,function(e,i,n,r,s,l){return n||(n=r),d+=t.slice(u,l).replace(We,yi),i&&(o=!0,d+="' +\n__e("+i+") +\n'"),s&&(a=!0,d+="';\n"+s+";\n__p += '"),n&&(d+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=l+e.length,e}),d+="';\n";var m=i.variable;m||(d="with (obj) {\n"+d+"\n}\n"),d=(a?d.replace(fe,""):d).replace(me,"$1").replace(ge,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Ml(function(){return Qe(l,f+"return "+d).apply(e,c)});if(g.source=d,Es(g))throw g;return g},fn.times=function(e,t){if((e=$s(e))<1||e>A)return[];var i=O,n=Wi(e,O);t=Ho(t),e-=O;for(var r=ui(n,t);++i<e;)t(i);return r},fn.toFinite=Us,fn.toInteger=$s,fn.toLength=js,fn.toLower=function(e){return Gs(e).toLowerCase()},fn.toNumber=zs,fn.toSafeInteger=function(e){return e?Dn($s(e),-A,A):0===e?e:0},fn.toString=Gs,fn.toUpper=function(e){return Gs(e).toUpperCase()},fn.trim=function(t,i,n){if((t=Gs(t))&&(n||i===e))return t.replace(Ae,"");if(!t||!(i=Hr(i)))return t;var r=Ci(t),o=Ci(i);return Zr(r,fi(r,o),mi(r,o)+1).join("")},fn.trimEnd=function(t,i,n){if((t=Gs(t))&&(n||i===e))return t.replace(Le,"");if(!t||!(i=Hr(i)))return t;var r=Ci(t);return Zr(r,0,mi(r,Ci(i))+1).join("")},fn.trimStart=function(t,i,n){if((t=Gs(t))&&(n||i===e))return t.replace(Pe,"");if(!t||!(i=Hr(i)))return t;var r=Ci(t);return Zr(r,fi(r,Ci(i))).join("")},fn.truncate=function(t,i){var n=w,r=E;if(Cs(i)){var o="separator"in i?i.separator:o;n="length"in i?$s(i.length):n,r="omission"in i?Hr(i.omission):r}var a=(t=Gs(t)).length;if(bi(t)){var s=Ci(t);a=s.length}if(n>=a)return t;var l=n-Si(r);if(l<1)return r;var c=s?Zr(s,0,l).join(""):t.slice(0,l);if(o===e)return c+r;if(s&&(l+=c.length-l),Os(o)){if(t.slice(l).search(o)){var u,h=c;for(o.global||(o=it(o.source,Gs(Be.exec(o))+"g")),o.lastIndex=0;u=o.exec(h);)var d=u.index;c=c.slice(0,d===e?l:d)}}else if(t.indexOf(Hr(o),l)!=l){var p=c.lastIndexOf(o);p>-1&&(c=c.slice(0,p))}return c+r},fn.unescape=function(e){return(e=Gs(e))&&be.test(e)?e.replace(ve,Ri):e},fn.uniqueId=function(e){var t=++ht;return Gs(e)+t},fn.upperCase=wl,fn.upperFirst=El,fn.each=Ga,fn.eachRight=Wa,fn.first=ba,kl(fn,(Xl={},Xn(fn,function(e,t){ut.call(fn.prototype,t)||(Xl[t]=e)}),Xl),{chain:!1}),fn.VERSION="4.17.10",jt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){fn[e].placeholder=fn}),jt(["drop","take"],function(t,i){yn.prototype[t]=function(n){n=n===e?1:Gi($s(n),0);var r=this.__filtered__&&!i?new yn(this):this.clone();return r.__filtered__?r.__takeCount__=Wi(n,r.__takeCount__):r.__views__.push({size:Wi(n,O),type:t+(r.__dir__<0?"Right":"")}),r},yn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),jt(["filter","map","takeWhile"],function(e,t){var i=t+1,n=i==S||3==i;yn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Ho(e,3),type:i}),t.__filtered__=t.__filtered__||n,t}}),jt(["head","last"],function(e,t){var i="take"+(t?"Right":"");yn.prototype[e]=function(){return this[i](1).value()[0]}}),jt(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");yn.prototype[e]=function(){return this.__filtered__?new yn(this):this[i](1)}}),yn.prototype.compact=function(){return this.filter(Pl)},yn.prototype.find=function(e){return this.filter(e).head()},yn.prototype.findLast=function(e){return this.reverse().find(e)},yn.prototype.invokeMap=Tr(function(e,t){return"function"==typeof e?new yn(this):this.map(function(i){return rr(i,e,t)})}),yn.prototype.reject=function(e){return this.filter(ls(Ho(e)))},yn.prototype.slice=function(t,i){t=$s(t);var n=this;return n.__filtered__&&(t>0||i<0)?new yn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),i!==e&&(n=(i=$s(i))<0?n.dropRight(-i):n.take(i-t)),n)},yn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},yn.prototype.toArray=function(){return this.take(O)},Xn(yn.prototype,function(t,i){var n=/^(?:filter|find|map|reject)|While$/.test(i),r=/^(?:head|last)$/.test(i),o=fn[r?"take"+("last"==i?"Right":""):i],a=r||/^find/.test(i);o&&(fn.prototype[i]=function(){var i=this.__wrapped__,s=r?[1]:arguments,l=i instanceof yn,c=s[0],u=l||vs(i),h=function(e){var t=o.apply(fn,Zt([e],s));return r&&d?t[0]:t};u&&n&&"function"==typeof c&&1!=c.length&&(l=u=!1);var d=this.__chain__,p=!!this.__actions__.length,f=a&&!d,m=l&&!p;if(!a&&u){i=m?i:new yn(this);var g=t.apply(i,s);return g.__actions__.push({func:Ua,args:[h],thisArg:e}),new vn(g,d)}return f&&m?t.apply(this,s):(g=this.thru(h),f?r?g.value()[0]:g.value():g)})}),jt(["pop","push","shift","sort","splice","unshift"],function(e){var t=ot[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);fn.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var r=this.value();return t.apply(vs(r)?r:[],e)}return this[i](function(i){return t.apply(vs(i)?i:[],e)})}}),Xn(yn.prototype,function(e,t){var i=fn[t];if(i){var n=i.name+"";(on[n]||(on[n]=[])).push({name:t,func:i})}}),on[mo(e,p).name]=[{name:"wrapper",func:e}],yn.prototype.clone=function(){var e=new yn(this.__wrapped__);return e.__actions__=no(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=no(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=no(this.__views__),e},yn.prototype.reverse=function(){if(this.__filtered__){var e=new yn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},yn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,i=vs(e),n=t<0,r=i?e.length:0,o=function(e,t,i){for(var n=-1,r=i.length;++n<r;){var o=i[n],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=Wi(t,e+a);break;case"takeRight":e=Gi(e,t-a)}}return{start:e,end:t}}(0,r,this.__views__),a=o.start,s=o.end,l=s-a,c=n?s:a-1,u=this.__iteratees__,h=u.length,d=0,p=Wi(l,this.__takeCount__);if(!i||!n&&r==l&&p==l)return jr(e,this.__actions__);var f=[];e:for(;l--&&d<p;){for(var m=-1,g=e[c+=t];++m<h;){var v=u[m],y=v.iteratee,b=v.type,x=y(g);if(b==C)g=x;else if(!x){if(b==S)continue e;break e}}f[d++]=g}return f},fn.prototype.at=$a,fn.prototype.chain=function(){return Fa(this)},fn.prototype.commit=function(){return new vn(this.value(),this.__chain__)},fn.prototype.next=function(){this.__values__===e&&(this.__values__=Fs(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?e:this.__values__[this.__index__++]}},fn.prototype.plant=function(t){for(var i,n=this;n instanceof gn;){var r=da(n);r.__index__=0,r.__values__=e,i?o.__wrapped__=r:i=r;var o=r;n=n.__wrapped__}return o.__wrapped__=t,i},fn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof yn){var i=t;return this.__actions__.length&&(i=new yn(this)),(i=i.reverse()).__actions__.push({func:Ua,args:[Ca],thisArg:e}),new vn(i,this.__chain__)}return this.thru(Ca)},fn.prototype.toJSON=fn.prototype.valueOf=fn.prototype.value=function(){return jr(this.__wrapped__,this.__actions__)},fn.prototype.first=fn.prototype.head,Oi&&(fn.prototype[Oi]=function(){return this}),fn}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Rt._=Ai,define(function(){return Ai})):Pt?((Pt.exports=Ai)._=Ai,At._=Ai):Rt._=Ai}.call(this);var ROSLIB=ROSLIB||{REVISION:"6"};function xml2json(e,t){var i={toObj:function(e){var t={};if(1==e.nodeType){if(e.attributes.length)for(var n=0;n<e.attributes.length;n++)t["@"+e.attributes[n].nodeName]=(e.attributes[n].nodeValue||"").toString();if(e.firstChild){for(var r=0,o=0,a=!1,s=e.firstChild;s;s=s.nextSibling)1==s.nodeType?a=!0:3==s.nodeType&&s.nodeValue.match(/[^ \f\n\r\t\v]/)?r++:4==s.nodeType&&o++;if(a)if(r<2&&o<2){i.removeWhite(e);for(s=e.firstChild;s;s=s.nextSibling)3==s.nodeType?t["#text"]=i.escape(s.nodeValue):4==s.nodeType?t["#cdata"]=i.escape(s.nodeValue):t[s.nodeName]?t[s.nodeName]instanceof Array?t[s.nodeName][t[s.nodeName].length]=i.toObj(s):t[s.nodeName]=[t[s.nodeName],i.toObj(s)]:t[s.nodeName]=i.toObj(s)}else e.attributes.length?t["#text"]=i.escape(i.innerXml(e)):t=i.escape(i.innerXml(e));else if(r)e.attributes.length?t["#text"]=i.escape(i.innerXml(e)):t=i.escape(i.innerXml(e));else if(o)if(o>1)t=i.escape(i.innerXml(e));else for(s=e.firstChild;s;s=s.nextSibling)t["#cdata"]=i.escape(s.nodeValue)}e.attributes.length||e.firstChild||(t=null)}else 9==e.nodeType?t=i.toObj(e.documentElement):8==e.nodeType||alert("unhandled node type: "+e.nodeType);return t},toJson:function(e,t,n){var r=t?'"'+t+'"':"";if(e instanceof Array){for(var o=0,a=e.length;o<a;o++)e[o]=i.toJson(e[o],"",n+"\t");r+=(t?":[":"[")+(e.length>1?"\n"+n+"\t"+e.join(",\n"+n+"\t")+"\n"+n:e.join(""))+"]"}else if(null==e)r+=(t&&":")+"null";else if("object"==typeof e){var s=[];for(var l in e)s[s.length]=i.toJson(e[l],l,n+"\t");r+=(t?":{":"{")+(s.length>1?"\n"+n+"\t"+s.join(",\n"+n+"\t")+"\n"+n:s.join(""))+"}"}else r+="string"==typeof e?(t&&":")+'"'+e.toString()+'"':(t&&":")+e.toString();return r},innerXml:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else for(var i=function(e){var t="";if(1==e.nodeType){t+="<"+e.nodeName;for(var n=0;n<e.attributes.length;n++)t+=" "+e.attributes[n].nodeName+'="'+(e.attributes[n].nodeValue||"").toString()+'"';if(e.firstChild){t+=">";for(var r=e.firstChild;r;r=r.nextSibling)t+=i(r);t+="</"+e.nodeName+">"}else t+="/>"}else 3==e.nodeType?t+=e.nodeValue:4==e.nodeType&&(t+="<![CDATA["+e.nodeValue+"]]>");return t},n=e.firstChild;n;n=n.nextSibling)t+=i(n);return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var t=e.firstChild;t;)if(3==t.nodeType)if(t.nodeValue.match(/[^ \f\n\r\t\v]/))t=t.nextSibling;else{var n=t.nextSibling;e.removeChild(t),t=n}else 1==t.nodeType?(i.removeWhite(t),t=t.nextSibling):t=t.nextSibling;return e}};9==e.nodeType&&(e=e.documentElement);var n=i.toJson(i.toObj(i.removeWhite(e)),e.nodeName,"\t");return"{\n"+t+(t?n.replace(/\t/g,t):n.replace(/\t|\n/g,""))+"\n}"}ROSLIB.URDF_SPHERE=0,ROSLIB.URDF_BOX=1,ROSLIB.URDF_CYLINDER=2,ROSLIB.URDF_MESH=3,ROSLIB.ActionClient=function(e){var t=this;e=e||{},this.ros=e.ros,this.serverName=e.serverName,this.actionName=e.actionName,this.timeout=e.timeout,this.goals={};var i=!1,n=new ROSLIB.Topic({ros:this.ros,name:this.serverName+"/feedback",messageType:this.actionName+"Feedback"}),r=new ROSLIB.Topic({ros:this.ros,name:this.serverName+"/status",messageType:"actionlib_msgs/GoalStatusArray"}),o=new ROSLIB.Topic({ros:this.ros,name:this.serverName+"/result",messageType:this.actionName+"Result"});this.goalTopic=new ROSLIB.Topic({ros:this.ros,name:this.serverName+"/goal",messageType:this.actionName+"Goal"}),this.cancelTopic=new ROSLIB.Topic({ros:this.ros,name:this.serverName+"/cancel",messageType:"actionlib_msgs/GoalID"}),this.goalTopic.advertise(),this.cancelTopic.advertise(),r.subscribe(function(e){i=!0,e.status_list.forEach(function(e){var i=t.goals[e.goal_id.id];i&&i.emit("status",e)})}),n.subscribe(function(e){var i=t.goals[e.status.goal_id.id];i&&(i.emit("status",e.status),i.emit("feedback",e.feedback))}),o.subscribe(function(e){var i=t.goals[e.status.goal_id.id];i&&(i.emit("status",e.status),i.emit("result",e.result))}),this.timeout&&setTimeout(function(){i||t.emit("timeout")},this.timeout)},ROSLIB.ActionClient.prototype.__proto__=EventEmitter2.prototype,ROSLIB.ActionClient.prototype.cancel=function(){var e=new ROSLIB.Message;this.cancelTopic.publish(e)},ROSLIB.Goal=function(e){var t=this;this.actionClient=e.actionClient,this.goalMessage=e.goalMessage,this.isFinished=!1;var i=new Date;this.goalID="goal_"+Math.random()+"_"+i.getTime(),this.goalMessage=new ROSLIB.Message({goal_id:{stamp:{secs:0,nsecs:0},id:this.goalID},goal:this.goalMessage}),this.on("status",function(e){t.status=e}),this.on("result",function(e){t.isFinished=!0,t.result=e}),this.on("feedback",function(e){t.feedback=e}),this.actionClient.goals[this.goalID]=this},ROSLIB.Goal.prototype.__proto__=EventEmitter2.prototype,ROSLIB.Goal.prototype.send=function(e){var t=this;t.actionClient.goalTopic.publish(t.goalMessage),e&&setTimeout(function(){t.isFinished||t.emit("timeout")},e)},ROSLIB.Goal.prototype.cancel=function(){var e=new ROSLIB.Message({id:this.goalID});this.actionClient.cancelTopic.publish(e)},ROSLIB.Message=function(e){var t=this;e=e||{},Object.keys(e).forEach(function(i){t[i]=e[i]})},ROSLIB.Param=function(e){e=e||{},this.ros=e.ros,this.name=e.name},ROSLIB.Param.prototype.get=function(e){var t=new ROSLIB.Service({ros:this.ros,name:"/rosapi/get_param",serviceType:"rosapi/GetParam"}),i=new ROSLIB.ServiceRequest({name:this.name,value:JSON.stringify("")});t.callService(i,function(t){var i=JSON.parse(t.value);e(i)})},ROSLIB.Param.prototype.set=function(e){var t=new ROSLIB.Service({ros:this.ros,name:"/rosapi/set_param",serviceType:"rosapi/SetParam"}),i=new ROSLIB.ServiceRequest({name:this.name,value:JSON.stringify(e)});t.callService(i,function(){})},ROSLIB.Ros=function(e){var t=(e=e||{}).url;this.socket=null,this.idCounter=0,this.setMaxListeners(0),t&&this.connect(t)},ROSLIB.Ros.prototype.__proto__=EventEmitter2.prototype,ROSLIB.Ros.prototype.connect=function(e){var t=this;this.socket=new WebSocket(e),this.socket.onopen=function(e){t.emit("connection",e)},this.socket.onclose=function(e){t.emit("close",e)},this.socket.onerror=function(e){t.emit("error",e)},this.socket.onmessage=function(e){function i(e){"publish"===e.op?t.emit(e.topic,e.msg):"service_response"===e.op&&t.emit(e.id,e.values)}var n=JSON.parse(e.data);"png"===n.op?function(e,t){var i=new Image;i.onload=function(){var e=document.createElement("canvas"),n=e.getContext("2d");e.width=i.width,e.height=i.height,n.drawImage(i,0,0);for(var r=n.getImageData(0,0,i.width,i.height).data,o="",a=0;a<r.length;a+=4)o+=String.fromCharCode(r[a],r[a+1],r[a+2]);var s=JSON.parse(o);t(s)},i.src="data:image/png;base64,"+e.data}(n,function(e){i(e)}):i(n)}},ROSLIB.Ros.prototype.close=function(){this.socket&&this.socket.close()},ROSLIB.Ros.prototype.authenticate=function(e,t,i,n,r,o,a){var s={op:"auth",mac:e,client:t,dest:i,rand:n,t:r,level:o,end:a};this.callOnConnection(s)},ROSLIB.Ros.prototype.callOnConnection=function(e){var t=this,i=JSON.stringify(e);this.socket&&this.socket.readyState===WebSocket.OPEN?t.socket.send(i):t.once("connection",function(){t.socket.send(i)})},ROSLIB.Ros.prototype.getTopics=function(e){var t=new ROSLIB.Service({ros:this,name:"/rosapi/topics",serviceType:"rosapi/Topics"}),i=new ROSLIB.ServiceRequest;t.callService(i,function(t){e(t.topics)})},ROSLIB.Ros.prototype.getServices=function(e){var t=new ROSLIB.Service({ros:this,name:"/rosapi/services",serviceType:"rosapi/Services"}),i=new ROSLIB.ServiceRequest;t.callService(i,function(t){e(t.services)})},ROSLIB.Ros.prototype.getParams=function(e){var t=new ROSLIB.Service({ros:this,name:"/rosapi/get_param_names",serviceType:"rosapi/GetParamNames"}),i=new ROSLIB.ServiceRequest;t.callService(i,function(t){e(t.names)})},ROSLIB.Service=function(e){e=e||{},this.ros=e.ros,this.name=e.name,this.serviceType=e.serviceType},ROSLIB.Service.prototype.callService=function(e,t){this.ros.idCounter++;var i="call_service:"+this.name+":"+this.ros.idCounter;this.ros.once(i,function(e){var i=new ROSLIB.ServiceResponse(e);t(i)});var n=[];Object.keys(e).forEach(function(t){n.push(e[t])});var r={op:"call_service",id:i,service:this.name,args:n};this.ros.callOnConnection(r)},ROSLIB.ServiceRequest=function(e){var t=this;e=e||{},Object.keys(e).forEach(function(i){t[i]=e[i]})},ROSLIB.ServiceResponse=function(e){var t=this;e=e||{},Object.keys(e).forEach(function(i){t[i]=e[i]})},ROSLIB.Topic=function(e){e=e||{},this.ros=e.ros,this.name=e.name,this.messageType=e.messageType,this.isAdvertised=!1,this.compression=e.compression||"none",this.throttle_rate=e.throttle_rate||0,this.compression&&"png"!==this.compression&&"none"!==this.compression&&this.emit("warning",this.compression+" compression is not supported. No compression will be used."),this.throttle_rate<0&&(this.emit("warning",this.throttle_rate+" is not allowed. Set to 0"),this.throttle_rate=0)},ROSLIB.Topic.prototype.__proto__=EventEmitter2.prototype,ROSLIB.Topic.prototype.subscribe=function(e){var t=this;this.on("message",function(t){e(t)}),this.ros.on(this.name,function(e){var i=new ROSLIB.Message(e);t.emit("message",i)}),this.ros.idCounter++;var i={op:"subscribe",id:"subscribe:"+this.name+":"+this.ros.idCounter,type:this.messageType,topic:this.name,compression:this.compression,throttle_rate:this.throttle_rate};this.ros.callOnConnection(i)},ROSLIB.Topic.prototype.unsubscribe=function(){this.ros.removeAllListeners([this.name]),this.ros.idCounter++;var e={op:"unsubscribe",id:"unsubscribe:"+this.name+":"+this.ros.idCounter,topic:this.name};this.ros.callOnConnection(e)},ROSLIB.Topic.prototype.advertise=function(){this.ros.idCounter++;var e={op:"advertise",id:"advertise:"+this.name+":"+this.ros.idCounter,type:this.messageType,topic:this.name};this.ros.callOnConnection(e),this.isAdvertised=!0},ROSLIB.Topic.prototype.unadvertise=function(){this.ros.idCounter++;var e={op:"unadvertise",id:"unadvertise:"+this.name+":"+this.ros.idCounter,topic:this.name};this.ros.callOnConnection(e),this.isAdvertised=!1},ROSLIB.Topic.prototype.publish=function(e){this.isAdvertised||this.advertise(),this.ros.idCounter++;var t={op:"publish",id:"publish:"+this.name+":"+this.ros.idCounter,topic:this.name,msg:e};this.ros.callOnConnection(t)},ROSLIB.Pose=function(e){e=e||{},this.position=new ROSLIB.Vector3(e.position),this.orientation=new ROSLIB.Quaternion(e.orientation)},ROSLIB.Pose.prototype.applyTransform=function(e){this.position.multiplyQuaternion(e.rotation),this.position.add(e.translation);var t=e.rotation.clone();t.multiply(this.orientation),this.orientation=t},ROSLIB.Pose.prototype.clone=function(){return new ROSLIB.Pose(this)},ROSLIB.Quaternion=function(e){e=e||{},this.x=e.x||0,this.y=e.y||0,this.z=e.z||0,this.w=e.w||1},ROSLIB.Quaternion.prototype.conjugate=function(){this.x*=-1,this.y*=-1,this.z*=-1},ROSLIB.Quaternion.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e)},ROSLIB.Quaternion.prototype.invert=function(){this.conjugate(),this.normalize()},ROSLIB.Quaternion.prototype.multiply=function(e){var t=this.x*e.w+this.y*e.z-this.z*e.y+this.w*e.x,i=-this.x*e.z+this.y*e.w+this.z*e.x+this.w*e.y,n=this.x*e.y-this.y*e.x+this.z*e.w+this.w*e.z,r=-this.x*e.x-this.y*e.y-this.z*e.z+this.w*e.w;this.x=t,this.y=i,this.z=n,this.w=r},ROSLIB.Quaternion.prototype.clone=function(){return new ROSLIB.Quaternion(this)},ROSLIB.Transform=function(e){e=e||{},this.translation=new ROSLIB.Vector3(e.translation),this.rotation=new ROSLIB.Quaternion(e.rotation)},ROSLIB.Transform.prototype.clone=function(){return new ROSLIB.Transform(this)},ROSLIB.Vector3=function(e){e=e||{},this.x=e.x||0,this.y=e.y||0,this.z=e.z||0},ROSLIB.Vector3.prototype.add=function(e){this.x+=e.x,this.y+=e.y,this.z+=e.z},ROSLIB.Vector3.prototype.subtract=function(e){this.x-=e.x,this.y-=e.y,this.z-=e.z},ROSLIB.Vector3.prototype.multiplyQuaternion=function(e){var t=e.w*this.x+e.y*this.z-e.z*this.y,i=e.w*this.y+e.z*this.x-e.x*this.z,n=e.w*this.z+e.x*this.y-e.y*this.x,r=-e.x*this.x-e.y*this.y-e.z*this.z;this.x=t*e.w+r*-e.x+i*-e.z-n*-e.y,this.y=i*e.w+r*-e.y+n*-e.x-t*-e.z,this.z=n*e.w+r*-e.z+t*-e.y-i*-e.x},ROSLIB.Vector3.prototype.clone=function(){return new ROSLIB.Vector3(this)},ROSLIB.TFClient=function(e){e=e||{},this.ros=e.ros,this.fixedFrame=e.fixedFrame||"/base_link",this.angularThres=e.angularThres||2,this.transThres=e.transThres||.01,this.rate=e.rate||10,this.goalUpdateDelay=e.goalUpdateDelay||50,this.currentGoal=!1,this.frameInfos={},this.goalUpdateRequested=!1,this.actionClient=new ROSLIB.ActionClient({ros:this.ros,serverName:"/tf2_web_republisher",actionName:"tf2_web_republisher/TFSubscriptionAction"})},ROSLIB.TFClient.prototype.processFeedback=function(e){var t=this;e.transforms.forEach(function(e){var i=e.child_frame_id,n=t.frameInfos[i];void 0!==n&&(n.transform=new ROSLIB.Transform({translation:e.transform.translation,rotation:e.transform.rotation}),n.cbs.forEach(function(e){e(n.transform)}))})},ROSLIB.TFClient.prototype.updateGoal=function(){this.currentGoal&&this.currentGoal.cancel();var e={source_frames:[],target_frame:this.fixedFrame,angular_thres:this.angularThres,trans_thres:this.transThres,rate:this.rate};for(var t in this.frameInfos)e.source_frames.push(t);this.currentGoal=new ROSLIB.Goal({actionClient:this.actionClient,goalMessage:e}),this.currentGoal.on("feedback",this.processFeedback.bind(this)),this.currentGoal.send(),this.goalUpdateRequested=!1},ROSLIB.TFClient.prototype.subscribe=function(e,t){"/"===e[0]&&(e=e.substring(1)),void 0===this.frameInfos[e]?(this.frameInfos[e]={cbs:[]},this.goalUpdateRequested||(setTimeout(this.updateGoal.bind(this),this.goalUpdateDelay),this.goalUpdateRequested=!0)):void 0!==this.frameInfos[e].transform&&t(this.frameInfos[e].transform),this.frameInfos[e].cbs.push(t)},ROSLIB.TFClient.prototype.unsubscribe=function(e,t){var i=this.frameInfos[e];if(void 0!==i){var n=i.cbs.indexOf(t);n>=0&&(i.cbs.splice(n,1),0===i.cbs.length&&delete this.frameInfos[e],this.needUpdate=!0)}},ROSLIB.UrdfBox=function(e){var t=this,i=(e=e||{}).xml;this.dimension=null,this.type=null;!function(e){this.type=ROSLIB.URDF_BOX;var i=e.getAttribute("size").split(" ");t.dimension=new ROSLIB.Vector3({x:parseFloat(i[0]),y:parseFloat(i[1]),z:parseFloat(i[2])})}(i)},ROSLIB.UrdfColor=function(e){var t=this,i=(e=e||{}).xml;this.r=null,this.g=null,this.b=null,this.a=null;!function(e){var i=e.getAttribute("rgba").split(" ");t.r=parseFloat(i[0]),t.g=parseFloat(i[1]),t.b=parseFloat(i[2]),t.a=parseFloat(i[3])}(i)},ROSLIB.UrdfCylinder=function(e){var t=this,i=(e=e||{}).xml;this.type=null,this.length=null,this.radius=null;!function(e){t.type=ROSLIB.URDF_CYLINDER,t.length=parseFloat(e.getAttribute("length")),t.radius=parseFloat(e.getAttribute("radius"))}(i)},ROSLIB.UrdfLink=function(e){var t=this,i=(e=e||{}).xml;this.name=null,this.visual=null;!function(e){t.name=e.getAttribute("name");var i=e.getElementsByTagName("visual");i.length>0&&(t.visual=new ROSLIB.UrdfVisual({xml:i[0]}))}(i)},ROSLIB.UrdfMaterial=function(e){var t=this,i=(e=e||{}).xml;this.name=null,this.textureFilename=null,this.color=null;!function(e){t.name=e.getAttribute("name");var i=e.getElementsByTagName("texture");i.length>0&&(t.textureFilename=i[0].getAttribute("filename"));var n=e.getElementsByTagName("color");n.length>0&&(t.color=new ROSLIB.UrdfColor({xml:n[0]}))}(i)},ROSLIB.UrdfMesh=function(e){var t=this,i=(e=e||{}).xml;this.filename=null,this.scale=null,this.type=null;!function(e){t.type=ROSLIB.URDF_MESH,t.filename=e.getAttribute("filename");var i=e.getAttribute("scale");if(i){var n=i.split(" ");t.scale=new ROSLIB.Vector3({x:parseFloat(n[0]),y:parseFloat(n[1]),z:parseFloat(n[2])})}}(i)},ROSLIB.UrdfModel=function(e){var t=this,i=(e=e||{}).xml,n=e.string;this.materials=[],this.links=[];n&&(i=(new DOMParser).parseFromString(n,"text/xml"));!function(e){var i=e.evaluate("//robot",e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;for(var n in t.name=i.getAttribute("name"),i.childNodes){var r=i.childNodes[n];if("material"===r.tagName){var o=new ROSLIB.UrdfMaterial({xml:r});t.materials[o.name]?console.warn("Material "+o.name+"is not unique."):t.materials[o.name]=o}else if("link"===r.tagName){var a=new ROSLIB.UrdfLink({xml:r});t.links[a.name]?console.warn("Link "+a.name+" is not unique."):(a.visual&&a.visual.material&&(t.materials[a.visual.material.name]?a.visual.material=t.materials[a.visual.material.name]:a.visual.material&&(t.materials[a.visual.material.name]=a.visual.material)),t.links[a.name]=a)}}}(i)},ROSLIB.UrdfSphere=function(e){var t=this,i=(e=e||{}).xml;this.radius=null,this.type=null;!function(e){t.type=ROSLIB.URDF_SPHERE,t.radius=parseFloat(e.getAttribute("radius"))}(i)},ROSLIB.UrdfVisual=function(e){var t=this,i=(e=e||{}).xml;this.origin=null,this.geometry=null,this.material=null;!function(e){var i=e.getElementsByTagName("origin");if(0===i.length)t.origin=new ROSLIB.Pose;else{var n=i[0].getAttribute("xyz"),r=new ROSLIB.Vector3;n&&(n=n.split(" "),r=new ROSLIB.Vector3({x:parseFloat(n[0]),y:parseFloat(n[1]),z:parseFloat(n[2])}));var o=i[0].getAttribute("rpy"),a=new ROSLIB.Quaternion;if(o){o=o.split(" ");var s=parseFloat(o[0])/2,l=parseFloat(o[1])/2,c=parseFloat(o[2])/2,u=Math.sin(s)*Math.cos(l)*Math.cos(c)-Math.cos(s)*Math.sin(l)*Math.sin(c),h=Math.cos(s)*Math.sin(l)*Math.cos(c)+Math.sin(s)*Math.cos(l)*Math.sin(c),d=Math.cos(s)*Math.cos(l)*Math.sin(c)-Math.sin(s)*Math.sin(l)*Math.cos(c),p=Math.cos(s)*Math.cos(l)*Math.cos(c)+Math.sin(s)*Math.sin(l)*Math.sin(c);(a=new ROSLIB.Quaternion({x:u,y:h,z:d,w:p})).normalize()}t.origin=new ROSLIB.Pose({position:r,orientation:a})}var f=e.getElementsByTagName("geometry");if(f.length>0){var m=null;for(var g in f[0].childNodes){var v=f[0].childNodes[g];if(1===v.nodeType){m=v;break}}var y=m.nodeName;"sphere"===y?t.geometry=new ROSLIB.UrdfSphere({xml:m}):"box"===y?t.geometry=new ROSLIB.UrdfBox({xml:m}):"cylinder"===y?t.geometry=new ROSLIB.UrdfCylinder({xml:m}):"mesh"===y?t.geometry=new ROSLIB.UrdfMesh({xml:m}):console.warn("Unknown geometry type "+y)}var b=e.getElementsByTagName("material");b.length>0&&(t.material=new ROSLIB.UrdfMaterial({xml:b[0]}))}(i)};var GZ3D=GZ3D||{REVISION:"1"},globalEmitter=new EventEmitter2({verboseMemoryLeak:!0}),isTouchDevice=/Mobi/.test(navigator.userAgent),emUnits=function(e){return e*parseFloat($("body").css("font-size"))},isWideScreen=function(){return $(window).width()/emUnits(1)>35},isTallScreen=function(){return $(window).height()/emUnits(1)>35},lastOpenMenu={mainMenu:"mainMenu",insertMenu:"insertMenu",treeMenu:"treeMenu"},tabColors={selected:"rgb(34, 170, 221)",unselected:"rgb(42, 42, 42)"},modelList=[{path:"buildings",title:"Buildings",examplePath1:"fast_food",examplePath2:"kitchen_dining",examplePath3:"house_1",models:[{modelPath:"fast_food",modelTitle:"Fast Food"},{modelPath:"gas_station",modelTitle:"Gas Station"},{modelPath:"house_1",modelTitle:"House 1"},{modelPath:"house_2",modelTitle:"House 2"},{modelPath:"house_3",modelTitle:"House 3"},{modelPath:"iss",modelTitle:"International Space Station"},{modelPath:"iss_half",modelTitle:"ISS half"},{modelPath:"kitchen_dining",modelTitle:"Kitchen and Dining"},{modelPath:"office_building",modelTitle:"Office Building"},{modelPath:"powerplant",modelTitle:"Power Plant"},{modelPath:"starting_pen",modelTitle:"Starting Pen"},{modelPath:"willowgarage",modelTitle:"Willow Garage"},{modelPath:"cafe",modelTitle:"Cafe"},{modelPath:"box_target_green",modelTitle:"Box target (green)"},{modelPath:"box_target_red",modelTitle:"Box target (red)"},{modelPath:"hoop_red",modelTitle:"Hoop (red)"},{modelPath:"control_console",modelTitle:"Control Console"}]},{path:"furniture",title:"Furniture",examplePath1:"hinged_door",examplePath2:"bookshelf",examplePath3:"table",models:[{modelPath:"bookshelf",modelTitle:"Book Shelf"},{modelPath:"cabinet",modelTitle:"Cabinet"},{modelPath:"drc_practice_door_4x8",modelTitle:"4x8 Doorway"},{modelPath:"drc_practice_ladder",modelTitle:"Ladder"},{modelPath:"hinged_door",modelTitle:"Hinged Door"},{modelPath:"table",modelTitle:"Table"},{modelPath:"table_marble",modelTitle:"Table Marble"},{modelPath:"cafe_table",modelTitle:"Cafe table"},{modelPath:"drc_practice_ball_valve",modelTitle:"Ball Valve"},{modelPath:"drc_practice_handle_wheel_valve",modelTitle:"Handle Wheel Valve"},{modelPath:"drc_practice_hand_wheel_valve",modelTitle:"Hand Wheel Valve"},{modelPath:"drc_practice_wheel_valve",modelTitle:"Wheel Valve"},{modelPath:"drc_practice_wheel_valve_large",modelTitle:"Wheel Valve Large"},{modelPath:"door_handle",modelTitle:"Door Handle"},{modelPath:"drc_practice_ball_valve_wall",modelTitle:"Wall (Ball Valve)"},{modelPath:"drc_practice_handle_wheel_valve_wall",modelTitle:"Wall (Handle Wheel Valve)"},{modelPath:"drc_practice_hand_wheel_valve_wall",modelTitle:"Wall (Hand Wheel Valve)"},{modelPath:"drc_practice_valve_wall",modelTitle:"Wall (Valve)"},{modelPath:"drc_practice_wheel_valve_wall",modelTitle:"Wall (Wheel Valve)"},{modelPath:"drc_practice_wheel_valve_large_wall",modelTitle:"Wall (Wheel Valve Large)"},{modelPath:"grey_wall",modelTitle:"Grey Wall"},{modelPath:"asphalt_plane",modelTitle:"Asphalt Plane"},{modelPath:"drc_practice_base_4x8",modelTitle:"Debris base"},{modelPath:"ground_plane",modelTitle:"Ground Plane"},{modelPath:"nist_maze_wall_120",modelTitle:"120 Maze Wall"},{modelPath:"nist_maze_wall_240",modelTitle:"240 Maze Wall"},{modelPath:"nist_maze_wall_triple_holes_120",modelTitle:"120 Maze Wall Triple Holes"},{modelPath:"nist_simple_ramp_120",modelTitle:"Simple Ramp"},{modelPath:"nist_stairs_120",modelTitle:"Stairs"}]},{path:"kitchen",title:"Kitchen",examplePath1:"saucepan",examplePath2:"beer",examplePath3:"bowl",models:[{modelPath:"beer",modelTitle:"Beer"},{modelPath:"bowl",modelTitle:"Bowl"},{modelPath:"coke_can",modelTitle:"Coke Can"},{modelPath:"saucepan",modelTitle:"Saucepan"},{modelPath:"plastic_cup",modelTitle:"Plastic Cup"}]},{path:"robocup",title:"Robocup",examplePath1:"robocup_3Dsim_ball",examplePath2:"robocup14_spl_goal",examplePath3:"robocup09_spl_field",models:[{modelPath:"robocup09_spl_field",modelTitle:"2009 SPL Field"},{modelPath:"robocup14_spl_field",modelTitle:"2014 SPL Field"},{modelPath:"robocup_3Dsim_field",modelTitle:"3D Sim. Field"},{modelPath:"robocup14_spl_goal",modelTitle:"SPL Goal"},{modelPath:"robocup_3Dsim_goal",modelTitle:"3D Sim. Goal"},{modelPath:"robocup_spl_ball",modelTitle:"SPL Ball"},{modelPath:"robocup_3Dsim_ball",modelTitle:"3D Sim. Ball"}]},{path:"first",title:"FIRST",examplePath1:"frc2016_field",examplePath2:"frc2016_chevaldefrise",examplePath3:"frc_field_2015",models:[{modelPath:"frc2016_chevaldefrise",modelTitle:"Cheval de Frise"},{modelPath:"frc2016_drawbridge",modelTitle:"Draw Bridge"},{modelPath:"frc2016_field",modelTitle:"2016 Field"},{modelPath:"frc2016_lowbar",modelTitle:"Low Bar"},{modelPath:"frc2016_moat",modelTitle:"Moat"},{modelPath:"frc2016_portcullis",modelTitle:"Portcullis"},{modelPath:"frc2016_ramparts",modelTitle:"Ramparts"},{modelPath:"frc2016_rockwall",modelTitle:"Rockwall"},{modelPath:"frc2016_roughterrain",modelTitle:"Rough Terrain"},{modelPath:"frc2016_sallyport",modelTitle:"Sallyport"},{modelPath:"frc_field_2015",modelTitle:"2015 Field"}]},{path:"robots",title:"Robots",examplePath1:"pioneer3at",examplePath2:"turtlebot",examplePath3:"pr2",models:[{modelPath:"create",modelTitle:"Create"},{modelPath:"husky",modelTitle:"Husky"},{modelPath:"irobot_hand",modelTitle:"iRobot Hand"},{modelPath:"pioneer2dx",modelTitle:"Pioneer 2DX"},{modelPath:"pioneer3at",modelTitle:"Pioneer 3AT"},{modelPath:"pr2",modelTitle:"PR2"},{modelPath:"robonaut",modelTitle:"Robonaut"},{modelPath:"simple_arm",modelTitle:"Simple Arm"},{modelPath:"simple_arm_gripper",modelTitle:"Simple Arm and Gripper"},{modelPath:"simple_gripper",modelTitle:"Simple Gripper"},{modelPath:"turtlebot",modelTitle:"TurtleBot"},{modelPath:"youbot",modelTitle:"YouBot"},{modelPath:"cart_rigid_suspension",modelTitle:"Cart: rigid suspension"},{modelPath:"cart_soft_suspension",modelTitle:"Cart: soft suspension"},{modelPath:"cessna",modelTitle:"Cessna"},{modelPath:"follower_vehicle",modelTitle:"Follower Vehicle"},{modelPath:"iris_with_standoffs",modelTitle:"Iris with Standoffs"},{modelPath:"iris_with_standoffs_demo",modelTitle:"Iris with Standoffs (demo)"},{modelPath:"mpl_right_arm",modelTitle:"MPL right arm"},{modelPath:"mpl_right_forearm",modelTitle:"MPL right forearm"},{modelPath:"parrot_bebop_2",modelTitle:"Parrot Bebop 2"},{modelPath:"quadrotor",modelTitle:"Quadrotor"},{modelPath:"submarine",modelTitle:"Submarine"},{modelPath:"submarine_buoyant",modelTitle:"Submarine (buoyant)"},{modelPath:"submarine_sinking",modelTitle:"Submarine (sinking)"},{modelPath:"warehouse_robot",modelTitle:"Warehouse Robot"},{modelPath:"zephyr_delta_wing",modelTitle:"Zephyr Delta Wing"}]},{path:"sensors",title:"Sensors",examplePath1:"camera",examplePath2:"hokuyo",examplePath3:"kinect",models:[{modelPath:"camera",modelTitle:"Camera"},{modelPath:"stereo_camera",modelTitle:"Stereo Camera"},{modelPath:"hokuyo",modelTitle:"Hokuyo"},{modelPath:"kinect",modelTitle:"Kinect"},{modelPath:"depth_camera",modelTitle:"Depth Camera"},{modelPath:"gimbal_small_2d",modelTitle:"Gimbal Small 2D"},{modelPath:"velodyne_hdl32",modelTitle:"Velodyne HDL-32"}]},{path:"street",title:"Street",examplePath1:"dumpster",examplePath2:"drc_practice_angled_barrier_45",examplePath3:"fire_hydrant",models:[{modelPath:"cinder_block",modelTitle:"Cinder Block"},{modelPath:"cinder_block_2",modelTitle:"Cinder Block 2"},{modelPath:"cinder_block_wide",modelTitle:"Cinder Block Wide"},{modelPath:"construction_barrel",modelTitle:"Construction Barrel"},{modelPath:"construction_cone",modelTitle:"Construction Cone"},{modelPath:"drc_practice_angled_barrier_45",modelTitle:"Angled Barrier 45"},{modelPath:"drc_practice_angled_barrier_135",modelTitle:"Angled Barrier 135"},{modelPath:"drc_practice_block_wall",modelTitle:"Block Wall"},{modelPath:"drc_practice_orange_jersey_barrier",modelTitle:"Jersey Barrier (Orange)"},{modelPath:"drc_practice_white_jersey_barrier",modelTitle:"Jersey Barrier (White)"},{modelPath:"drc_practice_truss",modelTitle:"Truss"},{modelPath:"drc_practice_yellow_parking_block",modelTitle:"Parking Block"},{modelPath:"dumpster",modelTitle:"Dumpster"},{modelPath:"fire_hydrant",modelTitle:"Fire Hydrant"},{modelPath:"jersey_barrier",modelTitle:"Jersey Barrier"},{modelPath:"lamp_post",modelTitle:"Lamp Post"},{modelPath:"mailbox",modelTitle:"Mailbox"},{modelPath:"mud_box",modelTitle:"Mud Box"},{modelPath:"nist_fiducial_barrel",modelTitle:"Fiducial Barrel"},{modelPath:"speed_limit_sign",modelTitle:"Speed Limit Sign"},{modelPath:"stop_sign",modelTitle:"Stop Sign"},{modelPath:"first_2015_trash_can",modelTitle:"Trash Can"},{modelPath:"person_standing",modelTitle:"Person Standning"},{modelPath:"person_walking",modelTitle:"Person Walking"}]},{path:"tools",title:"Tools",examplePath1:"hammer",examplePath2:"polaris_ranger_ev",examplePath3:"cordless_drill",models:[{modelPath:"cordless_drill",modelTitle:"Cordless Drill"},{modelPath:"fire_hose_long",modelTitle:"Fire Hose"},{modelPath:"fire_hose_long_curled",modelTitle:"Fire Hose Long Curled"},{modelPath:"hammer",modelTitle:"Hammer"},{modelPath:"monkey_wrench",modelTitle:"Monkey Wrench"},{modelPath:"polaris_ranger_ev",modelTitle:"Polaris Ranger EV"},{modelPath:"polaris_ranger_xp900",modelTitle:"Polaris Ranger XP900"},{modelPath:"polaris_ranger_xp900_no_roll_cage",modelTitle:"Polaris Ranger without roll cage"},{modelPath:"utility_cart",modelTitle:"Utility Cart"},{modelPath:"car_wheel",modelTitle:"Car Wheel"},{modelPath:"arm_part",modelTitle:"Arm Part"},{modelPath:"gear_part",modelTitle:"Gear Part"},{modelPath:"gasket_part",modelTitle:"Gasket Part"},{modelPath:"disk_part",modelTitle:"Disk Part"},{modelPath:"pulley_part",modelTitle:"Pulley Part"},{modelPath:"piston_rod_part",modelTitle:"Piston Rod Part"},{modelPath:"t_brace_part",modelTitle:"T Brace Part"},{modelPath:"u_joint_part",modelTitle:"U Joint Part"}]},{path:"misc",title:"Misc.",examplePath1:"brick_box_3x1x3",examplePath2:"drc_practice_4x4x20",examplePath3:"double_pendulum_with_base",models:[{modelPath:"double_pendulum_with_base",modelTitle:"Double Pendulum With Base"},{modelPath:"breakable_test",modelTitle:"Breakable_test"},{modelPath:"brick_box_3x1x3",modelTitle:"Brick Box 3x1x3"},{modelPath:"cardboard_box",modelTitle:"Cardboard Box"},{modelPath:"cube_20k",modelTitle:"Cube 20k"},{modelPath:"cricket_ball",modelTitle:"Cricket Ball"},{modelPath:"marble_1_5cm",modelTitle:"Marble 1.5 cm"},{modelPath:"metal_peg",modelTitle:"Metal Peg"},{modelPath:"metal_peg_board",modelTitle:"Metal Peg Board"},{modelPath:"mars_rover",modelTitle:"Mars Rover"},{modelPath:"stone_10_2_5_1cm",modelTitle:"Stone 10 x 2.5 x 1 cm"},{modelPath:"tube_2_25cm",modelTitle:"Tube 2.25 cm"},{modelPath:"tube_9_5mm",modelTitle:"Tube 9.5 mm"},{modelPath:"wood_block_10_2_1cm",modelTitle:"Wood Block 10 x 2 x 1 cm"},{modelPath:"wood_cube_10cm",modelTitle:"Wood Cube 10 cm"},{modelPath:"wood_cube_2_5cm",modelTitle:"Wood Cube 2.5 cm"},{modelPath:"wood_cube_5cm",modelTitle:"Wood Cube 5 cm"},{modelPath:"wood_cube_7_5cm",modelTitle:"Wood Cube 7.5 cm"},{modelPath:"wooden_board",modelTitle:"Wooden Board"},{modelPath:"wooden_case",modelTitle:"Wooden Case"},{modelPath:"wooden_case_metal_peg",modelTitle:"Wooden Case Metal Peg "},{modelPath:"wooden_case_wooden_peg",modelTitle:"Wooden Case Wooden Peg"},{modelPath:"wooden_peg",modelTitle:"Wooden Peg"},{modelPath:"wooden_peg_board",modelTitle:"Wooden Peg Board"},{modelPath:"drc_practice_2x4",modelTitle:"2x4 Lumber"},{modelPath:"drc_practice_2x6",modelTitle:"2x6 Lumber"},{modelPath:"drc_practice_4x4x20",modelTitle:"4x4x20 Lumber"},{modelPath:"drc_practice_4x4x40",modelTitle:"4x4x40 Lumber"},{modelPath:"drc_practice_blue_cylinder",modelTitle:"Blue Cylinder"},{modelPath:"drc_practice_wood_slats",modelTitle:"Wood Slats"},{modelPath:"nist_elevated_floor_120",modelTitle:"Elevated Floor 120"},{modelPath:"number1",modelTitle:"Number 1"},{modelPath:"number2",modelTitle:"Number 2"},{modelPath:"number3",modelTitle:"Number 3"},{modelPath:"number4",modelTitle:"Number 4"},{modelPath:"number5",modelTitle:"Number 5"},{modelPath:"number6",modelTitle:"Number 6"},{modelPath:"number7",modelTitle:"Number 7"},{modelPath:"number8",modelTitle:"Number 8"},{modelPath:"number9",modelTitle:"Number 9"},{modelPath:"ragdoll",modelTitle:"Ragdoll"},{modelPath:"textured_shapes",modelTitle:"Textured shapes"}]}];function getNameFromPath(e){if("box"===e)return"Box";if("sphere"===e)return"Sphere";if("cylinder"===e)return"Cylinder";if("pointlight"===e)return"Point Light";if("spotlight"===e)return"Spot Light";if("directionallight"===e)return"Directional Light";for(var t=0;t<modelList.length;++t)for(var i=0;i<modelList[t].models.length;++i)if(modelList[t].models[i].modelPath===e)return modelList[t].models[i].modelTitle}$(function(){if(("ontouchstart"in window||"onmsgesturechange"in window)&&$("body").addClass("isTouchDevice"),$("#view-collisions").buttonMarkup({icon:"false"}),$("#snap-to-grid").buttonMarkup({icon:"false"}),$("#open-tree-when-selected").buttonMarkup({icon:"false"}),$("#view-transparent").buttonMarkup({icon:"false"}),$("#view-wireframe").buttonMarkup({icon:"false"}),$("#view-joints").buttonMarkup({icon:"false"}),$("#view-com").buttonMarkup({icon:"false"}),globalEmitter.emit("toggle_notifications"),globalEmitter.emit("show_orbit_indicator"),$("#clock-touch").popup("option","arrow","t"),$("#notification-popup-screen").remove(),$(".tab").css("border-left-color",tabColors.unselected),isWideScreen()&&globalEmitter.emit("openTab","mainMenu","mainMenu"),isTallScreen()&&($(".collapsible_header").click(),$("#expand-MODELS").click(),$("#expand-LIGHTS").click()),isTouchDevice){$("#logplay-slider").css("width","100%"),$(".mouse-only").css("display","none"),$("#play-header-fieldset").css("position","absolute").css("right","13.6em").css("top","0em").css("z-index","1000"),$("#clock-header-fieldset").css("position","absolute").css("right","10.2em").css("top","0em").css("z-index","1000"),$("#mode-header-fieldset").css("position","absolute").css("right","0.5em").css("top","0.15em").css("z-index","1000"),$(".gzGUI").touchstart(function(e){globalEmitter.emit("pointerOnMenu")}),$(".gzGUI").touchend(function(e){globalEmitter.emit("pointerOffMenu")});$("#container").on("touchstart",function(e){$(this).data("checkdown",setTimeout(function(){globalEmitter.emit("longpress_container_start",e)},400))}).on("touchend",function(e){clearTimeout($(this).data("checkdown")),globalEmitter.emit("longpress_container_end",e,!1)}).on("touchmove",function(e){clearTimeout($(this).data("checkdown")),$(this).data("checkdown",setTimeout(function(){globalEmitter.emit("longpress_container_start",e)},400)),globalEmitter.emit("longpress_container_move",e)});$('[id^="insert-entity-"]').on("touchstart",function(e){var t=$(this).attr("id");t=t.substring(14),$(this).data("checkdown",setTimeout(function(){globalEmitter.emit("longpress_insert_start",e,t)},400))}).on("touchend",function(e){clearTimeout($(this).data("checkdown")),globalEmitter.emit("longpress_insert_end",e,!1)}).on("touchmove",function(e){clearTimeout($(this).data("checkdown")),globalEmitter.emit("longpress_insert_move",e)})}else $(".touch-only").css("display","none"),$('[id^="insert-entity-"]').click(function(e){var t=$(this).attr("id");t=t.substring(14),globalEmitter.emit("spawn_entity_start",t)}).on("mousedown",function(e){e.preventDefault()}),$("#play-header-fieldset").css("position","absolute").css("right","41.2em").css("top","0em").css("z-index","1000"),$("#clock-mouse").css("position","absolute").css("right","29.0em").css("top","0.5em").css("z-index","100").css("width","11.5em").css("height","2.5em").css("background-color","#333333").css("padding","3px").css("border-radius","5px"),$("#mode-header-fieldset").css("position","absolute").css("right","24.4em").css("top","0.15em").css("z-index","1000"),$("#box-header-fieldset").css("position","absolute").css("right","15.5em").css("top","0em").css("z-index","1000"),$("#sphere-header-fieldset").css("position","absolute").css("right","12.5em").css("top","0em").css("z-index","1000"),$("#cylinder-header-fieldset").css("position","absolute").css("right","9.5em").css("top","0em").css("z-index","1000"),$("#pointlight-header-fieldset").css("position","absolute").css("right","6.5em").css("top","0em").css("z-index","1000"),$("#spotlight-header-fieldset").css("position","absolute").css("right","3.5em").css("top","0em").css("z-index","1000"),$("#directionallight-header-fieldset").css("position","absolute").css("right","0.5em").css("top","0em").css("z-index","1000"),$(".gzGUI").mouseenter(function(e){globalEmitter.emit("pointerOnMenu")}),$(".gzGUI").mouseleave(function(e){globalEmitter.emit("pointerOffMenu")}),$("#container").mousedown(function(e){e.preventDefault(),3===e.which&&globalEmitter.emit("right_click",e)}),$("#model-popup-screen").mousedown(function(e){$("#model-popup").popup("close")});$(".tab").click(function(){var e=$(this).attr("id"),t=e.substring(0,e.indexOf("Tab"));$("#"+e).css("border-left-color")===tabColors.unselected?globalEmitter.emit("openTab",lastOpenMenu[t],t):globalEmitter.emit("closeTabs",!0)}),$(".closePanels").click(function(){globalEmitter.emit("closeTabs",!0)}),$("#view-mode").click(function(){globalEmitter.emit("manipulation_mode","view")}),$("#translate-mode").click(function(){globalEmitter.emit("manipulation_mode","translate")}),$("#rotate-mode").click(function(){globalEmitter.emit("manipulation_mode","rotate")}),$('[id^="header-insert-"]').click(function(){var e=$(this).attr("id");e=e.substring(14),globalEmitter.emit("closeTabs",!1),globalEmitter.emit("spawn_entity_start",e)}),$("#play").click(function(){-1!==$("#playText").html().indexOf("Play")?(globalEmitter.emit("pause",!1),globalEmitter.emit("notification_popup","Physics engine running")):(globalEmitter.emit("pause",!0),globalEmitter.emit("notification_popup","Physics engine paused"))}),$("#clock").click(function(){if($.mobile.activePage.find("#clock-touch").parent().hasClass("ui-popup-active"))$("#clock-touch").popup("close");else{var e=$("#clock").offset();$("#notification-popup").popup("close"),$("#clock-touch").popup("open",{x:e.left+emUnits(1.6),y:emUnits(4)})}}),$("#reset-model").click(function(){globalEmitter.emit("reset","model"),globalEmitter.emit("closeTabs",!1)}),$("#reset-world").click(function(){globalEmitter.emit("reset","world"),globalEmitter.emit("closeTabs",!1)}),$("#reset-view").click(function(){globalEmitter.emit("view_reset"),globalEmitter.emit("closeTabs",!1)}),$("#view-grid").click(function(){globalEmitter.emit("show_grid","toggle"),globalEmitter.emit("closeTabs",!1)}),$("#view-collisions").click(function(){globalEmitter.emit("show_collision"),globalEmitter.emit("closeTabs",!1)}),$("#view-orbit-indicator").click(function(){globalEmitter.emit("show_orbit_indicator"),globalEmitter.emit("closeTabs",!1)}),$("#snap-to-grid").click(function(){globalEmitter.emit("snap_to_grid"),globalEmitter.emit("closeTabs",!1)}),$("#open-tree-when-selected").click(function(){globalEmitter.emit("openTreeWhenSelected"),globalEmitter.emit("closeTabs",!1)}),$("#toggle-notifications").click(function(){globalEmitter.emit("toggle_notifications"),globalEmitter.emit("closeTabs",!1)}),$("body").on("keyup",function(e){if(27===e.which)return!1}),$("#view-transparent").click(function(){$("#model-popup").popup("close"),globalEmitter.emit("set_view_as","transparent")}),$("#view-wireframe").click(function(){$("#model-popup").popup("close"),globalEmitter.emit("set_view_as","wireframe")}),$("#view-joints").click(function(){"rgb(255, 255, 255)"===$("#view-joints a").css("color")&&($("#model-popup").popup("close"),globalEmitter.emit("view_joints"))}),$("#view-com").click(function(){"rgb(255, 255, 255)"===$("#view-com a").css("color")&&($("#model-popup").popup("close"),globalEmitter.emit("view_com"))}),$("#view-inertia").click(function(){"rgb(255, 255, 255)"===$("#view-inertia a").css("color")&&($("#model-popup").popup("close"),globalEmitter.emit("view_inertia"))}),$("#delete-entity").click(function(){globalEmitter.emit("delete_entity")}),$(window).resize(function(){globalEmitter.emit("resizePanel")}),$("#logplay-slider-input").on("slidestop",function(e,t){globalEmitter.emit("logPlaySlideStop",$("#logplay-slider-input").val())}),$("#logplay-slider-input").on("slidestart",function(e,t){globalEmitter.emit("logPlaySlideStart")}),$("#logplay-rewind").click(function(){globalEmitter.emit("logPlayRewind")}),$("#logplay-stepback").click(function(){globalEmitter.emit("logPlayStepback")}),$("#logplay-play").click(function(){-1!==$("#logplay-playText").html().indexOf("Play")?globalEmitter.emit("pause",!1):globalEmitter.emit("pause",!0)}),$("#logplay-stepforward").click(function(){globalEmitter.emit("logPlayStepforward")}),$("#logplay-forward").click(function(){globalEmitter.emit("logPlayForward")})});var gzangular=angular.module("gzangular",[]);gzangular.directive("ngRightClick",function(e){return function(t,i,n){var r=e(n.ngRightClick);i.bind("contextmenu",function(e){t.$apply(function(){e.preventDefault(),r(t,{$event:e})})})}}),gzangular.controller("treeControl",["$scope",function(e){e.updateStats=function(){e.models=modelStats,e.lights=lightStats,e.scene=sceneStats,e.physics=physicsStats,e.$$phase||e.$apply()},e.selectEntity=function(e){$("#model-popup").popup("close"),globalEmitter.emit("openTab","propertyPanel-"+convertNameId(e),"treeMenu"),globalEmitter.emit("selectEntity",e)},e.openEntityMenu=function(e,t){$("#model-popup").popup("close"),globalEmitter.emit("openEntityPopup",e,t)},e.openTab=function(e){globalEmitter.emit("openTab",e,"treeMenu")},e.expandTree=function(e){var t="expandable-"+e,i="expand-"+e;$("#"+t).is(":visible")?($("#"+t).hide(),$("#"+i+" img").css("transform","rotate(0deg)").css("-webkit-transform","rotate(0deg)").css("-ms-transform","rotate(0deg)")):($("#"+t).show(),$("#"+i+" img").css("transform","rotate(90deg)").css("-webkit-transform","rotate(90deg)").css("-ms-transform","rotate(90deg)"))},e.expandProperty=function(e,t,i,n,r){var o,a,s=convertNameId(t),l="expandable-"+e+"-"+s,c="expand-"+e+"-"+s;i&&(o=l,a=c,l=l+"-"+i,c=c+"-"+i),$("#"+l).is(":visible")?($("#"+l).hide(),$("#"+c+" img").css("transform","rotate(0deg)").css("-webkit-transform","rotate(0deg)").css("-ms-transform","rotate(0deg)")):(!i||"link"!==e&&"joint"!==e||($('[id^="'+o+'-"]').hide(),$('[id^="'+a+'-"] img').css("transform","rotate(0deg)").css("-webkit-transform","rotate(0deg)").css("-ms-transform","rotate(0deg)")),$("#"+l).show(),$("#"+c+" img").css("transform","rotate(90deg)").css("-webkit-transform","rotate(90deg)").css("-ms-transform","rotate(90deg)"),"pose"===e&&"link"===r&&globalEmitter.emit("setPoseStats",t,n))},e.changePose=function(e,t,i,n){globalEmitter.emit("setPose",e,t,convertNameId(i),n)},e.changeLight=function(e,t,i){globalEmitter.emit("setLight",e,convertNameId(t),i)},e.toggleProperty=function(e,t,i){globalEmitter.emit("toggleProperty",e,t,i)}}]),gzangular.controller("insertControl",["$scope",function(e){e.categories=modelList,e.spawnEntity=function(e){globalEmitter.emit("spawn_entity_start",e)},e.openTab=function(e){globalEmitter.emit("openTab",e,"insertMenu")}}]),GZ3D.Gui=function(e){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.scene=e,this.domElement=e.getDomElement(),this.spawnState=null,this.longPressContainerState=null,this.showNotifications=!1,this.openTreeWhenSelected=!1,this.modelStatsDirty=!1,this.logPlay=new GZ3D.LogPlay;var t,i=this;setInterval(function(){i.modelStatsDirty&&(i.updateStats(),i.modelStatsDirty=!1)},20),this.emitter.on("manipulation_mode",function(e){i.scene.setManipulationMode(e);var t=i.scene.modelManipulator.space;"view"===e?i.emitter.emit("notification_popup","View mode"):i.emitter.emit("notification_popup",e.charAt(0).toUpperCase()+e.substring(1)+" mode in "+t.charAt(0).toUpperCase()+t.substring(1)+" space")}),this.emitter.on("spawn_entity_start",function(e){i.scene.setManipulationMode("view"),$("#view-mode").prop("checked",!0),$('input[type="radio"]').checkboxradio("refresh");var t=getNameFromPath(e);i.spawnState="START",i.scene.spawnModel.start(e,function(t){i.emitter.emit("entityCreated",t,e)}),i.emitter.emit("notification_popup","Place "+t+" at the desired position")}),this.emitter.on("spawn_entity_move",function(e){i.spawnState="MOVE",i.scene.spawnModel.onTouchMove(e,!1)}),this.emitter.on("spawn_entity_end",function(){"MOVE"===i.spawnState&&i.scene.spawnModel.onTouchEnd(),i.spawnState=null}),this.emitter.on("reset",function(e){"world"===e?i.emitter.emit("notification_popup","Reset world"):"model"===e&&i.emitter.emit("notification_popup","Reset model poses")}),this.emitter.on("model_reset",function(){i.emitter.emit("reset","model"),i.emitter.emit("notification_popup","Reset model poses")}),this.emitter.on("view_reset",function(){i.scene.resetView(),i.emitter.emit("notification_popup","Reset view")}),this.emitter.on("show_collision",function(){i.scene.showCollision(!i.scene.showCollisions),i.scene.showCollisions?($("#view-collisions").buttonMarkup({icon:"check"}),i.emitter.emit("notification_popup","Viewing collisions")):($("#view-collisions").buttonMarkup({icon:"false"}),i.emitter.emit("notification_popup","Hiding collisions"))}),this.emitter.on("show_grid",function(e){"show"===e?i.scene.grid.visible=!0:"hide"===e?i.scene.grid.visible=!1:"toggle"===e&&(i.scene.grid.visible=!i.scene.grid.visible),i.scene.grid.visible?($("#view-grid").buttonMarkup({icon:"check"}),i.emitter.emit("notification_popup","Viewing grid")):($("#view-grid").buttonMarkup({icon:"false"}),i.emitter.emit("notification_popup","Hiding grid"))}),this.emitter.on("show_orbit_indicator",function(){i.scene.controls.showTargetIndicator=!i.scene.controls.showTargetIndicator,i.scene.controls.showTargetIndicator?($("#view-orbit-indicator").buttonMarkup({icon:"check"}),i.emitter.emit("notification_popup","Viewing orbit indicator")):($("#view-orbit-indicator").buttonMarkup({icon:"false"}),i.emitter.emit("notification_popup","Hiding orbit indicator"))}),this.emitter.on("snap_to_grid",function(){null===i.scene.modelManipulator.snapDist?($("#snap-to-grid").buttonMarkup({icon:"check"}),i.scene.modelManipulator.snapDist=.5,i.scene.spawnModel.snapDist=i.scene.modelManipulator.snapDist,i.emitter.emit("notification_popup","Snapping to grid")):($("#snap-to-grid").buttonMarkup({icon:"false"}),i.scene.modelManipulator.snapDist=null,i.scene.spawnModel.snapDist=null,i.emitter.emit("notification_popup","Not snapping to grid"))}),this.emitter.on("openTreeWhenSelected",function(){i.openTreeWhenSelected=!i.openTreeWhenSelected,i.openTreeWhenSelected?$("#open-tree-when-selected").buttonMarkup({icon:"check"}):$("#open-tree-when-selected").buttonMarkup({icon:"false"})}),this.emitter.on("toggle_notifications",function(){i.showNotifications=!i.showNotifications,i.showNotifications?$("#toggle-notifications").buttonMarkup({icon:"check"}):$("#toggle-notifications").buttonMarkup({icon:"false"})}),this.emitter.on("longpress_container_start",function(e){1!==e.originalEvent.touches.length||i.scene.modelManipulator.hovered||i.scene.spawnModel.active?i.emitter.emit("longpress_container_end",e.originalEvent,!0):(i.scene.showRadialMenu(e),i.longPressContainerState="START")}),this.emitter.on("longpress_container_end",function(e,t){"START"===i.longPressContainerState?(i.longPressContainerState="END",i.scene.radialMenu.showing&&(t?i.scene.radialMenu.hide(e):i.scene.radialMenu.hide(e,function(e,t){"delete"===e?(i.emitter.emit("deleteEntity",t),i.scene.setManipulationMode("view"),$("#view-mode").prop("checked",!0),$('input[type="radio"]').checkboxradio("refresh")):"translate"===e?($("#translate-mode").click(),$('input[type="radio"]').checkboxradio("refresh"),i.scene.attachManipulator(t,e)):"rotate"===e?($("#rotate-mode").click(),$('input[type="radio"]').checkboxradio("refresh"),i.scene.attachManipulator(t,e)):"transparent"===e?i.emitter.emit("set_view_as","transparent"):"wireframe"===e?i.emitter.emit("set_view_as","wireframe"):"joints"===e&&(i.scene.selectEntity(t),i.emitter.emit("view_joints"))}))):i.longPressContainerState="END"}),this.emitter.on("longpress_container_move",function(e){if(1!==e.originalEvent.touches.length)i.emitter.emit("longpress_container_end",e.originalEvent,!0);else{if("START"!==i.longPressContainerState)return;i.scene.radialMenu.showing&&i.scene.radialMenu.onLongPressMove(e)}}),this.emitter.on("longpress_insert_start",function(e,t){navigator.vibrate(50),i.emitter.emit("spawn_entity_start",t),e.stopPropagation()}),this.emitter.on("longpress_insert_end",function(e){i.emitter.emit("spawn_entity_end")}),this.emitter.on("longpress_insert_move",function(e){i.emitter.emit("spawn_entity_move",e),e.stopPropagation()}),this.emitter.on("notification_popup",function(e,n){i.showNotifications&&(clearTimeout(t),$("#notification-popup").popup("close"),$("#notification-popup").html("&nbsp;"+e+"&nbsp;"),$("#notification-popup").popup("open",{y:window.innerHeight-50}),void 0===n&&(n=2e3),t=setTimeout(function(){$("#notification-popup").popup("close")},n))}),this.emitter.on("right_click",function(e){i.scene.onRightClick(e,function(t){i.openEntityPopup(e,t)})}),this.emitter.on("set_view_as",function(e){i.scene.setViewAs(i.scene.selectedEntity,e)}),this.emitter.on("view_joints",function(){i.scene.viewJoints(i.scene.selectedEntity)}),this.emitter.on("view_inertia",function(){i.scene.viewInertia(i.scene.selectedEntity)}),this.emitter.on("view_com",function(){i.scene.viewCOM(i.scene.selectedEntity)}),this.emitter.on("delete_entity",function(){i.emitter.emit("deleteEntity",i.scene.selectedEntity),$("#model-popup").popup("close"),i.scene.selectEntity(null)}),this.emitter.on("pointerOnMenu",function(){i.scene.pointerOnMenu=!0}),this.emitter.on("pointerOffMenu",function(){i.scene.pointerOnMenu=!1}),this.emitter.on("openTab",function(e,t){if(lastOpenMenu[t]=e,$(".leftPanels").hide(),$("#"+e).show(),$(".tab").css("border-left-color",tabColors.unselected),$("#"+t+"Tab").css("border-left-color",tabColors.selected),e.indexOf("propertyPanel-")>=0){var n=e.substring(e.indexOf("-")+1),r=i.scene.getByName(convertNameId(n,!0)),o={};o.name=n,o.pose={},o.pose.position={x:r.position.x,y:r.position.y,z:r.position.z},o.pose.orientation={x:r.quaternion._x,y:r.quaternion._y,z:r.quaternion._z,w:r.quaternion._w}}i.emitter.emit("resizePanel")}),this.emitter.on("closeTabs",function(e){!e&&isWideScreen()||($(".leftPanels").hide(),$(".tab").css("left","0em"),$(".tab").css("border-left-color",tabColors.unselected))}),this.emitter.on("setTreeSelected",function(e){for(var t=0;t<modelStats.length;++t)modelStats[t].name===e?(modelStats[t].selected="selectedTreeItem",i.openTreeWhenSelected&&i.emitter.emit("openTab","propertyPanel-"+convertNameId(e),"treeMenu")):modelStats[t].selected="unselectedTreeItem";for(t=0;t<lightStats.length;++t)lightStats[t].name===e?(lightStats[t].selected="selectedTreeItem",i.openTreeWhenSelected&&i.emitter.emit("openTab","propertyPanel-"+convertNameId(e),"treeMenu")):lightStats[t].selected="unselectedTreeItem";i.updateStats()}),this.emitter.on("setTreeDeselected",function(){for(var e=0;e<modelStats.length;++e)modelStats[e].selected="unselectedTreeItem";for(e=0;e<lightStats.length;++e)lightStats[e].selected="unselectedTreeItem";i.updateStats()}),this.emitter.on("selectEntity",function(e){var t=i.scene.getByName(e);i.scene.selectEntity(t)}),this.emitter.on("openEntityPopup",function(e,t){if(!isTouchDevice){var n=i.scene.getByName(t);i.openEntityPopup(e,n)}}),this.emitter.on("setPoseStats",function(e,t){var n;n=void 0===t?i.scene.getByName(e):i.scene.getByName(t);var r={};r.name=n.name,r.pose={},r.pose.position={x:n.position.x,y:n.position.y,z:n.position.z},r.pose.orientation={x:n.quaternion._x,y:n.quaternion._y,z:n.quaternion._z,w:n.quaternion._w},n.children[0]instanceof THREE.Light?i.setLightStats(r,"update"):i.setModelStats(r,"update")}),this.emitter.on("resizePanel",function(){if($(".leftPanels").is(":visible")&&(isWideScreen()?$(".tab").css("left","23em"):$(".tab").css("left","10.5em")),$(".propertyPanels").is(":visible")){var e=$(window).width();isWideScreen()&&(e=emUnits(23)),$(".propertyPanels").css("width",e)}}),this.emitter.on("setPose",function(e,t,n,r){if(void 0!==r){var o=i.scene.getByName(n);if("orientation"===e?(o.rotation["_"+t]=r,o.quaternion.setFromEuler(o.rotation)):o[e][t]=r,o.updateMatrixWorld(),o.children[0]&&(o.children[0]instanceof THREE.SpotLight||o.children[0]instanceof THREE.DirectionalLight)){var a=o.children[0],s=new THREE.Vector3(0,0,0);s.copy(o.direction),o.localToWorld(s),a.target.position.copy(s)}i.scene.emitter.emit("entityChanged",o)}}),this.emitter.on("setLight",function(e,t,n){if(void 0!==n){var r=i.scene.getByName(t),o=r.children[0];"diffuse"===e?o.color=new THREE.Color(n):"specular"===e?r.serverProperties.specular=new THREE.Color(n):"range"===e?o.distance=n:"attenuation_constant"===e?r.serverProperties.attenuation_constant=n:"attenuation_linear"===e?(r.serverProperties.attenuation_linear=n,o.intensity=o.intensity/(1+n)):"attenuation_quadratic"===e&&(r.serverProperties.attenuation_quadratic=n,o.intensity=o.intensity/(1+n)),i.scene.emitter.emit("entityChanged",r)}}),this.emitter.on("toggleProperty",function(e,t){var n=i.scene.getByName(t);n.serverProperties[e]=!n.serverProperties[e],i.scene.emitter.emit("linkChanged",n)}),this.emitter.on("setLightStats",function(e,t){i.setLightStats(e,t)}),this.emitter.on("setModelStats",function(e,t){i.setModelStats(e,t)}),this.emitter.on("setSceneStats",function(e){i.setSceneStats(e)}),this.emitter.on("setPhysicsStats",function(e){i.setPhysicsStats(e)}),this.emitter.on("setPaused",function(e){i.setPaused(e)}),this.emitter.on("setLogPlayVisible",function(e){i.setLogPlayVisible(e)}),this.emitter.on("setLogPlayStats",function(e,t,n){i.setLogPlayStats(e,t,n)}),this.emitter.on("setRealTime",function(e){i.setRealTime(e)}),this.emitter.on("setSimTime",function(e){i.setSimTime(e)})},GZ3D.Gui.prototype.setPaused=function(e){e?$("#playText").html('<img style="height:1.2em" src="style/images/play.png" title="Play">'):$("#playText").html('<img style="height:1.2em" src="style/images/pause.png" title="Pause">'),this.emitter.emit("paused",e)},GZ3D.Gui.prototype.setRealTime=function(e){$(".real-time-value").text(formatTime(e))},GZ3D.Gui.prototype.setSimTime=function(e){$(".sim-time-value").text(formatTime(e))};var sceneStats={};GZ3D.Gui.prototype.setSceneStats=function(e){sceneStats.ambient=this.round(e.ambient,!0),sceneStats.background=this.round(e.background,!0)};var physicsStats={};GZ3D.Gui.prototype.setPhysicsStats=function(e){(physicsStats=e).enable_physics=this.trueOrFalse(physicsStats.enable_physics),physicsStats.max_step_size=this.round(physicsStats.max_step_size,!1,3),physicsStats.gravity=this.round(physicsStats.gravity,!1,3),physicsStats.sor=this.round(physicsStats.sor,!1,3),physicsStats.cfm=this.round(physicsStats.cfm,!1,3),physicsStats.erp=this.round(physicsStats.erp,!1,3),physicsStats.contact_max_correcting_vel=this.round(physicsStats.contact_max_correcting_vel,!1,3),physicsStats.contact_surface_layer=this.round(physicsStats.contact_surface_layer,!1,3),this.updateStats()};var modelStats=[];GZ3D.Gui.prototype.setModelStats=function(e,t){var i,n=e.name;if(e.name.indexOf("::")>=0&&(n=e.name.substring(0,e.name.indexOf("::")),i=e.name.substring(e.name.lastIndexOf("::")+2)),"update"===t){var r,o=$.grep(modelStats,function(e){return e.name===n});if(0===o.length){var a=this.findModelThumbnail(n);r=this.formatStats(e),modelStats.push({name:n,id:convertNameId(n),thumbnail:a,selected:"unselectedTreeItem",is_static:this.trueOrFalse(e.is_static),position:r.pose.position,orientation:r.pose.orientation,links:[],joints:[]});var s=modelStats[modelStats.length-1];if(e.link)for(var l=0;l<e.link.length;++l){var c=e.link[l].name.substring(e.link[l].name.lastIndexOf("::")+2);r=this.formatStats(e.link[l]),s.links.push({name:e.link[l].name,shortName:c,self_collide:this.trueOrFalse(e.link[l].self_collide),gravity:this.trueOrFalse(e.link[l].gravity),kinematic:this.trueOrFalse(e.link[l].kinematic),canonical:this.trueOrFalse(e.link[l].canonical),position:r.pose.position,orientation:r.pose.orientation,inertial:r.inertial})}if(e.joint)for(var u=0;u<e.joint.length;++u){var h,d=e.joint[u].name.substring(e.joint[u].name.lastIndexOf("::")+2),p=e.joint[u].parent.substring(e.joint[u].parent.lastIndexOf("::")+2),f=e.joint[u].child.substring(e.joint[u].child.lastIndexOf("::")+2);switch(e.joint[u].type){case 1:h="Revolute";break;case 2:h="Revolute2";break;case 3:h="Prismatic";break;case 4:h="Universal";break;case 5:h="Ball";break;case 6:h="Screw";break;case 7:h="Gearbox";break;default:h="Unknown"}r=this.formatStats(e.joint[u]),s.joints.push({name:e.joint[u].name,shortName:d,type:h,parent:e.joint[u].parent,parentShortName:p,child:e.joint[u].child,childShortName:f,position:r.pose.position,orientation:r.pose.orientation,axis1:r.axis1,axis2:r.axis2})}this.updateStats()}else{var m;if(e.link&&e.link[0]){var g=e.link[0].name;(m=$.grep(o[0].links,function(e){return e.shortName===g}))[0]&&(m[0].self_collide&&(m[0].self_collide=this.trueOrFalse(e.link[0].self_collide)),m[0].gravity&&(m[0].gravity=this.trueOrFalse(e.link[0].gravity)),m[0].kinematic&&(m[0].kinematic=this.trueOrFalse(e.link[0].kinematic)))}var v=convertNameId(n);i&&!$("#expandable-pose-"+v+"-"+i).is(":visible")||!i&&!$("#expandable-pose-"+v).is(":visible")||$("#expandable-pose-"+v+" input").is(":focus")||(e.position&&(e.pose={},e.pose.position=e.position,e.pose.orientation=e.orientation),e.pose&&(r=this.formatStats(e),void 0===i?(o[0].position=r.pose.position,o[0].orientation=r.pose.orientation):((m=$.grep(o[0].links,function(e){return e.shortName===i}))[0].position=r.pose.position,m[0].orientation=r.pose.orientation)),this.updateModelStatsAsync())}}else"delete"===t&&(this.deleteFromStats("model",n),this.updateStats())};var lightStats=[];GZ3D.Gui.prototype.setLightStats=function(e,t){var i=e.name;if("update"===t){var n,r=$.grep(lightStats,function(e){return e.name===i});if(0===r.length){var o,a;switch(e.type){case 2:o="style/images/spotlight.png";break;case 3:o="style/images/directionallight.png";break;default:o="style/images/pointlight.png"}e.attenuation={constant:e.attenuation_constant,linear:e.attenuation_linear,quadratic:e.attenuation_quadratic},n=this.formatStats(e),e.direction&&(a=e.direction),lightStats.push({name:i,id:convertNameId(i),thumbnail:o,selected:"unselectedTreeItem",position:n.pose.position,orientation:n.pose.orientation,diffuse:n.diffuse,specular:n.specular,color:n.color,range:e.range,attenuation:this.round(e.attenuation,!1,null),direction:a})}else n=this.formatStats(e),e.pose&&(r[0].position=n.pose.position,r[0].orientation=n.pose.orientation),e.diffuse&&(r[0].diffuse=n.diffuse),e.specular&&(r[0].specular=n.specular)}else"delete"===t&&this.deleteFromStats("light",i);this.updateStats()},GZ3D.Gui.prototype.findModelThumbnail=function(e){for(var t=0;t<modelList.length;++t)for(var i=0;i<modelList[t].models.length;++i){var n=modelList[t].models[i].modelPath;if(e.indexOf(n)>=0)return"assets/"+n+"/thumbnails/0.png"}return e.indexOf("box")>=0?"style/images/box.png":e.indexOf("sphere")>=0?"style/images/sphere.png":e.indexOf("cylinder")>=0?"style/images/cylinder.png":"style/images/box.png"},GZ3D.Gui.prototype.updateStats=function(){},GZ3D.Gui.prototype.updateModelStatsAsync=function(){this.modelStatsDirty=!0},GZ3D.Gui.prototype.openEntityPopup=function(e,t){this.scene.selectEntity(t),$(".ui-popup").popup("close"),t.children[0]instanceof THREE.Light?($("#view-transparent").css("visibility","collapse"),$("#view-wireframe").css("visibility","collapse"),$("#view-joints").css("visibility","collapse"),$("#view-com").css("visibility","collapse"),$("#view-inertia").css("visibility","collapse"),$("#model-popup").popup("open",{x:e.clientX+emUnits(6),y:e.clientY+emUnits(-8)})):("transparent"===this.scene.selectedEntity.viewAs?$("#view-transparent").buttonMarkup({icon:"check"}):$("#view-transparent").buttonMarkup({icon:"false"}),"wireframe"===this.scene.selectedEntity.viewAs?$("#view-wireframe").buttonMarkup({icon:"check"}):$("#view-wireframe").buttonMarkup({icon:"false"}),0===t.children.length?($("#view-inertia a").css("color","#888888"),$("#view-inertia").buttonMarkup({icon:"false"}),$("#view-com a").css("color","#888888"),$("#view-com").buttonMarkup({icon:"false"})):($("#view-inertia a").css("color","#ffffff"),$("#view-com a").css("color","#ffffff"),t.getObjectByName("INERTIA_VISUAL",!0)?$("#view-inertia").buttonMarkup({icon:"check"}):$("#view-inertia").buttonMarkup({icon:"false"}),t.getObjectByName("COM_VISUAL",!0)?$("#view-com").buttonMarkup({icon:"check"}):$("#view-com").buttonMarkup({icon:"false"})),void 0===t.joint||0===t.joint.length?($("#view-joints a").css("color","#888888"),$("#view-joints").buttonMarkup({icon:"false"})):($("#view-joints a").css("color","#ffffff"),t.getObjectByName("JOINT_VISUAL",!0)?$("#view-joints").buttonMarkup({icon:"check"}):$("#view-joints").buttonMarkup({icon:"false"})),$("#view-transparent").css("visibility","visible"),$("#view-wireframe").css("visibility","visible"),$("#view-joints").css("visibility","visible"),$("#view-com").css("visibility","visible"),$("#view-inertia").css("visibility","visible"),$("#model-popup").popup("open",{x:e.clientX+emUnits(6),y:e.clientY+emUnits(0)}))},GZ3D.Gui.prototype.formatStats=function(e){var t,i,n,r,o,a,s,l;if(e.pose&&(t=this.round(e.pose.position,!1,null),n=new THREE.Quaternion(e.pose.orientation.x,e.pose.orientation.y,e.pose.orientation.z,e.pose.orientation.w),(r=new THREE.Euler).setFromQuaternion(n),i={roll:r._x,pitch:r._y,yaw:r._z},i=this.round(i,!1,null)),e.inertial){o=this.round(e.inertial,!1,3);var c=e.inertial.pose;o.pose={},o.pose.position={x:c.position.x,y:c.position.y,z:c.position.z},o.pose.position=this.round(o.pose.position,!1,3),n=new THREE.Quaternion(c.orientation.x,c.orientation.y,c.orientation.z,c.orientation.w),(r=new THREE.Euler).setFromQuaternion(n),o.pose.orientation={roll:r._x,pitch:r._y,yaw:r._z},o.pose.orientation=this.round(o.pose.orientation,!1,3)}var u,h,d,p={};if(e.diffuse){for(l in s={},a=this.round(e.diffuse,!0))s[l]=a[l].toString(16),1===s[l].length&&(s[l]="0"+s[l]);p.diffuse="#"+s.r+s.g+s.b}if(e.specular){for(l in s={},u=this.round(e.specular,!0))s[l]=u[l].toString(16),1===s[l].length&&(s[l]="0"+s[l]);p.specular="#"+s.r+s.g+s.b}return e.axis1&&(h={},(h=this.round(e.axis1)).direction=this.round(e.axis1.xyz,!1,3)),e.axis2&&(d={},(d=this.round(e.axis2)).direction=this.round(e.axis2.xyz,!1,3)),{pose:{position:t,orientation:i},inertial:o,diffuse:a,specular:u,color:p,axis1:h,axis2:d}},GZ3D.Gui.prototype.round=function(e,t,i){var n=e;return n="number"==typeof n?this.roundNumber(n,t,i):this.roundArray(n,t,i)},GZ3D.Gui.prototype.roundNumber=function(e,t,i){var n=e;return n=t?Math.round(255*n):null===i?Math.round(1e3*n)/1e3:n.toFixed(i)},GZ3D.Gui.prototype.roundArray=function(e,t,i){var n=e;for(var r in n)"number"==typeof n[r]&&(n[r]=this.roundNumber(n[r],t,i));return n},GZ3D.Gui.prototype.trueOrFalse=function(e){return e?{icon:"true",title:"True"}:{icon:"false",title:"False"}},GZ3D.Gui.prototype.deleteFromStats=function(e,t){for(var i="model"===e?modelStats:lightStats,n=0;n<i.length;++n)if(i[n].name===t){$("#propertyPanel-"+convertNameId(t)).is(":visible")&&this.emitter.emit("openTab","treeMenu","treeMenu"),i.splice(n,1);break}},GZ3D.Gui.prototype.setLogPlayVisible=function(e){e!==this.logPlay.isVisible()&&(this.logPlay.setVisible(e),e?($("#editMenu").hide(),$("#insertMenuTab").hide(),$("#manipulatorModeFieldset").hide(),$("#simpleShapesFieldset").hide(),$("#lightsFieldset").hide(),$("#clock-mouse").hide(),$("#clock-header-fieldset").hide(),$("#play-header-fieldset").hide()):($("#editMenu").show(),$("#insertMenuTab").show(),$("#manipulatorModeFieldset").show(),$("#simpleShapesFieldset").show(),$("#lightsFieldset").show(),$("#clock-mouse").show(),$("#clock-header-fieldset").show(),$("#play-header-fieldset").show()))},GZ3D.Gui.prototype.setLogPlayStats=function(e,t,i){this.logPlay.setStats(e,t,i),$(".end-time-value").text(formatTime(i))};var convertNameId=function(e,t){return t?e.replace(new RegExp("_gzspace_","g")," "):e.replace(new RegExp(" ","g"),"_gzspace_")},formatTime=function(e){var t=e.sec,i=e.nsec;t-=86400*Math.floor(t/86400);var n=Math.floor(t/3600);t-=3600*n;var r=Math.floor(t/60);t-=60*r;var o=Math.floor(1e-6*i),a="";return n<10&&(a+="0"),a+=n.toFixed(0)+":",r<10&&(a+="0"),a+=r.toFixed(0)+":",t<10&&(a+="0"),a+=t.toFixed(0)+".",a+=("00"+o.toFixed(0)).slice(-3)};GZ3D.GZIface=function(e,t){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.scene=e,this.url=t||location.hostname+":"+location.port+location.pathname,this.protocol=location.protocol,this.secure="https:"===location.protocol,this.isConnected=!1,this.material=[],this.entityMaterial={},this.connect(),this.visualsToAdd=[],this.numConnectionTrials=0,this.maxConnectionTrials=30,this.timeToSleepBtwTrials=1e3},GZ3D.GZIface.prototype.connect=function(){this.webSocket=new ROSLIB.Ros({url:(this.secure?"wss://":"ws://")+this.url});var e=this;this.webSocket.on("connection",function(){e.onConnected()}),this.webSocket.on("error",function(){e.onError()}),this.webSocket.on("close",function(){setTimeout(function(){e.connect()},1e4)}),this.numConnectionTrials++},GZ3D.GZIface.prototype.onError=function(){1===this.numConnectionTrials&&this.emitter.emit("connectionError");var e=this;this.numConnectionTrials<this.maxConnectionTrials&&setTimeout(function(){e.connect()},this.timeToSleepBtwTrials)},GZ3D.GZIface.prototype.onConnected=function(){this.isConnected=!0,this.emitter.emit("connection"),this.heartbeatTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/heartbeat",messageType:"heartbeat"});var e=this;setInterval(function(){e.heartbeatTopic.publish({alive:1})},5e3);new ROSLIB.Topic({ros:this.webSocket,name:"~/status",messageType:"status"}).subscribe(function(t){"error"===t.status&&(e.isConnected=!1,this.emitter.emit("gzstatus","error"))}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/material",messageType:"material"}).subscribe(function(e){this.material=e,this.emitter.emit("material",this.material)}.bind(this)),this.sceneTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/scene",messageType:"scene"});this.sceneTopic.subscribe(function(e){if(e.name&&(this.scene.name=e.name),!0===e.grid&&this.emitter.emit("show_grid","show"),e.ambient){var t=new THREE.Color;t.r=e.ambient.r,t.g=e.ambient.g,t.b=e.ambient.b,this.scene.ambient.color=t}if(e.background){var i=new THREE.Color;i.r=e.background.r,i.g=e.background.g,i.b=e.background.b,this.scene.renderer.clear(),this.scene.renderer.setClearColor(i,1)}for(var n=0;n<e.light.length;++n){var r=e.light[n],o=this.createLightFromMsg(r);this.scene.add(o),this.emitter.emit("setLightStats",r,"update")}for(var a=0;a<e.model.length;++a){var s=e.model[a],l=this.createModelFromMsg(s);this.scene.add(l),this.emitter.emit("setModelStats",s,"update")}this.emitter.emit("setSceneStats",e),this.sceneTopic.unsubscribe()}.bind(this)),this.physicsTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/physics",messageType:"physics"});this.physicsTopic.subscribe(function(e){this.emitter.emit("setPhysicsStats",e)}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/pose/info",messageType:"pose"}).subscribe(function(e){var t=this.scene.getByName(e.name);t&&t!==this.scene.modelManipulator.object&&t.parent!==this.scene.modelManipulator.object&&(this.scene.updatePose(t,e.position,e.orientation),this.emitter.emit("setModelStats",e,"update"))}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/request",messageType:"request"}).subscribe(function(e){if("entity_delete"===e.request){var t=this.scene.getByName(e.data);t&&(t.children[0]instanceof THREE.Light?(this.emitter.emit("setLightStats",{name:e.data},"delete"),this.emitter.emit("notification_popup",e.data+" deleted")):(this.emitter.emit("setModelStats",{name:e.data},"delete"),this.emitter.emit("notification_popup",e.data+" deleted")),this.scene.remove(t))}}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/model/info",messageType:"model"}).subscribe(function(e){if(!this.scene.getByName(e.name)){var t=this.createModelFromMsg(e);t&&(this.scene.add(t),this.emitter.emit("notification_popup",e.name+" inserted"));for(var i=this.visualsToAdd.length,n=0,r=0;n<i;){var o=this.visualsToAdd[r].parent_name;if(o.indexOf(t.name)>=0){var a=this.scene.getByName(o),s=this.createVisualFromMsg(this.visualsToAdd[r]);a.add(s),this.visualsToAdd.splice(r,1)}else r++;n++}}this.emitter.emit("setModelStats",e,"update")}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/visual",messageType:"visual"}).subscribe(function(e){if(!this.scene.getByName(e.name)){if(e.name.indexOf("COLLISION_VISUAL")<0)return;var t=this.scene.getByName(e.parent_name);if(e.parent_name&&!t)this.visualsToAdd.push(e);else{var i=this.createVisualFromMsg(e);t.add(i)}}}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/world_stats",messageType:"world_stats"}).subscribe(function(e){this.forwardWorldStats(e)}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/factory/light",messageType:"light"}).subscribe(function(e){if(!this.scene.getByName(e.name)){var t=this.createLightFromMsg(e);this.scene.add(t);var i=[];this.scene.scene.getDescendants(i);for(var n=0;n<i.length;++n)i[n].material&&(i[n].material.needsUpdate=!0);this.emitter.emit("notification_popup",e.name+" inserted")}this.emitter.emit("setLightStats",e,"update")}.bind(this));new ROSLIB.Topic({ros:this.webSocket,name:"~/light/modify",messageType:"light"}).subscribe(function(e){var t=this.scene.getByName(e.name);t&&t!==this.scene.modelManipulator.object&&t.parent!==this.scene.modelManipulator.object&&(this.scene.updateLight(t,e),this.emitter.emit("setLightStats",e,"update"))}.bind(this)),this.heightmapDataService=new ROSLIB.Service({ros:this.webSocket,name:"~/heightmap_data",serviceType:"heightmap_data"}),this.roadService=new ROSLIB.Service({ros:this.webSocket,name:"~/roads",serviceType:"roads"});var t=new ROSLIB.ServiceRequest({name:"roads"});this.roadService.callService(t,function(t){var i=e.createRoadsFromMsg(t);this.scene.add(i)}),this.modelModifyTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/model/modify",messageType:"model"}),this.lightModifyTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/light/modify",messageType:"light"});this.emitter.on("entityChanged",function(t){var i=t.matrixWorld,n=new THREE.Vector3,r=new THREE.Quaternion,o=new THREE.Vector3;i.decompose(n,r,o);var a={name:t.name,id:t.userData.id,createEntity:0,position:{x:n.x,y:n.y,z:n.z},orientation:{w:r.w,x:r.x,y:r.y,z:r.z}};t.children[0]&&t.children[0]instanceof THREE.Light?(a.diffuse={r:t.children[0].color.r,g:t.children[0].color.g,b:t.children[0].color.b},a.specular={r:t.serverProperties.specular.r,g:t.serverProperties.specular.g,b:t.serverProperties.specular.b},a.direction=t.direction,a.range=t.children[0].distance,a.attenuation_constant=t.serverProperties.attenuation_constant,a.attenuation_linear=t.serverProperties.attenuation_linear,a.attenuation_quadratic=t.serverProperties.attenuation_quadratic,e.lightModifyTopic.publish(a)):e.modelModifyTopic.publish(a)}),this.linkModifyTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/link",messageType:"link"});this.emitter.on("linkChanged",function(t,i){var n={name:t.parent.name,id:t.parent.userData.id,link:{name:t.name,id:t.userData.id,self_collide:t.serverProperties.self_collide,gravity:t.serverProperties.gravity,kinematic:t.serverProperties.kinematic}};e.linkModifyTopic.publish(n)}),this.factoryTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/factory",messageType:"factory"}),this.lightFactoryTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/factory/light",messageType:"light"});this.deleteTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/entity_delete",messageType:"entity_delete"});this.emitter.on("deleteEntity",function(t){!function(t){var i={name:t.name};e.deleteTopic.publish(i)}(t)}),this.worldControlTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/world_control",messageType:"world_control"});var i=function(t,i){var n={};null!==t&&(n.pause=t),i&&(n.reset=i),e.worldControlTopic.publish(n)};this.emitter.on("entityCreated",function(t,i){var n=t.matrixWorld,r=new THREE.Vector3,o=new THREE.Quaternion,a=new THREE.Vector3;n.decompose(r,o,a);var s={name:t.name,type:i,createEntity:1,position:{x:r.x,y:r.y,z:r.z},orientation:{w:o.w,x:o.x,y:o.y,z:o.z}};t.children[0].children[0]instanceof THREE.Light?e.lightFactoryTopic.publish(s):e.factoryTopic.publish(s)}),this.emitter.on("reset",function(e){i(null,e)}),this.emitter.on("pause",function(e){i(e,null)}),this.playbackControlTopic=new ROSLIB.Topic({ros:this.webSocket,name:"~/playback_control",messageType:"playback_control"});this.emitter.on("logPlayChanged",function(t){e.playbackControlTopic.publish(t)})},GZ3D.GZIface.prototype.forwardWorldStats=function(e){void 0!==e.paused&&this.emitter.emit("setPaused",e.paused),e.log_playback_stats?(this.emitter.emit("setLogPlayVisible",!0),this.emitter.emit("setLogPlayStats",e.sim_time,e.log_playback_stats.start_time,e.log_playback_stats.end_time)):(this.emitter.emit("setLogPlayVisible",!1),this.emitter.emit("setRealTime",e.real_time)),this.emitter.emit("setSimTime",e.sim_time)},GZ3D.GZIface.prototype.createModelFromMsg=function(e){var t=new THREE.Object3D;t.name=e.name,t.userData.id=e.id,e.pose&&this.scene.setPose(t,e.pose.position,e.pose.orientation);for(var i=0;i<e.link.length;++i){var n=e.link[i],r=new THREE.Object3D;if(r.name=n.name,r.userData.id=n.id,r.serverProperties={self_collide:n.self_collide,gravity:n.gravity,kinematic:n.kinematic},n.inertial){var o,a,s={};r.userData.inertial={},o=n.inertial.pose,a=n.inertial.mass,s.ixx=n.inertial.ixx,s.ixy=n.inertial.ixy,s.ixz=n.inertial.ixz,s.iyy=n.inertial.iyy,s.iyz=n.inertial.iyz,s.izz=n.inertial.izz,r.userData.inertial.inertia=s,a&&(r.userData.inertial.mass=a),o&&(r.userData.inertial.pose=o)}n.pose&&this.scene.setPose(r,n.pose.position,n.pose.orientation),t.add(r);for(var l=0;l<n.visual.length;++l){var c=n.visual[l],u=this.createVisualFromMsg(c);u&&!u.parent&&r.add(u)}for(var h=0;h<n.collision.length;++h){n.collision[h];for(var d=0;d<n.collision[h].visual.length;++d){var p=n.collision[h].visual[d],f=this.createVisualFromMsg(p);f&&!f.parent&&r.add(f)}}}return e.joint&&(t.joint=e.joint),t},GZ3D.GZIface.prototype.createVisualFromMsg=function(e){if(e.geometry){var t=e.geometry,i=new THREE.Object3D;return i.name=e.name,e.pose&&this.scene.setPose(i,e.pose.position,e.pose.orientation),i.castShadow=e.cast_shadows,i.receiveShadow=e.receive_shadows,this.createGeom(t,e.material,i),i}},GZ3D.GZIface.prototype.createLightFromMsg=function(e){var t,i;1===e.type?(i=null,t=e.range):2===e.type?(i=e.direction,t=e.range):3===e.type&&(i=e.direction,t=null);var n=e.attenuation_linear,r=e.attenuation_quadratic,o=1/(1+1*n)*1*(Math.pow(1,2)/(Math.pow(1,2)+r*Math.pow(1,2)));return this.scene.createLight(e.type,e.diffuse,o,e.pose,t,e.cast_shadows,e.name,i,e.specular,e.attenuation_constant,e.attenuation_linear,e.attenuation_quadratic)},GZ3D.GZIface.prototype.createRoadsFromMsg=function(e){var t=new THREE.Object3D,i=this.material["Gazebo/Road"],n=null;i&&(n=this.parseUri("media/materials/textures/"+i.texture));var r=this.scene.createRoads(e.point,e.width,n);return t.add(r),t},GZ3D.GZIface.prototype.parseUri=function(e){var t=e.indexOf("://");return t>0&&(t+=3),"assets/"+e.substring(t)},GZ3D.GZIface.prototype.createGeom=function(e,t,i){var n,r=this,o=this.parseMaterial(t);if(e.box)n=this.scene.createBox(e.box.size.x,e.box.size.y,e.box.size.z);else if(e.cylinder)n=this.scene.createCylinder(e.cylinder.radius,e.cylinder.length);else if(e.sphere)n=this.scene.createSphere(e.sphere.radius);else if(e.plane)n=this.scene.createPlane(e.plane.normal.x,e.plane.normal.y,e.plane.normal.z,e.plane.size.x,e.plane.size.y);else if(e.mesh){for(var a=i;a.parent;)a=a.parent;var s=e.mesh.filename,l=e.mesh.submesh,c=e.mesh.center_submesh,u=s.substring(0,s.indexOf("://")),h="";if("file"===u||"model"===u)h=s.substring(s.indexOf("://")+3);else if(s.length>0&&"/"===s[0]){var d=s.indexOf("/meshes/");d>1&&(h=s.substring(s.lastIndexOf("/",d-1)))}if(h.length>0){e.mesh.scale&&(i.scale.x=e.mesh.scale.x,i.scale.y=e.mesh.scale.y,i.scale.z=e.mesh.scale.z);var p="assets/"+h;if(-1!==p.indexOf(".dae")&&isTouchDevice){p=p.substring(0,p.indexOf(".dae"));var f=new XMLHttpRequest;f.open("HEAD",p+"_coarse.dae",!1),f.send(),404===f.status?p+=".dae":p+="_coarse.dae"}var m=p.substr(-4).toLowerCase(),g=i.name+"::"+p;this.entityMaterial[g]=o,p=this.protocol+"//"+this.url+"/"+p,this.scene.loadMeshFromUri(p,l,c,function(e){if(o)if(-1===p.indexOf(".stl")){var t=[];e.getDescendants(t);for(var n=0;n<t.length;++n)if(t[n]instanceof THREE.Mesh){r.scene.setMaterial(t[n],o);break}}else r.scene.setMaterial(e,o);else".stl"===m&&r.scene.setMaterial(e,{ambient:[1,1,1,1]});i.add(e),x(i)})}}else if(e.heightmap){for(var v=new ROSLIB.ServiceRequest({name:r.scene.name}),y=e.heightmap.texture,b=0;b<y.length;++b)y[b].diffuse=this.parseUri(y[b].diffuse),y[b].normal=this.parseUri(y[b].normal);e.heightmap.size;this.heightmapDataService.callService(v,function(t){var n=t.heightmap;r.scene.loadHeightmap(n.heights,n.size.x,n.size.y,n.width,n.height,n.origin,y,e.heightmap.blend,i)})}function x(e){var t=[];e.getDescendants(t);for(var i=0;i<t.length;++i)if(t[i]instanceof THREE.Mesh){t[i].castShadow=!0,t[i].receiveShadow=!0,e.castShadows&&(t[i].castShadow=e.castShadows),e.receiveShadows&&(t[i].receiveShadow=e.receiveShadows),e.name.indexOf("COLLISION_VISUAL")>=0&&(t[i].castShadow=!1,t[i].receiveShadow=!1,t[i].visible=this.scene.showCollisions);break}}n&&(o&&this.scene.setMaterial(n,o),n.updateMatrix(),i.add(n),x(i))},GZ3D.GZIface.prototype.parseMaterial=function(e){if(!e)return null;var t,i,n,r,o,a,s,l,c,u,h=this.protocol+"//"+this.url+"/assets",d=e.script;if(d&&d.name&&(c=this.material[d.name])){r=c.ambient,o=c.diffuse,a=c.specular,s=c.opacity,l=c.scale;var p=c.texture;if(p){for(var f=0;f<d.uri.length;++f){var m=d.uri[f];"__default__"===m&&(m="file://media/materials/scripts/gazebo.material");var g=m.substring(0,m.indexOf("://"));if("model"===g){if(m.indexOf("textures")>0){n=m.substring(m.indexOf("://")+3);break}}else if("file"===g&&m.indexOf("materials")>0){n=m.substring(m.indexOf("://")+3,m.indexOf("materials")+9)+"/textures";break}}n&&(t=h+"/"+n+"/"+p)}}if(e.normal_map&&(u=e.normal_map.indexOf("://")>0?e.normal_map.substring(e.normal_map.indexOf("://")+3,e.normal_map.lastIndexOf("/")):n)){var v=e.normal_map.lastIndexOf("/")+1;v<0&&(v=0),i=h+"/"+u+"/"+e.normal_map.substr(v,e.normal_map.lastIndexOf(".")-v)+".png"}return{texture:t,normalMap:i,ambient:r,diffuse:o,specular:a,opacity:s,scale:l}};var nsInSec=1e9,correctTime=function(e){var t=0;e.sec>0&&e.nsec<0&&(t=Math.floor(Math.abs(e.nsec/nsInSec)+1),e.sec-=t,e.nsec+=t*nsInSec),e.sec<0&&e.nsec>0&&(t=Math.floor(Math.abs(e.nsec/nsInSec)+1),e.sec+=t,e.nsec-=t*nsInSec),e.sec+=Math.floor(e.nsec/nsInSec),e.nsec=Math.floor(e.nsec%nsInSec)},subtractTime=function(e,t){var i={};return i.sec=e.sec-t.sec,i.nsec=e.nsec-t.nsec,correctTime(i),i};GZ3D.LogPlay=function(){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.visible=null,this.startTime=null,this.endTime=null,this.active=!1,this.sliderRange=100,this.visible=!1;var e=this;this.emitter.on("logPlaySlideStop",function(t){if(e.startTime&&e.endTime){var i=t/e.sliderRange,n=e.startTime.sec+1e-9*e.startTime.nsec+i*(e.totalTime.sec+1e-9*e.totalTime.nsec),r={seek:{}};r.seek.sec=Math.floor(n),r.seek.nsec=Math.round((n-r.seek.sec)*nsInSec),e.emitter.emit("logPlayChanged",r),e.active=!1}}),this.emitter.on("logPlaySlideStart",function(){e.active=!0}),this.emitter.on("logPlayRewind",function(){var t={rewind:!0};e.emitter.emit("logPlayChanged",t)}),this.emitter.on("logPlayForward",function(){var t={forward:!0};e.emitter.emit("logPlayChanged",t)}),this.emitter.on("logPlayStepforward",function(){var t={multi_step:1};e.emitter.emit("logPlayChanged",t)}),this.emitter.on("logPlayStepback",function(){var t={multi_step:-1};e.emitter.emit("logPlayChanged",t)}),this.emitter.on("paused",function(e){e?$("#logplay-playText").html('<img style="height:1.2em" src="style/images/play.png" title="Play">'):$("#logplay-playText").html('<img style="height:1.2em" src="style/images/pause.png" title="Pause">')})},GZ3D.LogPlay.prototype.isVisible=function(){return this.visible},GZ3D.LogPlay.prototype.setVisible=function(e){e!==this.visible&&(this.visible=e,this.visible?$("#logplay").show():$("#logplay").hide())},GZ3D.LogPlay.prototype.setStats=function(e,t,i){if(this.simTime=e,this.startTime&&this.endTime&&this.totalTime&&this.startTime.sec===t.sec&&this.startTime.nsec===t.nsec&&this.endTime.sec===i.sec&&this.endTime.nsec===i.nsec||(this.startTime=t,this.endTime=i,this.totalTime=subtractTime(i,t)),!this.active){var n=subtractTime(this.simTime,this.startTime),r=(n.sec+1e-9*n.nsec)/(this.totalTime.sec+1e-9*this.totalTime.nsec);r=Math.max(r,0),$("#logplay-slider-input").val(r*this.sliderRange).slider("refresh"),$("#logplay-slider-input").text(r*this.sliderRange).slider("refresh")}},GZ3D.Manipulator=function(e,t,i,n){this.camera=e,this.domElement=void 0!==i?i:document,this.document=void 0!==n?n:document,this.mobile=void 0!==t&&t,this.object=void 0,this.mode="translate",this.space="world",this.hovered=!1,this.selected="null",this.scale=1,this.snapDist=null,this.modifierAxis=new THREE.Vector3(1,1,1),this.gizmo=new THREE.Object3D,this.pickerNames=[];var r=this,o={type:"change"},a=new THREE.Raycaster,s=new THREE.Vector2,l=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3,h=new THREE.Vector3,d=new THREE.Matrix4,p=new THREE.Vector3,f=new THREE.Matrix4,m=new THREE.Vector3,g=new THREE.Quaternion,v=new THREE.Vector3(1,0,0),y=new THREE.Vector3(0,1,0),b=new THREE.Vector3(0,0,1),x=new THREE.Quaternion,_=new THREE.Quaternion,w=new THREE.Quaternion,E=new THREE.Quaternion,T=new THREE.Quaternion,M=new THREE.Vector3,S=new THREE.Matrix4,C=new THREE.Matrix4,R=new THREE.Vector3,A=new THREE.Vector3,P=(new THREE.Vector3,new THREE.Matrix4),L=new THREE.Vector3,O=null,I=new THREE.Color,k=null,D=new THREE.Color,N={},H=["XY","YZ","XZ"],B="XY",F=new THREE.Object3D;this.gizmo.add(F);var U=new THREE.MeshBasicMaterial({visible:!1,side:THREE.DoubleSide});for(var $ in H)N[H[$]]=new THREE.Mesh(new THREE.PlaneGeometry(500,500),U),N[H[$]].material.side=THREE.DoubleSide,F.add(N[H[$]]);N.YZ.rotation.set(0,Math.PI/2,0),N.XZ.rotation.set(-Math.PI/2,0,0),me(N.YZ),me(N.XZ);var j,z,V={},G={},W=function(e,t){var i=new THREE.MeshBasicMaterial;return t&&(i.side=THREE.DoubleSide,i.depthTest=!1,i.depthWrite=!1),i.transparent=!0,i.setValues(e),void 0===e.opacity&&(i.opacity=.5),i},q=function(e,t){var i=new THREE.LineBasicMaterial;return i.color=e,i.depthTest=!1,i.depthWrite=!1,i.opacity=void 0!==t?t:1,i.transparent=!0,i},X=new THREE.Color(16777215),Z=new THREE.Color(8421504),Y=new THREE.Color(16711680),J=new THREE.Color(65280),K=new THREE.Color(255),Q=new THREE.Color(65535),ee=new THREE.Color(16711935),te=new THREE.Color(16776960);if(V.translate=new THREE.Object3D,G.translate=new THREE.Object3D,this.gizmo.add(V.translate),this.gizmo.add(G.translate),j=this.mobile?new THREE.CylinderGeometry(.5,.01,1.4,10,1,!1):new THREE.CylinderGeometry(.2,.1,.8,4,1,!1),(z=new THREE.Mesh(j,new W({color:Y,visible:!1,transparent:!1}))).position.x=.7,z.rotation.z=-Math.PI/2,me(z),z.name="TX",V.translate.add(z),this.pickerNames.push(z.name),(z=new THREE.Mesh(j,new W({color:J,visible:!1,transparent:!1}))).position.y=.7,me(z),z.name="TY",V.translate.add(z),this.pickerNames.push(z.name),(z=new THREE.Mesh(j,new W({color:K,visible:!1,transparent:!1}))).position.z=.7,z.rotation.x=Math.PI/2,me(z),z.name="TZ",V.translate.add(z),this.pickerNames.push(z.name),this.mobile){j=new THREE.CylinderGeometry(.1,.1,1,10,1,!1);var ie=new W({color:Y,transparent:!0},!0);(z=new THREE.Mesh(j,ie)).position.x=.5,z.rotation.z=-Math.PI/2,me(z),z.name="TX",G.translate.add(z);var ne=new W({color:J,transparent:!0},!0);(z=new THREE.Mesh(j,ne)).position.y=.5,me(z),z.name="TY",G.translate.add(z);var re=new W({color:K,transparent:!0},!0);(z=new THREE.Mesh(j,re)).position.z=.5,z.rotation.x=Math.PI/2,me(z),z.name="TZ",G.translate.add(z),j=new THREE.CylinderGeometry(0,.15,.4,10,1,!1),(z=new THREE.Mesh(j,ie)).position.x=1.2,z.rotation.z=-Math.PI/2,me(z),z.name="TX",G.translate.add(z),(z=new THREE.Mesh(j,ne)).position.y=1.2,me(z),z.name="TY",G.translate.add(z),(z=new THREE.Mesh(j,re)).position.z=1.2,z.rotation.x=Math.PI/2,me(z),z.name="TZ",G.translate.add(z)}else{(j=new THREE.Geometry).vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1)),j.colors.push(Y,Y,J,J,K,K);var oe=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});z=new THREE.Line(j,oe,THREE.LineSegments),G.translate.add(z),j=new THREE.CylinderGeometry(0,.05,.2,4,1,!0),(z=new THREE.Mesh(j,new W({color:Y,opacity:1},!0))).position.x=1.1,z.rotation.z=-Math.PI/2,me(z),z.name="TX",G.translate.add(z),(z=new THREE.Mesh(j,new W({color:J,opacity:1},!0))).position.y=1.1,me(z),z.name="TY",G.translate.add(z),(z=new THREE.Mesh(j,new W({color:K,opacity:1},!0))).position.z=1.1,z.rotation.x=Math.PI/2,me(z),z.name="TZ",G.translate.add(z),(z=new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new W({color:X,opacity:.25},!0))).name="TXYZ",this.pickerNames.push(z.name),G.translate.add(z),(z=new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new W({color:X,visible:!1},!0))).name="TXYZ",V.translate.add(z),j=new THREE.PlaneGeometry(.3,.3),(z=new THREE.Mesh(j,new W({color:te,opacity:.25},!0))).position.set(.15,.15,0),me(z),z.name="TXY",this.pickerNames.push(z.name),G.translate.add(z),(z=new THREE.Mesh(j,new W({color:te,visible:!1},!0))).position.set(.15,.15,0),me(z),z.name="TXY",V.translate.add(z),(z=new THREE.Mesh(j,new W({color:Q,opacity:.25},!0))).position.set(0,.15,.15),z.rotation.y=Math.PI/2,me(z),z.name="TYZ",this.pickerNames.push(z.name),G.translate.add(z),(z=new THREE.Mesh(j,new W({color:Q,visible:!1},!0))).position.set(0,.15,.15),z.rotation.y=Math.PI/2,me(z),z.name="TYZ",V.translate.add(z),(z=new THREE.Mesh(j,new W({color:ee,opacity:.25},!0))).position.set(.15,0,.15),z.rotation.x=Math.PI/2,me(z),z.name="TXZ",this.pickerNames.push(z.name),G.translate.add(z),(z=new THREE.Mesh(j,new W({color:ee,visible:!1},!0))).position.set(.15,0,.15),z.rotation.x=Math.PI/2,me(z),z.name="TXZ",V.translate.add(z)}if(V.rotate=new THREE.Object3D,G.rotate=new THREE.Object3D,this.gizmo.add(V.rotate),this.gizmo.add(G.rotate),j=this.mobile?new THREE.TorusGeometry(1,.3,4,36,2*Math.PI):new THREE.TorusGeometry(1,.15,4,6,Math.PI),(z=new THREE.Mesh(j,new W({color:Y,visible:!1,transparent:!1},!1))).rotation.z=-Math.PI/2,z.rotation.y=-Math.PI/2,me(z),z.name="RX",V.rotate.add(z),this.pickerNames.push(z.name),(z=new THREE.Mesh(j,new W({color:J,visible:!1,transparent:!1},!1))).rotation.z=Math.PI,z.rotation.x=-Math.PI/2,me(z),z.name="RY",V.rotate.add(z),this.pickerNames.push(z.name),(z=new THREE.Mesh(j,new W({color:K,visible:!1,transparent:!1},!1))).rotation.z=-Math.PI/2,me(z),z.name="RZ",V.rotate.add(z),this.pickerNames.push(z.name),this.mobile)j=new THREE.TorusGeometry(1,.1,4,36,2*Math.PI),(z=new THREE.Mesh(j,new W({color:K},!1))).rotation.z=-Math.PI/2,me(z),z.name="RZ",G.rotate.add(z),(z=new THREE.Mesh(j,new W({color:Y},!1))).rotation.z=-Math.PI/2,z.rotation.y=-Math.PI/2,me(z),z.name="RX",G.rotate.add(z),(z=new THREE.Mesh(j,new W({color:J},!1))).rotation.z=Math.PI,z.rotation.x=-Math.PI/2,me(z),z.name="RY",G.rotate.add(z);else{var ae=function(e,t,i){j=new THREE.Geometry,i=i||1;for(var n=0;n<=64*i;++n)"x"===t&&j.vertices.push(new THREE.Vector3(0,Math.cos(n/32*Math.PI),Math.sin(n/32*Math.PI)).multiplyScalar(e)),"y"===t&&j.vertices.push(new THREE.Vector3(Math.cos(n/32*Math.PI),0,Math.sin(n/32*Math.PI)).multiplyScalar(e)),"z"===t&&j.vertices.push(new THREE.Vector3(Math.sin(n/32*Math.PI),Math.cos(n/32*Math.PI),0).multiplyScalar(e));return j};(z=new THREE.Line(new ae(1,"x",.5),new q(Y))).name="RX",G.rotate.add(z),(z=new THREE.Line(new ae(1,"y",.5),new q(J))).name="RY",G.rotate.add(z),(z=new THREE.Line(new ae(1,"z",.5),new q(K))).name="RZ",G.rotate.add(z),(z=new THREE.Line(new ae(1,"z"),new q(Z))).name="RXYZE",this.pickerNames.push(z.name),G.rotate.add(z),(z=new THREE.Line(new ae(1.25,"z"),new q(te,.25))).name="RE",this.pickerNames.push(z.name),G.rotate.add(z),(z=new THREE.Mesh(new THREE.SphereGeometry(.95,12,12),new W({color:Z,visible:!1},!0))).name="RXYZE",V.rotate.add(z),this.pickerNames.push(z.name),N.SPHERE=new THREE.Mesh(new THREE.SphereGeometry(.95,12,12),new W({color:X,visible:!1},!0)),F.add(N.SPHERE),(z=new THREE.Mesh(new THREE.TorusGeometry(1.3,.15,4,12),new W({color:te,visible:!1},!0))).name="RE",V.rotate.add(z),this.pickerNames.push(z.name)}function se(e){e.preventDefault();var t=pe(e,V[r.mode].children);if(t){if(k!==t.object){var i=null;null!==k&&(i=G[r.mode].getObjectByName(k.name))&&i.material.color.copy(D),k=t.object,D.copy(k.material.color),(i=G[r.mode].getObjectByName(k.name))&&i.material.color.offsetHSL(0,0,-.3),r.dispatchEvent(o)}r.selected=k.name,r.hovered=!0,r.update(),r.setIntersectionPlane();var n=pe(e,[N[B]]);n&&(M.copy(r.object.position),S.extractRotation(r.object.matrix),P.extractRotation(r.object.matrixWorld),C.extractRotation(r.object.parent.matrixWorld),R.setFromMatrixScale(f.getInverse(r.object.parent.matrixWorld)),c.copy(n.point))}r.document.addEventListener("touchmove",he,!1),r.document.addEventListener("touchend",le,!1)}function le(){if(k){var e=G[r.mode].getObjectByName(k.name);e&&e.material.color.copy(D)}k=null,r.dispatchEvent(o),r.selected="null",r.hovered=!1,r.document.removeEventListener("touchmove",he,!1),r.document.removeEventListener("touchend",le,!1)}function ce(e){if(e.preventDefault(),0===e.button&&"null"===r.selected){var t=pe(e,V[r.mode].children),i=null;t?(O!==t.object&&(null!==O&&(i=G[r.mode].getObjectByName(O.name))&&i.material.color.copy(I),k=t.object,O=t.object,I.copy(O.material.color),(i=G[r.mode].getObjectByName(O.name))&&i.material.color.offsetHSL(0,0,-.3),r.dispatchEvent(o)),r.hovered=!0):null!==O&&((i=G[r.mode].getObjectByName(O.name))&&i.material.color.copy(I),O=null,r.dispatchEvent(o),r.hovered=!1)}r.document.addEventListener("mousemove",he,!1),r.document.addEventListener("mouseup",de,!1)}function ue(e){if(e.preventDefault(),0===e.button){if(pe(e,V[r.mode].children)){r.selected=k.name,r.update(),r.setIntersectionPlane();var t=pe(e,[N[B]]);t&&(M.copy(r.object.position),S.extractRotation(r.object.matrix),P.extractRotation(r.object.matrixWorld),C.extractRotation(r.object.parent.matrixWorld),R.setFromMatrixScale(f.getInverse(r.object.parent.matrixWorld)),c.copy(t.point))}r.document.addEventListener("mousemove",he,!1),r.document.addEventListener("mouseup",de,!1)}}function he(e){if("null"!==r.selected){e.preventDefault();var t=pe(e,[N[B]]);t&&(l.copy(t.point),"translate"===r.mode&&fe("T")?(l.sub(c),l.multiply(R),"local"===r.space&&(l.applyMatrix4(f.getInverse(P)),fe("X")&&1===r.modifierAxis.x||(l.x=0),fe("Y")&&1===r.modifierAxis.y||(l.y=0),fe("Z")&&1===r.modifierAxis.z||(l.z=0),fe("XYZ")&&l.set(0,0,0),l.applyMatrix4(S),r.object.position.copy(M),r.object.position.add(l)),("world"===r.space||fe("XYZ"))&&(fe("X")&&1===r.modifierAxis.x||(l.x=0),fe("Y")&&1===r.modifierAxis.y||(l.y=0),fe("Z")&&1===r.modifierAxis.z||(l.z=0),l.applyMatrix4(f.getInverse(C)),r.object.position.copy(M),r.object.position.add(l),r.snapDist&&(fe("X")&&(r.object.position.x=Math.round(r.object.position.x/r.snapDist)*r.snapDist),fe("Y")&&(r.object.position.y=Math.round(r.object.position.y/r.snapDist)*r.snapDist),fe("Z")&&(r.object.position.z=Math.round(r.object.position.z/r.snapDist)*r.snapDist)))):"rotate"===r.mode&&fe("R")&&(l.sub(A),l.multiply(R),m.copy(c).sub(A),m.multiply(R),"RE"===r.selected?(l.applyMatrix4(f.getInverse(d)),m.applyMatrix4(f.getInverse(d)),u.set(Math.atan2(l.z,l.y),Math.atan2(l.x,l.z),Math.atan2(l.y,l.x)),h.set(Math.atan2(m.z,m.y),Math.atan2(m.x,m.z),Math.atan2(m.y,m.x)),g.setFromRotationMatrix(f.getInverse(C)),T.setFromAxisAngle(p,u.z-h.z),x.setFromRotationMatrix(P),g.multiplyQuaternions(g,T),g.multiplyQuaternions(g,x),r.object.quaternion.copy(g)):"RXYZE"===r.selected?(T.setFromEuler(l.clone().cross(m).normalize()),g.setFromRotationMatrix(f.getInverse(C)),_.setFromAxisAngle(T,-l.clone().angleTo(m)),x.setFromRotationMatrix(P),g.multiplyQuaternions(g,_),g.multiplyQuaternions(g,x),r.object.quaternion.copy(g)):"local"===r.space?(l.applyMatrix4(f.getInverse(P)),m.applyMatrix4(f.getInverse(P)),u.set(Math.atan2(l.z,l.y),Math.atan2(l.x,l.z),Math.atan2(l.y,l.x)),h.set(Math.atan2(m.z,m.y),Math.atan2(m.x,m.z),Math.atan2(m.y,m.x)),x.setFromRotationMatrix(S),_.setFromAxisAngle(v,u.x-h.x),w.setFromAxisAngle(y,u.y-h.y),E.setFromAxisAngle(b,u.z-h.z),"RX"===r.selected&&x.multiplyQuaternions(x,_),"RY"===r.selected&&x.multiplyQuaternions(x,w),"RZ"===r.selected&&x.multiplyQuaternions(x,E),r.object.quaternion.copy(x)):"world"===r.space&&(u.set(Math.atan2(l.z,l.y),Math.atan2(l.x,l.z),Math.atan2(l.y,l.x)),h.set(Math.atan2(m.z,m.y),Math.atan2(m.x,m.z),Math.atan2(m.y,m.x)),g.setFromRotationMatrix(f.getInverse(C)),_.setFromAxisAngle(v,u.x-h.x),w.setFromAxisAngle(y,u.y-h.y),E.setFromAxisAngle(b,u.z-h.z),x.setFromRotationMatrix(P),"RX"===r.selected&&g.multiplyQuaternions(g,_),"RY"===r.selected&&g.multiplyQuaternions(g,w),"RZ"===r.selected&&g.multiplyQuaternions(g,E),g.multiplyQuaternions(g,x),r.object.quaternion.copy(g)))),r.update(),r.dispatchEvent(o)}}function de(e){r.selected="null",r.document.removeEventListener("mousemove",he,!1),r.document.removeEventListener("mouseup",de,!1)}function pe(e,t){var n=e.touches?e.touches[0]:e,o=i.getBoundingClientRect(),l=(n.clientX-o.left)/o.width,c=(n.clientY-o.top)/o.height;s.set(2*l-1,2*-c+1),a.setFromCamera(s,r.camera);var u=a.intersectObjects(t,!0);return!!u[0]&&u[0]}function fe(e){return-1!==r.selected.search(e)}function me(e){var t=new THREE.Geometry;e.updateMatrix(),t.merge(e.geometry,e.matrix),e.geometry=t,e.position.set(0,0,0),e.rotation.set(0,0,0),e.scale.set(1,1,1)}z=null,this.attach=function(e){this.object=e,this.setMode(r.mode),this.mobile?this.domElement.addEventListener("touchstart",se,!1):(this.domElement.addEventListener("mousedown",ue,!1),this.domElement.addEventListener("mousemove",ce,!1))},this.detach=function(e){this.object=void 0,this.selected="null",this.hide(),this.mobile?this.domElement.removeEventListener("touchstart",se,!1):(this.domElement.removeEventListener("mousedown",ue,!1),this.domElement.removeEventListener("mousemove",ce,!1))},this.update=function(){if(void 0!==this.object){this.object.updateMatrixWorld(),A.setFromMatrixPosition(this.object.matrixWorld),this.camera.updateMatrixWorld(),L.setFromMatrixPosition(this.camera.matrixWorld);var e=A.distanceTo(L)/6*this.scale;for(var t in this.gizmo.position.copy(A),this.gizmo.scale.set(e,e,e),this.gizmo.children)for(var i in this.gizmo.children[t].children){var n=this.gizmo.children[t].children[i],r=n.name;-1!==r.search("E")?(d.lookAt(L,A,m.set(0,1,0)),n.rotation.setFromRotationMatrix(d)):(p.copy(L).sub(A).normalize(),"local"===this.space?(g.setFromRotationMatrix(f.extractRotation(this.object.matrixWorld)),-1!==r.search("R")&&(f.makeRotationFromQuaternion(g).getInverse(f),p.applyMatrix4(f),"RX"===r&&(_.setFromAxisAngle(v,Math.atan2(-p.y,p.z)),g.multiplyQuaternions(g,_)),"RY"===r&&(w.setFromAxisAngle(y,Math.atan2(p.x,p.z)),g.multiplyQuaternions(g,w)),"RZ"===r&&(E.setFromAxisAngle(b,Math.atan2(p.y,p.x)),g.multiplyQuaternions(g,E))),n.quaternion.copy(g)):"world"===this.space&&(n.rotation.set(0,0,0),"RX"===r&&(n.rotation.x=Math.atan2(-p.y,p.z)),"RY"===r&&(n.rotation.y=Math.atan2(p.x,p.z)),"RZ"===r&&(n.rotation.z=Math.atan2(p.y,p.x))))}}},this.hide=function(){for(var e in G)for(var t in G[e].children)G[e].children[t].visible=!1},this.setMode=function(e){for(var t in r.mode=e,this.hide(),G[this.mode].children)G[this.mode].children[t].visible=!0;r.update()},this.setIntersectionPlane=function(){p.copy(L).sub(A).normalize(),"local"===this.space&&p.applyMatrix4(f.getInverse(r.object.matrixWorld)),fe("TXYZ")?B=Math.abs(p.x)>Math.abs(p.y)&&Math.abs(p.x)>Math.abs(p.z)?"YZ":Math.abs(p.y)>Math.abs(p.x)&&Math.abs(p.y)>Math.abs(p.z)?"XZ":"XY":fe("RX")||fe("TYZ")?B="YZ":fe("RY")||fe("TXZ")?B="XZ":fe("RZ")||fe("TXY")?B="XY":fe("X")?B=Math.abs(p.y)>Math.abs(p.z)?"XZ":"XY":fe("Y")?B=Math.abs(p.x)>Math.abs(p.z)?"YZ":"XY":fe("Z")&&(B=Math.abs(p.x)>Math.abs(p.y)?"YZ":"XZ")}},GZ3D.Manipulator.prototype=Object.create(THREE.EventDispatcher.prototype),GZ3D.OBJLoader=function(e,t,i,n,r,o){if(this.scene=e,this.submesh=i,this.centerSubmesh=n,this.callback=r,this.uri=t,this.files=o,this.usingRawFiles=this.files&&2===this.files.length&&this.files[0]&&this.files[1],this.objLoader=new THREE.OBJLoader,this.mtlLoader=new THREE.MTLLoader,this.mtlLoader.setCrossOrigin(""),!this.usingRawFiles){var a=this.uri.substr(0,this.uri.lastIndexOf("/")+1);this.mtlLoader.setPath(a)}this.container=void 0},GZ3D.OBJLoader.prototype.loadOBJ=function(){var e=this;if(this.usingRawFiles){var t=this.objLoader.parse(this.files[0]);this.onObjLoaded(t)}else this.objLoader.load(this.uri,function(t){e.onObjLoaded(t)})},GZ3D.OBJLoader.prototype.loadComplete=function(){var e=this.container;this.scene.meshes[this.uri]=e,e=e.clone(),this.scene.useSubMesh(e,this.submesh,this.centerSubmesh),e.name=this.uri,this.callback(e)},GZ3D.OBJLoader.prototype.applyMaterial=function(e){var t=[];this.container.getDescendants(t);for(var i=0;i<t.length;++i){var n=t[i];if(n&&n.material)if(n.material.name)n.material=e.create(n.material.name);else if(Array.isArray(n.material))for(var r=0;r<n.material.length;++r)n.material[r]=e.create(n.material[r].name)}this.loadComplete()},GZ3D.OBJLoader.prototype.loadMTL=function(e){if(e){if(e.indexOf("model://")>0)if(this.mtlLoader.path&&0!==this.mtlLoader.path.length){if(this.mtlLoader.path.indexOf("/meshes/")<0)return console.error("Failed to resolve texture URI. MTL file directory ["+this.mtlLoader.path+"] not supported, it should be in a /meshes directory"),void console.error(e);var t=this.mtlLoader.path;t=(t=t.substr(0,t.lastIndexOf("/meshes"))).substr(0,t.lastIndexOf("/")+1),e=e.replace(/model:\/\//g,t)}else e=e.replace(/model:\/\//g,"");var i=e.split("\n");if(0!==i.length){var n;for(var r in i){var o=i[r];if(void 0!==o)if(o.indexOf("map_Ka")<0&&o.indexOf("map_Kd")<0)n+=o+="\n";else if(o.indexOf("/materials/textures")>0&&!this.usingRawFiles)n+=o+="\n";else if(o.indexOf("../materials/textures")>0&&this.usingRawFiles)o=o.replace("../",""),n+=o+="\n";else{var a=this.mtlLoader.path||"";a=a.substr(0,a.lastIndexOf("meshes")),o=(o=o.replace("map_Ka ","map_Ka "+a+"materials/textures/")).replace("map_Kd ","map_Kd "+a+"materials/textures/"),n+=o+="\n"}}this.applyMaterial(this.mtlLoader.parse(n))}else console.error("Empty or no MTL file")}},GZ3D.OBJLoader.prototype.onObjLoaded=function(e){this.container=e;var t=this,i=function(e){t.loadMTL(e)};if(0!==this.container.materialLibraries.length)if(this.usingRawFiles)this.loadMTL(this.files[1]);else for(var n=0;n<this.container.materialLibraries.length;++n){var r=this.container.materialLibraries[n],o=new THREE.FileLoader(this.mtlLoader.manager);o.setPath(this.mtlLoader.path),o.load(r,i)}else this.loadComplete()},GZ3D.Ogre2Json=function(){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.materialObj=[],this.materials={}},GZ3D.Ogre2Json.prototype.LoadFromUrl=function(e){var t=(new THREE.FileLoader).load(e,function(){});return new Promise((e,i)=>{t.onload=(()=>{200===t.status?e(this.Parse(t.responseText)):i(t.statusText)})})},GZ3D.Ogre2Json.prototype.Parse=function(e){var t=e;t=(t=(t=(t="[{"+(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/{|}/gm,"\r\n$&\r\n")).replace(/^\s+/gm,"")).replace(/\s+$/gm,"")).replace(/^material (.*):(.*)$/gm,function(e,t,i){return"material "+t})).replace(/^material /gm,function(e,t){return 0===t?"":"},{"})).replace(/^vertex_program .*$|^fragment_program .*$/gm,function(e,t){var i=e.replace(/ /g,"_");return 0===t?i:"},{"+i})).replace(/^import .*$/gm,"")).replace(/^vertex_program_ref.*$|^fragment_program_ref.*$/gm,function(e,t){return e.replace(/ /g,"_")})).replace(/^texture_unit.*$/gm,function(e,t){return"texture_unit"})).replace(/^pass.*$/gm,function(e,t){return"pass"})).replace(/^technique.*$/gm,function(e,t){return"technique"})).replace(/(\/\*[\s\S]*?\*\/)|(\/\/.*$)/gm,"")).replace(/^\s+/gm,"")).replace(/\s+$/gm,"")).replace(/"/gm,"")).replace(/(.* .*){2,}/g,function(e){for(var t=e.split(/\s+/g),i=t[0]+" [",n=1;n<t.length-1;n++)i+=t[n]+",";return i+=t[t.length-1]+"]"})).replace(/(.* .*)/g,"$&,")).replace(/\r?\n|\r/g,"")).replace(/\s/g,": ")).replace(/{/g,function(e,t,i){return","===i[t-1]?"{":": {"}))+"}]").replace(/([\w/\.]+)/g,'"$&"')).replace(/,}/g,"}")).replace(/}"/g,'},"');try{this.materialObj=JSON.parse(t)}catch(i){return console.error("Failed to parse JSON. Original string:"),console.error(e),console.error("Modified string:"),console.error(t),!1}for(var i in this.materialObj)for(var n in this.materialObj[i]){if("object"==typeof this.materialObj[i][n]){this.materials[n]={};var r=_.get(this.materialObj[i],n+".technique.pass.ambient");void 0!==r&&Array.isArray(r)&&(this.materials[n].ambient=r.map(Number));var o=_.get(this.materialObj[i],n+".technique.pass.diffuse");void 0!==o&&Array.isArray(o)&&(this.materials[n].diffuse=o.map(Number));var a=_.get(this.materialObj[i],n+".technique.pass.specular");void 0!==a&&Array.isArray(a)&&(this.materials[n].specular=a.map(Number));var s=_.get(this.materialObj[i],n+".technique.pass.emissive");void 0!==s&&Array.isArray(s)&&(this.materials[n].emissive=s.map(Number));var l=_.get(this.materialObj[i],n+".technique.pass.depth_write");void 0!==l&&(this.materials[n].depth_write="off"!==l);var c=_.get(this.materialObj[i],n+".technique.pass.depth_check");void 0!==c&&(this.materials[n].depth_check="off"!==c);var u=_.get(this.materialObj[i],n+".technique.pass.texture_unit.texture");void 0!==u&&(this.materials[n].texture=u);var h=_.get(this.materialObj[i],n+".technique.pass.texture_unit.scale");void 0!==h&&Array.isArray(h)&&(this.materials[n].scale=h.map(Number));var d=_.get(this.materialObj[i],n+".technique.pass.texture_unit.alpha_op_ex");void 0!==d&&Array.isArray(d)&&4===d.length&&(this.materials[n].opacity=Number(d[3]))}else console.error("Failed to parse material ["+n+"]")}return this.emitter.emit("material",this.materials),!0},GZ3D.RadialMenu=function(e){this.domElement=void 0!==e?e:document,this.init()},GZ3D.RadialMenu.prototype.init=function(){this.radius=84,this.speed=12,this.bgSize=48,this.bgSizeSelected=81.6,this.highlightSize=54,this.iconProportion=.6,this.textureLoader=new THREE.TextureLoader,this.bgShape=this.textureLoader.load("style/images/icon_background.png"),this.layers={ICON:0,BACKGROUND:1,HIGHLIGHT:2},this.moving=!1,this.startPosition=null,this.showing=!1,this.selectedColor=new THREE.Color(2271965),this.plainColor=new THREE.Color(3355443),this.highlightColor=new THREE.Color(2271965),this.disabledColor=new THREE.Color(8947848),this.selected=null,this.model=null,this.menu=new THREE.Group,this.addItem("delete","style/images/trash.png"),this.addItem("translate","style/images/translate.png"),this.addItem("rotate","style/images/rotate.png"),this.addItem("transparent","style/images/transparent.png"),this.addItem("wireframe","style/images/wireframe.png"),this.addItem("joints","style/images/joints.png"),this.setNumberOfItems(this.menu.children.length),this.hide()},GZ3D.RadialMenu.prototype.hide=function(e,t){for(var i=0;i<this.numberOfItems;i++){var n=this.menu.children[i];n.children[this.layers.ICON].visible=!1,n.children[this.layers.ICON].scale.set(this.bgSize*this.iconProportion,this.bgSize*this.iconProportion,1),n.children[this.layers.BACKGROUND].visible=!1,n.children[this.layers.BACKGROUND].material.color=this.plainColor,n.children[this.layers.BACKGROUND].scale.set(this.bgSize,this.bgSize,1),n.children[this.layers.HIGHLIGHT].visible=!1}this.showing=!1,this.moving=!1,this.startPosition=null,t&&this.model&&this.selected&&(t(this.selected,this.model),this.model=null),this.selected=null},GZ3D.RadialMenu.prototype.show=function(e,t){if(!this.showing){this.model=t,t.children[0]instanceof THREE.Light?this.setNumberOfItems(3):this.setNumberOfItems(6);var i=this.getPointer(e);this.startPosition=i,this.menu.getObjectByName("transparent").isHighlighted=!1,this.menu.getObjectByName("wireframe").isHighlighted=!1,this.menu.getObjectByName("joints").isHighlighted=!1,this.menu.getObjectByName("joints").isDisabled=!1,"transparent"===this.model.viewAs&&(this.menu.getObjectByName("transparent").isHighlighted=!0),"wireframe"===this.model.viewAs&&(this.menu.getObjectByName("wireframe").isHighlighted=!0),void 0===this.model.joint||0===this.model.joint.length?this.menu.getObjectByName("joints").isDisabled=!0:this.model.getObjectByName("JOINT_VISUAL",!0)&&(this.menu.getObjectByName("joints").isHighlighted=!0);for(var n=0;n<this.numberOfItems;n++){var r=this.menu.children[n];r.children[this.layers.ICON].visible=!0,r.children[this.layers.ICON].position.set(i.x,i.y,1),r.children[this.layers.BACKGROUND].visible=!0,r.children[this.layers.BACKGROUND].position.set(i.x,i.y,1),r.isDisabled&&(r.children[this.layers.BACKGROUND].material.color=this.disabledColor),r.children[this.layers.HIGHLIGHT].visible=r.isHighlighted,r.children[this.layers.HIGHLIGHT].position.set(i.x,i.y,1)}this.moving=!0,this.showing=!0}},GZ3D.RadialMenu.prototype.update=function(){if(this.moving)for(var e=0;e<this.numberOfItems;e++){var t=this.menu.children[e],i=t.children[this.layers.ICON].position.x-this.startPosition.x,n=t.children[this.layers.ICON].position.y-this.startPosition.y;Math.sqrt(Math.pow(i,2)+Math.pow(n,2))<this.radius?(i-=this.speed*Math.sin((this.offset-e)*Math.PI/4),n+=this.speed*Math.cos((this.offset-e)*Math.PI/4)):this.moving=!1;var r=i+this.startPosition.x,o=n+this.startPosition.y;t.children[this.layers.ICON].position.x=r,t.children[this.layers.ICON].position.y=o,t.children[this.layers.BACKGROUND].position.x=r,t.children[this.layers.BACKGROUND].position.y=o,t.children[this.layers.HIGHLIGHT].position.x=r,t.children[this.layers.HIGHLIGHT].position.y=o}},GZ3D.RadialMenu.prototype.getPointer=function(e){e.originalEvent&&(e=e.originalEvent);var t=e.touches?e.touches[0]:e,i=this.domElement.getBoundingClientRect(),n=t.clientX-i.left,r=t.clientY-i.top;return{x:n-=.5*i.width,y:r=-(r-.5*i.height)}},GZ3D.RadialMenu.prototype.onLongPressMove=function(e){var t=this.getPointer(e),i=t.x-this.startPosition.x,n=t.y-this.startPosition.y,r=Math.atan2(n,i),o=null;r>-7*Math.PI/8&&r<-5*Math.PI/8?o=1:r>-8*Math.PI/8&&r<-7*Math.PI/8||r>7*Math.PI/8&&r<8*Math.PI/8?o=2:r>5*Math.PI/8&&r<7*Math.PI/8?o=3:r>3*Math.PI/8&&r<5*Math.PI/8?o=4:r>1*Math.PI/8&&r<3*Math.PI/8?o=5:r>-1*Math.PI/8&&r<1*Math.PI/8?o=6:r>-3*Math.PI/8&&r<-1*Math.PI/8?o=7:r>-5*Math.PI/8&&r<-3*Math.PI/8&&(o=8);var a=o-4+this.offset;(a>=this.numberOfItems||a<0)&&(this.selected=null,a=null);for(var s=0,l=0;l<this.numberOfItems;l++){var c=this.menu.children[l];s===a?(c.children[this.layers.ICON].scale.set(this.bgSizeSelected*this.iconProportion,this.bgSizeSelected*this.iconProportion,1),this.selected=c.children[this.layers.ICON].name,c.isDisabled||(c.children[this.layers.BACKGROUND].material.color=this.selectedColor),c.children[this.layers.BACKGROUND].scale.set(this.bgSizeSelected,this.bgSizeSelected,1)):(c.children[this.layers.ICON].scale.set(this.bgSize*this.iconProportion,this.bgSize*this.iconProportion,1),c.children[this.layers.BACKGROUND].scale.set(this.bgSize,this.bgSize,1),c.isDisabled||(c.children[this.layers.BACKGROUND].material.color=this.plainColor)),s++}},GZ3D.RadialMenu.prototype.addItem=function(e,t){t=this.textureLoader.load(t);var i=new THREE.SpriteMaterial({map:t}),n=new THREE.Sprite(i);n.scale.set(this.bgSize*this.iconProportion,this.bgSize*this.iconProportion,1),n.name=e,n.position.set(0,0,1);var r=new THREE.SpriteMaterial({map:this.bgShape,color:this.plainColor}),o=new THREE.Sprite(r);o.scale.set(this.bgSize,this.bgSize,1),o.position.set(0,0,1);var a=new THREE.SpriteMaterial({map:this.bgShape,color:this.highlightColor}),s=new THREE.Sprite(a);s.scale.set(this.highlightSize,this.highlightSize,1),o.position.set(0,0,1),s.visible=!1;var l=new THREE.Group;l.add(n),l.add(o),l.add(s),l.isHighlighted=!1,l.name=e,this.menu.add(l)},GZ3D.RadialMenu.prototype.setNumberOfItems=function(e){this.numberOfItems=e,this.offset=this.numberOfItems-1-Math.floor(this.numberOfItems/2)},GZ3D.Scene=function(e){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.shaders=e,this.init()},GZ3D.Scene.prototype.init=function(){this.name="default",this.scene=new THREE.Scene,this.meshes={},this.heightmap=null,this.selectedEntity=null,this.manipulationMode="view",this.pointerOnMenu=!1,this.textureLoader=new THREE.TextureLoader,this.textureLoader.crossOrigin="",this.colladaLoader=new THREE.ColladaLoader,this.stlLoader=new THREE.STLLoader,this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(11711154,1),this.renderer.autoClear=!1,this.ambient=new THREE.AmbientLight(6710886),this.scene.add(this.ambient);var e=this.getDomElement().width,t=this.getDomElement().height;this.camera=new THREE.PerspectiveCamera(60,e/t,.1,1e3),this.defaultCameraPosition=new THREE.Vector3(0,-5,5),this.resetView(),"function"==typeof GZ3D.RadialMenu&&(this.cameraOrtho=new THREE.OrthographicCamera(.5*-e,.5*e,.5*t,.5*-t,1,10),this.cameraOrtho.position.z=10,this.sceneOrtho=new THREE.Scene,this.radialMenu=new GZ3D.RadialMenu(this.getDomElement()),this.sceneOrtho.add(this.radialMenu.menu)),this.grid=new THREE.GridHelper(20,20,13421772,5066061),this.grid.name="grid",this.grid.position.z=.05,this.grid.rotation.x=.5*Math.PI,this.grid.castShadow=!1,this.grid.material.transparent=!0,this.grid.material.opacity=.5,this.grid.visible=!1,this.scene.add(this.grid),this.showCollisions=!1,this.spawnModel=new GZ3D.SpawnModel(this,this.getDomElement()),this.simpleShapesMaterial=new THREE.MeshPhongMaterial({color:16777215,shading:THREE.SmoothShading});var i=this;this.getDomElement().addEventListener("mouseup",function(e){i.onPointerUp(e)},!1),this.getDomElement().addEventListener("mousedown",function(e){i.onPointerDown(e)},!1),this.getDomElement().addEventListener("DOMMouseScroll",function(e){i.onMouseScroll(e)},!1),this.getDomElement().addEventListener("mousewheel",function(e){i.onMouseScroll(e)},!1),this.getDomElement().addEventListener("touchstart",function(e){i.onPointerDown(e)},!1),this.getDomElement().addEventListener("touchend",function(e){i.onPointerUp(e)},!1),this.modelManipulator=new GZ3D.Manipulator(this.camera,isTouchDevice,this.getDomElement()),this.timeDown=null,this.controls=new THREE.OrbitControls(this.camera,this.getDomElement()),this.scene.add(this.controls.targetIndicator);var n,r,o,a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(24),l=new THREE.BufferGeometry;l.setIndex(new THREE.BufferAttribute(a,1)),l.addAttribute("position",new THREE.BufferAttribute(s,3)),this.boundingBox=new THREE.LineSegments(l,new THREE.LineBasicMaterial({color:16777215})),this.boundingBox.visible=!1,this.jointTypes={REVOLUTE:1,REVOLUTE2:2,PRISMATIC:3,UNIVERSAL:4,BALL:5,SCREW:6,GEARBOX:7,FIXED:8},this.jointAxis=new THREE.Object3D,this.jointAxis.name="JOINT_VISUAL";var c=new THREE.Object3D;n=new THREE.CylinderGeometry(.01,.01,.3,10,1,!1),r=new THREE.MeshBasicMaterial({color:new THREE.Color(16711680)}),(o=new THREE.Mesh(n,r)).position.x=.15,o.rotation.z=-Math.PI/2,o.name="JOINT_VISUAL",c.add(o),r=new THREE.MeshBasicMaterial({color:new THREE.Color(65280)}),(o=new THREE.Mesh(n,r)).position.y=.15,o.name="JOINT_VISUAL",c.add(o),r=new THREE.MeshBasicMaterial({color:new THREE.Color(255)}),(o=new THREE.Mesh(n,r)).position.z=.15,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",c.add(o),n=new THREE.CylinderGeometry(0,.03,.1,10,1,!0),r=new THREE.MeshBasicMaterial({color:new THREE.Color(16711680)}),(o=new THREE.Mesh(n,r)).position.x=.3,o.rotation.z=-Math.PI/2,o.name="JOINT_VISUAL",c.add(o),r=new THREE.MeshBasicMaterial({color:new THREE.Color(65280)}),(o=new THREE.Mesh(n,r)).position.y=.3,o.name="JOINT_VISUAL",c.add(o),r=new THREE.MeshBasicMaterial({color:new THREE.Color(255)}),(o=new THREE.Mesh(n,r)).position.z=.3,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",c.add(o),this.jointAxis.XYZaxes=c;var u=new THREE.Object3D;(r=new THREE.MeshLambertMaterial).color=new THREE.Color(16776960);n=new THREE.CylinderGeometry(.015,.015,.3,36,1,!1),(o=new THREE.Mesh(n,r)).position.z=.15,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",u.add(o),n=new THREE.CylinderGeometry(0,.035,.1,36,1,!1),(o=new THREE.Mesh(n,r)).position.z=.3,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",u.add(o),this.jointAxis.mainAxis=u;var h=new THREE.Object3D;n=new THREE.TorusGeometry(.04,.006,10,36,3*Math.PI/2),(o=new THREE.Mesh(n,r)).position.z=.3,o.name="JOINT_VISUAL",h.add(o),n=new THREE.CylinderGeometry(.015,0,.025,10,1,!1),(o=new THREE.Mesh(n,r)).position.y=-.04,o.position.z=.3,o.rotation.z=Math.PI/2,o.name="JOINT_VISUAL",h.add(o),this.jointAxis.rotAxis=h;var d=new THREE.Object3D;n=new THREE.CylinderGeometry(.01,.01,.1,10,1,!0),(o=new THREE.Mesh(n,r)).position.x=.03,o.position.y=.03,o.position.z=.15,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",d.add(o),n=new THREE.CylinderGeometry(.02,0,.0375,10,1,!1),(o=new THREE.Mesh(n,r)).position.x=.03,o.position.y=.03,o.position.z=.2,o.rotation.x=-Math.PI/2,o.name="JOINT_VISUAL",d.add(o),(o=new THREE.Mesh(n,r)).position.x=.03,o.position.y=.03,o.position.z=.15-.05,o.rotation.x=Math.PI/2,o.name="JOINT_VISUAL",d.add(o),this.jointAxis.transAxis=d;var p=new THREE.Object3D;(o=new THREE.Mesh(n,r)).position.x=-.04,o.position.z=.19,o.rotation.z=-Math.PI/4,o.rotation.x=-Math.PI/10,o.name="JOINT_VISUAL",p.add(o);var f=new THREE.CatmullRomCurve3([new THREE.Vector3(.04,0,0),new THREE.Vector3(0,.04,.02),new THREE.Vector3(-.04,0,.04),new THREE.Vector3(0,-.04,.06),new THREE.Vector3(.04,0,.08),new THREE.Vector3(0,.04,.1),new THREE.Vector3(-.04,0,.12)]);n=new THREE.TubeGeometry(f,36,.01,10,!1),(o=new THREE.Mesh(n,r)).position.z=.3-.23,o.name="JOINT_VISUAL",p.add(o),this.jointAxis.screwAxis=p;var m=new THREE.Object3D;n=new THREE.SphereGeometry(.06),(o=new THREE.Mesh(n,r)).name="JOINT_VISUAL",m.add(o),this.jointAxis.ballVisual=m,this.COMvisual=new THREE.Object3D,this.COMvisual.name="COM_VISUAL",n=new THREE.SphereGeometry(1,32,32),o=new THREE.Mesh(n),this.setMaterial(o,{ambient:[.5,.5,.5,1],texture:"assets/media/materials/textures/com.png"}),o.name="COM_VISUAL",o.rotation.z=-Math.PI/2,this.COMvisual.add(o)},GZ3D.Scene.prototype.initScene=function(){this.emitter.emit("show_grid","show");var e=this.createLight(3,new THREE.Color(.8,.8,.8),.9,{position:{x:0,y:0,z:10},orientation:{x:0,y:0,z:0,w:1}},null,!0,"sun",{x:.5,y:.1,z:-.9});this.add(e)},GZ3D.Scene.prototype.setSDFParser=function(e){this.spawnModel.sdfParser=e},GZ3D.Scene.prototype.onPointerDown=function(e){if(e.preventDefault(),!this.spawnModel.active){var t,i=!0;if(e.touches)if(1===e.touches.length)t=new THREE.Vector2(e.touches[0].clientX,e.touches[0].clientY);else{if(2!==e.touches.length)return;t=new THREE.Vector2((e.touches[0].clientX+e.touches[1].clientX)/2,(e.touches[0].clientY+e.touches[1].clientY)/2)}else t=new THREE.Vector2(e.clientX,e.clientY),1!==e.which&&(i=!1);var n=new THREE.Vector3,r=this.getRayCastModel(t,n);n&&(this.controls.target=n),e.touches&&1!==e.touches.length||(r?"plane"===r.name?this.timeDown=(new Date).getTime():this.modelManipulator.pickerNames.indexOf(r.name)>=0||(""!==r.name?i&&r.parent===this.scene&&this.selectEntity(r):this.modelManipulator.hovered?(this.modelManipulator.update(),this.modelManipulator.object.updateMatrixWorld()):this.timeDown=(new Date).getTime()):this.timeDown=(new Date).getTime())}},GZ3D.Scene.prototype.onPointerUp=function(e){e.preventDefault(),(new Date).getTime()-this.timeDown<150&&(this.setManipulationMode("view"),"function"==typeof GZ3D.Gui&&($("#view-mode").click(),$('input[type="radio"]').checkboxradio("refresh"))),this.timeDown=null},GZ3D.Scene.prototype.onMouseScroll=function(e){e.preventDefault();var t=new THREE.Vector2(e.clientX,e.clientY),i=new THREE.Vector3;this.getRayCastModel(t,i);i&&(this.controls.target=i)},GZ3D.Scene.prototype.onKeyDown=function(e){if(e.shiftKey&&(187===e.keyCode||189===e.keyCode)){var t=new THREE.Vector2(this.getDomElement().width/2,this.getDomElement().height/2),i=new THREE.Vector3;this.getRayCastModel(t,i);i&&(this.controls.target=i),187===e.keyCode?this.controls.dollyOut():this.controls.dollyIn()}46===e.keyCode&&this.selectedEntity&&this.emitter.emit("delete_entity"),113===e.keyCode&&(this.effectsEnabled=!this.effectsEnabled),"function"==typeof GZ3D.Gui&&(27===e.keyCode&&($("#view-mode").click(),$('input[type="radio"]').checkboxradio("refresh")),82===e.keyCode&&($("#rotate-mode").click(),$('input[type="radio"]').checkboxradio("refresh")),84===e.keyCode&&($("#translate-mode").click(),$('input[type="radio"]').checkboxradio("refresh")))},GZ3D.Scene.prototype.getRayCastModel=function(e,t){var i=new THREE.Vector3((e.x-this.getDomElement().offsetLeft)/this.getDomElement().width*2-1,-(e.y-this.getDomElement().offsetTop)/this.getDomElement().height*2+1,1);i.unproject(this.camera);var n=new THREE.Raycaster(this.camera.position,i.sub(this.camera.position).normalize()),r=[];this.scene.getDescendants(r);var o,a,s=n.intersectObjects(r);if(s.length>0)e:for(var l=0;l<s.length;++l){if((o=s[l].object).name.indexOf("_lightHelper")>=0){o=o.parent;break}if(!this.modelManipulator.hovered&&"plane"===o.name){a=s[l].point;break}if("grid"!==o.name&&"boundingBox"!==o.name&&"JOINT_VISUAL"!==o.name&&"INERTIA_VISUAL"!==o.name&&"COM_VISUAL"!==o.name){for(;o.parent!==this.scene;){if(o.parent.parent===this.modelManipulator.gizmo&&("translate"===this.manipulationMode&&o.name.indexOf("T")>=0||"rotate"===this.manipulationMode&&o.name.indexOf("R")>=0))break e;o=o.parent}if(!this.radialMenu||o!==this.radialMenu.menu)if(o.name.indexOf("COLLISION_VISUAL")>=0)o=null;else if(this.modelManipulator.hovered){if(o===this.modelManipulator.gizmo)break}else if(""!==o.name){a=s[l].point;break}}else a=s[l].point,o=null}return a&&(t.x=a.x,t.y=a.y,t.z=a.z),o},GZ3D.Scene.prototype.getDomElement=function(){return this.renderer.domElement},GZ3D.Scene.prototype.render=function(){this.modelManipulator.hovered||this.radialMenu&&this.radialMenu.showing||this.pointerOnMenu||this.spawnModel.active?(this.controls.enabled=!1,this.controls.update()):(this.controls.enabled=!0,this.controls.update()),this.modelManipulator.update(),this.radialMenu&&this.radialMenu.update(),this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.renderer.clearDepth(),this.sceneOrtho&&this.cameraOrtho&&this.renderer.render(this.sceneOrtho,this.cameraOrtho)},GZ3D.Scene.prototype.setSize=function(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.cameraOrtho&&(this.cameraOrtho.left=-e/2,this.cameraOrtho.right=e/2,this.cameraOrtho.top=t/2,this.cameraOrtho.bottom=-t/2,this.cameraOrtho.updateProjectionMatrix()),this.renderer.setSize(e,t),this.render()},GZ3D.Scene.prototype.add=function(e){e.viewAs="normal",this.scene.add(e)},GZ3D.Scene.prototype.remove=function(e){this.scene.remove(e)},GZ3D.Scene.prototype.getByName=function(e){return this.scene.getObjectByName(e)},GZ3D.Scene.prototype.updatePose=function(e,t,i){this.modelManipulator&&this.modelManipulator.object&&this.modelManipulator.hovered||this.setPose(e,t,i)},GZ3D.Scene.prototype.setPose=function(e,t,i){e.position.x=t.x,e.position.y=t.y,e.position.z=t.z,e.quaternion.w=i.w,e.quaternion.x=i.x,e.quaternion.y=i.y,e.quaternion.z=i.z},GZ3D.Scene.prototype.removeAll=function(){for(;this.scene.children.length>0;)this.scene.remove(this.scene.children[0])},GZ3D.Scene.prototype.createPlane=function(e,t,i,n,r){var o=new THREE.PlaneGeometry(n,r,1,1),a=new THREE.MeshPhongMaterial,s=new THREE.Mesh(o,a),l=new THREE.Vector3(e,t,i),c=l.crossVectors(l,s.up);return s.rotation=l.applyAxisAngle(c,-l.angleTo(s.up)),s.name="plane",s.receiveShadow=!0,s},GZ3D.Scene.prototype.createSphere=function(e){var t=new THREE.SphereGeometry(e,32,32);return new THREE.Mesh(t,this.simpleShapesMaterial)},GZ3D.Scene.prototype.createCylinder=function(e,t){var i=new THREE.CylinderGeometry(e,e,t,32,1,!1),n=new THREE.Mesh(i,this.simpleShapesMaterial);return n.rotation.x=.5*Math.PI,n},GZ3D.Scene.prototype.createBox=function(e,t,i){var n=new THREE.BoxGeometry(e,t,i,1,1,1);n.dynamic=!0;for(var r=[1,4,5],o=[0],a=0;a<r.length;++a){var s=2*r[a],l=n.faceVertexUvs[0][s][0];n.faceVertexUvs[0][s][0]=n.faceVertexUvs[0][s][1],n.faceVertexUvs[0][s][1]=n.faceVertexUvs[0][s+1][1],n.faceVertexUvs[0][s][2]=l,n.faceVertexUvs[0][s+1][0]=n.faceVertexUvs[0][s+1][1],n.faceVertexUvs[0][s+1][1]=n.faceVertexUvs[0][s+1][2],n.faceVertexUvs[0][s+1][2]=n.faceVertexUvs[0][s][2]}for(var c=0;c<o.length;++c){var u=2*o[c],h=n.faceVertexUvs[0][u][0];n.faceVertexUvs[0][u][0]=n.faceVertexUvs[0][u][2],n.faceVertexUvs[0][u][1]=h,n.faceVertexUvs[0][u][2]=n.faceVertexUvs[0][u+1][1],n.faceVertexUvs[0][u+1][2]=n.faceVertexUvs[0][u][2],n.faceVertexUvs[0][u+1][1]=n.faceVertexUvs[0][u+1][0],n.faceVertexUvs[0][u+1][0]=n.faceVertexUvs[0][u][1]}n.uvsNeedUpdate=!0;var d=new THREE.Mesh(n,this.simpleShapesMaterial);return d.castShadow=!0,d},GZ3D.Scene.prototype.createLight=function(e,t,i,n,r,o,a,s,l,c,u,h){var d,p=new THREE.Object3D,f=new THREE.Color;void 0===t?t=16777215:typeof t!==THREE.Color?(f.r=t.r,f.g=t.g,f.b=t.b,t=f.clone()):typeof l!==THREE.Color&&(f.r=l.r,f.g=l.g,f.b=l.b,l=f.clone()),n&&(this.setPose(p,n.position,n.orientation),p.matrixWorldNeedsUpdate=!0),1===e?d=this.createPointLight(p,t,i,r,o):2===e?d=this.createSpotLight(p,t,i,r,o):3===e&&(d=this.createDirectionalLight(p,t,i,o));var m=d[0],g=d[1];a&&(m.name=a,p.name=a,g.name=a+"_lightHelper");var v=new THREE.Vector3(0,0,-1);s&&(v.x=s.x,v.y=s.y,v.z=s.z),p.direction=new THREE.Vector3(v.x,v.y,v.z);var y=new THREE.Object3D;return m.add(y),y.position.copy(v),y.matrixWorldNeedsUpdate=!0,m.target=y,p.serverProperties={},p.serverProperties.specular=l,p.serverProperties.attenuation_constant=c,p.serverProperties.attenuation_linear=u,p.serverProperties.attenuation_quadratic=h,p.add(m),p.add(g),p},GZ3D.Scene.prototype.createPointLight=function(e,t,i,n,r){void 0===i&&(i=.5);var o=new THREE.PointLight(t,i);n&&(o.distance=n),r&&(o.castShadow=r);var a=new THREE.OctahedronGeometry(.25,0);a.applyMatrix((new THREE.Matrix4).makeRotationX(Math.PI/2));var s=new THREE.MeshBasicMaterial({wireframe:!0,color:65280});return[o,new THREE.Mesh(a,s)]},GZ3D.Scene.prototype.createSpotLight=function(e,t,i,n,r){void 0===i&&(i=1),void 0===n&&(n=20);var o=new THREE.SpotLight(t,i);o.distance=n,o.position.set(0,0,0),r&&(o.castShadow=r);var a=new THREE.CylinderGeometry(0,.3,.2,4,1,!0);a.applyMatrix((new THREE.Matrix4).makeRotationX(Math.PI/2)),a.applyMatrix((new THREE.Matrix4).makeRotationZ(Math.PI/4));var s=new THREE.MeshBasicMaterial({wireframe:!0,color:65280});return[o,new THREE.Mesh(a,s)]},GZ3D.Scene.prototype.createDirectionalLight=function(e,t,i,n){void 0===i&&(i=1);var r=new THREE.DirectionalLight(t,i);r.shadow.camera.near=1,r.shadow.camera.far=50,r.shadow.mapSize.width=4094,r.shadow.mapSize.height=4094,r.shadow.camera.bottom=-100,r.shadow.camera.feft=-100,r.shadow.camera.right=100,r.shadow.camera.top=100,r.shadow.bias=1e-4,r.position.set(0,0,0),n&&(r.castShadow=n);var o=new THREE.Geometry;o.vertices.push(new THREE.Vector3(-.5,-.5,0)),o.vertices.push(new THREE.Vector3(-.5,.5,0)),o.vertices.push(new THREE.Vector3(-.5,.5,0)),o.vertices.push(new THREE.Vector3(.5,.5,0)),o.vertices.push(new THREE.Vector3(.5,.5,0)),o.vertices.push(new THREE.Vector3(.5,-.5,0)),o.vertices.push(new THREE.Vector3(.5,-.5,0)),o.vertices.push(new THREE.Vector3(-.5,-.5,0)),o.vertices.push(new THREE.Vector3(0,0,0)),o.vertices.push(new THREE.Vector3(0,0,-.5));var a=new THREE.LineBasicMaterial({color:65280});return[r,new THREE.Line(o,a,THREE.LineSegments)]},GZ3D.Scene.prototype.createRoads=function(e,t,i){var n=new THREE.Geometry;n.dynamic=!0;for(var r,o,a=0,s=t,l=1,c=0,u=new THREE.Vector3(0,0,0),h=new THREE.Vector3(0,0,0),d=[],p=0,f=0;f<e.length;++f){var m,g=new THREE.Vector3(e[f].x,e[f].y,e[f].z);if(f!==e.length-1&&(m=new THREE.Vector3(e[f+1].x,e[f+1].y,e[f+1].z)),l=1,f>0&&(c+=g.distanceTo(h)),a=c/s,0===f)u.x=m.x,u.y=m.y,u.z=m.z,u.sub(g),u.normalize();else if(f===e.length-1)u.x=g.x,u.y=g.y,u.z=g.z,u.sub(h),u.normalize();else{var v=new THREE.Vector3(0,0,0),y=new THREE.Vector3(0,0,0);v.x=g.x,v.y=g.y,v.z=g.z,v.sub(h),v.normalize(),y.x=m.x,y.y=m.y,y.z=m.z,y.sub(g),y.normalize();var b=v.dot(-1*y);u.x=m.x,u.y=m.y,u.z=m.z,u.sub(h),u.normalize(),b>-.97&&b<.97&&(l=1/Math.sin(.5*Math.acos(b)))}var x=Math.atan2(u.x,-u.y);r=new THREE.Vector3(g.x,g.y,g.z),o=new THREE.Vector3(g.x,g.y,g.z);var _=t*l*.5;r.x+=Math.cos(x)*_,r.y+=Math.sin(x)*_,o.x-=Math.cos(x)*_,o.y-=Math.sin(x)*_,n.vertices.push(r),n.vertices.push(o),d.push([0,a]),d.push([1,a]),f>0&&(n.faces.push(new THREE.Face3(p,p+1,p+2,new THREE.Vector3(0,0,1))),n.faceVertexUvs[0].push([new THREE.Vector2(d[p][0],d[p][1]),new THREE.Vector2(d[p+1][0],d[p+1][1]),new THREE.Vector2(d[p+2][0],d[p+2][1])]),p++,n.faces.push(new THREE.Face3(p,p+2,p+1,new THREE.Vector3(0,0,1))),n.faceVertexUvs[0].push([new THREE.Vector2(d[p][0],d[p][1]),new THREE.Vector2(d[p+2][0],d[p+2][1]),new THREE.Vector2(d[p+1][0],d[p+1][1])]),p++),h.x=g.x,h.y=g.y,h.z=g.z,a}n.computeFaceNormals(),n.verticesNeedUpdate=!0,n.uvsNeedUpdate=!0;var w=new THREE.MeshPhongMaterial;if(i){var E=this.textureLoader.load(i);E.wrapS=E.wrapT=THREE.RepeatWrapping,w.map=E}var T=new THREE.Mesh(n,w);return T.castShadow=!1,T},GZ3D.Scene.prototype.loadHeightmap=function(e,t,i,n,r,o,a,s,l){if(this.heightmap)console.log("Only one heightmap can be loaded at a time");else if(void 0!==l){var c=1;n-1>256&&(c=256/(n-1));var u=new THREE.PlaneGeometry(t,i,(n-1)*c,(r-1)*c);u.dynamic=!0;for(var h=[],d=r-1;d>=0;--d)for(var p=0;p<n;++p)h[(r-d-1)*n+p]=e[d*n+p];for(var f,m=(n-1)*c,g=(r-1)*c,v=0;v<g;++v)for(var y=0;y<m;++y){var b=v*m*1/(c*c)+y*(1/c);u.vertices[v*m+y].z=h[b]}if(u.computeFaceNormals(),u.computeVertexNormals(),a&&a.length>0){for(var x=[],_=[],w=0;w<a.length;++w)x[w]=this.textureLoader.load(a[w].diffuse),x[w].wrapS=THREE.RepeatWrapping,x[w].wrapT=THREE.RepeatWrapping,_[w]=t/a[w].size;for(var E=a.length;E<3;++E)x[E]=x[E-1];for(var T=s.length;T<2;++T)s[T]=s[T-1];for(var M=_.length;M<3;++M)_[M]=_[M-1];var S=new THREE.Vector3(0,0,1),C=new THREE.Color(16777215),R=[];this.scene.getDescendants(R);for(var A=0;A<R.length;++A)if(R[A]instanceof THREE.DirectionalLight){S=R[A].target.position,C=R[A].color;break}var P={uniforms:{texture0:{type:"t",value:x[0]},texture1:{type:"t",value:x[1]},texture2:{type:"t",value:x[2]},repeat0:{type:"f",value:_[0]},repeat1:{type:"f",value:_[1]},repeat2:{type:"f",value:_[2]},minHeight1:{type:"f",value:s[0].min_height},fadeDist1:{type:"f",value:s[0].fade_dist},minHeight2:{type:"f",value:s[1].min_height},fadeDist2:{type:"f",value:s[1].fade_dist},ambient:{type:"c",value:this.ambient.color},lightDiffuse:{type:"c",value:C},lightDir:{type:"v3",value:S}}};void 0!==this.shaders?(P.vertexShader=this.shaders.heightmapVS,P.fragmentShader=this.shaders.heightmapFS):console.log("Warning: heightmap shaders not provided."),f=new THREE.ShaderMaterial(P)}else f=new THREE.MeshPhongMaterial({color:5592405});var L=new THREE.Mesh(u,f);L.position.x=o.x,L.position.y=o.y,L.position.z=o.z,l.add(L),this.heightmap=l}else console.error("Missing parent, heightmap won't be loaded.")},GZ3D.Scene.prototype.loadMeshFromUri=function(e,t,i,n){e.substring(0,e.lastIndexOf("/"));var r=e.substring(e.lastIndexOf("/")+1);if(this.meshes[e]){var o=this.meshes[e];return o=o.clone(),this.useSubMesh(o,t,i),void n(o)}return".dae"===r.substr(-4).toLowerCase()?this.loadCollada(e,t,i,n):".obj"===r.substr(-4).toLowerCase()?new GZ3D.OBJLoader(this,e,t,i,n).loadOBJ():".stl"===r.substr(-4).toLowerCase()?this.loadSTL(e,t,i,n):void(".urdf"===r.substr(-5).toLowerCase()&&console.error("Attempting to load URDF file, but it's not supported."))},GZ3D.Scene.prototype.loadMeshFromString=function(e,t,i,n,r){e.substring(0,e.lastIndexOf("/"));var o=e.substring(e.lastIndexOf("/")+1);if(this.meshes[e]){var a=this.meshes[e];return a=a.clone(),this.useSubMesh(a,t,i),void n(a)}return".dae"===o.substr(-4).toLowerCase()?r.length<1||!r[0]?void console.error("Missing DAE file"):this.loadCollada(e,t,i,n,r[0]):".obj"===o.substr(-4).toLowerCase()?r.length<2||!r[0]||!r[1]?void console.error("Missing either OBJ or MTL file"):new GZ3D.OBJLoader(this,e,t,i,n,r).loadOBJ():void 0},GZ3D.Scene.prototype.loadCollada=function(e,t,i,n,r){var o,a=this;function s(r){(o=r.scene).updateMatrix(),a.prepareColladaMesh(o),a.meshes[e]=o,o=o.clone(),a.useSubMesh(o,t,i),o.name=e,n(o)}r?this.colladaLoader.parse(r,function(e){s(e)},void 0):this.colladaLoader.load(e,function(e){s(e)})},GZ3D.Scene.prototype.prepareColladaMesh=function(e){var t=[];e.getDescendants(t);for(var i=0;i<t.length;++i)t[i]instanceof THREE.Light&&t[i].parent.remove(t[i])},GZ3D.Scene.prototype.useSubMesh=function(e,t,i){if(!t)return null;var n,r=[];e.getDescendants(r);for(var o=0;o<r.length;++o)if(r[o]instanceof THREE.Mesh)if(r[o].name===t||r[o].geometry.name===t){if(i)if(r[o].geometry instanceof THREE.BufferGeometry){var a=r[o].geometry.attributes.position,s=a.itemSize,l=[],c=[],u=[],h=0;for(h=0;h<s;++h)l[h]=a.array[h],c[h]=l[h];var d=0;for(d=s;d<a.count*s;d+=s)for(h=0;h<s;++h)l[h]=Math.min(l[h],a.array[d+h]),c[h]=Math.max(c[h],a.array[d+h]);for(h=0;h<s;++h)u[h]=l[h]+.5*(c[h]-l[h]);for(d=0;d<a.count*s;d+=s)for(h=0;h<s;++h)a.array[d+h]-=u[h];r[o].geometry.attributes.position.needsUpdate=!0}else{var p=r[o].geometry.vertices,f=new THREE.Vector3,m=new THREE.Vector3;f.x=p[0].x,f.y=p[0].y,f.z=p[0].z,m.x=f.x,m.y=f.y,m.z=f.z;for(var g=1;g<p.length;++g)f.x=Math.min(f.x,p[g].x),f.y=Math.min(f.y,p[g].y),f.z=Math.min(f.z,p[g].z),m.x=Math.max(m.x,p[g].x),m.y=Math.max(m.y,p[g].y),m.z=Math.max(m.z,p[g].z);var v=new THREE.Vector3;v.x=f.x+.5*(m.x-f.x),v.y=f.y+.5*(m.y-f.y),v.z=f.z+.5*(m.z-f.z);for(var y=0;y<p.length;++y)p[y].x-=v.x,p[y].y-=v.y,p[y].z-=v.z;r[o].geometry.verticesNeedUpdate=!0;for(var b=r[o].parent;b;)b.position.set(0,0,0),b=b.parent}n=r[o]}else r[o].parent.remove(r[o]);return n},GZ3D.Scene.prototype.loadSTL=function(e,t,i,n){var r=null,o=this;this.stlLoader.load(e,function(a){(r=new THREE.Mesh(a)).castShadow=!0,r.receiveShadow=!0,o.meshes[e]=r,r=r.clone(),o.useSubMesh(r,t,i),r.name=e,n(r)})},GZ3D.Scene.prototype.setMaterial=function(e,t){if(e&&t){e.material=new THREE.MeshPhongMaterial;var i=t.ambient,n=t.diffuse;if(n){var r=[];if(r[0]=n[0],r[1]=n[1],r[2]=n[2],i){r[0]=.4*i[0]+.6*n[0],r[1]=.4*i[1]+.6*n[1],r[2]=.4*i[2]+.6*n[2]}e.material.color.setRGB(r[0],r[1],r[2])}var o=t.specular;o&&e.material.specular.setRGB(o[0],o[1],o[2]);var a=t.opacity;if(a&&a<1&&(e.material.transparent=!0,e.material.opacity=a),t.texture){var s=this.textureLoader.load(t.texture);t.scale&&(s.wrapS=s.wrapT=THREE.RepeatWrapping,s.repeat.x=1/t.scale[0],s.repeat.y=1/t.scale[1]),e.material.map=s}t.normalMap&&(e.material.normalMap=this.textureLoader.load(t.normalMap))}},GZ3D.Scene.prototype.setManipulationMode=function(e){this.manipulationMode=e,"view"===e?(this.modelManipulator.object&&this.emitter.emit("entityChanged",this.modelManipulator.object),this.selectEntity(null)):(this.modelManipulator.mode===this.manipulationMode&&(this.modelManipulator.space="world"===this.modelManipulator.space?"local":"world"),this.modelManipulator.mode=this.manipulationMode,this.modelManipulator.setMode(this.modelManipulator.mode),this.selectedEntity&&this.selectEntity(this.selectedEntity))},GZ3D.Scene.prototype.showCollision=function(e){if(e!==this.showCollisions){var t=[];this.scene.getDescendants(t);for(var i=0;i<t.length;++i)if(t[i]instanceof THREE.Object3D&&t[i].name.indexOf("COLLISION_VISUAL")>=0){var n=[];t[i].getDescendants(n);for(var r=0;r<n.length;++r)n[r]instanceof THREE.Mesh&&(n[r].visible=e)}this.showCollisions=e}},GZ3D.Scene.prototype.attachManipulator=function(e,t){this.modelManipulator.object&&this.emitter.emit("entityChanged",this.modelManipulator.object),"view"!==t&&(this.modelManipulator.attach(e),this.modelManipulator.mode=t,this.modelManipulator.setMode(this.modelManipulator.mode),this.scene.add(this.modelManipulator.gizmo))},GZ3D.Scene.prototype.resetView=function(){this.camera.position.copy(this.defaultCameraPosition),this.camera.up=new THREE.Vector3(0,0,1),this.camera.lookAt(new THREE.Vector3(0,0,0)),this.camera.updateMatrix()},GZ3D.Scene.prototype.showRadialMenu=function(e){if(this.radialMenu){var t=e.originalEvent,i=t.touches?t.touches[0]:t,n=new THREE.Vector2(i.clientX,i.clientY),r=new THREE.Vector3,o=this.getRayCastModel(n,r);o&&""!==o.name&&"plane"!==o.name&&-1===this.modelManipulator.pickerNames.indexOf(o.name)&&(this.radialMenu.show(t,o),this.selectEntity(o))}},GZ3D.Scene.prototype.setFromObject=function(e,t){e.min.x=e.min.y=e.min.z=1/0,e.max.x=e.max.y=e.max.z=-1/0;var i=new THREE.Vector3;function n(t){e.min.min(t),e.max.max(t)}t.updateMatrixWorld(!0),t.traverse(function(e){var t,r,o=e.geometry;if(void 0!==o&&"INERTIA_VISUAL"!==e.name&&"COM_VISUAL"!==e.name)if(o.isGeometry){var a=o.vertices;for(t=0,r=a.length;t<r;t++)i.copy(a[t]),i.applyMatrix4(e.matrixWorld),n(i)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(t=0,r=s.count;t<r;t++)i.fromBufferAttribute(s,t).applyMatrix4(e.matrixWorld),n(i)}})},GZ3D.Scene.prototype.showBoundingBox=function(e){if("string"==typeof e&&(e=this.scene.getObjectByName(e)),this.boundingBox.visible){if(this.boundingBox.parent===e)return;this.hideBoundingBox()}var t=new THREE.Box3;this.setFromObject(t,e),t.min.x=t.min.x-e.position.x,t.min.y=t.min.y-e.position.y,t.min.z=t.min.z-e.position.z,t.max.x=t.max.x-e.position.x,t.max.y=t.max.y-e.position.y,t.max.z=t.max.z-e.position.z;var i=this.boundingBox.geometry.attributes.position,n=i.array;n[0]=t.max.x,n[1]=t.max.y,n[2]=t.max.z,n[3]=t.min.x,n[4]=t.max.y,n[5]=t.max.z,n[6]=t.min.x,n[7]=t.min.y,n[8]=t.max.z,n[9]=t.max.x,n[10]=t.min.y,n[11]=t.max.z,n[12]=t.max.x,n[13]=t.max.y,n[14]=t.min.z,n[15]=t.min.x,n[16]=t.max.y,n[17]=t.min.z,n[18]=t.min.x,n[19]=t.min.y,n[20]=t.min.z,n[21]=t.max.x,n[22]=t.min.y,n[23]=t.min.z,i.needsUpdate=!0,this.boundingBox.geometry.computeBoundingSphere();var r=new THREE.Matrix4;r.extractRotation(e.matrixWorld);var o=new THREE.Matrix4;o.getInverse(r),this.boundingBox.quaternion.setFromRotationMatrix(o),this.boundingBox.name="boundingBox",this.boundingBox.visible=!0,e.add(this.boundingBox)},GZ3D.Scene.prototype.hideBoundingBox=function(){this.boundingBox.parent&&this.boundingBox.parent.remove(this.boundingBox),this.boundingBox.visible=!1},GZ3D.Scene.prototype.onRightClick=function(e,t){var i=new THREE.Vector2(e.clientX,e.clientY),n=this.getRayCastModel(i,new THREE.Vector3);n&&""!==n.name&&"plane"!==n.name&&-1===this.modelManipulator.pickerNames.indexOf(n.name)&&t(n)},GZ3D.Scene.prototype.setViewAs=function(e,t){e.viewAs===t&&(t="normal");var i="wireframe"===t;function n(e){-1===o.indexOf(e.id)&&(o.push(e.id),"transparent"===t?(e.opacity?e.originalOpacity=e.opacity:e.originalOpacity=1,e.opacity=.25,e.transparent=!0):(e.opacity=e.originalOpacity?e.originalOpacity:1,e.opacity>=1&&(e.transparent=!1)),e.wireframe=i)}var r=[],o=[];e.getDescendants(r);for(var a=0;a<r.length;++a)if(r[a].material&&-1===r[a].name.indexOf("boundingBox")&&-1===r[a].name.indexOf("COLLISION_VISUAL")&&!this.getParentByPartialName(r[a],"COLLISION_VISUAL")&&-1===r[a].name.indexOf("wireframe")&&-1===r[a].name.indexOf("JOINT_VISUAL")&&-1===r[a].name.indexOf("COM_VISUAL")&&-1===r[a].name.indexOf("INERTIA_VISUAL"))if(r[a].material instanceof THREE.MultiMaterial)for(var s=0;s<r[a].material.materials.length;++s)n(r[a].material.materials[s]);else if(Array.isArray(r[a].material))for(var l=0;l<r[a].material.length;++l)n(r[a].material[l]);else n(r[a].material);e.viewAs=t},GZ3D.Scene.prototype.getParentByPartialName=function(e,t){for(var i=e.parent;i&&i!==this.scene;){if(-1!==i.name.indexOf(t))return i;i=i.parent}return null},GZ3D.Scene.prototype.selectEntity=function(e){e?(e!==this.selectedEntity&&(this.showBoundingBox(e),this.selectedEntity=e),this.attachManipulator(e,this.manipulationMode),this.emitter.emit("setTreeSelected",e.name)):(this.modelManipulator.object&&(this.modelManipulator.detach(),this.scene.remove(this.modelManipulator.gizmo)),this.hideBoundingBox(),this.selectedEntity=null,this.emitter.emit("setTreeDeselected"))},GZ3D.Scene.prototype.viewJoints=function(e){var t;if(void 0!==e.joint&&0!==e.joint.length)if(e.jointVisuals)if(void 0!==e.jointVisuals[0].parent&&null!==e.jointVisuals[0].parent)for(var i=0;i<e.jointVisuals.length;++i)e.jointVisuals[i].parent.remove(e.jointVisuals[i]);else for(var n=0;n<e.joint.length;++n)(t=e.getObjectByName(e.joint[n].child))&&t.add(e.jointVisuals[n]);else{e.jointVisuals=[];for(var r=0;r<e.joint.length;++r)if(t=e.getObjectByName(e.joint[r].child)){var o=this.jointAxis.XYZaxes.clone();t.add(o),e.jointVisuals.push(o),o.scale.set(.7,.7,.7),this.setPose(o,e.joint[r].pose.position,e.joint[r].pose.orientation);var a=null;e.joint[r].type!==this.jointTypes.BALL&&e.joint[r].type!==this.jointTypes.FIXED&&(a=this.jointAxis.mainAxis.clone(),o.add(a));var s,l,c,u=null;e.joint[r].type!==this.jointTypes.REVOLUTE2&&e.joint[r].type!==this.jointTypes.UNIVERSAL||(u=this.jointAxis.mainAxis.clone(),o.add(u)),e.joint[r].type===this.jointTypes.REVOLUTE||e.joint[r].type===this.jointTypes.GEARBOX?a.add(this.jointAxis.rotAxis.clone()):e.joint[r].type===this.jointTypes.REVOLUTE2||e.joint[r].type===this.jointTypes.UNIVERSAL?(a.add(this.jointAxis.rotAxis.clone()),u.add(this.jointAxis.rotAxis.clone())):e.joint[r].type===this.jointTypes.BALL?o.add(this.jointAxis.ballVisual.clone()):e.joint[r].type===this.jointTypes.PRISMATIC?a.add(this.jointAxis.transAxis.clone()):e.joint[r].type===this.jointTypes.SCREW&&a.add(this.jointAxis.screwAxis.clone()),a&&(e.joint[r].axis1||console.log("no joint axis "+e.joint[r].type+"vs "+this.jointTypes.FIXED),void 0===e.joint[r].axis1.use_parent_model_frame&&(e.joint[r].axis1.use_parent_model_frame=!0),(s=new THREE.Vector3(e.joint[r].axis1.xyz.x,e.joint[r].axis1.xyz.y,e.joint[r].axis1.xyz.z)).normalize(),l=new THREE.Matrix4,e.joint[r].axis1.use_parent_model_frame&&(l.extractRotation(o.matrix),l.getInverse(l),s.applyMatrix4(l),l.extractRotation(t.matrix),l.getInverse(l),s.applyMatrix4(l)),(c=new THREE.Matrix4).lookAt(s,new THREE.Vector3(0,0,0),a.up),a.quaternion.setFromRotationMatrix(c)),u&&(void 0===e.joint[r].axis2.use_parent_model_frame&&(e.joint[r].axis2.use_parent_model_frame=!0),(s=new THREE.Vector3(e.joint[r].axis2.xyz.x,e.joint[r].axis2.xyz.y,e.joint[r].axis2.xyz.z)).normalize(),l=new THREE.Matrix4,e.joint[r].axis2.use_parent_model_frame&&(l.extractRotation(o.matrix),l.getInverse(l),s.applyMatrix4(l),l.extractRotation(t.matrix),l.getInverse(l),s.applyMatrix4(l)),u.position=s.multiplyScalar(.3),(c=new THREE.Matrix4).lookAt(s,new THREE.Vector3(0,0,0),u.up),u.quaternion.setFromRotationMatrix(c))}}},GZ3D.Scene.prototype.viewCOM=function(e){var t;if(void 0!==e&&null!==e&&0!==e.children.length)if(e.COMVisuals)if(void 0!==e.COMVisuals[0].parent&&null!==e.COMVisuals[0].parent)for(var i=0;i<e.COMVisuals.length;++i){for(var n=0;n<3;n++)e.COMVisuals[i].parent.remove(e.COMVisuals[i].crossLines[n]);e.COMVisuals[i].parent.remove(e.COMVisuals[i])}else for(var r=0;r<e.children.length;++r)(t=e.getObjectByName(e.children[r].name))&&"boundingBox"!==t.name&&(t.add(e.COMVisuals[r].crossLines[0]),t.add(e.COMVisuals[r].crossLines[1]),t.add(e.COMVisuals[r].crossLines[2]),t.add(e.COMVisuals[r]));else{e.COMVisuals=[];for(var o,a,s,l,c,u,h,d,p,f=new Array(6),m=0;m<e.children.length;++m)if((t=e.getObjectByName(e.children[m].name))&&t.userData.inertial){var g,v,y,b={},x=t.userData.inertial;y=t.userData.inertial.pose,v=x.mass,g=Math.cbrt(.75*v/(11340*Math.PI)),a=this.COMvisual.clone(),t.add(a),e.COMVisuals.push(a),a.scale.set(g,g,g);var _=new THREE.Vector3(0,0,0),w=new THREE.Quaternion,E=new THREE.Euler(0,0,0,"XYZ");w.setFromEuler(E),b={position:_,orientation:w},void 0!==y&&(this.setPose(a,y.position,y.orientation),b=y),a.crossLines=[];var T=new THREE.Euler;T.copy(t.rotation),t.setRotationFromMatrix((new THREE.Matrix4).getInverse(t.parent.matrixWorld)),(o=new THREE.Box3).setFromObject(t),t.setRotationFromEuler(T);var M=new THREE.Matrix4;M.getInverse(t.matrixWorld),o.applyMatrix4(M),f[0]=new THREE.Vector3(o.min.x,b.position.y,b.position.z),f[1]=new THREE.Vector3(o.max.x,b.position.y,b.position.z),f[2]=new THREE.Vector3(b.position.x,o.min.y,b.position.z),f[3]=new THREE.Vector3(b.position.x,o.max.y,b.position.z),f[4]=new THREE.Vector3(b.position.x,b.position.y,o.min.z),f[5]=new THREE.Vector3(b.position.x,b.position.y,o.max.z),(u=new THREE.Geometry).vertices.push(f[0]),u.vertices.push(f[1]),(h=new THREE.Geometry).vertices.push(f[2]),h.vertices.push(f[3]),(d=new THREE.Geometry).vertices.push(f[4]),d.vertices.push(f[5]),p=new THREE.LineBasicMaterial({color:65280}),s=new THREE.Line(u,p,THREE.LineSegments),l=new THREE.Line(h,p,THREE.LineSegments),c=new THREE.Line(d,p,THREE.LineSegments),s.name="COM_VISUAL",l.name="COM_VISUAL",c.name="COM_VISUAL",a.crossLines.push(s),a.crossLines.push(l),a.crossLines.push(c),t.add(s),t.add(l),t.add(c)}}},GZ3D.Scene.prototype.viewInertia=function(e){var t;if(void 0!==e&&null!==e&&0!==e.children.length)if(e.inertiaVisuals)if(void 0!==e.inertiaVisuals[0].parent&&null!==e.inertiaVisuals[0].parent)for(var i=0;i<e.inertiaVisuals.length;++i){for(var n=0;n<3;n++)e.inertiaVisuals[i].parent.remove(e.inertiaVisuals[i].crossLines[n]);e.inertiaVisuals[i].parent.remove(e.inertiaVisuals[i])}else for(var r=0;r<e.children.length;++r)(t=e.getObjectByName(e.children[r].name))&&"boundingBox"!==t.name&&(t.add(e.inertiaVisuals[r].crossLines[0]),t.add(e.inertiaVisuals[r].crossLines[1]),t.add(e.inertiaVisuals[r].crossLines[2]),t.add(e.inertiaVisuals[r]));else{e.inertiaVisuals=[];for(var o,a,s,l,c,u,h,d,p,f=new Array(6),m=0;m<e.children.length;++m)if((t=e.getObjectByName(e.children[m].name))&&(d=t.userData.inertial)){var g,v,y,b,x,_,w,E,T={};if(d.pose)T=t.userData.inertial.pose;else{if(!t.position){console.log("Link pose not found!");continue}T.position=t.position,T.orientation=t.quaternion}_=d.mass,y=(w=d.inertia).ixx,b=w.iyy,x=w.izz,v=new THREE.Vector3,_<0||y<0||b<0||x<0||y+b<x||b+x<y||x+y<b?console.log("The link "+t.name+" has unrealistic inertia, unable to visualize box of equivalent inertia."):(v.x=Math.sqrt(6*(x+b-y)/_),v.y=Math.sqrt(6*(x+y-b)/_),v.z=Math.sqrt(6*(y+b-x)/_),(p=new THREE.Object3D).name="INERTIA_VISUAL",(g=this.createBox(1,1,1)).name="INERTIA_VISUAL",E={ambient:[1,0,1,1],diffuse:[1,0,1,1],depth_write:!1,opacity:.5},this.setMaterial(g,E),p.add(g),p.name="INERTIA_VISUAL",t.add(p),e.inertiaVisuals.push(p),p.scale.set(v.x,v.y,v.z),p.crossLines=[],this.setPose(p,T.position,T.orientation),(new THREE.Box3).setFromObject(t),f[0]=new THREE.Vector3(T.position.x,T.position.y,-2*v.z+T.position.z),f[1]=new THREE.Vector3(T.position.x,T.position.y,2*v.z+T.position.z),f[2]=new THREE.Vector3(T.position.x,-2*v.y+T.position.y,T.position.z),f[3]=new THREE.Vector3(T.position.x,2*v.y+T.position.y,T.position.z),f[4]=new THREE.Vector3(-2*v.x+T.position.x,T.position.y,T.position.z),f[5]=new THREE.Vector3(2*v.x+T.position.x,T.position.y,T.position.z),(l=new THREE.Geometry).vertices.push(f[0]),l.vertices.push(f[1]),(c=new THREE.Geometry).vertices.push(f[2]),c.vertices.push(f[3]),(u=new THREE.Geometry).vertices.push(f[4]),u.vertices.push(f[5]),h=new THREE.LineBasicMaterial({color:65280}),o=new THREE.Line(l,h,THREE.LineSegments),a=new THREE.Line(c,h,THREE.LineSegments),s=new THREE.Line(u,h,THREE.LineSegments),o.name="INERTIA_VISUAL",a.name="INERTIA_VISUAL",s.name="INERTIA_VISUAL",p.crossLines.push(o),p.crossLines.push(a),p.crossLines.push(s),t.add(o),t.add(a),t.add(s))}}},GZ3D.Scene.prototype.updateLight=function(e,t){var i,n=e.children[0],r=new THREE.Color;t.diffuse&&(r.r=t.diffuse.r,r.g=t.diffuse.g,r.b=t.diffuse.b,n.color=r.clone()),t.specular&&(r.r=t.specular.r,r.g=t.specular.g,r.b=t.specular.b,e.serverProperties.specular=r.clone()),t.pose&&(this.setPose(e,t.pose.position,t.pose.orientation),e.matrixWorldNeedsUpdate=!0),t.range&&(n.distance=t.range),t.cast_shadows&&(n.castShadow=t.cast_shadows),t.attenuation_constant&&(e.serverProperties.attenuation_constant=t.attenuation_constant),t.attenuation_linear&&(e.serverProperties.attenuation_linear=t.attenuation_linear,n.intensity=n.intensity/(1+t.attenuation_linear)),t.attenuation_quadratic&&(e.serverProperties.attenuation_quadratic=t.attenuation_quadratic,n.intensity=n.intensity/(1+t.attenuation_quadratic)),t.direction&&(i=new THREE.Vector3(t.direction.x,t.direction.y,t.direction.z),e.direction=new THREE.Vector3,e.direction.copy(i),n.target&&n.target.position.copy(i))},GZ3D.Scene.prototype.createFromSdf=function(e){if(void 0!==e){var t=new THREE.Object3D,i=xml2json(this.spawnModel.sdfParser.parseXML(e),"\t"),n=(JSON.parse(i).sdf,this.spawnModel.sdfParser.spawnFromSDF(e));if(n)return t.name=n.name,t.add(n),t}else console.log(" No argument provided ")},GZ3D.SdfParser=function(e,t,i){this.emitter=globalEmitter||new EventEmitter2({verboseMemoryLeak:!0}),this.SDF_VERSION=1.5,this.MATERIAL_ROOT=i?i.protocol+"//"+i.url+"/assets":"assets",this.usingFilesUrls=!1,this.parseXML=function(e){return(new window.DOMParser).parseFromString(e,"text/xml")},this.scene=e,this.scene.setSDFParser(this),this.gui=t,this.gziface=i,this.init(),this.materials={},this.entityMaterial={},this.meshes={},this.mtls={},this.textures={},this.customUrls=[];var n=this;this.emitter.on("material",function(e){n.materials=Object.assign(n.materials,e)})},GZ3D.SdfParser.prototype.init=function(){if(this.gziface){this.usingFilesUrls=!0;var e=this;this.emitter.on("connectionError",function(){e.emitter.emit("notification_popup","GzWeb is currently runningwithout a server, and materials could not be loaded.When connected scene will be reinitialized",5e3),e.onConnectionError()}),this.emitter.on("gzstatus",function(t){"error"===t&&(e.emitter.emit("notification_popup","GzWeb is currently running without a GzServer,and Scene is reinitialized.",5e3),e.onConnectionError())})}else this.scene.initScene()},GZ3D.SdfParser.prototype.addUrl=function(e){void 0!==e&&0===e.indexOf("http")?this.customUrls.push(e):console.log("Trying to add invalid URL")},GZ3D.SdfParser.prototype.onConnectionError=function(){this.scene.initScene();var e=this;this.emitter.on("entityCreated",function(t,i){e.gziface.isConnected||e.addModelByType(t,i)});this.emitter.on("deleteEntity",function(t){var i=t.name,n=e.scene.getByName(i);void 0!==n&&(n.children[0]instanceof THREE.Light?e.emitter.emit("setLightStats",{name:i},"delete"):e.gui.setModelStats({name:i},"delete"),e.scene.remove(n))})},GZ3D.SdfParser.prototype.parseColor=function(e){var t={},i=e.split(/\s+/);return t.r=parseFloat(i[0]),t.g=parseFloat(i[1]),t.b=parseFloat(i[2]),t.a=parseFloat(i[3]),t},GZ3D.SdfParser.prototype.parse3DVector=function(e){var t={},i=e.split(/\s+/);return t.x=parseFloat(i[0]),t.y=parseFloat(i[1]),t.z=parseFloat(i[2]),t},GZ3D.SdfParser.prototype.spawnLightFromSDF=function(e){var t=e.light,i=t["@name"],n=this.parseColor(t.diffuse),r=this.parseColor(t.specular),o=this.parsePose(t.pose),a=this.parseBool(t.cast_shadows),s=null,l=null,c=null,u=null,h=null,d=1;t.attenuation&&(t.attenuation.range&&(s=parseFloat(t.attenuation.range)),t.attenuation.constant&&(l=parseFloat(t.attenuation.constant)),t.attenuation.linear&&(c=parseFloat(t.attenuation.linear)),t.attenuation.quadratic&&(u=parseFloat(t.attenuation.quadratic)));var p=u,f=1/(1+1*c)*1*(Math.pow(1,2)/(Math.pow(1,2)+p*Math.pow(1,2)));return"point"===t["@type"]&&(d=1),"spot"===t["@type"]?d=2:"directional"===t["@type"]&&(d=3,h=this.parse3DVector(t.direction)),this.scene.createLight(d,n,f,o,s,a,i,h,r,l,c,u)},GZ3D.SdfParser.prototype.parsePose=function(e){var t={position:new THREE.Vector3,orientation:new THREE.Quaternion};if("string"!=typeof e&&!(e instanceof String))return t;var i=e.split(/\s+/),n=new THREE.Vector3(parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2])),r=new THREE.Quaternion,o=new THREE.Euler(parseFloat(i[3]),parseFloat(i[4]),parseFloat(i[5]),"ZYX");return r.setFromEuler(o),t.position=n,t.orientation=r,t},GZ3D.SdfParser.prototype.parseScale=function(e){var t=e.split(/\s+/);return new THREE.Vector3(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))},GZ3D.SdfParser.prototype.parseBool=function(e){return JSON.parse(e)},GZ3D.SdfParser.prototype.createMaterial=function(e){var t,i,n,r,o,a,s,l,c;if(!e)return null;var u,h=e.script;if(h&&(h.uri||(h.uri=["file://media/materials/scripts/gazebo.material"]),h.uri instanceof Array||(h.uri=[h.uri]),h.name))if(n=this.materials[h.name]){if(r=n.ambient,o=n.diffuse,a=n.specular,s=n.opacity,c=n.scale,n.texture){for(var d=0;d<h.uri.length;++d){var p=h.uri[d].substring(0,h.uri[d].indexOf("://"));if("model"===p){if(h.uri[d].indexOf("textures")>0){t=h.uri[d].substring(h.uri[d].indexOf("://")+3);break}}else if("file"===p&&h.uri[d].indexOf("materials")>0){t=h.uri[d].substring(h.uri[d].indexOf("://")+3,h.uri[d].indexOf("materials")+9)+"/textures";break}}if(this.usingFilesUrls)if(0!==this.customUrls.length){for(var f=0;f<this.customUrls.length;f++)if(this.customUrls[f].indexOf(n.texture)>-1){i=this.customUrls[f];break}}else i=this.MATERIAL_ROOT+"/"+t+"/"+n.texture;else i=this.textures[n.texture]}}else console.log(h.name+" is not cached!!!");if(e.normal_map&&(u=e.normal_map.indexOf("://")>0?e.normal_map.substring(e.normal_map.indexOf("://")+3,e.normal_map.lastIndexOf("/")):t)){var m=e.normal_map.lastIndexOf("/")+1;m<0&&(m=0);var g=e.normal_map.substr(m,e.normal_map.lastIndexOf(".")-m);if(this.usingFilesUrls)if(0!==this.customUrls.length){for(var v=0;v<this.customUrls.length;v++)if(this.customUrls[v].indexOf(g+".png")>-1){l=this.customUrls[v];break}}else l=this.MATERIAL_ROOT+"/"+u+"/"+g+".png";else l=this.textures[g+".png"]}return{texture:i,normalMap:l,ambient:r,diffuse:o,specular:a,opacity:s,scale:c}},GZ3D.SdfParser.prototype.parseSize=function(e){var t=e.split(/\s+/);return{x:parseFloat(t[0]),y:parseFloat(t[1]),z:parseFloat(t[2])}},GZ3D.SdfParser.prototype.createGeom=function(e,t,i){var n,r,o,a=this,s=this.createMaterial(t);if(e.box)r=this.parseSize(e.box.size),n=this.scene.createBox(r.x,r.y,r.z);else if(e.cylinder){var l=parseFloat(e.cylinder.radius),c=parseFloat(e.cylinder.length);n=this.scene.createCylinder(l,c)}else if(e.sphere)n=this.scene.createSphere(parseFloat(e.sphere.radius));else if(e.plane)o=this.parseSize(e.plane.normal),r=this.parseSize(e.plane.size),n=this.scene.createPlane(o.x,o.y,o.z,r.x,r.y);else if(e.mesh){var u,h,d=e.mesh.uri;e.mesh.submesh&&(u=e.mesh.submesh.name,h=this.parseBool(e.mesh.submesh.center));var p=d.substring(0,d.indexOf("://"));if("file"===p||"model"===p){var f=d.substring(d.indexOf("://")+3);if(e.mesh.scale){var m=this.parseScale(e.mesh.scale);i.scale.x=m.x,i.scale.y=m.y,i.scale.z=m.z}var g=this.MATERIAL_ROOT+"/"+f,v=g.substr(-4).toLowerCase(),y=i.name+"::"+g;this.entityMaterial[y]=s;var b=d.substring(d.lastIndexOf("/")+1);if(this.usingFilesUrls){if(0!==this.customUrls.length)for(var x=0;x<this.customUrls.length;x++)if(this.customUrls[x].indexOf(b)>-1){g=this.customUrls[x];break}this.scene.loadMeshFromUri(g,u,h,function(e){if(e){if(s)if(".stl"!==v){var t=[];e.getDescendants(t);for(var n=0;n<t.length;++n)if(t[n]instanceof THREE.Mesh){a.scene.setMaterial(t[n],s);break}}else a.scene.setMaterial(e,s);else".stl"===v&&a.scene.setMaterial(e,{ambient:[1,1,1,1]});i.add(e),T(i)}else console.error("Failed to load mesh.")})}else{var _=this.meshes[b];if(!_)return void console.error("Missing mesh file ["+b+"]");if(".obj"===v){var w=b.split(".")[0]+".mtl",E=this.mtls[w];if(!E)return void console.error("Missing MTL file ["+w+"]");a.scene.loadMeshFromString(g,u,h,function(e){e?(i.add(e),T(i)):console.error("Failed to load mesh.")},[_,E])}else".dae"===v&&a.scene.loadMeshFromString(g,u,h,function(e){if(e){if(s){var t=[];e.getDescendants(t);for(var n=0;n<t.length;++n)if(t[n]instanceof THREE.Mesh){a.scene.setMaterial(t[n],s);break}}i.add(e),T(i)}else console.error("Failed to load mesh.")},[_])}}}function T(e){var t=[];e.getDescendants(t);for(var i=0;i<t.length;++i)if(t[i]instanceof THREE.Mesh){t[i].castShadow=!0,t[i].receiveShadow=!0,e.castShadows&&(t[i].castShadow=e.castShadows),e.receiveShadows&&(t[i].receiveShadow=e.receiveShadows),e.name.indexOf("COLLISION_VISUAL")>=0&&(t[i].castShadow=!1,t[i].receiveShadow=!1,t[i].visible=this.scene.showCollisions);break}}n&&(s&&this.scene.setMaterial(n,s),n.updateMatrix(),i.add(n),T(i))},GZ3D.SdfParser.prototype.createVisual=function(e){if(e.geometry){var t=new THREE.Object3D;if(t.name=e["@name"],e.pose){var i=this.parsePose(e.pose);this.scene.setPose(t,i.position,i.orientation)}return this.createGeom(e.geometry,e.material,t),t}return null},GZ3D.SdfParser.prototype.spawnFromSDF=function(e){var t=xml2json("string"==typeof e?this.parseXML(e):e,"\t"),i=JSON.parse(t).sdf;if(i)return i.model?this.spawnModelFromSDF(i):i.light?this.spawnLightFromSDF(i):i.world?this.spawnWorldFromSDF(i):void 0;console.error("Failed to parse SDF: ",t)},GZ3D.SdfParser.prototype.loadSDF=function(e){if(e){var t=e.toLowerCase(),i=null;if(i=0===t.indexOf("http")?e:t.endsWith(".world")||t.endsWith(".sdf")?this.MATERIAL_ROOT+"/worlds/"+e:this.MATERIAL_ROOT+"/"+e+"/model.sdf"){var n=this.fileFromUrl(i);if(n)return this.spawnFromSDF(n)}else console.log("Error: unable to load "+e+" - file not found")}else{console.error("Must provide either a model/world name or the URL of an SDF file")}},GZ3D.SdfParser.prototype.spawnModelFromSDF=function(e){var t,i,n,r=new THREE.Object3D;for(r.name=e.model["@name"],e.model.pose&&(t=this.parsePose(e.model.pose),this.scene.setPose(r,t.position,t.orientation)),e.model.link instanceof Array||(e.model.link=[e.model.link]),i=0;i<e.model.link.length;++i)(n=this.createLink(e.model.link[i]))&&r.add(n);if(e.model.model)for(e.model.model instanceof Array||(e.model.model=[e.model.model]),i=0;i<e.model.model.length;++i){var o={model:e.model.model[i]},a=this.spawnModelFromSDF(o);a&&r.add(a)}return r},GZ3D.SdfParser.prototype.spawnWorldFromSDF=function(e){var t=new THREE.Object3D,i=this.scene.getByName("sun");if(i&&this.scene.remove(i),e.world.include){e.world.include instanceof Array||(e.world.include=[e.world.include]);for(var n=0;n<e.world.include.length;++n){var r=e.world.include[n];if(r.uri&&r.uri.startsWith("model://"))for(var o=r.uri.substr("model://".length),a=0;a<this.customUrls.length;++a){var s=new URL(this.customUrls[a]);if(s.pathname.indexOf(o)>0&&s.pathname.toLowerCase().endsWith(".sdf")){var l=this.fileFromUrl(this.customUrls[a]);if(l){var c=this.spawnFromSDF(l);if(r.name&&(c.name=r.name),r.pose){var u=this.parsePose(r.pose);this.scene.setPose(c,u.position,u.orientation)}t.add(c)}else console.log("Failed to spawn model: "+o);break}}}}if(e.world.model){e.world.model instanceof Array||(e.world.model=[e.world.model]);for(var h=0;h<e.world.model.length;++h){var d={model:e.world.model[h]},p=this.spawnModelFromSDF(d);t.add(p)}}if(e.world.light){e.world.light instanceof Array||(e.world.light=[e.world.light]);for(var f=0;f<e.world.light.length;++f){var m={light:e.world.light[f]},g=this.spawnLightFromSDF(m);t.add(g)}}return t},GZ3D.SdfParser.prototype.createLink=function(e){var t,i,n=new THREE.Object3D;if(n.name=e["@name"],e.inertial){var r,o,a={};n.userData.inertial={},r=e.inertial.pose,o=e.inertial.mass,a.ixx=e.inertial.ixx,a.ixy=e.inertial.ixy,a.ixz=e.inertial.ixz,a.iyy=e.inertial.iyy,a.iyz=e.inertial.iyz,a.izz=e.inertial.izz,n.userData.inertial.inertia=a,o&&(n.userData.inertial.mass=o),r&&(n.userData.inertial.pose=r)}if(e.pose&&(t=this.parsePose(e.pose),this.scene.setPose(n,t.position,t.orientation)),e.visual){e.visual instanceof Array||(e.visual=[e.visual]);for(var s=0;s<e.visual.length;++s)(i=this.createVisual(e.visual[s]))&&!i.parent&&n.add(i)}if(e.collision){e.collision instanceof Array||(e.collision=[e.collision]);for(var l=0;l<e.collision.length;++l)(i=this.createVisual(e.collision[l]))&&!i.parent&&(i.castShadow=!1,i.receiveShadow=!1,i.visible=this.scene.showCollisions,n.add(i))}return n},GZ3D.SdfParser.prototype.addModelByType=function(e,t){var i,n,r,o,a=new THREE.Quaternion;if(e.matrixWorld){var s=e.matrixWorld;n=new THREE.Vector3,r=new THREE.Euler;var l=new THREE.Vector3;s.decompose(n,r,l),a.setFromEuler(r)}if("box"===t)i=this.createBoxSDF(n,r),o=this.spawnFromSDF(i);else if("sphere"===t)i=this.createSphereSDF(n,r),o=this.spawnFromSDF(i);else if("cylinder"===t)i=this.createCylinderSDF(n,r),o=this.spawnFromSDF(i);else if("spotlight"===t)o=this.scene.createLight(2),this.scene.setPose(o,n,a);else if("directionallight"===t)o=this.scene.createLight(3),this.scene.setPose(o,n,a);else if("pointlight"===t)o=this.scene.createLight(1),this.scene.setPose(o,n,a);else{var c=this.loadSDF(t);(o=new THREE.Object3D).add(c),o.name=e.name,this.scene.setPose(o,n,a)}var u,h=this;u=function(){void 0===h.scene.getByName(o.name)?(h.scene.add(o),h.gui.setModelStats(o,"update")):setTimeout(u,100)},setTimeout(u,100)},GZ3D.SdfParser.prototype.createSimpleShapeSDF=function(e,t,i,n){return'<sdf version="'+this.SDF_VERSION+'"><model name="'+e+'"><pose>'+t.x+" "+t.y+" "+t.z+" "+i.x+" "+i.y+" "+i.z+'</pose><link name="link"><inertial><mass>1.0</mass></inertial><collision name="collision"><geometry>'+n+'</geometry></collision><visual name="visual"><geometry>'+n+"</geometry><material><script><uri>file://media/materials/scripts/gazebo.material</uri><name>Gazebo/Grey</name><\/script></material></visual></link></model></sdf>"},GZ3D.SdfParser.prototype.createBoxSDF=function(e,t){return this.createSimpleShapeSDF("box",e,t,"<box><size>1.0 1.0 1.0</size></box>")},GZ3D.SdfParser.prototype.createSphereSDF=function(e,t){return this.createSimpleShapeSDF("sphere",e,t,"<sphere><radius>0.5</radius></sphere>")},GZ3D.SdfParser.prototype.createCylinderSDF=function(e,t){return this.createSimpleShapeSDF("cylinder",e,t,"<cylinder><radius>0.5</radius><length>1.0</length></cylinder>")},GZ3D.SdfParser.prototype.fileFromUrl=function(e){var t=new XMLHttpRequest;t.overrideMimeType("text/xml"),t.open("GET",e,!1);try{t.send()}catch(t){return void console.log("Failed to get URL ["+e+"]: "+t.message)}if(200===t.status)return t.responseXML;console.log("Failed to get URL ["+e+"]")},GZ3D.Shaders=function(){this.init()},GZ3D.Shaders.prototype.init=function(){this.heightmapVS="varying vec2 vUv;varying vec3 vPosition;varying vec3 vNormal;void main( void ) {  vUv = uv;  vPosition = position;  vNormal = -normal;  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",this.heightmapFS="uniform sampler2D texture0;uniform sampler2D texture1;uniform sampler2D texture2;uniform float repeat0;uniform float repeat1;uniform float repeat2;uniform float minHeight1;uniform float minHeight2;uniform float fadeDist1;uniform float fadeDist2;uniform vec3 ambient;uniform vec3 lightDiffuse;uniform vec3 lightDir;varying vec2 vUv;varying vec3 vPosition;varying vec3 vNormal;float blend(float distance, float fadeDist) {  float alpha = distance / fadeDist;  if (alpha < 0.0) {    alpha = 0.0;  }  if (alpha > 1.0) {    alpha = 1.0;  }  return alpha;}void main(){  vec3 diffuse0 = texture2D( texture0, vUv*repeat0 ).rgb;  vec3 diffuse1 = texture2D( texture1, vUv*repeat1 ).rgb;  vec3 diffuse2 = texture2D( texture2, vUv*repeat2 ).rgb;  vec3 fragcolor = diffuse0;  if (fadeDist1 > 0.0)  {    fragcolor = mix(      fragcolor,      diffuse1,      blend(vPosition.z - minHeight1, fadeDist1)    );  }  if (fadeDist2 > 0.0)  {    fragcolor = mix(      fragcolor,      diffuse2,      blend(vPosition.z - (minHeight1 + minHeight2), fadeDist2)    );  }  vec3 lightDirNorm = normalize(lightDir);  float intensity = max(dot(vNormal, lightDirNorm), 0.0);  vec3 vLightFactor = ambient + lightDiffuse * intensity;  gl_FragColor = vec4(fragcolor.rgb * vLightFactor, 1.0);}"},GZ3D.SpawnModel=function(e,t){this.scene=e,this.domElement=void 0!==t?t:document,this.init(),this.obj=void 0,this.callback=void 0,this.sdfParser=void 0,this.spawnedShapeMaterial=new THREE.MeshPhongMaterial({color:16777215,shading:THREE.SmoothShading}),this.spawnedShapeMaterial.transparent=!0,this.spawnedShapeMaterial.opacity=.5},GZ3D.SpawnModel.prototype.init=function(){this.plane=new THREE.Plane(new THREE.Vector3(0,0,1),0),this.ray=new THREE.Ray,this.obj=null,this.active=!1,this.snapDist=null},GZ3D.SpawnModel.prototype.start=function(e,t){var i;this.active&&this.finish(),this.callback=t,this.obj=new THREE.Object3D,"box"===e?(i=this.scene.createBox(1,1,1)).material=this.spawnedShapeMaterial:"sphere"===e?(i=this.scene.createSphere(.5)).material=this.spawnedShapeMaterial:"cylinder"===e?(i=this.scene.createCylinder(.5,1)).material=this.spawnedShapeMaterial:i="pointlight"===e?this.scene.createLight(1):"spotlight"===e?this.scene.createLight(2):"directionallight"===e?this.scene.createLight(3):this.sdfParser.loadSDF(e),this.obj.name=this.generateUniqueName(e),this.obj.add(i);var n=new THREE.Vector2(window.window.innerWidth/2,window.innerHeight/2),r=new THREE.Vector3;this.scene.getRayCastModel(n,r),this.obj.position.x=r.x,this.obj.position.y=r.y,this.obj.position.z+=.5,this.scene.add(this.obj);var o=[];this.scene.scene.getDescendants(o);for(var a=0;a<o.length;++a)o[a].material&&(o[a].material.needsUpdate=!0);var s=this;this.mouseDown=function(e){s.onMouseDown(e)},this.mouseUp=function(e){s.onMouseUp(e)},this.mouseMove=function(e){s.onMouseMove(e)},this.keyDown=function(e){s.onKeyDown(e)},this.touchMove=function(e){s.onTouchMove(e,!0)},this.touchEnd=function(e){s.onTouchEnd(e)},this.domElement.addEventListener("mousedown",s.mouseDown,!1),this.domElement.addEventListener("mouseup",s.mouseUp,!1),this.domElement.addEventListener("mousemove",s.mouseMove,!1),document.addEventListener("keydown",s.keyDown,!1),this.domElement.addEventListener("touchmove",s.touchMove,!1),this.domElement.addEventListener("touchend",s.touchEnd,!1),this.active=!0},GZ3D.SpawnModel.prototype.finish=function(){this.domElement.removeEventListener("mousedown",this.mouseDown,!1),this.domElement.removeEventListener("mouseup",this.mouseUp,!1),this.domElement.removeEventListener("mousemove",this.mouseMove,!1),document.removeEventListener("keydown",this.keyDown,!1),this.scene.remove(this.obj),this.obj=void 0,this.active=!1},GZ3D.SpawnModel.prototype.onMouseDown=function(e){e.preventDefault(),e.stopImmediatePropagation()},GZ3D.SpawnModel.prototype.onMouseMove=function(e){this.active&&(e.preventDefault(),this.moveSpawnedModel(e.clientX,e.clientY))},GZ3D.SpawnModel.prototype.onTouchMove=function(e,t){var i;this.active&&((i=t?e:e.originalEvent).preventDefault(),1===i.touches.length&&this.moveSpawnedModel(i.touches[0].pageX,i.touches[0].pageY))},GZ3D.SpawnModel.prototype.onTouchEnd=function(){this.active&&(this.callback(this.obj),this.finish())},GZ3D.SpawnModel.prototype.onMouseUp=function(e){this.active&&(this.callback(this.obj),this.finish())},GZ3D.SpawnModel.prototype.onKeyDown=function(e){27===e.keyCode&&this.finish()},GZ3D.SpawnModel.prototype.moveSpawnedModel=function(e,t){var i=new THREE.Vector3(e/window.innerWidth*2-1,-t/window.innerHeight*2+1,.5);i.unproject(this.scene.camera),this.ray.set(this.scene.camera.position,i.sub(this.scene.camera.position).normalize());var n=this.ray.intersectPlane(this.plane);if(n&&(n.z=this.obj.position.z,this.snapDist&&(n.x=Math.round(n.x/this.snapDist)*this.snapDist,n.y=Math.round(n.y/this.snapDist)*this.snapDist),this.scene.setPose(this.obj,n,new THREE.Quaternion),this.obj.children[0].children[0]&&(this.obj.children[0].children[0]instanceof THREE.SpotLight||this.obj.children[0].children[0]instanceof THREE.DirectionalLight))){var r=this.obj.children[0].children[0];r.direction&&r.target&&r.target.position.copy(r.direction)}},GZ3D.SpawnModel.prototype.generateUniqueName=function(e){for(var t=0;t<1e3;){if(!this.scene.getByName(e+"_"+t))return e+"_"+t;++t}};